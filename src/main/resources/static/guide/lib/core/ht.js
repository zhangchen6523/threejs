!function(i,u,w){"use strict";function C(){this.el=[1,0,0,0,1,0,0,0,1]}function f(h){var H={};return{get:function($){if(H[$]!==w)return H[$];var f;switch($){case"WEBGL_depth_texture":f=h.getExtension("WEBGL_depth_texture")||h.getExtension("MOZ_WEBGL_depth_texture")||h.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":f=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":f=h.getExtension("WEBGL_compressed_texture_s3tc")||h.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":f=h.getExtension("WEBGL_compressed_texture_pvrtc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":f=h.getExtension("WEBGL_compressed_texture_etc1");break;default:f=h.getExtension($)}return H[$]=f,f}}}function _(A,h,Q){function c(){if(P!==w)return P;var S=h.get("EXT_texture_filter_anisotropic");return P=null!==S?A.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function v(y){if("highp"===y){if(A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.HIGH_FLOAT).precision>0&&A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.HIGH_FLOAT).precision>0)return"highp";y="mediump"}return"mediump"===y&&A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.MEDIUM_FLOAT).precision>0&&A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var P;Q=Q||{};var m="undefined"!=typeof WebGL2RenderingContext&&A instanceof WebGL2RenderingContext,i=Q.precision!==w?Q.precision:"highp",O=v(i);O!==i&&(console.warn("WebGL:",i,"not supported, using",O,"instead."),i=O);var U=Q.logarithmicDepthBuffer===!0,_=A.getParameter(A.MAX_TEXTURE_IMAGE_UNITS),a=A.getParameter(A.MAX_VERTEX_TEXTURE_IMAGE_UNITS),s=A.getParameter(A.MAX_TEXTURE_SIZE),k=A.getParameter(A.MAX_CUBE_MAP_TEXTURE_SIZE),B=A.getParameter(A.MAX_VERTEX_ATTRIBS),z=A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS),F=A.getParameter(A.MAX_VARYING_VECTORS),K=A.getParameter(A.MAX_FRAGMENT_UNIFORM_VECTORS),f=a>0,Y=m||!!h.get("OES_texture_float"),L=f&&Y,o=m?A.getParameter(A.MAX_SAMPLES):0;return{getMaxAnisotropy:c,getMaxPrecision:v,precision:i,logarithmicDepthBuffer:U,maxTextures:_,maxVertexTextures:a,maxTextureSize:s,maxCubemapSize:k,maxAttributes:B,maxVertexUniforms:z,maxVaryings:F,maxFragmentUniforms:K,vertexTextures:f,floatFragmentTextures:Y,floatVertexTextures:L,maxSamples:o}}var g="ht";if(!i[g]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),i.performance&&i.performance.now||function(){var T=Date.now();i.performance||(i.performance={}),i.performance.now=function(){return Date.now()-T}}();for(var d=Date.now(),D=16,E=["ms","moz","webkit","o"],B=0;B<E.length&&!i.requestAnimationFrame;++B)i.requestAnimationFrame=i[E[B]+"RequestAnimationFrame"],i.cancelAnimationFrame=i[E[B]+"CancelAnimationFrame"]||i[E[B]+"CancelRequestAnimationFrame"];i.requestAnimationFrame||(i.requestAnimationFrame=function(S){var B=Date.now(),V=D+d-B;return 0>V&&(V=0),d=B,i.setTimeout(function(){d=Date.now(),S(performance.now())},V)}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(G){return i.clearTimeout(G)}),u.assign===w&&(u.assign=function(g){if(g===w||null===g)throw new TypeError("Cannot convert undefined or null to object");for(var X=u(g),h=1;h<arguments.length;h++){var L=arguments[h];if(L!==w&&null!==L)for(var C in L)u.prototype.hasOwnProperty.call(L,C)&&(X[C]=L[C])}return X})}();var l=i.document,t=null,Y=i[g]={},k=i[g+"config"],Q=Y.Default=k&&k.Default||{},K=Y.Style=k&&k.Style||{},J=Y.Attr=k&&k.Attr||{},p=Y.Color=k&&k.Color||{},R=Y.IsGetter=k&&k.IsGetter||{};!function(){var V=!1;try{var C=u.defineProperty({},"passive",{get:function(){V=!0}});i.addEventListener("test",C,C),i.removeEventListener("test",C,C)}catch(e){V=!1}Q.passiveSupported=V}();var e,P,M,V,v=Q.passiveSupported,j=Q.eventListenerOptionsFalse=v?{passive:!1,capture:!1}:!1,D=Q.eventListenerOptionsTrue=v?{passive:!1,capture:!0}:!0,b=function(E,Z,H,z){E.addEventListener(Z,H,z?D:j)},n=function(H,Q,L,m){H.removeEventListener(Q,L,m?D:j)},X=Math,y=X.round,E=X.floor,m=X.ceil,N=X.sqrt,q=X.max,a=X.min,c=X.abs,I=X.cos,$=X.acos,d=X.sin,B=X.pow,W=X.asin,A=X.exp,S=X.PI,z=2*S,T=S/2,H=X.tan,r=X.atan2,L=X.random,G=X.log,U=!1,x=!1,F=i.parseInt||global.parseInt,O="2020-10-15",h=i.navigator?i.navigator.platform.indexOf("Win")>-1:!1,s=function(x){return x*x},Z=i.setTimeout,o=i.clearTimeout,Lb=i.location,hc=i.navigator?i.navigator.userAgent.toLowerCase():"",Tq=function(G){return G.test(hc)},Rf=Tq(/msie/),Kc=Tq(/msie/)||Tq(/trident/),Hg=Tq(/msie 10/),Ye=Tq(/edge/),xg=Tq(/firefox/),Cc=Tq(/mac/),mc=Q.isTouchable===w?h?!1:l?"ontouchend"in l:!1:Q.isTouchable,Xp="default",Kh="single",Fo="multiple",Fl="front",jf="back",Ug="left",af="right",_j="top",mn="bottom",Qi="center",mh="eye",Xf="middle",sp="east",Nr="west",Dm="north",Ym="none",yr="px",Po="absolute",Ko="border",vn="triangle",_m="rect",vb="circle",qk="cylinder",Fc="shape",Rp="items",bo="normal",Ii="remove",_p="clear",Bh="width",Lm="height",Lg="ingroup",Kr="check",ys="uncheck",kq="radio",Jf="radioOn",Eb="radioOff",ef="points",op="values",Gd="series",Ed="body",cf="label",Om="label2",_o="note",Pd="note2",nk="icons",Nm="labelFont",zb="labelColor",jn="labelSelectColor",Mr="note.expanded",kc="note2.expanded",Kn="edge.expanded",Sh="edge.points",mp="edge.type",dj="rotation",Vp="hidden",Xe="visible",wg="tuv",vi="no",xe="draw",hm="select",Mm="currentSubGraph",Fr="selectBackground",Qg="autoMakeVisible",Ml="autoHideScrollBar",sc="scrollBarColor",us="scrollBarSize",gn="indent",qn="rowHeight",fj="columnLineColor",xi="rowLineColor",Ho="columnLineVisible",bh="rowLineVisible",Vr="visibleFunc",Oc="expandIcon",As="collapseIcon",kf="checkMode",hh="sortFunc",Ep="editable",fd="batchEditable",Ln="tristate",Mb="asc",_l="desc",uf="position",Vo="elevation",zl="children",_q="translateX",Go="translateY",$q="dataModel",qf="maxSize",No="state",Kd="shape3d",Hb="shape3d.resolution",Zm="shape3d.visible",Xm="shape3d.from.visible",fb="shape3d.to.visible",ss="shape3d.top.visible",Kk="shape3d.bottom.visible",eh="repeat.uv.length",Am="serializeValue",Nj="deserializeValue",pp="centerUniform",oh="uniform",Jk="rgba(255,255,255,0)",tc="style",tg="attr",Vn="field",Rl="string",Wg="boolean",kg="color",Pb="int",Aq="number",ns="ew-resize",zn="ns-resize",ok="pointer",jg="auto",$h="mousedown",iq="mousemove",mj="mouseup",th="mouseout",ke="touchstart",zm="touchmove",as="touchend",xj="keydown",Xc="keyup",Ie=["DOMMouseScroll","mousewheel"],zf=xg?Ie[0]:Ie[1],Sn=mc?[ke,zm,as,xj,Xc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[xj,Xc,"keypress","input",$h,iq,mj,th,zf,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],uc=t,oj=t,zi=t,Eh=mj.length,eo=function(){zi&&(o(zi.timeout),zi=t)},Qb=function(){zi&&yf(zi.e,zi.info)};i.addEventListener&&(mc||(b(i,th,function(){eo()}),b(i,zf,function(){sj()})),b(i,Xc,function(D){91===D.keyCode?ar={}:delete ar[D.keyCode]},!0),b(i,xj,function(O){ar[O.keyCode]=!0},!0),b(i,"blur",function(){ar={}}));var jd,Tk,zr,xb=0,eq=t,rq=function(i,M){var N=Z(function(){delete eq[N],wf(eq)&&(eq=t),i()},M);return N},If=t,Ve=t,Bk={},Rq={},Fe={},pm={},Pm={},ar={},xm={},Dn={},ac={},dk={},Im=/.json$/,fe=/^data:image\/svg\+xml/,Ok={},Ci=[],sg={},Dk=t,Jj=t,cj=function(){},ds=function(){throw"Oops!"},si=[0,0,0],xq={x:0,y:0,width:0,height:0},Bf=t,mq=t,sm=t,Lj=function(E,l){Rq[E]=l,l&&l.comps&&!l.uuid&&(l.uuid=Y.Math.generateUUID()),Hd[E]&&(l.cacheRule=Hd[E],delete Hd[E])},bc=function(Q){mq&&!Q._72O&&(sm||(sm={}),sm[Q._72O=Re()]=Q),jd!=t?sb()<.05&&V&&!Tk&&(ko=eo):ko=mi},Sp=function(P,I,o,x){mq||(mq={});var Y=mq[P];if(Y){if(Y.url===I)return;Y.image?(Y.image.onload=cj,Y.image.onerror=cj):Y.request&&(Y.request.onload=cj,Y.request.onerror=cj)}if(Im.test(I)){var k=new qh;if(mq[P]={request:k,url:I},I=Q.beforeLoadURL(I,P),I.data){var p=Q.parse(I.data);Ng(P,p),Q.handleImageLoaded(P,p)}else{k.onload=function(){if(200===this.status||0===this.status){var l=Q.parse(k.getResponseText());Ng(P,l),Q.handleImageLoaded(P,l)}else Ng(P,Q.handleUnfoundImage(P,I)||t)},k.onerror=function(){Ng(P,Q.handleUnfoundImage(P,I)||t)};var A={};A.url=encodeURI(I),A.sync=!1,k.send(A)}}else{var p=new Image;mq[P]={image:p,url:I},/^data:image/.test(I)||(I=Q.beforeLoadURL(I,P),I=Q.appendTimeStamp(I),I=encodeURI(I),p.crossOrigin=Q.crossOrigin),Q.convertImageSrc(I,function(e){Kc&&(I.toLowerCase().indexOf(".svg")>0||fe.test(I))?(l.body.appendChild(p),p.style.visibility="hidden",p.onload=function(){Z(function(){if(o&&(p.width=o),x&&(p.height=x),!p.width||!p.height){var T=p.width||p.clientWidth,s=p.height||p.clientHeight;p.width=T,p.height=s}Q.handleImageLoaded(P,p),Ng(P,p),l.body.removeChild(p),p.style.visibility=""},180)},p.onerror=function(){Ng(P,Q.handleUnfoundImage(P,I)||t),l.body.removeChild(p),p.style.visibility=""}):(p.onload=function(){o&&(p.width=o),x&&(p.height=x),Q.handleImageLoaded(P,p),Ng(P,p)},p.onerror=function(){Ng(P,Q.handleUnfoundImage(P,I)||t)}),p.src=e})}},Ng=function(G,J){if(Lj(G,J),delete mq[G],wf(mq)&&(mq=t,sm)){for(var l in sm){var $=sm[l];$._2O&&$._2O[G]&&($.deleteTexture(G),delete $._2O[G]),$.invalidateAll&&$.invalidateAll(w,"imageLoaded",G),$.redraw&&$.redraw(),$.iv(),delete $._72O}sm=t}if(J&&sm)for(var l in sm){var $=sm[l];$.invalidateAll&&$.invalidateAll(w,"imageLoading",G),$.redraw&&$.redraw(),$.iv()}},Lq=function(){return G=X&&Date,function(){return i.performance&&i.performance.now?i.performance.now():Date.now()}}(),fr=function(x,Y,S){return{width:x,height:Y,comps:Cl(S)?S:[S]}},Qd=function(M,c){return{type:vb,rect:[M,c,1.6,1.6],borderWidth:1,borderColor:uj,gradient:mm,gradientColor:Uj,background:uj}},os=function(v,D){return fr(16,16,{type:vn,rect:[4,4,10,8],background:v,rotation:D?1.57:3.14})},ap=function(E,W){return fr(16,16,{type:vn,rect:[4,4,8,7],background:E,rotation:W?3.14:0})},ql=function(z){var y=z._orientation;return"horizontal"===y||"h"===y},er=function(v,i){var e=t||4,w=t||1,U=t||1;0>e?e=0:e>.25&&(e=.25);var $,A,s,N,L,p,W,n=.5,B=[],r=[],C=[],o=z/U,D=z/w,q=n-e;for(A=0;w>=A;A++)for(N=-S+A*D,p=I(N),L=d(N),$=0;U>=$;$++)s=$*o,W=q+e*p,B.push(I(s)*W,L*e,-d(s)*W),(P=[v,i])&&r.push($/U,1-A/w);for(A=0;w>A;A++){var f=A*(U+1),H=(A+1)*(U+1);for($=0;U>$;$++)C.push(f+$,H+$+1,H+$,f+$,f+$+1,H+$+1),nq.z=ts.z=[v,i]}},xc=function(e){var W=2,U=0;for(var Q in e)Q.length===W&&F(Q,32)===fm&&(Dk=Jj=e[Q]),U++;return U},gb=function(i,N,l,z){return l||(l=mc?5:3,l/=z||1),{x:i-l,y:N-l,width:2*l,height:2*l}},$c=function(l,w,p,$){var F=this;w||(w=mc?5:3,p=20,$=20);var x={x:l,y:w,width:p,height:$};if(p)for(var g=0;p>g;g++)if(3===p)$=20;else for(var h=0;$>h;h++)F=i?i:p;var o={x:S,y:2*S};if(Mf(x,o)){var r=Lm[0]+_j[0]+_p[1]+Mb.length,k=Vp[0]+Ln[0]+_p[1]+Ed.length;hl[mh]=[F[r],F[k]],F[r]=Wd[mh],F[k]=Wd[Kd]}},Zl=function(u){return(/ble$/.test(u)||/ed$/.test(u)||R[u]?"is":"get")+u.charAt(0).toUpperCase()+u.slice(1)},Wd=function(r){return"set"+r.charAt(0).toUpperCase()+r.slice(1)},vh=function(G){return typeof G===Rl||G instanceof String},Td=function(c){return typeof c===Aq},mi=function(r){return typeof r===Wg},ao=function(g){return g&&"object"==typeof g},Jm=function(n){return"function"==typeof n},Cl=function(d){return d instanceof Array},Pr=function(u){return u instanceof ls},vs=function(E){return Cl(E)?new ls(E):E},wk=function(l){return l instanceof Pc},br=function(b){return b instanceof lc},Ae=function(K){return K instanceof li},gs=function(i,z){if(!(i instanceof Y.Group))return!1;if(!z)return i.isExpanded();var p=z.getDataUI(i);return p&&p._88I?!0:!1},ei=function(l){return l instanceof aq},Tp=function(X){return X&&"IFRAME"===X.tagName},fs=function(v){return v==t||Q.numberDigits==t?v:parseFloat(v.toFixed(Q.numberDigits))},je=function(y,_,B){var P,q=_.length;if(B)for(var s=0;B>s;s++)if(3===q)y.push(_[0]),y.push(_[1]),y.push(_[2]);else for(P=0;q>P;P++)y.push(_[P]);else if(3===q)y.push(_[0]),y.push(_[1]),y.push(_[2]);else for(P=0;q>P;P++)y.push(_[P])},$k=function(P){return P?ao(P)?P:{}:!1},oi=function(C,b,z){var N,M=ao(C)?C:C.prototype;for(N in b)z&&N in M?M[N]===w&&console.warn("class",M,"has own undefined property",N,", keep exist!"):M[N]=b[N];return C},qo=function(K,g){if(!("wheelDelta"in g)){var L=g.deltaMode;g.wheelDelta=L===g.DOM_DELTA_PIXEL?-g.deltaY:L===g.DOM_DELTA_LINE?40*-g.deltaY:120*-g.deltaY}K.handle_mousewheel(g)},vf=function(v){return String.fromCharCode(v)},rc=function(L){for(var $,V=0,W="";V<L.length;V++)$=L[L.length-1-V],"%"===$?$="'":"a"===$?$='"':"]"===$&&($="\\"),W+=vf($.charCodeAt(0)-1);return W},ml=function(V,d,C){V.superClass.constructor.apply(d,C)},wf=function($){for(var M in $)return!1;return!0},Xl=function(T){return T?0===T.length:!0},nn=function(){var G="";return[ys[0],xi[0],cf[0]].forEach(function($){G+=Wd($).slice(3)}),oh=l&&l[G]||pp,function(k,N){return k===N?!0:k.x===N.x&&k.y===N.y&&k.width===N.width&&k.height===N.height}}(),kh=function(e,w,n){return w>e?w:e>n?n:e},Kq=function(S){return 0>S?-1:S>0?1:0},sb=function(){var L=1e4*d(Eh++);return L-E(L)},Dh=function(x,h,D){return Kl(x.x,x.y,h.x,h.y,D.x,D.y,D.x+D.width,D.y,!0)||Kl(x.x,x.y,h.x,h.y,D.x+D.width,D.y,D.x+D.width,D.y+D.height,!0)||Kl(x.x,x.y,h.x,h.y,D.x+D.width,D.y+D.height,D.x,D.y+D.height,!0)||Kl(x.x,x.y,h.x,h.y,D.x,D.y+D.height,D.x,D.y,!0)},Kl=function(T,z,l,J,n,x,G,X,f){var j=(G-n)*(z-x)-(X-x)*(T-n),Z=(X-x)*(l-T)-(G-n)*(J-z);if(0!==Z){var N=j/Z,P=T+N*(l-T),Y=z+N*(J-z);return f&&(P+ee<a(T,l)||P-ee>q(T,l)||P+ee<a(n,G)||P-ee>q(n,G)||Y+ee<a(z,J)||Y-ee>q(z,J)||Y+ee<a(x,X)||Y-ee>q(x,X))?t:[P,Y]}return t},Oe=function(r,R,S){if(r&&S)if(R){if(R===tc)return r.getStyle(S);if(R===tg)return r.getAttr(S);if(R===Vn)return r[S]}else if(S=Zl(S),r[S])return r[S]();return w},jp=function(z,c,P,a){if(z&&P)if(c){if(c===tc)z.s(P,a);else if(c===tg)z.a(P,a);else if(c===Vn){var l=z[P];z[P]=a,z.fp("f:"+P,l,a)}}else P=Wd(P),z[P]&&z[P](a)},Mg=function(Q,X,Z){return X&&"top"!==X?"bottom"===X?{x:Q.x,y:Q.y,width:Q.width,height:Q.height*Z}:"right"===X?{x:Q.x,y:Q.y,width:Q.width*Z,height:Q.height}:"left"===X?{x:Q.x+Q.width*(1-Z),y:Q.y,width:Q.width*Z,height:Q.height}:void 0:{x:Q.x,y:Q.y+Q.height*(1-Z),width:Q.width,height:Q.height*Z}},im=function(T,K,C,c,U){K&&Qf(T,C,c,1,U,K)},gr=function(u,T,_,Z){var F=1-u;return F*F*T+2*u*F*_+u*u*Z},nq=function(K,F,T,G,w){var O=1-K;return O*O*O*F+3*O*O*K*T+3*O*K*K*G+K*K*K*w},ji=function(P){var o,Q,Y,r,e=0;return P.forEach(function(k){if(o=k.length,o>0)for(Q=k[0],r=1;o>r;r++)Y=k[r],e+=ro(Q,Y),Q=Y}),e},nb=function(B,l,o){var y="__"+B,G=function(O){o.disabled||o["handle_"+B](O)};o[y]||(o[y]=G,b(l,B,G))},Kp=function(m,z,x){var $="__"+m,f=x[$];f&&(n(z,m,f),delete x[$])},qs=function(i,F){var f="_"+F;i[Zl(F)]=function(){return this[f]},i[Wd(F)]=function(x){var d=this[f];this[f]=x,this.fp(F,d,x)}},Yj=function(D){return u.create(D)},oq=function(A){if(!A.element){var U,X;(U=A.textField)?X=dq(kk.TextField,U):(U=A.textArea)?X=dq(kk.TextArea,U):(U=A.button)?X=dq(kk.Button,U):(U=A.comboBox)?X=dq(kk.ComboBox,U):(U=A.checkBox)?X=dq(kk.CheckBox,U):(U=A.radioButton)?X=dq(kk.RadioButton,U):(U=A.slider)?X=dq(kk.Slider,U):(U=A.colorPicker)?X=dq(kk.ColorPicker,U):(U=A.image)&&(X=dq(kk.Image,U)),X&&(A.element=X)}},yo=function(Y,c){var G=wc(Y);return G._ht=c,G},wi=i.top===i?i.top:i||i.document,wc=function(W,Y){var P=l.createElement("div"),H=P.style;return P.tabIndex=-1,P.onkeydown=Hc,H.msTouchAction=Ym,hb(P,t,0),mc&&H.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",t),W&&(H.overflow=Vp),Y&&zg(Y,P),P},Yh=function(C,A){var J=l.createElement("canvas"),c=J.style;return c.msTouchAction=Ym,A||(c.pointerEvents=Ym),hb(J,t,0),C&&zg(C,J),J},hb=function(o,m,Q){var h=o.style;h.border=m?m+" solid 1px":0,h.outline=0,h.padding=Q?"0 "+Q+yr:0,uo(o)},uo=function(b){var $=b.style;$.position=Po,$.margin=0,$.setProperty("box-sizing","border-box",t),$.setProperty("-moz-box-sizing","border-box",t)},ik=function(K,R,k,b){b||(b=td),R!=t&&(K.width=R*b,K.style.width=R+yr),k!=t&&(K.height=k*b,K.style.height=k+yr)},zg=function(i,k,K){i.appendChild(k),K&&(k.style.position=Po)},Pg=function(F,Q){Q.split||(Q+="");for(var x,O=Q.split("\n"),J=0,W=O.length,f=0;W>f;f++){var p=Rj(F.font,O[f]);p.width>J&&(J=p.width),x||(x=p.height)}return F.ss=O,{width:J,height:x*W}},ff=function(V,m,z,D,T,w){var M=m.length;if(1===M)ii(V,m[0],z,D,T);else for(var N=z.height/M,Z={x:z.x,y:z.y,width:z.width,height:N},L=0;L<m.length;L++)w?rd(V,m[L],D,T,Z.x,Z.y,Z.width,Z.height,w):ii(V,m[L],Z,D,T),Z.y+=N},ii=function(o,X,h,D,C){o.font=D?D:Vq,o.fillStyle=C?C:hj,o.textAlign=Qi,o.textBaseline=Xf;var B,a;h?h.width===w?(B=h.x,a=h.y):(B=h.x+h.width/2,a=h.y+h.height/2):(B=0,a=0),o.fillText(X,y(B),y(a))},zh=function(s){s.getView&&(s=s.getView());var D=s.offsetWidth||s.scrollWidth;return!D&&s.style.width&&(D=F(s.style.width)),D},zd=function(z){z.getView&&(z=z.getView());var R=z.offsetHeight||z.scrollHeight;return!R&&z.style.height&&(R=F(z.style.height)),R},Jr=function(f,e,R){var i=e[0].toUpperCase()+e.substring(1,e.length);f["webkit"+i]=R,f["moz"+i]=R,f["ms"+i]=R,f["o"+i]=R,f[e]=R},lo=function(){var X=function(Z){Hc(Z),Z.stopPropagation()},O=function(R){Hc(R)},F=mc?[ke]:[xj,$h];return function(_,Y){var f=wc(),r=f.style;return r.backgroundColor=Q.disabledBackground,_&&(r.backgroundImage="url("+_+")",r.backgroundPosition="50% 50%",r.backgroundRepeat="no-repeat no-repeat"),Y===!1?F.forEach(function(B){b(f,B,O)}):F.forEach(function(P){b(f,P,X)}),f}}(),ck=function(Z){var X=Z.getContext("2d");return X.save(),X.lineCap=aj,X.lineJoin=Ll,X},ko=function(L,c,v,z){_h(L,c*td,v*td),z*=td,1!==z&&L.scale(z,z)},_h=function(j,m,_){j.translate(m,_)},Pp=function(A,P){P&&A.rotate(P)},ri=function(T,R,P){R===w&&(R=1),P===w&&(P=1),(1!==R||1!==P)&&T.scale(R,P)},Pl=!1,A=wi[Kr[1]+_q[0]],mg=function(F){var g=l.activeElement;if(l.activeElement!==F){g&&g.forceOnblur&&g.forceOnblur();for(var z=[],w=F.parentNode;w;)z.push([w,w.scrollLeft,w.scrollTop]),w=w.parentNode;if(!Pl){var W=[],Y=[];try{for(var q=i.parent,$=i;q!==$;)W.push([q,q.scrollX,q.scrollY]),$=q,q=i.parent;var t=i.frameElement;if(t)for(var U=t.parentNode;U;)Y.push([U,U.scrollLeft,U.scrollTop]),U=U.parentNode}catch(x){Pl=!0}}if(mc)F.focus();else{var a=Gp(),h=a.target;F.focus(),h.scrollLeft=a.left,h.scrollTop=a.top}z.forEach(function(S){S[0].scrollLeft=S[1],S[0].scrollTop=S[2]}),Pl||(W.forEach(function(P){P[0].scrollTo(P[1],P[2])}),Y.forEach(function(f){f[0].scrollLeft=f[1],f[0].scrollTop=f[2]}))}},Le=function(e){return e&&e.getView?e.getView():e},Km=function(o,A,d,U,G){if(2===arguments.length&&(d=A.y,U=A.width,G=A.height,A=A.x),o.isSelfViewEvent)o.setX(A),o.setY(d),o.setWidth(U),o.setHeight(G);else{var X=Le(o),s=X.style;if((l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement)!==X)A!==w&&(s.left=A+yr),d!==w&&(s.top=d+yr),U!==w&&(s.width=U+yr),G!==w&&(s.height=G+yr);else{var N=Q.getWindowInfo();s.left=(A=N.left)+yr,s.top=(d=N.top)+yr,s.width=(U=N.width)+yr,s.height=(G=N.height)+yr}o.endEditing&&!mc&&o.endEditing(),o.redraw&&o.redraw(),o.invalidate&&o.invalidate(),o.onLayouted&&o.onLayouted(A,d,U,G),o.fireViewEvent&&o.fireViewEvent("layout")}},jm=function(I){if(!I.touches)return I;var K=I.touches[0];return K?K:I.changedTouches[0]},Ck=function(f){return mc?jm(f).target:f.target},em=function(y){Q.popup&&Q.popup.close(),Q.popup=y},lg=t,Wo=function(r){lg.handleWindowTouchMove(r)},al=function(q){lg.handleWindowTouchEnd(q),n(i,zm,Wo),n(i,as,al),lg=t},Wh=function(b){lg.handleWindowMouseMove(b)},$p=function(B){lg.handleWindowMouseUp(B),n(i,iq,Wh),n(i,mj,$p),lg=t},rp=function(x){return 1===Jh(x)},Wr=function(X,c){return c?c.keyCode===X:ar[X]},xr=function(Q){return Sf(Q)&&Wr(65,Q)},Eg=function(y){return Wr(46,y)||Wr(8,y)},Rg=function(Q){return function(W){return W?W.keyCode===Q:ar[Q]}},fm=573,cl=[65,83,68,87,37,38,39,40,32,13,27],Hl=Rg(cl[0]),pi=Rg(cl[1]),Kj=Rg(cl[2]),fk=Rg(cl[3]),_g=Rg(cl[4]),ah=Rg(cl[5]),El=Rg(cl[6]),Fq=Rg(cl[7]),Kb=Rg(cl[8]),sf=Rg(cl[9]),Fd=Rg(cl[10]),Yb={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Lf=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,5,7,53],xk=t,dn=t,wq=function(B,e){xk||(xk=Yh()),ik(xk,B,e,1);var F=ck(xk);return F.clearRect(0,0,B,e),F},Ei=function(){var v,c={};for(var N in i){var S=Fo.length;if(N.length==S&&N[0]===Fo[2]&&N[1]===Ym[1]&&N[4]===Fo[3]&&N[5]===Fo[4]&&N.substr(S-2)===Ym[1]+Ym[2]){var m=i[N];for(var r in m)r.length===S&&r.substr(0,3)===af[3]+Ii[3]+hm[0]&&r.substr(S-2)===Fo[0]+_o[3]&&(Ie=m[r])}}return function(B){var H,A=c[B];return A||(v||(v=Yh(),ik(v,1,1,1)),H=v.getContext("2d"),H.clearRect(0,0,1,1),Qf(H,0,0,1,1,B),A=H.getImageData(0,0,1,1).data,A=c[B]=[A[0],A[1],A[2],A[3]]),A}}(),be=function(D){if(!vh(D))return D;var e=Ei(D);return e.CA||(e.CA=[e[0]/255,e[1]/255,e[2]/255,e[3]/255]),e.CA},Jl=function(G,y,S,u,P){var x=Yh();x.width=S,x.height=u;var E=x.getContext("2d");E.drawImage(G,0,0,S,u);try{for(var A=E.getImageData(0,0,S,u),s=A.data,g=0,W=s.length;W>g;g+=4){var R=s[g+0],r=s[g+1],$=s[g+2],C=s[g+3];"override_a"===P?s[g+3]=255*y[3]:"override_rgb"===P?(s[g+0]=255*y[0],s[g+1]=255*y[1],s[g+2]=255*y[2]):"override"===P?(s[g+0]=255*y[0],s[g+1]=255*y[1],s[g+2]=255*y[2],s[g+3]=255*y[3]):(s[g+0]=y[0]*R,s[g+1]=y[1]*r,s[g+2]=y[2]*$,s[g+3]=y[3]*C)}E.putImageData(A,0,0)}catch(Q){return G}return x},hl=function(C,m,K){return m&&(m="miter"===K?8*m+20:m+1,C&&Wn(C,m)),m},Dq=function(l,Q){if(Q){var m=new Gm(Q),c=l.width/2,X=l.height/2,y=Qm([m.tf(-c,-X),m.tf(c,-X),m.tf(c,X),m.tf(-c,X)]);return y.x+=l.x+c,y.y+=l.y+X,y}return l},Hp=function(p,R,u,d,B,W,j,H){d*=Math.PI/180;var V={x:Math.cos(d)*(p.x-j.x)/2+Math.sin(d)*(p.y-j.y)/2,y:-Math.sin(d)*(p.x-j.x)/2+Math.cos(d)*(p.y-j.y)/2},x=Math.pow(V.x,2)/Math.pow(R,2)+Math.pow(V.y,2)/Math.pow(u,2);x>1&&(R*=Math.sqrt(x),u*=Math.sqrt(x));var o=(B==W?-1:1)*Math.sqrt((Math.pow(R,2)*Math.pow(u,2)-Math.pow(R,2)*Math.pow(V.y,2)-Math.pow(u,2)*Math.pow(V.x,2))/(Math.pow(R,2)*Math.pow(V.y,2)+Math.pow(u,2)*Math.pow(V.x,2)));isNaN(o)&&(o=0);var r={x:o*R*V.y/u,y:o*-u*V.x/R},v={x:(p.x+j.x)/2+Math.cos(d)*r.x-Math.sin(d)*r.y,y:(p.y+j.y)/2+Math.sin(d)*r.x+Math.cos(d)*r.y},L=function(Y){return Math.sqrt(Math.pow(Y[0],2)+Math.pow(Y[1],2))},F=function(p,T){return(p[0]*T[0]+p[1]*T[1])/(L(p)*L(T))},n=function(v,O){return(v[0]*O[1]<v[1]*O[0]?-1:1)*Math.acos(F(v,O))},O=n([1,0],[(V.x-r.x)/R,(V.y-r.y)/u]),P=[(V.x-r.x)/R,(V.y-r.y)/u],A=[(-V.x-r.x)/R,(-V.y-r.y)/u],z=n(P,A);F(P,A)<=-1&&(z=Math.PI),F(P,A)>=1&&(z=0);var F=R>u?R:u,Q=R>u?1:R/u,h=R>u?u/R:1;if(null==H){var M={x:0,y:0,width:0,height:0};Wn(M,F),M.x*=Q,M.width*=Q,M.y*=h,M.height*=h;var b=new Gm(d);return M=Qm([b.tf(M.x,M.y),b.tf(M.x+M.width,M.y),b.tf(M.x+M.width,M.y+M.height),b.tf(M.x,M.y+M.height)]),M.x+=v.x,M.y+=v.y,[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}]}H.translate(v.x,v.y),H.rotate(d),H.scale(Q,h),H.arc(0,0,F,O,O+z,1-W),H.scale(1/Q,1/h),H.rotate(-d),H.translate(-v.x,-v.y)},kl=function(T,W){T&&T.beginPath();for(var J,F,l,_=[],A=function(t){for(var I,M=/(\-{0,1}[\d\.]+)/gi,j=[];I=M.exec(t);)j.push(parseFloat(I[0]));return j},q=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,M={x:0,y:0};J=q.exec(W);){var c=J[0],d=c.substr(0,1);if("M"===d||"m"===d){for(var r=A(c),b=0;b<r.length;b+=2){var m=r[b],X=r[b+1];"m"===d&&(m+=M.x,X+=M.y),T&&T.moveTo(m,X),_.push({x:m,y:X}),M.x=m,M.y=X}F=l=null}else if("H"===d||"h"===d){for(var r=A(c),b=0;b<r.length;b+=1){var m=r[b];"h"===d&&(m+=M.x),T&&T.lineTo(m,M.y),_.push({x:m,y:M.y}),M.x=m}F=l=null}else if("C"===d||"c"===d){for(var r=A(c),b=0;b<r.length;b+=6){var S=r[b],h=r[b+1],a=r[b+2],Z=r[b+3],m=r[b+4],X=r[b+5];"c"===d&&(S+=M.x,h+=M.y,a+=M.x,Z+=M.y,m+=M.x,X+=M.y),T&&T.bezierCurveTo(S,h,a,Z,m,X),_.push({x:S,y:h}),_.push({x:a,y:Z}),_.push({x:m,y:X}),M.x=m,M.y=X}F=[S,h,a,Z,m,X],l=null}else if("S"===d||"s"===d){for(var r=A(c),b=0;b<r.length;b+=4){var S,h;F?(S=2*F[4]-F[2],h=2*F[5]-F[3]):(S=M.x,h=M.y);var a=r[b],Z=r[b+1],m=r[b+2],X=r[b+3];"s"===d&&(a+=M.x,Z+=M.y,m+=M.x,X+=M.y),T&&T.bezierCurveTo(S,h,a,Z,m,X),_.push({x:S,y:h}),_.push({x:a,y:Z}),_.push({x:m,y:X}),M.x=m,M.y=X}F=[S,h,a,Z,m,X],l=null}else if("Q"===d||"q"===d){for(var r=A(c),b=0;b<r.length;b+=4){var S=r[b],h=r[b+1],m=r[b+2],X=r[b+3];"q"===d&&(S+=M.x,h+=M.y,m+=M.x,X+=M.y),T&&T.quadraticCurveTo(S,h,m,X),_.push({x:S,y:h}),_.push({x:m,y:X}),M.x=m,M.y=X}F=null,l=[S,h,m,X]}else if("T"===d||"t"===d){for(var r=A(c),b=0;b<r.length;b+=2){var S,h;l?(S=2*l[2]-l[0],h=2*l[3]-l[1]):(S=M.x,h=M.y);var m=r[b],X=r[b+1];"t"===d&&(m+=M.x,X+=M.y),T&&T.quadraticCurveTo(S,h,m,X),_.push({x:S,y:h}),_.push({x:m,y:X}),M.x=m,M.y=X}F=null,l=[S,h,m,X]}else if("V"===d||"v"===d){for(var r=A(c),b=0;b<r.length;b+=1){var X=r[b];"v"===d&&(X+=M.y),T&&T.lineTo(M.x,X),_.push({x:M.x,y:X}),M.y=X}F=l=null}else if("L"===d||"l"===d){for(var r=A(c),b=0;b<r.length;b+=2){var m=r[b],X=r[b+1];"l"===d&&(m+=M.x,X+=M.y),T&&T.lineTo(m,X),_.push({x:m,y:X}),M.x=m,M.y=X}F=l=null}else if("A"===d||"a"===d){for(var r=A(c),b=0;b<r.length;b+=7){var B=r[b],g=r[b+1],N=r[b+2],K=r[b+3],t=r[b+4],m=r[b+5],X=r[b+6];"a"===d&&(m+=M.x,X+=M.y);var k=Hp(M,B,g,N,K,t,{x:m,y:X},T);k&&(_=_.concat(k)),M.x=m,M.y=X}F=l=null}var G=c.substr(c.length-1);("z"===G||"Z"===G)&&T&&T.closePath()}return _},Hm=function(w,d){var v,e,R="L"===d[0],p=d.length;w.save(),R?(w.transform(d[5],d[6],d[7],d[8],d[9],d[10]),v=w.createLinearGradient(d[1],d[2],d[3],d[4]),e=11):(w.transform(d[7],d[8],d[9],d[10],d[11],d[12]),v=w.createRadialGradient(d[1],d[2],d[3],d[4],d[5],d[6]),e=13);for(var O=w.compGray;p>e;)v.addColorStop(d[e],O?Q.toGrayColor(d[e+1]):d[e+1]),e+=2;w.fillStyle=v},ts=function(p,J){var g=p.s("shape.gradient.pack");if(g){for(var W=g.length,r=new Array(W),y=0;W>y;y++)r[y]=g[y];var v,A,d,u,I,K,s,T,f,N,B,E,P,m="L"===r[0];v=m?5:7,A=r[v],d=r[v+1],u=r[v+2],I=r[v+3],K=r[v+4],s=r[v+5],T=J[0],f=J[1],N=J[2],B=J[3],E=J[4],P=J[5],r[v]=T*A+N*d,r[v+1]=f*A+B*d,r[v+2]=T*u+N*I,r[v+3]=f*u+B*I,r[v+4]=T*K+N*s+E,r[v+5]=f*K+B*s+P,p.s("shape.gradient.pack",r)}},ps=function(Y,_,L,H){var p=!1;if(Y.beginPath?Y.beginPath():p=!0,Pr(_)&&(_=_._as),Pr(L)&&(L=L._as),L&&L.length){for(var I,K,J,u,d=0,w=0,O=L.length;O>w;w++)I=L[w],1===I?(K=_[d++],Y.moveTo(K.x,p?-K.y:K.y)):2===I?(K=_[d++],Y.lineTo(K.x,p?-K.y:K.y)):3===I?(K=_[d++],J=_[d++],Y.quadraticCurveTo(K.x,p?-K.y:K.y,J.x,p?-J.y:J.y)):4===I?(K=_[d++],J=_[d++],u=_[d++],Y.bezierCurveTo(K.x,p?-K.y:K.y,J.x,p?-J.y:J.y,u.x,p?-u.y:u.y)):5===I&&Y.closePath();H&&5!==I&&Y.closePath()}else{var z,G,g,Q=_.length;if(Q>0){for(z=_[0],Y.moveTo(z.x,p?-z.y:z.y),G=1;Q>G;G++)g=_[G],Y.lineTo(g.x,p?-g.y:g.y);H&&Y.closePath()}}},hr=function(Q,T,f,B){if(Pr(Q)&&(Q=Q._as),Pr(T)&&(T=T._as),T&&T.length){f=f||Yq;for(var i,d,p,y,k,X,$,g,U=[],q=t,C=0,J=0,Y=T.length;Y>J;J++)if(i=T[J],1===i)U.push(q=[]),q.push(Q[C++]);else if(2===i)q.push(Q[C++]);else if(3===i){for(d=q[q.length-1],p=Q[C++],y=Q[C++],X=1;f>X;X++)$=gr(X/f,d.x,p.x,y.x),g=gr(X/f,d.y,p.y,y.y),q.push({x:$,y:g,b:!0});q.push(y)}else if(4===i){for(d=q[q.length-1],p=Q[C++],y=Q[C++],k=Q[C++],X=1;f>X;X++)$=nq(X/f,d.x,p.x,y.x,k.x),g=nq(X/f,d.y,p.y,y.y,k.y),q.push({x:$,y:g,b:!0});q.push(k)}else 5===i&&q.push(q[0]);return B&&5!==i&&q&&q.length>2&&q.push(q[0]),U}return B&&Q.length>2&&(Q=Q.slice(),Q.push(Q[0])),Q?[Q]:[]},lp=function(o,I,C,X,Y,R){var T,Q,j,w=Ei(I),$=X,u=w[0],b=w[1],L=w[2];if(C){var s=Ei(C);T=s[0]-u,Q=s[1]-b,j=s[2]-L}else T=255-u,Q=255-b,j=255-L;for(R||(R=X>10?1:.5,R=1>Y?a(R/Y,2):R),o.save(),o.shadowOffsetX=0,o.shadowOffsetY=0,o.shadowBlur=0,o.shadowColor=0;(X-=R)>0;){var D=1-X/$,W=u+T*D,P=b+Q*D,U=L+j*D;W=a(m(W),255),P=a(m(P),255),U=a(m(U),255),o.strokeStyle="rgb("+W+","+P+","+U+")",o.lineWidth=X,o.stroke()}o.restore()},gd=function(){var F={};return function(o,A){var T=o+"-"+A,X=F[T];if(X)return X;var $,e,Y,x=Ei(o);return 0>A?(A=(100+A)/100,$=m(x[0]*A),e=m(x[1]*A),Y=m(x[2]*A)):(A/=100,$=x[0],e=x[1],Y=x[2],$+=(255-$)*A,e+=(255-e)*A,Y+=(255-Y)*A,$=a(m($),255),e=a(m(e),255),Y=a(m(Y),255)),F[T]="rgb("+$+","+e+","+Y+")"}}(),Qf=function(Y,g,t,Z,S,C){C&&(Y.fillStyle=C),Y.beginPath(),Y.rect(g,t,Z,S),Y.fill()},yp=function(R,q,h,N,b,v,A){R.beginPath(),yk[q](R,h.x,h.y,h.width,h.height,N,b,v,A)},Se=function(F,X,I,V,o){var i=yk[I];F.fillStyle=i?i(F,X,V?V:Uj,o.x,o.y,o.width,o.height):X},hd=function(R,q,T,W,i,v){try{if(!q.tagName&&q.comps){q._cacheImage_||(q._cacheImage_={});var l;l="override"===W?"colors_override":"override_rgb"===W?"colors_override_rgb":"override_a"===W?"colors_override_a":"colors",q._cacheImage_[l]||(q._cacheImage_[l]={__count__:0});var C=q._cacheImage_[l][T];C||(q._cacheImage_[l].__count__>Q.imageCacheThreshold&&(q._cacheImage_[l]={__count__:0}),C=Y.Default.toCanvas(q,To(q),wb(q),null,i,v,T,null,W),q._cacheImage_[l][T]=C,q._cacheImage_[l].__count__++),q=C}R.fillStyle=R.createPattern(q,"repeat")}catch(L){R.fillStyle="black"}},tl=function(C,m,B,v,g,q,u){C.save(),C.translate(m,B),C.scale(1,u/q),C.arc(0,0,q,v,g),C.restore()},Pe=function(F,Z,p,P,X,N,_,a){var q,y,O,i,W,D,g,M,t,U,o;if(c(X)>2*S&&(X=2*S),W=m(c(X)/(S/4)),q=X/W,y=-q,O=-P,W>0){D=Z+I(P)*N,g=p+d(-P)*_,a?F.lineTo(D,g):F.moveTo(D,g);for(var b=0;W>b;b++)O+=y,i=O-y/2,M=Z+I(O)*N,t=p+d(O)*_,U=Z+I(i)*(N/I(y/2)),o=p+d(i)*(_/I(y/2)),F.quadraticCurveTo(U,o,M,t)}},Ee=function(U,X,N,e,o,l,P,W,J){6===arguments.length&&(P=l,W=l,J=l);var r=X+e,z=N+o,E=o>e?2*e:2*o;l=E>l?l:E,P=E>P?P:E,W=E>W?W:E,J=E>J?J:E;var K=.29*J,M=.58*J;U.moveTo(r,z-J),U.quadraticCurveTo(r,z-M,r-K,z-K),U.quadraticCurveTo(r-M,z,r-J,z),K=.29*W,M=.58*W,U.lineTo(X+W,z),U.quadraticCurveTo(X+M,z,X+K,z-K),U.quadraticCurveTo(X,z-M,X,z-W),K=.29*l,M=.58*l,U.lineTo(X,N+l),U.quadraticCurveTo(X,N+M,X+K,N+K),U.quadraticCurveTo(X+M,N,X+l,N),K=.29*P,M=.58*P,U.lineTo(r-P,N),U.quadraticCurveTo(r-M,N,r-K,N+K),U.quadraticCurveTo(r,N+M,r,N+P),U.lineTo(r,z-J)},Lh=function(H,g,t,d,i,S,_){g&&(t=y(t),d=y(d),_||(_=1),H.fillStyle=g,H.beginPath(),H.rect(t,d,_,S),H.rect(t,d,i,_),S-_>0&&H.rect(t,d+S-_,i,_),i-_>0&&H.rect(t+i-_,d,_,S),H.fill())},mb=function(K,_,b,f){var P=f.x,x=f.y,Q=f.width,m=f.height;if(!(!_||!b||0>=Q||0>=m)){var j,v=Cj(_),y=_e(_),o=b>0;1===b||-1===b?(K.fillStyle=o?v:y,K.beginPath(),K.rect(P,x,1,m),K.rect(P,x,Q,1),K.fill(),K.fillStyle=o?y:v,K.beginPath(),K.rect(P,x+m-1,Q,1),K.rect(P+Q-1,x,1,m),K.fill()):(b=a(c(b),a(Q/2,m/2)),j=K.createLinearGradient(P,x,P+b,x),j.addColorStop(0,o?v:y),j.addColorStop(1,_),K.fillStyle=j,K.beginPath(),K.moveTo(P,x),K.lineTo(P+b,x+b),K.lineTo(P+b,x+m-b),K.lineTo(P,x+m),K.lineTo(P,x),K.fill(),j=K.createLinearGradient(P,x,P,x+b),j.addColorStop(0,o?v:y),j.addColorStop(1,_),K.fillStyle=j,K.beginPath(),K.moveTo(P,x),K.lineTo(P+b,x+b),K.lineTo(P+Q-b,x+b),K.lineTo(P+Q,x),K.lineTo(P,x),K.fill(),j=K.createLinearGradient(P,x+m,P,x+m-b),j.addColorStop(0,o?y:v),j.addColorStop(1,_),K.fillStyle=j,K.beginPath(),K.moveTo(P,x+m),K.lineTo(P+b,x+m-b),K.lineTo(P+Q-b,x+m-b),K.lineTo(P+Q,x+m),K.lineTo(P,x+m),K.fill(),j=K.createLinearGradient(P+Q,x,P+Q-b,x),j.addColorStop(0,o?y:v),j.addColorStop(1,_),K.fillStyle=j,K.beginPath(),K.moveTo(P+Q,x),K.lineTo(P+Q-b,x+b),K.lineTo(P+Q-b,x+m-b),K.lineTo(P+Q,x+m),K.lineTo(P+Q,x),K.fill())}},Vf=function(u,A,h,_,S,R,H){var G=u.createLinearGradient(_,S,R,H);return G.addColorStop(0,h),G.addColorStop(1,A),G},gp=function(E,_,k,Z,B,O,F){var c=E.createLinearGradient(Z,B,O,F);return c.addColorStop(0,_),c.addColorStop(.5,k),c.addColorStop(1,_),c},wh=function(Q,N,z,C,I,W,q){var X=Q.createLinearGradient(C,I,W,q);return X.addColorStop(0,N),X.addColorStop(1/3,z),X.addColorStop(2/3,N),X.addColorStop(1,z),X},Gn=function(r,L,n,C,G,g,N,F,k){var z=r.createRadialGradient(C+g*F,G+N*k,a(g,N)/24,C+g/2,G+N/2,q(g,N)/2);return z.addColorStop(0,n),z.addColorStop(1,L),z},eb=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],yk={polygon:function(Z,F,C,Q,h,f){(f==t||3>f)&&(f=6);
for(var L,w,P=a(Q,h)/2,o=F+Q/2,v=C+h/2,x=0,D=2*S/f,m=0;f>m;m++)L=o+I(x)*P,w=v+d(x)*P,0===m?Z.moveTo(L,w):Z.lineTo(L,w),x+=D;Z.closePath()},arc:function(u,i,K,q,L,k,O,h,G){k==t&&(k=S),O==t&&(O=z),h==t&&(h=!0);var N=i+q/2,b=K+L/2;h&&u.moveTo(N,b),G?tl(u,N,b,k,O,q/2,L/2):u.arc(N,b,a(q,L)/2,k,O),h&&u.closePath()},rect:function(L,p,H,h,Y){L.rect(p,H,h,Y)},circle:function(d,Z,S,q,u){d.arc(Z+q/2,S+u/2,a(q,u)/2,0,z,!0)},oval:function(p,G,b,J,H){tl(p,G+J/2,b+H/2,0,z,J/2,H/2)},roundRect:function(j,q,r,B,$,f){f==t&&(f=a(a(B,$)/4,8)),Ee(j,q,r,B,$,f)},star:function(l,s,H,Y,b){var U=2*Y,T=2*b,Z=s+Y/2,i=H+b/2;l.moveTo(Z-U/4,i-T/12),l.lineTo(s+.306*Y,H+.579*b),l.lineTo(Z-U/6,i+T/4),l.lineTo(s+Y/2,H+.733*b),l.lineTo(Z+U/6,i+T/4),l.lineTo(s+.693*Y,H+.579*b),l.lineTo(Z+U/4,i-T/12),l.lineTo(s+.611*Y,H+.332*b),l.lineTo(Z+0,i-T/4),l.lineTo(s+.388*Y,H+.332*b),l.closePath()},pentagram:function(d,q,V,E,v){var Y=.5*v,Q=q+.5*E,U=V+Y,L=.5257311121191336*E;L>Y&&(L=Y);var z=eb,c=0;for(d.moveTo(Q+L*z[c++],U+L*z[c++]);20>c;)d.lineTo(Q+L*z[c++],U+L*z[c++]);d.closePath()},triangle:function(Z,u,Q,R,$){Z.moveTo(u+R/2,Q),Z.lineTo(u+R,Q+$),Z.lineTo(u,Q+$),Z.closePath()},hexagon:function(v,l,y,X,T){v.moveTo(l,y+T/2),v.lineTo(l+X/4,y+T),v.lineTo(l+3*X/4,+y+T),v.lineTo(l+X,y+T/2),v.lineTo(l+3*X/4,y),v.lineTo(l+X/4,y),v.closePath()},pentagon:function(Q,A,Y,c,y){var p=2*c,K=2*y,k=A+c/2,G=Y+y/2;Q.moveTo(k-p/4,G-K/12),Q.lineTo(k-p/6,G+K/4),Q.lineTo(k+p/6,G+K/4),Q.lineTo(k+p/4,G-K/12),Q.lineTo(k+0,G-K/4),Q.closePath()},diamond:function(Q,C,$,i,d){Q.moveTo(C+i/2,$),Q.lineTo(C,$+d/2),Q.lineTo(C+i/2,$+d),Q.lineTo(C+i,$+d/2),Q.closePath()},rightTriangle:function(X,D,G,n,B){X.moveTo(D,G),X.lineTo(D+n,G+B),X.lineTo(D,G+B),X.closePath()},parallelogram:function(F,n,D,e,Q){var l=e/4;F.moveTo(n+l,D),F.lineTo(n+e,D),F.lineTo(n+e-l,D+Q),F.lineTo(n,D+Q),F.closePath()},trapezoid:function(d,I,V,Z,r){var t=Z/4;d.moveTo(I+t,V),d.lineTo(I+Z-t,V),d.lineTo(I+Z,V+r),d.lineTo(I,V+r),d.closePath()},"linear.southwest":function(P,e,Y,z,V,b,R){return Vf(P,e,Y,z,V+R,z+b,V)},"linear.southeast":function(q,b,s,Y,g,t,B){return Vf(q,b,s,Y+t,g+B,Y,g)},"linear.northwest":function(q,g,k,o,w,M,T){return Vf(q,g,k,o,w,o+M,w+T)},"linear.northeast":function(m,o,I,H,h,E,j){return Vf(m,o,I,H+E,h,H,h+j)},"linear.north":function(j,Y,u,a,B,I,Z){return Vf(j,Y,u,a,B,a,B+Z)},"linear.south":function(s,f,F,M,V,G,U){return Vf(s,f,F,M,V+U,M,V)},"linear.west":function(s,v,R,G,F,K){return Vf(s,v,R,G,F,G+K,F)},"linear.east":function(R,K,A,s,k,I){return Vf(R,K,A,s+I,k,s,k)},"radial.center":function(p,t,$,i,A,L,e){return Gn(p,t,$,i,A,L,e,.5,.5)},"radial.southwest":function(O,Z,d,p,T,N,r){return Gn(O,Z,d,p,T,N,r,.25,.75)},"radial.southeast":function(W,J,G,T,o,E,M){return Gn(W,J,G,T,o,E,M,.75,.75)},"radial.northwest":function(Q,j,d,m,z,s,C){return Gn(Q,j,d,m,z,s,C,.25,.25)},"radial.northeast":function(m,w,V,R,P,y,Y){return Gn(m,w,V,R,P,y,Y,.75,.25)},"radial.north":function(Z,o,B,d,J,M,L){return Gn(Z,o,B,d,J,M,L,.5,.25)},"radial.south":function(s,u,Q,e,a,R,D){return Gn(s,u,Q,e,a,R,D,.5,.75)},"radial.west":function(Z,i,v,h,l,D,N){return Gn(Z,i,v,h,l,D,N,.25,.5)},"radial.east":function(o,b,J,x,p,O,H){return Gn(o,b,J,x,p,O,H,.75,.5)},"spread.horizontal":function(l,Q,m,u,G,o){return gp(l,Q,m,u,G,u+o,G)},"spread.vertical":function(m,i,B,C,e,W,v){return gp(m,i,B,C,e,C,e+v)},"spread.diagonal":function(W,d,y,D,B,I,F){return gp(W,d,y,D+I,B,D,B+F)},"spread.antidiagonal":function(d,S,P,t,B,G,a){return gp(d,S,P,t,B,t+G,B+a)},"spread.north":function(P,i,M,p,W,L,R){return wh(P,i,M,p,W-R/4,p,W+R+R/4)},"spread.south":function(A,Q,k,t,r,x,v){return wh(A,k,Q,t,r-v/4,t,r+v+v/4)},"spread.west":function(c,j,h,P,X,K){return wh(c,j,h,P-K/4,X,P+K+K/4,X)},"spread.east":function(u,f,h,$,H,P){return wh(u,h,f,$-P/4,H,$+P+P/4,H)}},kp=function(F,S,W){return new Gm(F).tf(S,W)},dl=function(F){var R=F.touches[0],q=F.touches[1],C=R.clientX,f=R.clientY,z=q.clientX,s=q.clientY;return N((C-z)*(C-z)+(f-s)*(f-s))},De=function(g){var n=g.touches[0],s=g.touches[1],U=n.clientX,f=n.clientY,p=s.clientX,Y=s.clientY;return{x:(U+p)/2,y:(f+Y)/2}},Qj=(function(){for(var g=0,l=_l.split(""),$=0;$<l.length;$++)g=10*F(l[$])+g;return er(i[fm.toString(8*$)+cf.substr($)+3],i[fm.toString(8*$)+cf.substr($)+4]),g}(),function(i,w,_){for(var U=0;U<_.size();U++){var p=_.get(U);i.co(p)&&w.add(p)}for(U=0;U<_.size();U++)p=_.get(U),Qj(i,w,p._children)}),js=function(I,l,P){for(var N=0;N<P.size();N++){var L=P.get(P.size()-1-N);I.co(L)&&l.add(L)}for(N=0;N<P.size();N++)L=P.get(N),js(I,l,L._children)},Jn=function(W,o,j){for(var N=!1,B=0;B<j.size();B++){var R=j.get(B);W.co(R)?N&&o.add(R):N=1}for(B=0;B<j.size();B++)R=j.get(B),Jn(W,o,R._children)},Ni=function(Q,M,Y){for(var o=!1,j=0;j<Y.size();j++){var n=Y.get(Y.size()-1-j);Q.co(n)?o&&M.add(n):o=!0}for(j=0;j<Y.size();j++)n=Y.get(j),Ni(Q,M,n._children)},wm=Q.moveDatas=function(j,Q,M,O){var e=O==t;if(0!==Q||0!==M||!e&&0!==O){var A=!0,c=[];if(j.forEach(function(Y){A&&(Y._69O||Ae(Y)||ei(Y))&&(A=!1)}),A)c=j;else{var U={},h={};j.forEach(function(C){U[C._id]=!0});var I={},k=function(_){var Q=_._id;return U[Q]?(c.push(_),I[Q]=!0):I[Q]=!1},J=function(K){var X=K._id;if(h[X])return k(K);var i=I[X];if(i!==w)return i;var g=K._parent;if(g&&(ei(g)||Ae(g))&&J(g))return I[X]=!0;var A=K._host;return A&&(h[X]=X,i=J(A),h[X]=w,i)?I[X]=!0:k(K)};j.forEach(function(o){J(o)})}c.forEach(function(w){if(wk(w))e?w.translate(Q,M):w.translate3d(Q,M,O);else{var N=w.s(Sh);if(!N||N.isEmpty())return;var S=new ls;N.each(function(Y){Y=kr(Y),e?(Y.x+=Q,Y.y+=M):(Y.x+=Q,Y.y+=O,Y.e==t?Y.e=M:Y.e+=M),S.add(Y)}),w.s(Sh,S)}})}},Qc=function(){function v(z,L){return L===z.substring(0,L.length)?!0:!1}function s(H){return parseFloat(H)||0}function W(b,O){if(O==w&&(O=new de),v(b,"matrix3d")){var e=b.substring(9,b.length-1).split(",");e=e.map(s),O.fromArray(e)}else if(v(b,"matrix")){var e=b.substring(7,b.length-1).split(",");e=e.map(s),O.el[0]=e[0],O.el[1]=e[1],O.el[2]=0,O.el[3]=0,O.el[4]=e[2],O.el[5]=e[3],O.el[6]=0,O.el[7]=0,O.el[8]=0,O.el[9]=0,O.el[10]=1,O.el[11]=0,O.el[12]=e[4],O.el[13]=e[5],O.el[14]=0,O.el[15]=1}return O}function t(l,E){E==w&&(E=new dc);var v=l.split(/\s+/);return v=v.map(s),E.set(v[0]||0,v[1]||0,v[2]||0),E}var J,j,A,Q,U,f=function(Z,V){J||(J=new de,j=new dc,A=new de,Q=new de,U=new de),V==w&&(V=new de);var l=getComputedStyle(Z);l.transform&&"none"!==l.transform&&(W(l.transform,J),t(l.transformOrigin,j),Q.setPosition(j),j.negate(),U.setPosition(j),(Kc||"preserve-3d"!==l.transformStyle)&&(J.el[8]=0,J.el[9]=0,J.el[10]=1,J.el[11]=0),V.multiplyMatrices(U,V),V.multiplyMatrices(J,V),V.multiplyMatrices(Q,V)),!Kc&&l.perspective&&"none"!==l.perspective&&(A.el[11]=-1/s(l.perspective),t(l.perspectiveOrigin,j),Q.setPosition(j),j.negate(),U.setPosition(j),V.multiplyMatrices(U,V),V.multiplyMatrices(A,V),V.multiplyMatrices(Q,V));for(var S=Z.offsetParent,c=Z.offsetLeft,p=Z.offsetTop,B=Z.parentElement;B&&B!==S;){var b=getComputedStyle(B);if("none"!==b.transform||"none"!==b.perspective)break;B=B.parentElement}return B==w&&Z!==Z.ownerDocument.documentElement&&"fixed"!==l.position&&(B=Z.ownerDocument.documentElement),S!=w&&S!==B&&(c-=B.offsetLeft,p-=B.offsetTop),j.set(c,p,0),Q.setPosition(j),V.multiplyMatrices(Q,V),B&&f(B,V),V};return function(Q,s){var S=Q.parentElement;if(S){var r=S.updateAppendMatrix;if(r){delete S.updateAppendMatrix;var j=new de;f(S,j);var m=new de;m.getInverse(j),S._matrixAppend=m,S._maxrixPreAppend=j}return s?S._matrixAppend:S._maxrixPreAppend}}}(),Wl=function(_,Y){for(;_&&!_.hasOwnProperty(Y);)_=u.getPrototypeOf(_);return _&&u.getOwnPropertyDescriptor(_,Y)},ti=u.getPrototypeOf?function(c,U,P){var m=Wl(U,P);m&&u.defineProperty(c,P,m)}:function(S,U,y){S[y]=U[y]},yg={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Tf=function(){var P={1:function(F,L){return{x:F.x-L.width/2,y:F.y-L.height/2}},2:function(J,I){return{x:J.x+I.width/2,y:J.y-I.height/2}},3:function(d,x){return{x:d.x+d.width/2,y:d.y-x.height/2}},4:function(c,E){return{x:c.x+c.width-E.width/2,y:c.y-E.height/2}},5:function(s,d){return{x:s.x+s.width+d.width/2,y:s.y-d.height/2}},6:function(q){return{x:q.x,y:q.y}},7:function(I){return{x:I.x+I.width/2,y:I.y}},8:function(S){return{x:S.x+S.width,y:S.y}},9:function(Y,z){return{x:Y.x-z.width/2,y:Y.y+z.height/2}},10:function(e,o){return{x:e.x+o.width/2,y:e.y+o.height/2}},11:function(v,a){return{x:v.x+v.width/2,y:v.y+a.height/2}},12:function(T,j){return{x:T.x-j.width/2+T.width,y:T.y+j.height/2}},13:function(F,s){return{x:F.x+F.width+s.width/2,y:F.y+s.height/2}},14:function(i,M){return{x:i.x-M.width/2,y:i.y+i.height/2}},15:function(o){return{x:o.x,y:o.y+o.height/2}},16:function($,t){return{x:$.x+t.width/2,y:$.y+$.height/2}},17:function(L){return{x:L.x+L.width/2,y:L.y+L.height/2}},18:function($,o){return{x:$.x+$.width-o.width/2,y:$.y+$.height/2}},19:function(e){return{x:e.x+e.width,y:e.y+e.height/2}},20:function(Z,B){return{x:Z.x+Z.width+B.width/2,y:Z.y+Z.height/2}},21:function(x,q){return{x:x.x-q.width/2,y:x.y+x.height-q.height/2}},22:function(o,E){return{x:o.x+E.width/2,y:o.y+o.height-E.height/2}},23:function(x,P){return{x:x.x+x.width/2,y:x.y+x.height-P.height/2}},24:function(k,n){return{x:k.x+k.width-n.width/2,y:k.y+k.height-n.height/2}},25:function(m,q){return{x:m.x+m.width+q.width/2,y:m.y+m.height-q.height/2}},26:function(q){return{x:q.x,y:q.y+q.height}},27:function($){return{x:$.x+$.width/2,y:$.y+$.height}},28:function(Y){return{x:Y.x+Y.width,y:Y.y+Y.height}},29:function(M,R){return{x:M.x-R.width/2,y:M.y+M.height+R.height/2}},30:function(k,W){return{x:k.x+W.width/2,y:k.y+k.height+W.height/2}},31:function(W,Z){return{x:W.x+W.width/2,y:W.y+W.height+Z.height/2}},32:function(d,e){return{x:d.x+d.width-e.width/2,y:d.y+d.height+e.height/2}},33:function(Y,f){return{x:Y.x+Y.width+f.width/2,y:Y.y+Y.height+f.height/2}},34:function(D,a){return{x:D.x,y:D.y-a.height/2}},35:function(E,m){return{x:E.x+E.width,y:E.y-m.height/2}},36:function(e,Y){return{x:e.x,y:e.y+e.height+Y.height/2}},37:function(z,K){return{x:z.x+z.width,y:z.y+z.height+K.height/2}},38:function(N,S){return{x:N.x+N.width/4,y:N.y-S.height/2}},39:function(m,K){return{x:m.x+3*m.width/4,y:m.y-K.height/2}},40:function(c){return{x:c.x+c.width/4,y:c.y}},41:function(V){return{x:V.x+3*V.width/4,y:V.y}},42:function(Q,a){return{x:Q.x+Q.width/4,y:Q.y+a.height/2}},43:function(G,g){return{x:G.x+3*G.width/4,y:G.y+g.height/2}},44:function(k,N){return{x:k.x+k.width/2,y:k.y+k.height/2-N.height/2}},45:function(Z){return{x:Z.x+Z.width/4,y:Z.y+Z.height/2}},46:function(h,I){return{x:h.x+h.width/2-I.width/2,y:h.y+h.height/2}},47:function(N,r){return{x:N.x+N.width/2+r.width/2,y:N.y+N.height/2}},48:function(S){return{x:S.x+3*S.width/4,y:S.y+S.height/2}},49:function(l,Z){return{x:l.x+l.width/2,y:l.y+l.height/2+Z.height/2}},50:function(h,m){return{x:h.x+h.width/4,y:h.y+h.height-m.height/2}},51:function(C,c){return{x:C.x+3*C.width/4,y:C.y+C.height-c.height/2}},52:function(V){return{x:V.x+V.width/4,y:V.y+V.height}},53:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height}},54:function(H,V){return{x:H.x+H.width/4,y:H.y+H.height+V.height/2}},55:function(E,f){return{x:E.x+3*E.width/4,y:E.y+E.height+f.height/2}}};return xc(i)?function(c,k,r){return P[c](k,r?r:xq)}:void 0}();oi(p,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Gh=p.reverse,gj=p.transparent,Mn=p.rectSelectBackground,Qq=p.dash,Yp=p.titleBackground,pk=p.titleIconBackground,Uk=p.headerBackground,ak=p.headerIconBackground,ws=p.headerSeparator,cq=p.headerLine,Sj=p.contentIconBackground,wj=p.contentLine,Vi=(p.widgetIconHighlight,p.widgetIconBorder),uj=(p.widgetIconGradient,p.imageBackground),Uj=p.imageGradient,ng=p.highlight,Nd=p.label,Yc=p.labelSelect;if(O&&!i.shutAlert1){var lh=new Date,Jb=O.split("-"),bk=new Date(lh.getFullYear(),lh.getMonth(),lh.getDate()),O=new Date(F(Jb[0],10),F(Jb[1],10)-1,F(Jb[2],10)),sl=bk.getTime(),hn=O.getTime(),rh=g+"_try",Jq=i.alert;try{var nf=i.localStorage;if(nf&&Jq)if(hn>sl&&1728e6>hn-sl){var Fg=(hn-sl)/864e5;nf&&nf[rh]!=Fg&&(nf[rh]=Fg,i.htWillExpire?Jq(i.htWillExpire.replace("{{day}}",Fg)):Jq("HT for Web free trial license will expire in "+Fg+" days, please apply for a new license!"))}else sl>=hn&&(i.htExpired?Jq(i.htExpired):Jq("Your free trial of HT for Web has expired!")),nf&&delete nf[rh]}catch(Ji){}}Math.sign===w&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t});var Th="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Qh={encode:function(s,C){var O,z,P,l,R,B,t,J="",w=0;for(s=Qh._utf8_encode(s);w<s.length;)O=s.charCodeAt(w++),z=s.charCodeAt(w++),P=s.charCodeAt(w++),l=O>>2,R=(3&O)<<4|z>>4,B=(15&z)<<2|P>>6,t=63&P,isNaN(z)?B=t=64:isNaN(P)&&(t=64),J=J+C.charAt(l)+C.charAt(R)+C.charAt(B)+C.charAt(t);return J},decode:function(k,f){var j,J,R,P,l,F,V,Y="",n=0;for(k=k.replace(/[^A-Za-z0-9\+\/\=]/g,"");n<k.length;)P=f.indexOf(k.charAt(n++)),l=f.indexOf(k.charAt(n++)),F=f.indexOf(k.charAt(n++)),V=f.indexOf(k.charAt(n++)),j=P<<2|l>>4,J=(15&l)<<4|F>>2,R=(3&F)<<6|V,Y+=String.fromCharCode(j),64!=F&&(Y+=String.fromCharCode(J)),64!=V&&(Y+=String.fromCharCode(R));return Y=Qh._utf8_decode(Y)},_utf8_encode:function(F){F=F.replace(/\r\n/g,"\n");for(var S="",c=0;c<F.length;c++){var b=F.charCodeAt(c);128>b?S+=String.fromCharCode(b):b>127&&2048>b?(S+=String.fromCharCode(192|b>>6),S+=String.fromCharCode(128|63&b)):(S+=String.fromCharCode(224|b>>12),S+=String.fromCharCode(128|63&b>>6),S+=String.fromCharCode(128|63&b))}return S},_utf8_decode:function(d){for(var D="",H=0,x=0,O=0,J=0;H<d.length;)x=d.charCodeAt(H),128>x?(D+=String.fromCharCode(x),H++):x>191&&224>x?(O=d.charCodeAt(H+1),D+=String.fromCharCode((31&x)<<6|63&O),H+=2):(O=d.charCodeAt(H+1),J=d.charCodeAt(H+2),D+=String.fromCharCode((15&x)<<12|(63&O)<<6|63&J),H+=3);return D}},Rd=[],Jd=[],Qr=Y.Math={generateUUID:function(){for(var L=[],o=0;256>o;o++)L[o]=(16>o?"0":"")+o.toString(16).toUpperCase();return function(){var w=0|4294967295*Math.random(),k=0|4294967295*Math.random(),A=0|4294967295*Math.random(),x=0|4294967295*Math.random();return L[255&w]+L[255&w>>8]+L[255&w>>16]+L[255&w>>24]+"-"+L[255&k]+L[255&k>>8]+"-"+L[64|15&k>>16]+L[255&k>>24]+"-"+L[128|63&A]+L[255&A>>8]+"-"+L[255&A>>16]+L[255&A>>24]+L[255&x]+L[255&x>>8]+L[255&x>>16]+L[255&x>>24]}}(),clamp:function(j,i,y){return Math.max(i,Math.min(y,j))},generateIncreasingID:function(){var v=0;return function(){return++v}}(),encodeBase64:function(T,g){return Qh.encode(T,g||Th)},decodeBase64:function(X,o){return Qh.decode(X,o||Th)},randomArray:function(p,K){K=K||p.length;for(var V=K-1;V>0;V--){var w=Math.floor(Math.random()*(V+1)),q=p[V];p[V]=p[w],p[w]=q}return p},isPOT:function(H){return H>0&&0===(H-1&H)},nearestPOT:function(V){if(!V)return 1;var x=V;x--,x|=x>>1,x|=x>>2,x|=x>>4,x|=x>>8,x|=x>>16,x++;var L=x>>1;return V-L>x-V?x:L},requestMatrix4:function(){return Rd.length>0?Rd.pop():new Qr.Matrix4},releaseMatrix4:function(P){Rd.push(P)},requestVector3:function(){return Jd.length>0?Jd.pop():new Qr.Vector3},releaseVector3:function(R){Jd.push(R)}},gi=Y.Matrix=Y.Math.Matrix2d=function(H,$,R,Y,K){this.setFromTransform(H,$,R,Y,K)},Gm=gi;gi.prototype={},gi.prototype.constructor=gi,gi.prototype.set=function(O,I,l,A,C,Q){return this.a=O,this.b=I,this.c=l,this.d=A,this.tx=C,this.ty=Q,this},gi.prototype.setFromTransform=function(K,P,f,L,q){var i=this;if(K===w)return i.a=1,i.b=0,i.c=0,i.d=1,i.tx=0,i.ty=0,void 0;K=K||0;var B=d(K),p=I(K);return L=L||1,q=q||1,i.a=p*L,i.b=B*L,i.c=-B*q,i.d=p*q,i.tx=P||0,i.ty=f||0,i},gi.prototype.apply=function(S,c){c=c||new ob;var b=S.x,e=S.y;return c.x=this.a*b+this.c*e+this.tx,c.y=this.b*b+this.d*e+this.ty,c},gi.prototype.applyInverse=function($,r){r=r||new ob;var Z=1/(this.a*this.d+this.c*-this.b),B=$.x,p=$.y;return r.x=this.d*Z*B+-this.c*Z*p+(this.ty*this.c-this.tx*this.d)*Z,r.y=this.a*Z*p+-this.b*Z*B+(-this.ty*this.a+this.tx*this.b)*Z,r},gi.prototype.translate=function(Z,m){return this.tx+=Z,this.ty+=m,this},gi.prototype.scale=function(s,h){return this.a*=s,this.d*=h,this.c*=s,this.b*=h,this.tx*=s,this.ty*=h,this},gi.prototype.rotate=function(V){var O=Math.cos(V),i=Math.sin(V),R=this.a,N=this.c,S=this.tx;return this.a=R*O-this.b*i,this.b=R*i+this.b*O,this.c=N*O-this.d*i,this.d=N*i+this.d*O,this.tx=S*O-this.ty*i,this.ty=S*i+this.ty*O,this},gi.prototype.appendTranslate=function(T,O){return this.tx+=this.a*T+this.c*O,this.ty+=this.b*T+this.d*O,this},gi.prototype.appendScale=function(G,R){return this.a*=G,this.d*=R,this.c*=R,this.b*=G,this},gi.prototype.appendRotate=function(k){if(!k)return this;var n=Math.cos(k),L=Math.sin(k),U=this.a,l=this.b;return this.a=U*n+this.c*L,this.b=l*n+this.d*L,this.c=-U*L+this.c*n,this.d=-l*L+this.d*n,this},gi.prototype.append=function(w){var A=this.a,C=this.b,O=this.c,t=this.d;return this.a=w.a*A+w.b*O,this.b=w.a*C+w.b*t,this.c=w.c*A+w.d*O,this.d=w.c*C+w.d*t,this.tx=w.tx*A+w.ty*O+this.tx,this.ty=w.tx*C+w.ty*t+this.ty,this},gi.prototype.setTransform=function(J,r,x,w,y,z,n,f,F){var X,a,L,G,g,b,o,M,e,p;return g=Math.sin(n),b=Math.cos(n),o=Math.cos(F),M=Math.sin(F),e=-Math.sin(f),p=Math.cos(f),X=b*y,a=g*y,L=-g*z,G=b*z,this.a=o*X+M*L,this.b=o*a+M*G,this.c=e*X+p*L,this.d=e*a+p*G,this.tx=J+(x*X+w*L),this.ty=r+(x*a+w*G),this},gi.prototype.prepend=function(M){var j=this.tx;if(1!==M.a||0!==M.b||0!==M.c||1!==M.d){var f=this.a,$=this.c;this.a=f*M.a+this.b*M.c,this.b=f*M.b+this.b*M.d,this.c=$*M.a+this.d*M.c,this.d=$*M.b+this.d*M.d}return this.tx=j*M.a+this.ty*M.c+M.tx,this.ty=j*M.b+this.ty*M.d+M.ty,this},gi.prototype.transform=gi.prototype.prepend,gi.prototype.invert=function(){var E=this.a,r=this.b,x=this.c,F=this.d,_=this.tx,U=E*F-r*x;return this.a=F/U,this.b=-r/U,this.c=-x/U,this.d=E/U,this.tx=(x*this.ty-F*_)/U,this.ty=-(E*this.ty-r*_)/U,this},gi.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},gi.prototype.clone=function(){var Y=new gi;return Y.a=this.a,Y.b=this.b,Y.c=this.c,Y.d=this.d,Y.tx=this.tx,Y.ty=this.ty,Y},gi.prototype.copy=function(o){return o.a=this.a,o.b=this.b,o.c=this.c,o.d=this.d,o.tx=this.tx,o.ty=this.ty,o},gi.prototype.tf=function(c,d){1===arguments.length&&(d=c.y,c=c.x);var P=this;return{x:P.a*c+P.c*d+P.tx,y:P.b*c+P.d*d+P.ty}},gi.prototype.tfi=function(I,S){1===arguments.length&&(S=I.y,I=I.x);var g=this,z=1/(g.a*g.d+g.c*-g.b);return{x:g.d*z*I+-g.c*z*S+(g.ty*g.c-g.tx*g.d)*z,y:g.a*z*S+-g.b*z*I+(-g.ty*g.a+g.tx*g.b)*z}},gi.IDENTITY=new gi,gi.TEMP_MATRIX=new gi;var Dj=Y.Math.Quaternion=function(b,U,s,B){this.set(b,U,s,B)};u.assign(Dj.prototype,{set:function(A,r,k,Y){var s=this;return s._x=A||0,s._y=r||0,s._z=k||0,s._w=Y!==w?Y:1,s},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(G){var d=this;return d._x=G._x,d._y=G._y,d._z=G._z,d._w=G._w,d},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(T){return this._x*T._x+this._y*T._y+this._z*T._z+this._w*T._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var S=this.length();return 0===S?(this._x=0,this._y=0,this._z=0,this._w=1):(S=1/S,this._x=this._x*S,this._y=this._y*S,this._z=this._z*S,this._w=this._w*S),this},fromArray:function(A,e){e===w&&(e=0);var y=this;return y._x=A[e],y._y=A[e+1],y._z=A[e+2],y._w=A[e+3],this},slerp:function(f,x){if(0===x)return this;if(1===x)return this.copy(f);var e=this._x,A=this._y,s=this._z,j=this._w,u=j*f._w+e*f._x+A*f._y+s*f._z;if(0>u?(this._w=-f._w,this._x=-f._x,this._y=-f._y,this._z=-f._z,u=-u):this.copy(f),u>=1)return this._w=j,this._x=e,this._y=A,this._z=s,this;var w=Math.sqrt(1-u*u);if(Math.abs(w)<.001)return this._w=.5*(j+this._w),this._x=.5*(e+this._x),this._y=.5*(A+this._y),this._z=.5*(s+this._z),this;var Y=Math.atan2(w,u),I=Math.sin((1-x)*Y)/w,g=Math.sin(x*Y)/w;return this._w=j*I+this._w*g,this._x=e*I+this._x*g,this._y=A*I+this._y*g,this._z=s*I+this._z*g,this},setFromAxisAngle:function(r,p){var l=p/2,k=Math.sin(l);return this._x=r.x*k,this._y=r.y*k,this._z=r.z*k,this._w=Math.cos(l),this},setFromEuler:function(b){var f=b._x,R=b._y,z=b._z,L=b._order,e=Math.cos,x=Math.sin,w=e(f/2),K=e(R/2),y=e(z/2),h=x(f/2),J=x(R/2),X=x(z/2);return"XYZ"===L?(this._x=h*K*y+w*J*X,this._y=w*J*y-h*K*X,this._z=w*K*X+h*J*y,this._w=w*K*y-h*J*X):"YXZ"===L?(this._x=h*K*y+w*J*X,this._y=w*J*y-h*K*X,this._z=w*K*X-h*J*y,this._w=w*K*y+h*J*X):"ZXY"===L?(this._x=h*K*y-w*J*X,this._y=w*J*y+h*K*X,this._z=w*K*X+h*J*y,this._w=w*K*y-h*J*X):"ZYX"===L?(this._x=h*K*y-w*J*X,this._y=w*J*y+h*K*X,this._z=w*K*X-h*J*y,this._w=w*K*y+h*J*X):"YZX"===L?(this._x=h*K*y+w*J*X,this._y=w*J*y+h*K*X,this._z=w*K*X-h*J*y,this._w=w*K*y-h*J*X):"XZY"===L&&(this._x=h*K*y-w*J*X,this._y=w*J*y-h*K*X,this._z=w*K*X+h*J*y,this._w=w*K*y+h*J*X),this},setFromRotationMatrix:function(w){var p,I=w.el,E=I[0],C=I[4],m=I[8],z=I[1],r=I[5],Q=I[9],A=I[2],P=I[6],v=I[10],d=E+r+v;return d>0?(p=.5/Math.sqrt(d+1),this._w=.25/p,this._x=(P-Q)*p,this._y=(m-A)*p,this._z=(z-C)*p):E>r&&E>v?(p=2*Math.sqrt(1+E-r-v),this._w=(P-Q)/p,this._x=.25*p,this._y=(C+z)/p,this._z=(m+A)/p):r>v?(p=2*Math.sqrt(1+r-E-v),this._w=(m-A)/p,this._x=(C+z)/p,this._y=.25*p,this._z=(Q+P)/p):(p=2*Math.sqrt(1+v-E-r),this._w=(z-C)/p,this._x=(m+A)/p,this._y=(Q+P)/p,this._z=.25*p),this},setFromToVectors:function(){var q,Z;return function(n,v){return q===w&&(q=new dc),Z=n.dot(v)+1,1e-7>Z?(Z=0,Math.abs(n.x)>Math.abs(n.z)?q.set(-n.y,n.x,0):q.set(0,-n.z,n.y)):q.crossVectors(n,v),this._x=q.x,this._y=q.y,this._z=q.z,this._w=Z,this.normalize()}}(),setFromUnitVectors:function(){var o,M,u=1e-6;return function(l,i){return o===w&&(o=new dc),M=l.dot(i)+1,u>M?(M=0,Math.abs(l.x)>Math.abs(l.z)?o.set(-l.y,l.x,0):o.set(0,-l.z,l.y)):o.crossVectors(l,i),this._x=o.x,this._y=o.y,this._z=o.z,this._w=M,this.normalize()}}(),multiply:function(h){return this.multiplyQuaternions(this,h)},premultiply:function(z){return this.multiplyQuaternions(z,this)},multiplyQuaternions:function(b,a){var V=b._x,o=b._y,A=b._z,P=b._w,q=a._x,T=a._y,E=a._z,m=a._w;return this._x=V*m+P*q+o*E-A*T,this._y=o*m+P*T+A*q-V*E,this._z=A*m+P*E+V*T-o*q,this._w=P*m-V*q-o*T-A*E,this}});var qe=Y.Math.Vector4=function(I,c,R,l){this.x=I||0,this.y=c||0,this.z=R||0,this.w=l!==w?l:1};u.assign(qe.prototype,{isVector4:!0,set:function(C,J,K,z){return this.x=C,this.y=J,this.z=K,this.w=z,this},setScalar:function(c){return this.x=c,this.y=c,this.z=c,this.w=c,this},setX:function(T){return this.x=T,this},setY:function(C){return this.y=C,this},setZ:function(_){return this.z=_,this},setW:function(s){return this.w=s,this},setComponent:function(M,P){switch(M){case 0:this.x=P;break;case 1:this.y=P;break;case 2:this.z=P;break;case 3:this.w=P;break;default:throw new Error("index is out of range: "+M)}return this},getComponent:function(T){switch(T){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+T)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(j){return this.x=j.x,this.y=j.y,this.z=j.z,this.w=j.w!==w?j.w:1,this},add:function(d,o){return o!==w?this.addVectors(d,o):(this.x+=d.x,this.y+=d.y,this.z+=d.z,this.w+=d.w,this)},addScalar:function(q){return this.x+=q,this.y+=q,this.z+=q,this.w+=q,this},addVectors:function(H,w){return this.x=H.x+w.x,this.y=H.y+w.y,this.z=H.z+w.z,this.w=H.w+w.w,this},addScaledVector:function(n,X){return this.x+=n.x*X,this.y+=n.y*X,this.z+=n.z*X,this.w+=n.w*X,this},sub:function(e,S){return S!==w?this.subVectors(e,S):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(F){return this.x-=F,this.y-=F,this.z-=F,this.w-=F,this},subVectors:function(F,k){return this.x=F.x-k.x,this.y=F.y-k.y,this.z=F.z-k.z,this.w=F.w-k.w,this},multiplyScalar:function(P){return this.x*=P,this.y*=P,this.z*=P,this.w*=P,this},applyMatrix4:function(Y){var v=this.x,t=this.y,P=this.z,O=this.w,B=Y.el;return this.x=B[0]*v+B[4]*t+B[8]*P+B[12]*O,this.y=B[1]*v+B[5]*t+B[9]*P+B[13]*O,this.z=B[2]*v+B[6]*t+B[10]*P+B[14]*O,this.w=B[3]*v+B[7]*t+B[11]*P+B[15]*O,this},divideScalar:function(v){return this.multiplyScalar(1/v)},setAxisAngleFromQuaternion:function(_){this.w=2*Math.acos(_.w);var v=Math.sqrt(1-_.w*_.w);return 1e-4>v?(this.x=1,this.y=0,this.z=0):(this.x=_.x/v,this.y=_.y/v,this.z=_.z/v),this},setAxisAngleFromRotationMatrix:function(m){var b,e,w,Z,g=.01,M=.1,X=m.el,v=X[0],y=X[4],O=X[8],c=X[1],n=X[5],p=X[9],i=X[2],H=X[6],h=X[10];if(Math.abs(y-c)<g&&Math.abs(O-i)<g&&Math.abs(p-H)<g){if(Math.abs(y+c)<M&&Math.abs(O+i)<M&&Math.abs(p+H)<M&&Math.abs(v+n+h-3)<M)return this.set(1,0,0,0),this;b=Math.PI;var u=(v+1)/2,P=(n+1)/2,Y=(h+1)/2,s=(y+c)/4,I=(O+i)/4,x=(p+H)/4;return u>P&&u>Y?g>u?(e=0,w=.707106781,Z=.707106781):(e=Math.sqrt(u),w=s/e,Z=I/e):P>Y?g>P?(e=.707106781,w=0,Z=.707106781):(w=Math.sqrt(P),e=s/w,Z=x/w):g>Y?(e=.707106781,w=.707106781,Z=0):(Z=Math.sqrt(Y),e=I/Z,w=x/Z),this.set(e,w,Z,b),this}var d=Math.sqrt((H-p)*(H-p)+(O-i)*(O-i)+(c-y)*(c-y));return Math.abs(d)<.001&&(d=1),this.x=(H-p)/d,this.y=(O-i)/d,this.z=(c-y)/d,this.w=Math.acos((v+n+h-1)/2),this},min:function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this.z=Math.min(this.z,Q.z),this.w=Math.min(this.w,Q.w),this},max:function(R){return this.x=Math.max(this.x,R.x),this.y=Math.max(this.y,R.y),this.z=Math.max(this.z,R.z),this.w=Math.max(this.w,R.w),this},clamp:function(A,o){return this.x=Math.max(A.x,Math.min(o.x,this.x)),this.y=Math.max(A.y,Math.min(o.y,this.y)),this.z=Math.max(A.z,Math.min(o.z,this.z)),this.w=Math.max(A.w,Math.min(o.w,this.w)),this},clampScalar:function(){var v,y;return function(A,Z){return v===w&&(v=new qe,y=new qe),v.set(A,A,A,A),y.set(Z,Z,Z,Z),this.clamp(v,y)}}(),clampLength:function(H,T){var k=this.length();return this.divideScalar(k||1).multiplyScalar(Math.max(H,Math.min(T,k)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(L){return this.x*L.x+this.y*L.y+this.z*L.z+this.w*L.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(j){return this.normalize().multiplyScalar(j)},lerp:function(G,z){return this.x+=(G.x-this.x)*z,this.y+=(G.y-this.y)*z,this.z+=(G.z-this.z)*z,this.w+=(G.w-this.w)*z,this},lerpVectors:function(e,g,A){return this.subVectors(g,e).multiplyScalar(A).add(e)},equals:function(F){return F.x===this.x&&F.y===this.y&&F.z===this.z&&F.w===this.w},fromArray:function(c,T){return T===w&&(T=0),this.x=c[T],this.y=c[T+1],this.z=c[T+2],this.w=c[T+3],this},toArray:function(s,B){return s===w&&(s=[]),B===w&&(B=0),s[B]=this.x,s[B+1]=this.y,s[B+2]=this.z,s[B+3]=this.w,s},fromBufferAttribute:function(J,P){return this.x=J.getX(P),this.y=J.getY(P),this.z=J.getZ(P),this.w=J.getW(P),this}});var dc=Y.Math.Vector3=function(c,m,T){c===w?(this.x=0,this.y=0,this.z=0):"object"==typeof c?this.copy(c):this.set(c,m==w?c:m,T==w?c:T)};u.assign(dc.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(M,T,z){return this.x=M,this.y=T,this.z=z,this},equals:function(d){return d&&this.x===d.x&&this.y===d.y&&this.z===d.z},setScalar:function(G){return this.x=G,this.y=G,this.z=G,this},setX:function(J){return this.x=J,this},setY:function(d){return this.y=d,this},setZ:function(G){return this.z=G,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(j){return j.x===w?(this.x=j[0],this.y=j[1],this.z=j[2]):(this.x=j.x,this.y=j.y,this.z=j.z||0),this},add:function(L){return this.x+=L.x,this.y+=L.y,this.z+=L.z,this},addScalar:function(M){return this.x+=M,this.y+=M,this.z+=M,this},addVectors:function(m,J){return this.x=m.x+J.x,this.y=m.y+J.y,this.z=m.z+J.z,this},addScaledVector:function(C,F){return this.x+=C.x*F,this.y+=C.y*F,this.z+=C.z*F,this},sub:function(R){return this.x-=R.x,this.y-=R.y,this.z-=R.z,this},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this},subVectors:function(c,V){return this.x=c.x-V.x,this.y=c.y-V.y,this.z=c.z-V.z,this},divide:function(Q){return this.x/=Q.x,this.y/=Q.y,this.z/=Q.z,this},multiply:function(j){return this.x*=j.x,this.y*=j.y,this.z*=j.z,this},multiplyScalar:function($){return this.x*=$,this.y*=$,this.z*=$,this},distanceTo:function(k){return Math.sqrt(this.distanceToSquared(k))},distanceToSquared:function(v){var r=this.x-v.x,O=this.y-v.y,z=this.z-v.z;return r*r+O*O+z*z},distanceToSquared2:function(l){var N=this.x-l[0],H=this.y-l[1],z=this.z-l[2];return N*N+H*H+z*z},divideVectors:function(F,k){return this.x=F.x/k.x,this.y=F.y/k.y,this.z=F.z/k.z,this},multiplyVectors:function(E,k){return this.x=E.x*k.x,this.y=E.y*k.y,this.z=E.z*k.z,this},transformDirection:function(o){var u=this.x,h=this.y,U=this.z,B=o.el;return this.x=B[0]*u+B[4]*h+B[8]*U,this.y=B[1]*u+B[5]*h+B[9]*U,this.z=B[2]*u+B[6]*h+B[10]*U,this.normalize()},applyAxisAngle:function(){var t=new Dj;return function(Z,c){return this.applyQuaternion(t.setFromAxisAngle(Z,c))}}(),applyEuler:function(){var G=new Dj;return function(c){return this.applyQuaternion(G.setFromEuler(c))}}(),applyQuaternion:function(l){var Z=this.x,c=this.y,K=this.z,L=l._x,G=l._y,p=l._z,x=l._w,g=x*Z+G*K-p*c,e=x*c+p*Z-L*K,Q=x*K+L*c-G*Z,a=-L*Z-G*c-p*K;return this.x=g*x+a*-L+e*-p-Q*-G,this.y=e*x+a*-G+Q*-L-g*-p,this.z=Q*x+a*-p+g*-G-e*-L,this},applyMatrix4:function(L){var g=this.x,S=this.y,$=this.z,B=L.el,A=1/(B[3]*g+B[7]*S+B[11]*$+B[15]);return this.x=(B[0]*g+B[4]*S+B[8]*$+B[12])*A,this.y=(B[1]*g+B[5]*S+B[9]*$+B[13])*A,this.z=(B[2]*g+B[6]*S+B[10]*$+B[14])*A,this},applyMatrix3:function($){var I=this.x,v=this.y,j=this.z,c=$.el;return this.x=c[0]*I+c[3]*v+c[6]*j,this.y=c[1]*I+c[4]*v+c[7]*j,this.z=c[2]*I+c[5]*v+c[8]*j,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var V=new dc;return function(E){return this.sub(V.copy(E).multiplyScalar(2*this.dot(E)))}}(),dot:function(S){return this.x*S.x+this.y*S.y+this.z*S.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)
},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var e=this.length();return e?this.multiplyScalar(1/e):this},setLength:function(r){return this.normalize().multiplyScalar(r)},fromArray:function(M,K){return K===w&&(K=0),this.x=M[K],this.y=M[K+1],this.z=M[K+2],this},toArray:function(q,Q){return q===w&&(q=[0,0,0]),Q===w&&(Q=0),q[Q]=this.x,q[Q+1]=this.y,q[Q+2]=this.z,q},cross:function(x){return this.crossVectors(this,x)},angleTo:function(e){var V=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return V>1||-1>V?0:Math.acos(V)},lerp:function(U,Y){return this.x+=(U.x-this.x)*Y,this.y+=(U.y-this.y)*Y,this.z+=(U.z-this.z)*Y,this},lerpVectors:function(p,X,K){return this.subVectors(X,p).multiplyScalar(K).add(p)},crossVectors:function(p,e){var I=p.x,l=p.y,f=p.z,o=e.x,m=e.y,j=e.z;return this.x=l*j-f*m,this.y=f*o-I*j,this.z=I*m-l*o,this},min:function(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this},max:function(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this},setFromMatrixPosition:function(a){return this.setFromMatrixColumn(a,3)},setFromMatrixScale:function(y){var N=this.setFromMatrixColumn(y,0).length(),i=this.setFromMatrixColumn(y,1).length(),U=this.setFromMatrixColumn(y,2).length();return this.x=N,this.y=i,this.z=U,this},setFromMatrixColumn:function(U,W){return this.fromArray(U.el,4*W)}});var ob=Y.Math.Vector2=function(Y,c,z){"object"==typeof Y&&(Y.x!=w?(c=Y.y,Y=Y.x,z=Y.e):(z=Y[2],c=Y[1],Y=Y[0])),this.set(Y||0,c||0,z)};ob.prototype={},ob.prototype.constructor=ob,u.defineProperties(ob.prototype,{width:{get:function(){return this.x},set:function(O){this.x=O}},height:{get:function(){return this.y},set:function(I){this.y=I}}}),ob.prototype.clone=function(){return new ob(this.x,this.y,this.e)},ob.prototype.copy=function(G){return this.set(G.x,G.y,G.e),this},ob.prototype.equals=function(w){return w.x===this.x&&w.y===this.y},ob.prototype.set=function(b,G,f){return this.x=b||0,this.y=G||(0!==G?this.x:0),f!=w&&(this.e=f),this},ob.prototype.setScalar=function(U){return this.x=U,this.y=U,this},ob.prototype.setX=function(F){return this.x=F||0,this},ob.prototype.setY=function(z){return this.y=z||0,this},ob.prototype.add=function(W){return this.x+=W.x,this.y+=W.y,this},ob.prototype.addVectors=function(L,u){return this.x=L.x+u.x,this.y=L.y+u.y,this},ob.prototype.addScalar=function(R){return this.x+=R,this.y+=R,this},ob.prototype.addScaledVector=function($,y){return this.x+=$.x*y,this.y+=$.y*y,this},ob.prototype.sub=function(y){return this.x-=y.x,this.y-=y.y,this},ob.prototype.subScalar=function(G){return this.x-=G,this.y-=G,this},ob.prototype.subVectors=function(A,L){return this.x=A.x-L.x,this.y=A.y-L.y,this},ob.prototype.multiply=function(k){return this.x*=k.x,this.y*=k.y,this},ob.prototype.multiplyScalar=function(v){return this.x*=v,this.y*=v,this},ob.prototype.divide=function(a){return this.x/=a.x,this.y/=a.y,this},ob.prototype.divideScalar=function(N){return this.multiplyScalar(1/N)},ob.prototype.min=function(x){return this.x=Math.min(this.x,x.x),this.y=Math.min(this.y,x.y),this},ob.prototype.max=function(J){return this.x=Math.max(this.x,J.x),this.y=Math.max(this.y,J.y),this},ob.prototype.fromArray=function(A,F){return F===w&&(F=0),this.x=A[F],this.y=A[F+1],this},ob.prototype.clamp=function(H,L){return this.x=Math.max(H.x,Math.min(L.x,this.x)),this.y=Math.max(H.y,Math.min(L.y,this.y)),this},ob.prototype.clampScalar=function(){var z,N;return function(r,X){return z===w&&(z=new ob,N=new ob),z.set(r,r),N.set(X,X),this.clamp(z,N)}}(),ob.prototype.clampLength=function(o,Y){var X=this.length();return this.multiplyScalar(Math.max(o,Math.min(Y,X))/X)},ob.prototype.dot=function(F){return this.x*F.x+this.y*F.y},ob.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},ob.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},ob.prototype.normalize=function(){return this.divideScalar(this.length())},ob.prototype.angle=function(){var h=Math.atan2(this.y,this.x);return 0>h&&(h+=2*Math.PI),h},ob.prototype.distanceTo=function(O){return Math.sqrt(this.distanceToSquared(O))},ob.prototype.distanceToSquared=function(S){var M=this.x-S.x,k=this.y-S.y;return M*M+k*k},ob.prototype.isNearEnough=function(l){return this.distanceToSquared(l)<1e-8},ob.prototype.setLength=function(G){var H=this.length();return H?this.multiplyScalar(G/H):this},ob.prototype.lerp=function(r,t){return this.x+=(r.x-this.x)*t,this.y+=(r.y-this.y)*t,this},ob.prototype.lerpVectors=function(U,d,D){return this.subVectors(d,U).multiplyScalar(D).add(U)},ob.prototype.rotateAround=function(j,n){var v=j?j.x:0,U=j?j.y:0,r=Math.cos(n),Q=Math.sin(n),E=this.x-v,u=this.y-U;return this.x=E*r-u*Q+v,this.y=E*Q+u*r+U,this},u.assign(C.prototype,{isMatrix3:!0,set:function(D,h,M,L,A,E,a,i,n){var U=this.el;return U[0]=D,U[1]=L,U[2]=a,U[3]=h,U[4]=A,U[5]=i,U[6]=M,U[7]=E,U[8]=n,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(q){var B=this.el,f=q.el;return B[0]=f[0],B[1]=f[1],B[2]=f[2],B[3]=f[3],B[4]=f[4],B[5]=f[5],B[6]=f[6],B[7]=f[7],B[8]=f[8],this},setFromMatrix4:function(T){var d=T.el;return this.set(d[0],d[4],d[8],d[1],d[5],d[9],d[2],d[6],d[10]),this},applyToBufferAttribute:function(){var D=new dc;return function(r){for(var z=0,y=r.count;y>z;z++)D.x=r.getX(z),D.y=r.getY(z),D.z=r.getZ(z),D.applyMatrix3(this),r.setXYZ(z,D.x,D.y,D.z);return r}}(),multiply:function(Y){return this.multiplyMatrices(this,Y)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(G,g){var N=G.el,O=g.el,w=this.el,S=N[0],t=N[3],h=N[6],Q=N[1],V=N[4],B=N[7],E=N[2],k=N[5],f=N[8],I=O[0],M=O[3],R=O[6],A=O[1],_=O[4],o=O[7],L=O[2],a=O[5],u=O[8];return w[0]=S*I+t*A+h*L,w[3]=S*M+t*_+h*a,w[6]=S*R+t*o+h*u,w[1]=Q*I+V*A+B*L,w[4]=Q*M+V*_+B*a,w[7]=Q*R+V*o+B*u,w[2]=E*I+k*A+f*L,w[5]=E*M+k*_+f*a,w[8]=E*R+k*o+f*u,this},multiplyScalar:function(z){var v=this.el;return v[0]*=z,v[3]*=z,v[6]*=z,v[1]*=z,v[4]*=z,v[7]*=z,v[2]*=z,v[5]*=z,v[8]*=z,this},determinant:function(){var P=this.el,H=P[0],K=P[1],Z=P[2],_=P[3],g=P[4],y=P[5],n=P[6],h=P[7],p=P[8];return H*g*p-H*y*h-K*_*p+K*y*n+Z*_*h-Z*g*n},getInverse:function(z){var w=z.el,L=this.el,o=w[0],_=w[1],j=w[2],B=w[3],c=w[4],r=w[5],v=w[6],Y=w[7],C=w[8],G=C*c-r*Y,H=r*v-C*B,d=Y*B-c*v,n=o*G+_*H+j*d;if(0===n)return this.identity();var D=1/n;return L[0]=G*D,L[1]=(j*Y-C*_)*D,L[2]=(r*_-j*c)*D,L[3]=H*D,L[4]=(C*o-j*v)*D,L[5]=(j*B-r*o)*D,L[6]=d*D,L[7]=(_*v-Y*o)*D,L[8]=(c*o-_*B)*D,this},transpose:function(){var x,i=this.el;return x=i[1],i[1]=i[3],i[3]=x,x=i[2],i[2]=i[6],i[6]=x,x=i[5],i[5]=i[7],i[7]=x,this},getNormalMatrix:function(n){return this.setFromMatrix4(n).getInverse(this).transpose()},transposeIntoArray:function(m){var B=this.el;return m[0]=B[0],m[1]=B[3],m[2]=B[6],m[3]=B[1],m[4]=B[4],m[5]=B[7],m[6]=B[2],m[7]=B[5],m[8]=B[8],this},setUvTransform:function(w,A,u,I,O,C,t){var N=Math.cos(O),d=Math.sin(O);this.set(u*N,u*d,-u*(N*C+d*t)+C+w,-I*d,I*N,-I*(-d*C+N*t)+t+A,0,0,1)},scale:function(Z,f){var E=this.el;return E[0]*=Z,E[3]*=Z,E[6]*=Z,E[1]*=f,E[4]*=f,E[7]*=f,this},rotate:function(_){var M=Math.cos(_),Z=Math.sin(_),L=this.el,g=L[0],V=L[3],s=L[6],W=L[1],c=L[4],l=L[7];return L[0]=M*g+Z*W,L[3]=M*V+Z*c,L[6]=M*s+Z*l,L[1]=-Z*g+M*W,L[4]=-Z*V+M*c,L[7]=-Z*s+M*l,this},translate:function(V,u){var e=this.el;return e[0]+=V*e[2],e[3]+=V*e[5],e[6]+=V*e[8],e[1]+=u*e[2],e[4]+=u*e[5],e[7]+=u*e[8],this},equals:function(M){for(var p=this.el,i=M.el,z=0;9>z;z++)if(p[z]!==i[z])return!1;return!0},fromArray:function(R,x){x===w&&(x=0);for(var a=0;9>a;a++)this.el[a]=R[a+x];return this},toArray:function(W,G){W===w&&(W=[]),G===w&&(G=0);var y=this.el;return W[G]=y[0],W[G+1]=y[1],W[G+2]=y[2],W[G+3]=y[3],W[G+4]=y[4],W[G+5]=y[5],W[G+6]=y[6],W[G+7]=y[7],W[G+8]=y[8],W}});var vg=Y.Math.Plane=function(o,A){this.normal=o!==w?o:new dc(1,0,0),this.constant=A!==w?A:0};u.assign(vg.prototype,{set:function(u,L){return this.normal.copy(u),this.constant=L,this},setComponents:function(V,o,x,c){return this.normal.set(V,o,x),this.constant=c,this},setFromNormalAndCoplanarPoint:function(n,U){return this.normal.copy(n),this.constant=-U.dot(this.normal),this},setFromCoplanarPoints:function(){var Q=new dc,n=new dc;return function(v,z,P){var R=Q.subVectors(P,z).cross(n.subVectors(v,z)).normalize();return this.setFromNormalAndCoplanarPoint(R,v),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(_){return this.normal.copy(_.normal),this.constant=_.constant,this},normalize:function(){var j=1/this.normal.length();return this.normal.multiplyScalar(j),this.constant*=j,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(h){return this.normal.dot(h)+this.constant},distanceToSphere:function(N){return this.distanceToPoint(N.center)-N.radius},projectPoint:function(B,l){return l===w&&(l=new dc),l.copy(this.normal).multiplyScalar(-this.distanceToPoint(B)).add(B)},intersectLine:function(){var Y=new dc;return function(h,L){L===w&&(L=new dc);var E=h.delta(Y),Z=this.normal.dot(E);if(0===Z)return 0===this.distanceToPoint(h.start)?L.copy(h.start):w;var c=-(h.start.dot(this.normal)+this.constant)/Z;return 0>c||c>1?w:L.copy(E).multiplyScalar(c).add(h.start)}}(),intersectsLine:function(F){var c=this.distanceToPoint(F.start),e=this.distanceToPoint(F.end);return 0>c&&e>0||0>e&&c>0},intersectsBox:function(C){return C.intersectsPlane(this)},intersectsSphere:function(b){return b.intersectsPlane(this)},coplanarPoint:function(y){return y===w&&(y=new dc),y.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var i=new dc,g=new C;return function(K,o){var B=o||g.getNormalMatrix(K),W=this.coplanarPoint(i).applyMatrix4(K),b=this.normal.applyMatrix3(B).normalize();return this.constant=-W.dot(b),this}}(),translate:function(H){return this.constant-=H.dot(this.normal),this},equals:function(A){return A.normal.equals(this.normal)&&A.constant===this.constant}});var tk=Y.Math.Ray=function(o,p){this.origin=o!==w?o.clone():new dc,this.direction=p!==w?p.clone():new dc};u.assign(tk.prototype,{set:function(W,B){return this.origin.copy(W),this.direction.copy(B),this},clone:function(){return(new this.constructor).copy(this)},copy:function(R){return this.origin.copy(R.origin),this.direction.copy(R.direction),this.maxHitLen=R.maxHitLen,this},at:function(V,o){var R=o||new dc;return R.copy(this.direction).multiplyScalar(V).add(this.origin)},setMaxHitLength:function(o){this.maxHitLen=o},lookAt:function(X){return this.direction.copy(X).sub(this.origin).normalize(),this},applyMatrix4:function(F){var I=this.maxHitLen;if(I){var u=this.direction.clone().multiplyScalar(I).add(this.origin);u.applyMatrix4(F)}return this.origin.applyMatrix4(F),this.direction.transformDirection(F),I&&(this.maxHitLen=this.origin.distanceTo(u)),this},intersectSphere:function(){var H=new dc;return function(F,Z){H.subVectors(F.center,this.origin);var A=H.dot(this.direction),g=H.dot(H)-A*A,q=F.radius*F.radius;if(g>q)return null;var M=Math.sqrt(q-g),$=A-M,j=A+M;return 0>$&&0>j?null:0>$?this.at(j,Z):this.at($,Z)}}(),intersectEllipsoid:function(){var u=new dc,H=new dc;return function(r,E){u.subVectors(r.center,this.origin),u.divide(r.radius),H.divideVectors(this.direction,r.radius);var F=H.lengthSq(),V=u.dot(H),A=u.dot(u)*F-V*V;if(A>F)return null;var Q=Math.sqrt(F-A),G=(V-Q)/F,t=(V+Q)/F;return 0>G&&0>t?null:0>G?this.at(t,E):this.at(G,E)}}(),intersectBox:function(K,O){var Y,P,X,T,g,M,F=1/this.direction.x,s=1/this.direction.y,z=1/this.direction.z,B=this.origin;if(F>=0?(Y=(K.min.x-B.x)*F,P=(K.max.x-B.x)*F):(Y=(K.max.x-B.x)*F,P=(K.min.x-B.x)*F),s>=0?(X=(K.min.y-B.y)*s,T=(K.max.y-B.y)*s):(X=(K.max.y-B.y)*s,T=(K.min.y-B.y)*s),Y>T||X>P)return null;if((X>Y||Y!==Y)&&(Y=X),(P>T||P!==P)&&(P=T),z>=0?(g=(K.min.z-B.z)*z,M=(K.max.z-B.z)*z):(g=(K.max.z-B.z)*z,M=(K.min.z-B.z)*z),Y>M||g>P)return null;if((g>Y||Y!==Y)&&(Y=g),(P>M||P!==P)&&(P=M),0>P)return null;var t=Y>=0?Y:P,$=this.maxHitLen;return $&&t>$?null:this.at(t,O)},intersectTriangle:function(){var h=new dc,Y=new dc,_=new dc,y=new dc;return function(T,w,j,P,$){Y.subVectors(w,T),_.subVectors(j,T),y.crossVectors(Y,_);var k,U=this.direction.dot(y);if(U>0){if(P)return null;k=1}else{if(!(0>U))return null;k=-1,U=-U}h.subVectors(this.origin,T);var X=k*this.direction.dot(_.crossVectors(h,_));if(0>X)return null;var O=k*this.direction.dot(Y.cross(h));if(0>O||X+O>U)return null;var R=-k*h.dot(y);if(0>R)return null;var K=R/U,p=this.maxHitLen;return p&&K>p?null:this.at(K,$)}}()});var Fn=Y.Math.Box3=function(j,r){this.min=j!==w?j:new dc(1/0,1/0,1/0),this.max=r!==w?r:new dc(-1/0,-1/0,-1/0)};u.assign(Fn.prototype,{set:function(b,g){return this.min.copy(b),this.max.copy(g),this},setFromArray:function(V){for(var Q=1/0,x=1/0,z=1/0,I=-1/0,j=-1/0,Z=-1/0,T=0,$=V.length;$>T;T+=3){var o=V[T],q=V[T+1],E=V[T+2];Q>o&&(Q=o),x>q&&(x=q),z>E&&(z=E),o>I&&(I=o),q>j&&(j=q),E>Z&&(Z=E)}return this.min.set(Q,x,z),this.max.set(I,j,Z),this},setFromPoints:function(d){this.makeEmpty();for(var M=0,L=d.length;L>M;M++)this.expandByPoint(d[M]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(W){return W.max.x<this.min.x||W.min.x>this.max.x||W.max.y<this.min.y||W.min.y>this.max.y||W.max.z<this.min.z||W.min.z>this.max.z?!1:!0},copy:function(R){return this.min.copy(R.min),this.max.copy(R.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(y){return this.min.min(y),this.max.max(y),this},expandByBox:function(X){return this.min.min(X.min),this.max.max(X.max),this},applyMatrix4:function(){var i=[new dc,new dc,new dc,new dc,new dc,new dc,new dc,new dc];return function(W){return this.isEmpty()?this:(i[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(W),i[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(W),i[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(W),i[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(W),i[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(W),i[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(W),i[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(W),i[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(W),this.setFromPoints(i),this)}}()});var Ke=Y.Math.Sphere=function(h,p){this.center=h!==w?h:new dc,this.radius=p!==w?p:0};u.assign(Ke.prototype,{set:function(K,X){return this.center.copy(K),this.radius=X,this},setFromPoints:function(){var C=new Fn;return function(J,l){var n=this.center;l!==w?n.copy(l):C.setFromPoints(J).getCenter(n);for(var U=0,e=0,g=J.length;g>e;e++)U=Math.max(U,n.distanceToSquared(J[e]));return this.radius=Math.sqrt(U),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(V){return V.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(_){return _.distanceTo(this.center)-this.radius},intersectsSphere:function(G){var p=this.radius+G.radius;return G.center.distanceToSquared(this.center)<=p*p},intersectsBox:function(n){return n.intersectsSphere(this)},intersectsPlane:function(g){return Math.abs(g.distanceToPoint(this.center))<=this.radius},clampPoint:function(J,b){var y=this.center.distanceToSquared(J);return b===w&&(b=new dc),b.copy(J),y>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b},getBoundingBox:function(l){return l===w&&(l=new Fn),l.set(this.center,this.center),l.expandByScalar(this.radius),l},applyMatrix4:function(p){return this.center.applyMatrix4(p),this.radius=this.radius*p.getMaxScaleOnAxis(),this},translate:function(S){return this.center.add(S),this},equals:function(P){return P.center.equals(this.center)&&P.radius===this.radius}});var ec=Y.Math.Frustum=function(V,C,H,q,l,c){this.planes=[V!==w?V:new vg,C!==w?C:new vg,H!==w?H:new vg,q!==w?q:new vg,l!==w?l:new vg,c!==w?c:new vg]};u.assign(ec.prototype,{set:function(x,r,_,c,X,U){var C=this.planes;return C[0].copy(x),C[1].copy(r),C[2].copy(_),C[3].copy(c),C[4].copy(X),C[5].copy(U),this},clone:function(){return(new this.constructor).copy(this)},copy:function(K){for(var A=this.planes,i=0;6>i;i++)A[i].copy(K.planes[i]);return this},setFromMatrix:function(W){var I=this.planes,O=W.el,D=O[0],H=O[1],L=O[2],l=O[3],f=O[4],J=O[5],k=O[6],b=O[7],y=O[8],d=O[9],x=O[10],i=O[11],A=O[12],h=O[13],e=O[14],n=O[15];return I[0].setComponents(l-D,b-f,i-y,n-A).normalize(),I[1].setComponents(l+D,b+f,i+y,n+A).normalize(),I[2].setComponents(l+H,b+J,i+d,n+h).normalize(),I[3].setComponents(l-H,b-J,i-d,n-h).normalize(),I[4].setComponents(l-L,b-k,i-x,n-e).normalize(),I[5].setComponents(l+L,b+k,i+x,n+e).normalize(),this},intersectsObject:function(){var D=new Ke;return function(g){var i=g.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),D.copy(i.boundingSphere).applyMatrix4(g.matrixWorld),this.intersectsSphere(D)}}(),intersectsSprite:function(){var s=new Ke;return function(j){return s.center.set(0,0,0),s.radius=.7071067811865476,s.applyMatrix4(j.matrixWorld),this.intersectsSphere(s)}}(),intersectsSphere:function(h){for(var F=this.planes,O=h.center,v=-h.radius,g=0;6>g;g++){var f=F[g].distanceToPoint(O);if(v>f)return!1}return!0},intersectsBox:function(){var i=new dc;return function(T){for(var C=this.planes,d=0;6>d;d++){var B=C[d];if(i.x=B.normal.x>0?T.max.x:T.min.x,i.y=B.normal.y>0?T.max.y:T.min.y,i.z=B.normal.z>0?T.max.z:T.min.z,B.distanceToPoint(i)<0)return!1}return!0}}(),containsPoint:function(r){for(var m=this.planes,Y=0;6>Y;Y++)if(m[Y].distanceToPoint(r)<0)return!1;return!0}});var de=Y.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};u.assign(de.prototype,{set:function(z,Y,f,V,W,N,q,g,F,b,A,r,a,p,Z,U){var m=this.el;return m[0]=z,m[4]=Y,m[8]=f,m[12]=V,m[1]=W,m[5]=N,m[9]=q,m[13]=g,m[2]=F,m[6]=b,m[10]=A,m[14]=r,m[3]=a,m[7]=p,m[11]=Z,m[15]=U,this},clone:function(){return(new de).fromArray(this.el)},fromArray:function(U,d){d===w&&(d=0);for(var Q=this.el,Z=0;16>Z;Z++)Q[Z]=U[Z+d];return this},getElements:function(){return this.el},scale:function(k){var B=this.el,Y=k.x,o=k.y,t=k.z;return B[0]*=Y,B[4]*=o,B[8]*=t,B[1]*=Y,B[5]*=o,B[9]*=t,B[2]*=Y,B[6]*=o,B[10]*=t,B[3]*=Y,B[7]*=o,B[11]*=t,this},makeRotationFromEuler:function(u){var W=this.el,t=u._x,U=u._y,Z=u._z,p=u._order,e=Math.cos(t),R=Math.sin(t),l=Math.cos(U),$=Math.sin(U),P=Math.cos(Z),K=Math.sin(Z);if("XYZ"===p){var E=e*P,N=e*K,g=R*P,Q=R*K;W[0]=l*P,W[4]=-l*K,W[8]=$,W[1]=N+g*$,W[5]=E-Q*$,W[9]=-R*l,W[2]=Q-E*$,W[6]=g+N*$,W[10]=e*l}else if("YXZ"===p){var B=l*P,M=l*K,v=$*P,b=$*K;W[0]=B+b*R,W[4]=v*R-M,W[8]=e*$,W[1]=e*K,W[5]=e*P,W[9]=-R,W[2]=M*R-v,W[6]=b+B*R,W[10]=e*l}else if("ZXY"===p){var B=l*P,M=l*K,v=$*P,b=$*K;W[0]=B-b*R,W[4]=-e*K,W[8]=v+M*R,W[1]=M+v*R,W[5]=e*P,W[9]=b-B*R,W[2]=-e*$,W[6]=R,W[10]=e*l}else if("ZYX"===p){var E=e*P,N=e*K,g=R*P,Q=R*K;W[0]=l*P,W[4]=g*$-N,W[8]=E*$+Q,W[1]=l*K,W[5]=Q*$+E,W[9]=N*$-g,W[2]=-$,W[6]=R*l,W[10]=e*l}else if("YZX"===p){var s=e*l,D=e*$,w=R*l,q=R*$;W[0]=l*P,W[4]=q-s*K,W[8]=w*K+D,W[1]=K,W[5]=e*P,W[9]=-R*P,W[2]=-$*P,W[6]=D*K+w,W[10]=s-q*K}else if("XZY"===p){var s=e*l,D=e*$,w=R*l,q=R*$;W[0]=l*P,W[4]=-K,W[8]=$*P,W[1]=s*K+q,W[5]=e*P,W[9]=D*K-w,W[2]=w*K-D,W[6]=R*P,W[10]=q*K+s}return W[3]=0,W[7]=0,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,this},makeRotationFromQuaternion:function($){var M=this.el,N=$._x,x=$._y,D=$._z,t=$._w,K=N+N,L=x+x,i=D+D,o=N*K,r=N*L,e=N*i,Y=x*L,X=x*i,g=D*i,s=t*K,T=t*L,O=t*i;return M[0]=1-(Y+g),M[4]=r-O,M[8]=e+T,M[1]=r+O,M[5]=1-(o+g),M[9]=X-s,M[2]=e-T,M[6]=X+s,M[10]=1-(o+Y),M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(z){var c=this.el,D=z.el,F=D[0],N=D[1],U=D[2],p=D[3],L=D[4],W=D[5],Z=D[6],Y=D[7],o=D[8],E=D[9],w=D[10],B=D[11],V=D[12],k=D[13],$=D[14],i=D[15],t=E*$*Y-k*w*Y+k*Z*B-W*$*B-E*Z*i+W*w*i,v=V*w*Y-o*$*Y-V*Z*B+L*$*B+o*Z*i-L*w*i,g=o*k*Y-V*E*Y+V*W*B-L*k*B-o*W*i+L*E*i,f=V*E*Z-o*k*Z-V*W*w+L*k*w+o*W*$-L*E*$,q=F*t+N*v+U*g+p*f;if(0===q)return this.identity();var d=1/q;return c[0]=t*d,c[1]=(k*w*p-E*$*p-k*U*B+N*$*B+E*U*i-N*w*i)*d,c[2]=(W*$*p-k*Z*p+k*U*Y-N*$*Y-W*U*i+N*Z*i)*d,c[3]=(E*Z*p-W*w*p-E*U*Y+N*w*Y+W*U*B-N*Z*B)*d,c[4]=v*d,c[5]=(o*$*p-V*w*p+V*U*B-F*$*B-o*U*i+F*w*i)*d,c[6]=(V*Z*p-L*$*p-V*U*Y+F*$*Y+L*U*i-F*Z*i)*d,c[7]=(L*w*p-o*Z*p+o*U*Y-F*w*Y-L*U*B+F*Z*B)*d,c[8]=g*d,c[9]=(V*E*p-o*k*p-V*N*B+F*k*B+o*N*i-F*E*i)*d,c[10]=(L*k*p-V*W*p+V*N*Y-F*k*Y-L*N*i+F*W*i)*d,c[11]=(o*W*p-L*E*p-o*N*Y+F*E*Y+L*N*B-F*W*B)*d,c[12]=f*d,c[13]=(o*k*U-V*E*U+V*N*w-F*k*w-o*N*$+F*E*$)*d,c[14]=(V*W*U-L*k*U-V*N*Z+F*k*Z+L*N*$-F*W*$)*d,c[15]=(L*E*U-o*W*U+o*N*Z-F*E*Z-L*N*w+F*W*w)*d,this},makeRotationAxis:function(h,x){var X=Math.cos(x),k=Math.sin(x),v=1-X,F=h.x,Z=h.y,y=h.z,S=v*F,V=v*Z;return this.set(S*F+X,S*Z-k*y,S*y+k*Z,0,S*Z+k*y,V*Z+X,V*y-k*F,0,S*y-k*Z,V*y+k*F,v*y*y+X,0,0,0,0,1),this},multiply:function(f){return this.multiplyMatrices(this,f)},premultiply:function(K){return this.multiplyMatrices(K,this)},multiplyMatrices:function(d,y){var O=d.el,$=y.el,z=this.el,r=O[0],l=O[4],g=O[8],V=O[12],W=O[1],s=O[5],H=O[9],t=O[13],T=O[2],F=O[6],X=O[10],Q=O[14],P=O[3],v=O[7],k=O[11],x=O[15],i=$[0],o=$[4],A=$[8],p=$[12],j=$[1],C=$[5],J=$[9],I=$[13],h=$[2],D=$[6],w=$[10],G=$[14],c=$[3],L=$[7],b=$[11],q=$[15];return z[0]=r*i+l*j+g*h+V*c,z[4]=r*o+l*C+g*D+V*L,z[8]=r*A+l*J+g*w+V*b,z[12]=r*p+l*I+g*G+V*q,z[1]=W*i+s*j+H*h+t*c,z[5]=W*o+s*C+H*D+t*L,z[9]=W*A+s*J+H*w+t*b,z[13]=W*p+s*I+H*G+t*q,z[2]=T*i+F*j+X*h+Q*c,z[6]=T*o+F*C+X*D+Q*L,z[10]=T*A+F*J+X*w+Q*b,z[14]=T*p+F*I+X*G+Q*q,z[3]=P*i+v*j+k*h+x*c,z[7]=P*o+v*C+k*D+x*L,z[11]=P*A+v*J+k*w+x*b,z[15]=P*p+v*I+k*G+x*q,this},lookAt:function(){var w=new dc,q=new dc,B=new dc;return function(Q,A,D){var h=this.el;return B.subVectors(Q,A),0===B.lengthSq()&&(B.z=1),B.normalize(),w.crossVectors(D,B),0===w.lengthSq()&&(1===Math.abs(D.z)?B.x+=1e-4:B.z+=1e-4,B.normalize(),w.crossVectors(D,B)),w.normalize(),q.crossVectors(B,w),h[0]=w.x,h[4]=q.x,h[8]=B.x,h[1]=w.y,h[5]=q.y,h[9]=B.y,h[2]=w.z,h[6]=q.z,h[10]=B.z,this}}(),extractScale:function(){var X;return function(z){X===w&&(X=new dc),z===w&&(z=new dc);var K=X.setFromMatrixColumn(this,0).length(),n=X.setFromMatrixColumn(this,1).length(),k=X.setFromMatrixColumn(this,2).length();return z.set(K,n,k),z}}(),extractRotation:function(){var f;return function(Y){f===w&&(f=new dc),Y===w&&(Y=new de);var d=this.el,O=Y.el,m=1/f.setFromMatrixColumn(Y,0).length(),h=1/f.setFromMatrixColumn(Y,1).length(),A=1/f.setFromMatrixColumn(Y,2).length();return d[0]=O[0]*m,d[1]=O[1]*m,d[2]=O[2]*m,d[4]=O[4]*h,d[5]=O[5]*h,d[6]=O[6]*h,d[8]=O[8]*A,d[9]=O[9]*A,d[10]=O[10]*A,this}}(),multiplyScalar:function(k){var p=this.el;return p[0]*=k,p[4]*=k,p[8]*=k,p[12]*=k,p[1]*=k,p[5]*=k,p[9]*=k,p[13]*=k,p[2]*=k,p[6]*=k,p[10]*=k,p[14]*=k,p[3]*=k,p[7]*=k,p[11]*=k,p[15]*=k,this},getPosition:function(h){return h===w&&(h=new dc),h.setFromMatrixColumn(this,3)},setPosition:function(p){var r=this.el;return r[12]=p.x,r[13]=p.y,r[14]=p.z,this},toArray:function(Y,H){Y===w&&(Y=[]),H===w&&(H=0);var l=this.el;return Y[H]=l[0],Y[H+1]=l[1],Y[H+2]=l[2],Y[H+3]=l[3],Y[H+4]=l[4],Y[H+5]=l[5],Y[H+6]=l[6],Y[H+7]=l[7],Y[H+8]=l[8],Y[H+9]=l[9],Y[H+10]=l[10],Y[H+11]=l[11],Y[H+12]=l[12],Y[H+13]=l[13],Y[H+14]=l[14],Y[H+15]=l[15],Y},determinant:function(){var z=this.el,c=z[0],Y=z[4],K=z[8],I=z[12],O=z[1],H=z[5],w=z[9],p=z[13],E=z[2],J=z[6],b=z[10],X=z[14],j=z[3],t=z[7],f=z[11],Q=z[15];return j*(+I*w*J-K*p*J-I*H*b+Y*p*b+K*H*X-Y*w*X)+t*(+c*w*X-c*p*b+I*O*b-K*O*X+K*p*E-I*w*E)+f*(+c*p*J-c*H*X-I*O*J+Y*O*X+I*H*E-Y*p*E)+Q*(-K*H*E-c*w*J+c*H*b+K*O*J-Y*O*b+Y*w*E)},copy:function(j){var W=this.el,O=j.el;return W[0]=O[0],W[1]=O[1],W[2]=O[2],W[3]=O[3],W[4]=O[4],W[5]=O[5],W[6]=O[6],W[7]=O[7],W[8]=O[8],W[9]=O[9],W[10]=O[10],W[11]=O[11],W[12]=O[12],W[13]=O[13],W[14]=O[14],W[15]=O[15],this},compose:function(b,C,g){var y=this.el,p=C._x,L=C._y,G=C._z,X=C._w,Z=p+p,K=L+L,T=G+G,B=p*Z,H=p*K,j=p*T,f=L*K,R=L*T,D=G*T,d=X*Z,S=X*K,t=X*T,M=g.x,i=g.y,Q=g.z;return y[0]=(1-(f+D))*M,y[1]=(H+t)*M,y[2]=(j-S)*M,y[3]=0,y[4]=(H-t)*i,y[5]=(1-(B+D))*i,y[6]=(R+d)*i,y[7]=0,y[8]=(j+S)*Q,y[9]=(R-d)*Q,y[10]=(1-(B+f))*Q,y[11]=0,y[12]=b.x,y[13]=b.y,y[14]=b.z,y[15]=1,this},decompose:function(){var n=new dc,X=new de;return function(f,x,$){var I=this.el,P=n.set(I[0],I[1],I[2]).length(),Q=n.set(I[4],I[5],I[6]).length(),Z=n.set(I[8],I[9],I[10]).length(),m=this.determinant();0>m&&(P=-P),f.x=I[12],f.y=I[13],f.z=I[14],X.copy(this);var v=1/P,g=1/Q,B=1/Z;return X.el[0]*=v,X.el[1]*=v,X.el[2]*=v,X.el[4]*=g,X.el[5]*=g,X.el[6]*=g,X.el[8]*=B,X.el[9]*=B,X.el[10]*=B,x.setFromRotationMatrix(X),$.x=P,$.y=Q,$.z=Z,this}}()});var Zg=Y.Math.Triangle=function(T,v,d){this.a=T!==w?T:new dc,this.b=v!==w?v:new dc,this.c=d!==w?d:new dc};u.assign(Zg,{barycoordFromPoint:function(){var Z=new dc,b=new dc,$=new dc;return function(u,q,y,S,N){Z.subVectors(S,q),b.subVectors(y,q),$.subVectors(u,q);var A=Z.dot(Z),C=Z.dot(b),B=Z.dot($),W=b.dot(b),f=b.dot($),V=A*W-C*C,t=N||new dc;if(0===V)return t.set(-2,-1,-1);var k=1/V,P=(W*B-C*f)*k,G=(A*f-C*B)*k;return t.set(1-P-G,G,P)}}()});var $o=Y.Math.Euler=function(E,Q,x,g,t){this.set(E,Q,x,g,t)};$o.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],$o.DefaultOrder="XYZ",$o.ReverseOrder=function(t){return t=t[2]+t[1]+t[0],t.toUpperCase()},u.defineProperties($o.prototype,{x:{get:function(){return this._x},set:function(O){this._x=O,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(G){this._z=G,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(B){this._order=B,this.onChangeCallback()}}}),u.assign($o.prototype,{set:function(z,f,V,J,v){return Cl(z)&&(v=V,J=f,V=z[2],f=z[1],z=z[0]),J?v&&(J=$o.ReverseOrder(J)):J="ZYX",this._x=z||0,this._y=f||0,this._z=V||0,this._order=J||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(w){return this._x=w._x,this._y=w._y,this._z=w._z,this._order=w._order,this.onChangeCallback(),this},setFromRotationMatrix:function(C,z,t){var h=Y.Math.clamp,d=C.el||C,b=d[0],$=d[4],P=d[8],W=d[1],u=d[5],N=d[9],E=d[2],y=d[6],m=d[10];return z=z||this._order,"XYZ"===z?(this._y=Math.asin(h(P,-1,1)),Math.abs(P)<.99999?(this._x=Math.atan2(-N,m),this._z=Math.atan2(-$,b)):(this._x=Math.atan2(y,u),this._z=0)):"YXZ"===z?(this._x=Math.asin(-h(N,-1,1)),Math.abs(N)<.99999?(this._y=Math.atan2(P,m),this._z=Math.atan2(W,u)):(this._y=Math.atan2(-E,b),this._z=0)):"ZXY"===z?(this._x=Math.asin(h(y,-1,1)),Math.abs(y)<.99999?(this._y=Math.atan2(-E,m),this._z=Math.atan2(-$,u)):(this._y=0,this._z=Math.atan2(W,b))):"ZYX"===z?(this._y=Math.asin(-h(E,-1,1)),Math.abs(E)<.99999?(this._x=Math.atan2(y,m),this._z=Math.atan2(W,b)):(this._x=0,this._z=Math.atan2(-$,u))):"YZX"===z?(this._z=Math.asin(h(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(-N,u),this._y=Math.atan2(-E,b)):(this._x=0,this._y=Math.atan2(P,m))):"XZY"===z?(this._z=Math.asin(-h($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(y,u),this._y=Math.atan2(P,b)):(this._x=Math.atan2(-N,m),this._y=0)):console.warn("unsupported order: "+z),this._order=z,t!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var P=new de;return function(M,c,Y){return P.makeRotationFromQuaternion(M),this.setFromRotationMatrix(P,c,Y)}}(),setFromVector3:function(f,c){return this.set(f.x,f.y,f.z,c||this._order)},reorder:function(){var K=new Dj;return function(q){return K.setFromEuler(this),this.setFromQuaternion(K,q)}}(),equals:function(E){return E._x===this._x&&E._y===this._y&&E._z===this._z&&E._order===this._order},fromArray:function(F){return this._x=F[0],this._y=F[1],this._z=F[2],F[3]!==w&&(this._order=F[3]),this.onChangeCallback(),this},toArray:function(J,j){return J===w&&(J=[]),j===w&&(j=0),J[j]=this._x,J[j+1]=this._y,J[j+2]=this._z,J[j+3]=this._order,J},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new dc(this._x,this._y,this._z)},onChange:function(i){return this.onChangeCallback=i,this},onChangeCallback:function(){}});var yb={ms_ac:function(X,T){for(var c=T.ms_ac,z=0;z<c.length;z++)qs(X,c[z])},ms_listener:function(F){F.addListeners=function(){for(var k=this,W=0;W<Sn.length;W++){var i=Sn[W];"wheel"===i&&!k.handle_wheel&&k.handle_mousewheel&&(k.handle_wheel=function(j){qo(k,j)}),k["handle_"+i]&&nb(i,k.getView(),k),!Q.isTouchable&&Q.mockTouch&&~function(C,H){var o;if("mousedown"===H?o="touchstart":"mouseup"===H?o="touchend":"mousemove"===H&&(o="touchmove"),C.___mockListeners||(C.___mockListeners={}),o&&!C.___mockListeners[o]){var t=function(V){V.stopPropagation(),Hc(V);var j=jm(V),k=new MouseEvent(H,{bubbles:!0,cancelable:!0,clientX:j.clientX,clientY:j.clientY,pageX:j.pageX,pageY:j.pageY});j.target.dispatchEvent(k)};C.___mockListeners[o]=t,C.addEventListener(o,t)}}(k.getView(),i)}},F.removeListeners=function(){for(var V=this,N=0;N<Sn.length;N++)V["handle_"+Sn[N]]&&Kp(Sn[N],V.getView(),V)}},ms_fire:function(t){t.mp=function(m,N,C){this.addPropertyChangeListener(m,N,C)},t.ump=function(d,g){this.removePropertyChangeListener(d,g)},t.fp=function(p,H,o,e,b){return this.firePropertyChange(p,H,o,e,b)},t.addPropertyChangeListener=function(l,Q,n){var m=this;m._62I||(m._62I=new vl),m._62I.add(l,Q,n)},t.removePropertyChangeListener=function(M,$){this._62I&&this._62I.remove(M,$)},t.firePropertyChange=function(_,Z,v,f,w){if(f){if(f(Z,v))return!1}else if(Z===v)return!1;var W=this,m=w||{};return m.property=_,m.oldValue=Z,m.newValue=v,m.source=W,m.data=W,W._62I&&W._62I.fire(m),W.onPropertyChanged&&W.onPropertyChanged(m),!0}},ms_attr:function(I){I.a=function(p,$){var A=this;if(2===arguments.length)A.setAttr(p,$);else{if(!ao(p))return A.getAttr(p);for(var W in p)A.setAttr(W,p[W])}return A},I.getAttr=function(A,l){if(l===w&&(l=1),this._attrObject&&A in this._attrObject)return this._attrObject[A];if(this.getImage){var T=this.getImage();if(vh(T)&&(T=Rq[T]),ao(T)&&"dataBindings"in T)for(var h=T.dataBindings,$=h.length-1;$>=0;$--){var i=h[$];if(i.attr===A){if("defaultValue"in i)return i.defaultValue;break}}}return l?J[A]:w},I.setAttr=function(J,_){var v=this;v._attrObject||(v._attrObject={});var i=v._attrObject[J];_===w?delete v._attrObject[J]:v._attrObject[J]=_,v.fp&&v.fp("a:"+J,i,_)&&v.onAttrChanged&&v.onAttrChanged(J,i,_)},I.getSerializableAttrs=function(){var z,b={};for(z in this._attrObject)b[z]=1;return b}},ms_bnb:function(L){L.getBodyColor=function(F){return F.s("body.color")},L.getBorderColor=function(s){return s.s("border.color")}},_51o:function(Q){Q.mi=function(X,r,c){this.addInteractorListener(X,r,c)},Q.umi=function(Y,J){this.removeInteractorListener(Y,J)},Q.fi=function(T){this.fireInteractorEvent(T)},Q.addInteractorListener=function(Z,x,k){var H=this;H._63I||(H._63I=new vl),H._63I.add(Z,x,k)},Q.removeInteractorListener=function(h,w){this._63I&&this._63I.remove(h,w)},Q.fireInteractorEvent=function(i){this._63I&&this._63I.fire(i)},Q.setInteractors=function(H){var g=this,s=g._interactors;s&&s.each(function(F){F.tearDown()}),Cl(H)&&(H=new ls(H)),g._interactors=H,H&&H.each(function(Q){Q.setUp()}),g.fp("interactors",s,H),g.invalidateSelection()},Q.getInteractors=function(){return this._interactors}},_49o:function(f){f._44O=t,f._45O=t,f.getTopPainters=function(){return this._44O},f.getBottomPainters=function(){return this._45O},f.addTopPainter=function(y){var P=this;P._44O||(P._44O=new ls),P._44O.contains(y)||(P._44O.add(y),P.redraw&&P.redraw())},f.removeTopPainter=function(E){var Z=this;Z._44O&&(Z._44O.remove(E),Z.redraw&&Z.redraw())},f.addBottomPainter=function(m){var j=this;j._45O||(j._45O=new ls),j._45O.contains(m)||(j._45O.add(m),j.redraw&&j.redraw())},f.removeBottomPainter=function(T){var l=this;l._45O&&(l._45O.remove(T),l.redraw&&l.redraw())},f._93db=function(z,F){var y=this;y._45O&&y._45O.each(function(D){D.draw?D.draw(z,F):D.call(y,z,F)
})},f._92db=function(P,O){var y=this;y._44O&&y._44O.each(function(x){x.draw?x.draw(P,O):x.call(y,P,O)})}},ms_sm:function(A){A.sm=function(){return this.getSelectionModel()},A.setSelectableFunc=function(g){this.sm().setFilterFunc(g)},A.getSelectableFunc=function(){return this.sm().getFilterFunc()},A.getSelectionModel=function(){var h=this;return h._selectionModel?h._selectionModel:h.dm().sm()},A.isSelectionModelShared=function(){return!this._selectionModel},A.setSelectionModelShared=function(A){var P=this,m=!P._selectionModel,Z=P.handleSelectionChange,I=P.dm();m!==A&&(P.invalidateSelection&&P.invalidateSelection(),A?(I.sm().ms(Z,P),P._selectionModel.ums(Z,P),P._selectionModel.dispose(),P._selectionModel=t):(I.sm().ums(Z,P),P._selectionModel=new dr(I),P._selectionModel.ms(Z,P)),P.onSelectionModelSharedChanged(),P.fp("selectionModelShared",m,A))},A.onSelectionModelSharedChanged=function(){var p=this;p.redraw(),p.invalidateSelection&&p.invalidateSelection()},A.removeSelection=function(){var o=this.dm();o.beginTransaction(),this.sm().toSelection().each(o.remove,o),o.endTransaction()},A.selectAll=function(){var P=this;P.sm().ss(P.dm().toDatas(function(Q){return P.isVisible(Q)&&P.isSelectable(Q)}))},A.isSelected=function(w){return this.sm().co(w)},A.isSelectedById=function(C){var D=this.dm().getDataById(C);return D?this.isSelected(D):!1},A.isSelectable=function(q){return this.sm().isSelectable(q)}},ms_tx:function(H){H._64I=0,H._65O=0,H.isScrollable=function(){return this.getWidth()<this._64I},H._40o=function(){return this.isScrollable()},H.getLogicalPoint=function(K){return fg(K,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},H.tx=function(G){return G===w?this.getTranslateX():(this.setTranslateX(G),void 0)},H.getTranslateX=function(){return this._65O},H.setTranslateX=function(I){var b=this,x=b.getWidth()-b._64I;x>I&&(I=x),I>0&&(I=0),I=y(I);var G=b._65O;b._65O=I,b.fp(_q,G,I)}},ms_ty:function(R){R._23Q=0,R._66O=0,R._41o=function(){return this.getHeight()<this._23Q},R.getLogicalPoint=function(I){return fg(I,this._canvas||this._view,this.tx?this.tx():0,this.ty())},R.ty=function(u){return u===w?this.getTranslateY():(this.setTranslateY(u),void 0)},R.getTranslateY=function(){return this._66O},R.setTranslateY=function(N){var d=this,M=d.getHeight()-d._23Q;M>N&&(N=M),N>0&&(N=0),N=y(N);var C=d._66O;d._66O=N,d.fp(Go,C,N)}},ms_txy:function(p){p._65O=0,p._66O=0,p.tx=function(R){return R===w?this.getTranslateX():(this.setTranslateX(R),void 0)},p.ty=function(k){return k===w?this.getTranslateY():(this.setTranslateY(k),void 0)},p.onTranslateEnded=function(){},p.setTranslate=function(A,l,C){var N=this;if(C=$k(C)){N._65I&&N._65I.stop(!0);var b=N.tx(),m=N.ty();C.action=function(T){N.setTranslate(b+(A-b)*T,m+(l-m)*T)},C._37o=function(){delete N._66I,delete N._65I,N.onTranslateEnded()},N._66I=1,N._65I=ze(C)}else N.tx(A),N.ty(l)},p.getTranslateX=function(){return this._65O},p.setTranslateX=function(N){var z=this;N=z.adjustTranslateX(N);var d=z._65O;z._65O=N,z.fp(_q,d,N)},p.getTranslateY=function(){return this._66O},p.setTranslateY=function(J){var X=this;J=X.adjustTranslateY(J);var c=X._66O;X._66O=J,X.fp(Go,c,J)},p.adjustTranslateX=function(U){return y(U)},p.adjustTranslateY=function(q){return y(q)},p.translate=function(d,W,r){this.setTranslate(this.tx()+d,this.ty()+W,r)},p.getLogicalPoint=function(u){var X=this;return fg(u,this._canvas||X._view,X.tx(),X.ty())}},ms_dm:function(j){j.dm=function(Y){return Y?(this.setDataModel(Y),void 0):this.getDataModel()},j.getDataModel=function(){return this._dataModel}},ms_lp:function(b){b.lp=function(v){return this.getLogicalPoint(v)}},ms_v:function(q){q._disabled=!1,q.setDisabled=function(d,G){var q=this,L=q._disabled;L!==d&&(L&&(ig(q._63O),delete q._63O),d&&(zg(q._view,q._63O=lo(G)),q.iv()),q._disabled=d,q.fp("disabled",L,d))},q.isDisabled=function(){return this._disabled},q.getDisabledDiv=function(){return this._63O},q.getView=function(){return this._view},q.addToDOM=function(w){var F=this,z=F.getView(),S=z.style;w=w||l.body,w.appendChild(z),S.left="0",S.right="0",S.top="0",S.bottom="0",b(i,"resize",function(){F.iv()}),F.iv()},q.getWidth=function(){return this._view.clientWidth},q.getHeight=function(){return this._view.clientHeight},q.setWidth=function(x){var z=this;z._view.style.width=x+yr,z.iv(),z.fp&&z.fp(Bh,t,x)},q.setHeight=function(c){var p=this;p._view.style.height=c+yr,p.iv(),p.fp&&p.fp(Lm,t,c)},q.setFocus=function(s){var K=this,L=K._currentEditor;return s&&L&&(L.getView&&(L=L.getView()),L.contains(s.target))?!1:(mg(K._view),K.endEditing&&K.endEditing(),K.fireViewEvent("focus"),!0)},q.iv=function(V){this.invalidate(V)},q.invalidate=function(z){var Z=this;Z._68I||(Z._68I=1,zs(Z.validate,Z,t,z),Z.onInvalidated&&Z.onInvalidated(),Z.fireViewEvent("invalidate"))},q.validate=function(){var b=this,p=b._view;if(b._68I&&(delete b._68I,p.parentNode))if(0===p.offsetWidth&&0===p.offsetHeight&&b._67I!==t)b._67I===w&&(b._67I=Q.reinvalidateCount),b._67I>0?b._67I--:b._67I=t,b.iv();else{b.fireViewEvent("beginValidate"),b.validateImpl(),b.onValidated&&b.onValidated(),b.fireViewEvent("validate");var x=b._63O;x&&(p.lastChild!==x&&(ig(x),zg(p,x)),Km(x,0,0,b.getWidth(),b.getHeight())),bc(b),Ri(b),Pf(b)}},q.layout=function(S,s,W,r){1===arguments.length?Km(this,S):Km(this,S,s,W,r)},q.addViewListener=function(O,s,u){var M=this;M._67O||(M._67O=new vl),M._67O.add(O,s,u)},q.removeViewListener=function(B,V){this._67O.remove(B,V)},q.fireViewEvent=function(P){var Z=this;Z._67O&&(vh(P)&&(P={kind:P}),Z._67O.fire(P)),Q.viewListener&&Q.viewListener(Z,P)}},ms_tip:function(F){F.setToolTipEnabled=function(W){var s=this;W?mc||s._13o||(s.enableToolTip(),s.fp("toolTipEnabled",!1,!0)):s._13o&&(s.disableToolTip(),s.fp("toolTipEnabled",!0,!1))},F.isToolTipEnabled=function(){return!!this._13o},F.enableToolTip=function(){var T=this;if(!mc&&!T._13o){T._13o=function(h){var _=T.getToolTip(h);_!=t?Q.toolTipContinual&&Q.isToolTipShowing()?yf(h,_):(sj(),zi={timeout:Z(Qb,pj),e:h,info:_}):sj()};var U=T.getView();b(U,iq,T._13o),b(U,"mouseleave",Q.hideToolTip)}},F.disableToolTip=function(){var X=this;if(X._13o){var f=X.getView();n(f,iq,X._13o),n(f,"mouseleave",Q.hideToolTip),delete X._13o}},F.getToolTip=function(X){var Q=this;if(Q.getDataAt){var s=Q.getDataAt(X);return s?s.getToolTip():t}return Q.getValue?Q.getValue():void 0}},_52o:function(d){d._zoom=1,d._29I=xq,d.zoomIn=function(j,m){this.setZoom(this._zoom*Zb,j,m)},d.zoomOut=function(M,n){this.setZoom(this._zoom/Zb,M,n)},d.zoomReset=function(W,G){this.setZoom(1,W,G)},d.scrollZoomIn=function(a){this.setZoom(this._zoom*bs,t,a)},d.scrollZoomOut=function(B){this.setZoom(this._zoom/bs,t,B)},d.pinchZoomIn=function(k){this.setZoom(this._zoom*ip,t,k)},d.pinchZoomOut=function(W){this.setZoom(this._zoom/ip,t,W)},d.adjustZoom=function(Y){return dd>Y?dd:Y>Gb?Gb:Y},d.getZoom=function(){return this._zoom},d.setZoom=function(r,L,t){var d=this;if(L=$k(L)){d._14o&&d._14o.stop(!0);var J=d._zoom;L.action=function(U){d._96O(J+(r-J)*U,t)},L._37o=function(){delete d._zooming,delete d._14o,d.onZoomEnded()},d._zooming=1,d._14o=ze(L)}else d._96O(r,t)},d._96O=function(S,Y){var V=this;if(S=V.adjustZoom(S),S!==V._zoom){V.validate();var Q=V._29I,u=V._zoom;0!==Q.width&&0!==Q.height&&(Y=Y?Y:{x:Q.x+Q.width/2,y:Q.y+Q.height/2},V.tx((Y.x-Q.x)*u-Y.x*S),V.ty((Y.y-Q.y)*u-Y.y*S)),V._zoom=S,V.fp("zoom",u,S)}}},ms_edge:function(X){X._2I=function(S){var C=this;C._44I||(C._44I=new ls),C._42I||(C._42I=new ls),C._44I.add(S),C._42I.add(S),C._20I()},X._4I=function(h){var D=this;D._44I||(D._44I=new ls),D._43I||(D._43I=new ls),D._44I.add(h),D._43I.add(h),D._20I()},X._16I=function(D){var m=this;m._44I.remove(D),m._42I.remove(D),m._44I.isEmpty()&&delete m._44I,m._42I.isEmpty()&&delete m._42I,m._20I()},X._18I=function(I){var W=this;W._44I.remove(I),W._43I.remove(I),W._44I.isEmpty()&&delete W._44I,W._43I.isEmpty()&&delete W._43I,W._20I()},X._20I=function(){var Q=this;if(delete Q._45I,!Q._44I||Q._44I.isEmpty())return delete Q._70O,void 0;var v;Q._44I.each(function(N){N.isLooped()&&(v||(v={}),v[N._id]||(Q._45I||(Q._45I=new ls),Q._45I.add(N),v[N._id]=N))}),v?(Q._70O=new ls,Q._44I.each(function(d){v[d._id]?"A"===v[d._id]||(v[d._id]="A",Q._70O.add(d)):Q._70O.add(d)})):Q._70O=Q._44I},X.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},X.getSourceAgentEdges=function(){return this._46I},X.getTargetAgentEdges=function(){return this._47I},X._1I=function(H){var W=this;W._46I||(W._46I=new ls),W._48I||(W._48I=new ls),W._46I.add(H),W._48I.add(H),W._19I()},X._3I=function(o){var z=this;z._47I||(z._47I=new ls),z._48I||(z._48I=new ls),z._47I.add(o),z._48I.add(o),z._19I()},X._15I=function(l){var O=this;O._46I.remove(l),O._48I.remove(l),O._46I.isEmpty()&&delete O._46I,O._48I.isEmpty()&&delete O._48I,O._19I()},X._17I=function(M){var R=this;R._47I.remove(M),R._48I.remove(M),R._47I.isEmpty()&&delete R._47I,R._48I.isEmpty()&&delete R._48I,R._19I()},X._19I=function(){var T=this;delete T._49I;var o=T._48I;if(o&&!o.isEmpty()){var V={};o.each(function(m){V[m._id]?T._49I||(T._49I=new ls):V[m._id]=m}),T._49I?o.each(function(p){V[p._id]&&(T._49I.add(p),delete V[p._id])}):T._49I=o}},X.getLoopedEdges=function(){return this._45I},X.getEdges=function(){return this._70O},X.getAgentEdges=function(){return this._49I},X.getSourceEdges=function(){return this._42I},X.getTargetEdges=function(){return this._43I},X._8I=function(){this._70O&&this._70O.each(function(g){g._7I()})}}};oi(Q,{getVersion:function(){return"7.0.8"}},!0),oi(Q,{numberDigits:5,crossOrigin:"",baseZIndex:w,isTouchable:mc,devicePixelRatio:i.devicePixelRatio?i.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:p.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return lg},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:mc?20:1,animDuration:200,animEasing:function(k){return k*k},labelColor:Nd,labelSelectColor:Yc,labelFont:"12px arial, sans-serif",widgetIndent:mc?30:20,widgetRowHeight:mc?30:20,widgetHeaderHeight:mc?32:22,widgetTitleHeight:mc?34:24,scrollBarColor:gj,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:mc?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Dh,intersectionLineLine:Kl,isEnter:sf,isEsc:Fd,isDelete:Eg,isSpace:Kb,isLeft:_g,isUp:ah,isRight:El,isDown:Fq,getTarget:Ck,isString:vh,isNumber:Td,isBoolean:mi,isArray:Cl,isSelectAll:xr,isFunction:Jm,isObject:ao,getPropertyValue:Oe,setPropertyValue:jp,addMethod:oi,isMobile:function(){var t;return function(){return t!==w?t:(t=!1,function(w){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(w)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(w.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||i.opera),t)}}(),createGradient:function(T,j,y,F,E,J,b,M){var i=yk[j];return i(T,y,F,E,J,b,M)},appendToScreen:function(Q){Q=Q.getView?Q.getView():Q,(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement||l.body).appendChild(Q)},encodeString:function(E){return Y.Math.encodeBase64(E,Q.encodeStringKey)},decodeString:function(Z){return Y.Math.decodeBase64(Z,Q.encodeStringKey)},findView:function(c){var o=function(V,d){var v=d._ht;v&&V.push(v);var w=d.children,c=w.length;if(c)for(var i=0;c>i;i++)o(V,w[i])},K=[];o(K,l.body);var I=function(E,w){for(var T="2d"===w?Uh.GraphView:Tn.Graph3dView,R=0,C=E.length;C>R;R++)if(E[R]instanceof T)return K[R];return null};return"all"===c?K:"2d"===c?I(K,"2d"):"3d"===c?I(K,"3d"):I(K,"3d")||I(K,"2d")},toggleFullscreen:function(X){var C=X.getView();if(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement)l.exitFullscreen?l.exitFullscreen():l.msExitFullscreen?l.msExitFullscreen():l.mozCancelFullScreen?l.mozCancelFullScreen():l.webkitExitFullscreen&&l.webkitExitFullscreen();else{var J=!0;if(X.isSelfViewEvent){var x=X.getX(),m=X.getY(),h=X.getWidth(),f=X.getHeight(),A=C.style.background,y=C.style.backgroundColor;A||y||(C.style.backgroundColor="white"),C.requestFullscreen?C.requestFullscreen():C.msRequestFullscreen?C.msRequestFullscreen():C.mozRequestFullScreen?C.mozRequestFullScreen():C.webkitRequestFullscreen&&C.webkitRequestFullscreen();var c=setInterval(function(){if(C!==(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement))clearInterval(c),X.setX(x),X.setY(m),X.setWidth(h),X.setHeight(f),X._fullscreen=!1,C.style.oldBackgroundColor=y,X.iv();else{var $=Y.Default.getWindowInfo();(J||$.width!==X.getWidth()||$.height!==X.getHeight())&&(X.setX($.left),X.setY($.top),X.setWidth($.width),X.setHeight($.height),X._fullscreen=!0,X.iv(),J=!1)}},500)}else{var t=C.style.left,w=C.style.top,h=C.style.width,f=C.style.height,A=C.style.background,y=C.style.backgroundColor;A||y||(C.style.backgroundColor="white"),C.requestFullscreen?C.requestFullscreen():C.msRequestFullscreen?C.msRequestFullscreen():C.mozRequestFullScreen?C.mozRequestFullScreen():C.webkitRequestFullscreen&&C.webkitRequestFullscreen();var c=setInterval(function(){if(C!==(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement))clearInterval(c),C.style.left=t,C.style.top=w,C.style.width=h,C.style.height=f,C.style.oldBackgroundColor=y,X.iv();else{var M=Y.Default.getWindowInfo();(J||M.width!==X.getWidth()||M.height!==X.getHeight())&&(Km(X),J=!1)}},500)}}},appendTimeStamp:function(p){return p},setCompType:function(t,S){Jm(S)||ao(S)?xm[t]=S:Hn(t)},getCompType:function(u){var Z=xm[u];return Z===w&&Im.test(u)&&Hn(u),Z},getCompTypeMap:function(){return xm},drawCompType:function(i,I,s,E,Z,x){i(I,s,E,Z,x)},numberListener:function(){var h={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(E){var V=E.keyCode;h[V]||65===V&&Q.isCtrlDown(E)||86===V&&Q.isCtrlDown(E)||67===V&&Q.isCtrlDown(E)||88===V&&Q.isCtrlDown(E)||V>=35&&40>=V||(E.shiftKey||48>V||V>57)&&(96>V||V>105)&&E.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(C){var $=C.target.tagName;("DIV"===$||"CANVAS"===$)&&!(Q.ignoreKeyCodes.indexOf(C.keyCode)>=0)&&("keydown"!==C.type||_g(C)||El(C)||ah(C)||Fq(C)||Eg(C)||65===C.keyCode&&(C.metaKey||C.ctrlKey))&&(C.preventDefault(),C.preventManipulation&&C.preventManipulation())},getWindowInfo:function(){var r=l.documentElement,I=r&&(r.scrollLeft||r.scrollTop)?r:l.body;return{target:I,left:I.scrollLeft,top:I.scrollTop,width:i.innerWidth||I.clientWidth,height:i.innerHeight||I.clientHeight}},isDragging:function(){return!!lg},isLeftButton:function(m){return mc?!0:0===m.button},isMiddleButton:function(q){return mc?!1:q&&(1===q.button||4&(q.buttons||0))},isRightButton:function(Z){return mc?!1:Z&&(2===Z.button||2&(Z.buttons||0))},isInput:function(d){if(!d)return!1;var Z=d.tagName;return"INPUT"===Z||"TEXTAREA"===Z||"SELECT"===Z},getTouchCount:function(D){return mc?D.touches.length:1},isDoubleClick:function(){function R(u){u.details=0,u.timeout=null,u.lastPoint=null}var M={};return If=new G,Ve=If.getTime(),function(s){if(s.touches&&s.touches.length>1)return!1;var H=s.button==t?"":s.button,A=s.type+H,W=A+"_isDoubleClick",q=M[A];if(q||(q=M[A]={details:0,timeout:null,lastPoint:null}),s[W]===w){s[W]=!0;var S=ad(s);q.timeout&&(o(q.timeout),q.timeout=null),q.lastPoint&&ro(q.lastPoint,S)>Q.doubleClickRange&&R(q),q.lastPoint=S,q.details++,q.timeout=Z(function(){R(this)}.bind(q),500)}return 2===q.details}}(),isShiftDown:function(k){return k?k.shiftKey:ar["16"]},isCtrlDown:function(M){return M?Cc?M.metaKey:M.ctrlKey:Cc?ar["91"]:ar["17"]},getClientPoint:function(H){return mc&&(H=jm(H)),{x:H.clientX,y:H.clientY}},isMouseEvent:function(n){return n instanceof MouseEvent||0===n.type.indexOf("mouse")},getTargetElement:function(n){if(Q.isMouseEvent(n)||!l.elementFromPoint)return n.target;var Z=xf(n);return l.elementFromPoint(Z.x,Z.y)},getPagePoint:function(W){return mc&&(W=jm(W)),{x:W.pageX,y:W.pageY}},createObject:function(R,D){var e=new R;for(var I in D){var f=D[I];if(Jm(f))e[I]=f;else if(0===I.indexOf("s:"))e.s(I.substr(2),D[I]);else if(0===I.indexOf("a:"))e.a(I.substr(2),D[I]);else{var c=Wd(I),f=D[I];e[c]?(e[c](f),"setToolTip"===c&&e.enableToolTip&&e.enableToolTip()):e[I]=f}}return e},setImage:function(b,X,y,x){var u=arguments.length;4===u?Sp(b,x,X,y):2===u?vh(X)?Sp(b,X):Lj(b,X):1===u&&Sp(b,b)},getImage:function(v,l,S){var f;if(v==t)return t;if(ao(v)?f=v:(f=Rq[v],v&&f===w&&(mq&&mq[v]||Sp(v,v))),l&&f&&f.tagName){var s;s="override"===S?"colors_override":"override_rgb"===S?"colors_override_rgb":"override_a"===S?"colors_override_a":"colors",f[s]||(f[s]={__count__:0});var d=f[s][l];return d||(f[s].__count__>Q.imageCacheThreshold&&(f[s]={__count__:0}),d=Jl(f,be(l),f.width,f.height,S),f[s][l]=d,f[s].__count__++),d}return f},isImageComplete:function($,x,H){var v=ir($);if(!v)return!1;if(v.tagName)return v.complete;for(var t,$,B,J=v.comps,V=!0,D=0,C=J.length;C>D;D++)if(t=J[D],B=t.type,"image"===t.type){$=t.name,$&&$.func&&($=bf($,x));var f=Vl($,x,H);if(!f){V=!1;break}}else if(Im.test(B)&&Q.getCompType(B)===w){V=!1,Hn(B);break}return V},getId:function(){var M=1;return function(){return++M}}(),callLater:function(F,U,W,p){var A=function(){F.apply(U,W)};return p?Z(A,p):i.requestAnimationFrame(A)},cancelLater:function(O,l){l?o(O):i.cancelAnimationFrame(O)},clone:function(O){if(null==O||"object"!=typeof O)return O;if(O instanceof Date){var D=new Date;return D.setTime(O.getTime()),D}if(O instanceof Array){for(var D=[],d=0,h=O.length;h>d;d++)D[d]=kr(O[d]);return D}if(O instanceof ls){for(var D=new ls,d=0,h=O.length;h>d;d++)D.set(d,kr(O.get(d)));return D}if(O instanceof Ro)return O;if(O instanceof u){var D={};for(var o in O)O.hasOwnProperty(o)&&(D[o]=kr(O[o]));return D}return O},callWhenLoaded:function(O,e){e=e||100;var X=rq(O,e);eq||(eq={}),eq[X]={tick:X,cb:O,delay:e}},beforeLoadURL:function(L,V){if(eq){var u={};for(var V in eq){var w=eq[V];o(w.tick);var C=rq(w.cb,w.delay);u[C]={tick:C,delay:w.delay,cb:w.cb}}eq=u}return Q.convertURL?Q.convertURL(L,V):L},convertURL:function(D){return D},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return Q.getImage("default_blank")},resizeImagePOT:function(Z,o){if(!Z||!Z.tagName)return Z;var N=Z.width,x=Z.height;if(!N||!x)return Z;if(Qr.isPOT(N)&&Qr.isPOT(x)&&(!o||N===x))return Z;var A,M;o?M=A=Qr.nearestPOT(Math.min(N,x)):(A=Qr.nearestPOT(N),M=Qr.nearestPOT(x));var g=Yh(),V=g.getContext("2d");return ik(g,A,M,1),V.drawImage(Z,0,0,N,x,0,0,A,M),g},sortFunc:function(h,Q){if(h===Q)return 0;if(h==t&&Q!=t)return 1;if(h!=t&&Q==t)return-1;if(h==t&&Q==t)return 0;var S,G=typeof h,B=typeof Q;return G===Rl&&B===Rl?S=h.localeCompare(Q):G===Aq&&B===Aq&&(S=h-Q),S===w&&(S=(""+h).localeCompare(""+Q)),S>0?1:0>S?-1:0},getClassMap:function(){return Bk},getClass:function(s){if(vh(s)){var F,e=Bk[s];if(!e){F=s.split("."),e=i;for(var I=0;I<F.length;I++)e=e[F[I]];Bk[s]=e}return e}return s},def:function(M,d,n){var p,v,$,i=function(){};if(i.prototype=d.prototype,p=new i,vh(M)){if(Bk[M])throw"'"+M+"' already defined";$=Nb(M),p.getClassName=function(){return M}}else $=M;if(p.constructor=$,p.getClass=function(){return $},p.getSuperClass=function(){return d},n)for(v in n)yb[v]&&yb.hasOwnProperty(v)?yb[v](p,n):ti(p,n,v);$.prototype=p,$.superClass=d.prototype},startAnim:function(){var S=function(w){w.duration&&(w.startTime=Lq()),w.timeId=zs(w.tick,t,t,w.interval)};return function(l){return l=kr(l),l.easing=l.easing||Q.animEasing,l.duration||l.frames||(l.duration=Q.animDuration),l.t=0,l.duration?l.interval=0:(l.frame=0,l.interval=l.interval||10),l.tick=function(){if(l.duration){var e=(Lq()-l.startTime)/l.duration;if(e>1&&(e=1),l.t=e,l.action(l.easing(e),e),!l.isRunning())return;1===e?l.stop():l._isPaused||(l.timeId=zs(l.tick))}else{if(l.frame++,e=l.t=l.frame/l.frames,l.action(l.easing(e),e),!l.isRunning())return;l.frame<l.frames?l._isPaused||(l.timeId=zs(l.tick,t,t,l.interval)):l.stop()}},l.resume=function(){l._isPaused&&(delete l._isPaused,l.duration?l.t<1&&(l.startTime=Lq()-l.duration*l.t,l.timeId=zs(l.tick)):l.frame<l.frames&&(l.timeId=zs(l.tick,t,t,l.interval)))},l.pause=function(){Jc(l.timeId,!l.duration),l._isPaused=!0},l.isPaused=function(){return this._isPaused},l.stop=function(D){l.isRunning()&&(Jc(l.timeId,!l.duration),delete l.timeId,l.duration?l.t<1&&D&&(l.t=1,l.action(l.easing(1),1)):l.frame<l.frames&&D&&(l.frame=l.frames,l.action(l.easing(1),1)),l._37o&&l._37o(),l.finishFunc&&l.finishFunc())},l.isRunning=function(){return l.timeId!=t},l.delay?zs(S,t,[l],l.delay):S(l),l}}(),getTextSize:function(){var X={},k=l?Yh().getContext("2d"):t;return function(O,e){k.font=O?O:Vq;var R=X[k.font];return R||(R=2*k.measureText("e").width+4,X[k.font]=R),{width:k.measureText(e).width+4,height:R}}}(),drawText:function(H,S,u,R,Z,l,P,Q,x,T){if(S!=t){var c=Rj(u,S),B={};B.y=T&&T!==Xf?T===_j?l+c.height/2:l+Q-c.height/2:l+Q/2,B.x=x&&x!==Ug?x===af?Z+P-c.width/2:Z+P/2:Z+c.width/2,ii(H,S,B,u,R)}},getDistance:function(y,K){var W=y.length;return K?3===W?N(s(y[0]-K[0])+s(y[1]-K[1])+s(y[2]-K[2])):2===W?N(s(y[0]-K[0])+s(y[1]-K[1])):y.z===w?N(s(K.x-y.x)+s(K.y-y.y)):N(s(K.x-y.x)+s(K.y-y.y)+s(K.z-y.z)):3===W?N(s(y[0])+s(y[1])+s(y[2])):2===W?N(s(y[0])+s(y[1])):void 0},brighter:function(p,S){return 0>S&&(S=-S),gd(p,S?S:40)},darker:function(N,n){return n>0&&(n=-n),gd(N,n?n:-40)},unionPoint:function(A,Z){if(!A)return t;if(2===arguments.length)return A&&Z?{x:a(A.x,Z.x),y:a(A.y,Z.y),width:c(A.x-Z.x),height:c(A.y-Z.y)}:t;var e=A;if(e._as&&(e=e._as),e.length===w)return t;var B=e.length;if(0>=B)return t;for(var R=1,I=e[0],$={x:I.x,y:I.y,width:0,height:0};B>R;R++){I=e[R];var U=a($.x,I.x),E=q($.x+$.width,I.x),j=a($.y,I.y),H=q($.y+$.height,I.y);$.x=U,$.y=j,$.width=E-U,$.height=H-j}return $},unionRect:function(e,O){if(e&&!O)return kr(e);if(!e&&O)return kr(O);if(e&&O){var I={x:a(e.x,O.x),y:a(e.y,O.y)};return I.width=q(e.x+e.width,O.x+O.width)-I.x,I.height=q(e.y+e.height,O.y+O.height)-I.y,I}return t},containsPoint:function(B,e,p,J){if(J!=t&&1!==J){var H=B.x+B.width/2,O=B.y+B.height/2;B={x:H-B.width/2*J,y:O-B.height/2*J,width:B.width*J,height:B.height*J}}if(p){var L=B.width/2,_=B.height/2,k=d(-p),h=I(-p),K=e.x-B.x-L,Z=e.y-B.y-_;return e={x:h*K-k*Z,y:k*K+h*Z},Mf({x:-L,y:-_,width:B.width,height:B.height},e)}return!(!B||e.x<B.x||e.y<B.y||e.x>B.x+B.width||e.y>B.y+B.height)},containsRect:function(R,g){if(!R||!g)return!1;var M=g.x,c=g.y,N=g.width,F=g.height,I=R.width,s=R.height;if(0>(I|s|N|F))return!1;var Y=R.x,D=R.y;if(Y>M||D>c)return!1;if(I+=Y,N+=M,M>=N){if(I>=Y||N>I)return!1}else if(I>=Y&&N>I)return!1;if(s+=D,F+=c,c>=F){if(s>=D||F>s)return!1}else if(s>=D&&F>s)return!1;return!0},intersectsRect:function(h,o){if(!h||!o)return!1;var $=o.width,T=o.height,p=h.width,d=h.height;if(0>=p||0>=d||0>=$||0>=T)return!1;var A=o.x,a=o.y,y=h.x,I=h.y;return p+=y,d+=I,$+=A,T+=a,p>A&&d>a&&$>y&&T>I},intersection:function(F,n){if(!F||!n)return t;var S=n.x,c=n.y,X=F.x,h=F.y,Q=S,A=c,s=X,m=h;return Q+=n.width,A+=n.height,s+=F.width,m+=F.height,X>S&&(S=X),h>c&&(c=h),Q>s&&(Q=s),A>m&&(A=m),Q-=S,A-=c,0>=Q||0>=A?t:{x:S,y:c,width:Q,height:A}},grow:function(Q,y,f){f===w&&(f=y),Q.x-=y,Q.y-=f,Q.width=Q.width+2*y,Q.height=Q.height+2*f},getScreenPoint:function(I,G,p,Y,A,T,n){var $=p.getBoundingClientRect(),y=I*(T||1)-p.scrollLeft+(Y||0),H=G*(n||1)-p.scrollTop+(A||0),w=Qc(p,!1);if(w){var N=new dc(y,H,0);return N.applyMatrix4(w),console.log(N),{x:N.x,y:N.y}}return{x:y+$.left,y:H+$.top}},getLogicalPoint:function(F,R,Y,c,D,i){var f,N,h=R.getBoundingClientRect();F.target?(Sf(F)?Cc?ar["91"]=!0:ar["17"]=!0:Cc?ar["91"]=!1:ar["17"]=!1,ar["16"]=Dc(F)?!0:!1,F=mc?jm(F):F,f=F.clientX,N=F.clientY):(f=F.x,N=F.y);var Q=Qc(R,!0);if(Q){var X=new dc(f,N,0);X.applyMatrix4(Q);do{if(Math.abs(X.z)<=1e-6)break;var A=new dc(f,N,1);if(A.applyMatrix4(matrix),Math.abs(A.z)<=1e-6){X=A;break}if(A.sub(X),Math.abs(A.z)<=1e-6)break;X.addScaledVector(A,-X.z/A.z)}while(!1);return{x:(X.x+R.scrollLeft-(Y||0))/(D||1),y:(X.y+R.scrollTop-(c||0))/(i||1)}}return{x:(f-h.left+R.scrollLeft-(Y||0))/(D||1),y:(N-h.top+R.scrollTop-(c||0))/(i||1)}},removeHTML:function(){var b;return function(r){return r&&r.getView&&(r=r.getView()),r&&r.parentNode?b===r?!0:(b=r,r.parentNode.removeChild(r),b=t,!0):!1}}(),getToolTipDiv:function(){if(!uc){uc=wc(),oj=wc();var w=uc.style;Q.baseZIndex!=t&&(w.zIndex=F(Q.baseZIndex)+3+""),w.whiteSpace="nowrap",w.color=Q.toolTipLabelColor,w.background=Q.toolTipBackground,w.font=Q.toolTipLabelFont,w.padding="5px",w.boxShadow="0px 0px 3px "+Q.toolTipShadowColor}return uc},isToolTipShowing:function(){return uc&&uc.parentNode?!0:oj&&oj.parentNode?!0:!1},hideToolTip:function(){ig(uc),ig(oj),eo()},showToolTip:function(J,$){if(!J||$==t)return sj(),void 0;Q.getToolTipDiv();var r,f;if($.html?($=$.html,r=oj,ig(uc)):(r=uc,ig(oj)),f=r.style,r.innerHTML=$,r.parentNode||Y.Default.appendToScreen(r),J.target){J=xf(J);var h=Gp(),e=J.x,c=J.y,H=mc?60:12;if(mc){var y=r.getBoundingClientRect();f.left=e-y.width/2+yr,f.top=c-y.height-H<h.top?c+H+yr:c-y.height-H+yr}else{f.left=e+H+yr,f.top=c+H+yr;var y=r.getBoundingClientRect();y.left+y.width>h.width&&(f.left=e-H-y.width+yr),y.top+y.height>h.height&&(f.top=c-H-y.height+yr),y.left<0&&(f.left=e+H+yr),y.top<0&&(f.top=c+H+yr)}}else f.left=J.x+yr,f.top=J.y+yr;eo()},startDragging:function(T,c,O){O==w&&(O=!0),T!==lg&&(lg?O&&(mc?lg.handleWindowTouchEnd(c):lg.handleWindowMouseUp(c)):mc?(b(i,zm,Wo),b(i,as,al)):(b(i,iq,Wh),b(i,mj,$p)),lg=T)},getImageMap:function(){return Rq},toBoundaries:function(Z,R,y,I){var X=[];return hr(Z,R,y,I).forEach(function(h){var Q=[];h.forEach(function(t){Q.push(t.x,t.y)}),X.push(Q)}),X},getCurrentKeyCodeMap:function(){return ar},drawCenterImage:function(W,o,r,z,C,S,x,Z){!C&&S&&S.isSelfViewEvent&&(C=S);var Y=To(o,C,S),p=wb(o,C,S);qc(W,o,y(r-Y/2),y(z-p/2),Y,p,C,S,x,Z)},drawStretchImage:function(P,e,k,R,t,j,p,f,V,u,T,b){!f&&V&&V.isSelfViewEvent&&(f=V);var U,H=To(e,f,V,j),l=wb(e,f,V,p);"uniform"===k?(U=a(j/H,p/l),H*=U,l*=U,R+=y((j-H)/2),t+=y((p-l)/2),j=H,p=l):"centerUniform"===k&&((H>j||l>p)&&(U=a(j/H,p/l),H*=U,l*=U),R+=y((j-H)/2),t+=y((p-l)/2),j=H,p=l);var w=P.interactiveInfo;if(w){var K;if(K="center"===k?{x:R+j/2-H/2,y:t+p/2-l/2,width:H,height:l}:{x:R,y:t,width:j,height:p},w.rect){var g=w.compInfos,r=g.length;r&&(g[r-1].rect.image=e)}else w.rect=K}if("center"===k){var N=T!==!1&&(H>j||l>p);N&&(P.save(),P.beginPath(),P.rect(R,t,j,p),P.clip()),qc(P,e,R+j/2-H/2,t+p/2-l/2,H,l,f,V,u,b),N&&P.restore()}else qc(P,e,R,t,j,p,f,V,u,b)},toCanvas:function(F,X,G,Y,Z,B,s,y,e){F=ir(F,s),X=X||To(F,Z),G=G||wb(F,Z);var J=Yh(),K=ck(J);return y?(ik(J,X,G,y),K.scale(y,y)):ik(J,X,G,1),Mi(K,F,Y,0,0,X,G,Z,B,s,e),F&&F.clampToEdge&&(J.clampToEdge=F.clampToEdge),K.restore(),J},toGrayColor:function(V){if(!V)return V;var h=Ei(V),Z=y(.299*h[0]+.587*h[1]+.114*h[2]);return"rgba("+Z+","+Z+","+Z+","+h[3]/255+")"},createGradientImage:function(q,V,B,J){for(var n=["L",0,0,q,0,1,0,0,1,0,0],X=0,H=Math.min(V.length,B.length);H>X;X++)n.push(B[X],V[X]);var U=Y.Default.toCanvas({width:q,height:q,clampToEdge:!0,comps:[{type:"shape",rotation:J||0,points:[0,0,q,0,q,q,0,q],background:"#ffffff",gradientPack:n}]});return U},createElement:function(H,g,F,s){var y=l.createElement(H);return hb(y,g||p.widgetBorder,2),y.style.font=F?F:Vq,s!=t&&(y.value=s),Q.onElementCreated&&Q.onElementCreated(y),y},containedInView:function(x,U){var b=Le(U).getBoundingClientRect();return Mf({x:b.left,y:b.top,width:b.width,height:b.height},ad(x))},isIsolating:function(){return xb>0},setIsolating:function(m){m?xb++:xb--},getMSMap:function(){return yb},stringify:function(V,M,y){var d=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var K=JSON.stringify(V,function(K,s){return"function"==typeof s?"__ht__"+(s.__ht__||s.toString()):Td(s)?fs(s):s instanceof Y.List?"__ht__list"+(s.__ht__list||Q.stringify(s._as)):s},M==t?2:M);return Date.prototype.toJSON=d,y&&(K="__ht__encode"+Q.encodeString(K)),K},parse:function(X){return vh(X)?"__ht__encode"!=X.substr(0,12)||(X=Q.decodeString(X.substr(12)),vh(X))?JSON.parse(X,function(j,s){if(vh(s))if("__ht__function"==s.substr(0,14)){var U=s.indexOf("{")+1,o=s.lastIndexOf("}"),e=s.indexOf("(")+1,J=s.indexOf(")");if(U&&o&&e&&J){var t=new Function(s.substring(e,J),s.substring(U,o));return t.__ht__=s.substr(6),t}}else{if("__ht__date"==s.substr(0,10))return new Date(F(s.substr(10)));if("__ht__list"===s.substr(0,10))return new ls(Q.parse(s.substr(10)))}return s}):X:X},loadJS:function(K,x){x&&K.push(x);var t=K.shift();if(Cl(t))K=t.contact(K),Q.loadJS(K);else if(Jm(t))t(),Q.loadJS(K);else if(vh(t)){var D=l.createElement("script");D.onload=function(){Q.loadJS(K)},D.setAttribute("src",t),l.getElementsByTagName("head")[0].appendChild(D)}else K.length&&Q.loadJS(K)},extendClass:function(S,W){var d=S.prototype;for(var z in W)yb[z]&&yb.hasOwnProperty(z)?yb[z](d,W):d[z]=W[z]},toRoundedCorner:function(){function R(F,T,l){F.x=T.x,F.y=T.e||l,F.z=T.y}var g=new dc,M=new dc,u=new dc,G=new dc;return function(P,$){var O,d=0;P.getPoints&&(d=P.getElevation(),P=P.getPoints()),O=P instanceof ls?P:new ls(P);var C=O.size();if(0>=$)return{points:O};var Y=new ls,X=new ls,I=O.get(0);R(g,I,d),Y.add(I),X.add(1);for(var q=1;C>q;q++)if(C>q+1){var U=O.get(q),y=O.get(q+1);R(M,U,d),R(u,y,d),G.subVectors(g,M).setLength(Math.min(.99*G.length(),$)).add(M),U.e!==w||I.e!==w?Y.add({x:G.x,y:G.z,e:G.y}):Y.add({x:G.x,y:G.z}),Y.add(U),G.subVectors(u,M).setLength(Math.min(.99*G.length(),$)).add(M),U.e!==w||y.e!==w?Y.add(I={x:G.x,y:G.z,e:G.y}):Y.add(I={x:G.x,y:G.z}),g.copy(G),X.addAll([2,3])}else Y.add(O.get(q)),X.add(2);return{points:Y,segments:X}}}(),toColorData:Ei,setCanvas:ik,createDiv:wc,createDisabledDiv:lo,createView:yo,createCanvas:Yh,appendChild:zg,initContext:ck,checkLoadingImage:bc,translateAndScale:ko,layout:Km,getPosition:Tf,drawPoints:ps,drawRoundRect:Ee,drawBorder:Lh,setFocus:mg,getter:Zl,setter:Wd,isEmptyObject:wf,cameraPriority:function(){var I={skybox:0,main:1e4,top:1e7};return u.seal(u.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return I.skybox
},set:function(W){if(W>=I.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");I.skybox=Number(W)}},main:{configurable:!1,enumerable:!1,get:function(){return I.main},set:function(R){if(R<=I.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(R>=I.top)throw new RangeError("Main camera must have lower priority than the top camera.");I.main=Number(R)}},top:{configurable:!1,enumerable:!1,get:function(){return I.top},set:function(W){if(W<=I.main)throw new RangeError("Top camera must have higher priority than the main camera.");I.top=Number(W)}}}))}()},!0),oi(R,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Wj=Q.disabledOpacity,pj=Q.toolTipDelay,td=Q.devicePixelRatio,Pq=Q.autoMakeVisible,Qe=Q.autoHideScrollBar,mm=Q.imageGradient,yf=Q.showToolTip,sj=Q.hideToolTip,Wk=Q.dashPattern,aj=Q.lineCap,Ll=Q.lineJoin,hj=Q.labelColor,Ef=Q.labelSelectColor,Vq=Q.labelFont,co=Q.widgetIndent,Nf=Q.widgetRowHeight,pq=Q.widgetHeaderHeight,ch=Q.widgetTitleHeight,ih=Q.scrollBarColor,Wi=Q.scrollBarSize,Uo=Q.scrollBarTimeout,fl=Q.scrollBarMinLength,Ce=Q.scrollBarInteractiveSize,Zb=Q.zoomIncrement,bs=Q.scrollZoomIncrement,ip=Q.pinchZoomIncrement,Gb=Q.zoomMax,dd=Q.zoomMin,dq=Q.createObject,Hc=Q.preventDefault,Vb=Q.setImage,ir=Q.getImage,Vl=Q.isImageComplete,ld=Q.drawCenterImage,Mi=Q.drawStretchImage,Re=Q.getId,zs=Q.callLater,Jc=Q.cancelLater,Uc=Q.sortFunc,kr=Q.clone,Nb=Q.getClass,ze=Q.startAnim,Cj=Q.brighter,_e=Q.darker,rd=Q.drawText,Rj=Q.getTextSize,Ir=Q.isLeftButton,He=Q.isMiddleButton,Cf=Q.isRightButton,Jh=Q.getTouchCount,fo=Q.isDoubleClick,Dc=Q.isShiftDown,Sf=Q.isCtrlDown,ad=Q.getClientPoint,xf=Q.getPagePoint,ro=Q.getDistance,Qm=Q.unionPoint,me=Q.unionRect,Mf=Q.containsPoint,lk=Q.containsRect,Hr=Q.intersectsRect,Ak=Q.intersection,Gp=Q.getWindowInfo,Wn=Q.grow,fg=Q.getLogicalPoint,Em=Q.getScreenPoint,Rr=Q.startDragging,ig=Q.removeHTML,Io=Q.createElement,Yq=Q.segmentResolution,lr=Q.shapeResolution,Nh=Q.shapeSide,Tr=Q.def,uk=function(j,B,b){Tr(g+"."+j,B,b)},ol=function(x,u){x.childNodes.forEach(function(q){u(q),ol(q,u)})};oi(Q,{toolTipLabelColor:hj,toolTipLabelFont:Vq,toolTipBackground:p.toolTipBackground,toolTipShadowColor:gj,debugTipLabelFont:Vq,debugTipLabelColor:hj,debugTipBackground:p.toolTipBackground,drawBreakableText:ff,setDevicePixelRatio:function(z){td=Q.devicePixelRatio="number"==typeof z?z:i.devicePixelRatio,ol(l.body,function(w){var A=w._ht;A&&A._canvas&&(ik(A._canvas,A.getWidth(),A.getHeight()),A.redraw?A.redraw():A.iv())})}},!0);var ee=1e-6,vk="undefined"!=typeof Uint16Array?Uint16Array:Array,cc="undefined"!=typeof Float32Array?Float32Array:Array,Sb=function(j,v,x){var D=[j[0]-v[0],j[1]-v[1],j[2]-v[2]];if(x){var T=ro(D);T>0&&(D[0]/=T,D[1]/=T,D[2]/=T)}return D},en=function(){var l="charCodeAt",c=2*(2*Po.length+1);for(var b in i)if(b===g+Ug[0]+(yr.length+2)){var Q=i[b];if(!Q)break;for(var A=Q.length,E=0;A>E;E++)if(Q[E][l](0)===c&&Q[E+1]!=t&&Q[E+1]===yr[0]&&Q[E+2]!=t&&Q[E+2][l](0)===c){for(var L=E+3;A>L;L++)if(Q[L][l](0)===c){if(0==Q[L+1])for(var W,J=L+2;A>J;J++){if(Q[J][l](0)===c){0==Q[J-1]&&W&&(Rf=W.substr(0,W.length-1));break}W==t?W=Q[J]:W+=Q[J]}break}break}break}return function(C){return[-C[0],-C[1],-C[2]]}}(),wr=function(H,O){return 3===H.length?H[0]*O[0]+H[1]*O[1]+H[2]*O[2]:H[0]*O[0]+H[1]*O[1]},_d=function(){var u=new cc(16);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},$l=_d(),jj=function(F){var H=new cc(16);return H[0]=F[0],H[1]=F[1],H[2]=F[2],H[3]=F[3],H[4]=F[4],H[5]=F[5],H[6]=F[6],H[7]=F[7],H[8]=F[8],H[9]=F[9],H[10]=F[10],H[11]=F[11],H[12]=F[12],H[13]=F[13],H[14]=F[14],H[15]=F[15],H},Qk=function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},mo=function(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},wl=function(V,Q){var K=V[0],y=V[1],H=V[2];return V[0]=Q[0]*K+Q[4]*y+Q[8]*H+Q[12],V[1]=Q[1]*K+Q[5]*y+Q[9]*H+Q[13],V[2]=Q[2]*K+Q[6]*y+Q[10]*H+Q[14],V},ul=function(N,A){var q=N[0],M=N[1],n=N[2],w=N[3];return N[0]=A[0]*q+A[4]*M+A[8]*n+A[12]*w,N[1]=A[1]*q+A[5]*M+A[9]*n+A[13]*w,N[2]=A[2]*q+A[6]*M+A[10]*n+A[14]*w,N[3]=A[3]*q+A[7]*M+A[11]*n+A[15]*w,N},Do=function(){var F,G,e,H,O=vf(cl[1]+cl[7]),u=vf(cl[0]+cl[3]-cl[10]),h=vf(cl[8]+2),z=function(){return G=e.charAt(F),F+=1,G},p=function(){var V="";if(G===h)for(;z();){if(G===h)return z(),V;V+=G}else z()},P=function(){for(;G&&" ">=G;)z()},a=function(){var t,R={};if(G===O){if(z(),P(),G===u)return z(),R;for(;G;){if(t=p(),P(),z(),R[t]=H(),P(),G===u)return z(),R;z(),P()}}};return H=function(){switch(P(),G){case O:return a();default:return p()}},function(J){if(V={},J){var w;if(e=J,F=0,G=" ",w=H(),P(),!G)return w}}}(),Cq=function(C,w){if(w){var A=d(w),D=I(w),k=C[4],U=C[5],a=C[6],y=C[7],M=C[8],x=C[9],s=C[10],Z=C[11];C[4]=k*D+M*A,C[5]=U*D+x*A,C[6]=a*D+s*A,C[7]=y*D+Z*A,C[8]=M*D-k*A,C[9]=x*D-U*A,C[10]=s*D-a*A,C[11]=Z*D-y*A}},tp=function(N,H){if(H){var G=d(H),j=I(H),w=N[0],h=N[1],s=N[2],f=N[3],$=N[8],u=N[9],O=N[10],V=N[11];N[0]=w*j-$*G,N[1]=h*j-u*G,N[2]=s*j-O*G,N[3]=f*j-V*G,N[8]=w*G+$*j,N[9]=h*G+u*j,N[10]=s*G+O*j,N[11]=f*G+V*j}},kd=function(R,N){if(N){var y=d(N),z=I(N),E=R[0],T=R[1],p=R[2],M=R[3],x=R[4],P=R[5],h=R[6],X=R[7];R[0]=E*z+x*y,R[1]=T*z+P*y,R[2]=p*z+h*y,R[3]=M*z+X*y,R[4]=x*z-E*y,R[5]=P*z-T*y,R[6]=h*z-p*y,R[7]=X*z-M*y}},Ur=function(n,d,e){return od(t,e===!1?t:n.getFinalScale3d(),n.getFinalRotation3d(),n.getRotationMode(),n.p3(),t,d)},od=function(d,D,T,Y,w,n,S){return n||(n=_d()),w&&vq(n,w),vm(n,T,Y),S&&Cb(n,n,S),D&&Zd(n,D),d&&Cb(n,n,d),n},Ob=function(y,K,r){K=F(K),r=F(r);var $=this;$.g=y,$._84O=K,$._85O=r,$._70I=!0,$.F=0,$._83O=K+r,$.pen={x:0,y:0}},Gr="lineDashOffset",sr="setLineDash",dp=function(P){for(var N in P)1===N.length&&(Gr=P[N]);return N?1:0},Wp=function(u,l,s){return Xl(l)?u:u[sr]?(u[sr](l),s&&(u.lineDashOffset=s),u):new Ob(u,l[0],l.length>1?l[1]:l[0])},Xn=function(i,m){!Xl(m)&&i[sr]&&(i[sr](Ci),i.lineDashOffset=0)};if(Tr(Ob,u,{_69I:6,moveTo:function(x,c){var Q=this,r=Q.pen;r.x=x,r.y=c,Q.g.moveTo(x,c),Q.start||(Q.start={x:x,y:c})},lineTo:function(w,F){var W=this,f=W.pen,u=w-f.x,O=F-f.y,n=r(O,u),g=I(n),v=d(n),z=W._23O(f.x,f.y,w,F),j=W._85O,C=W._84O,e=W._83O;if(W.F){if(W.F>z)return W._70I?W._72I(w,F):W.moveTo(w,F),W.F-=z,void 0;if(W._70I?W._72I(f.x+g*W.F,f.y+v*W.F):W.moveTo(f.x+g*W.F,f.y+v*W.F),z-=W.F,W.F=0,W._70I=!W._70I,!z)return}var P=E(z/e);if(P){for(var B=g*C,G=v*C,X=g*j,Y=v*j,_=0;P>_;_++)W._70I?(W._72I(f.x+B,f.y+G),W.moveTo(f.x+X,f.y+Y)):(W.moveTo(f.x+X,f.y+Y),W._72I(f.x+B,f.y+G));z-=e*P}W._70I?z>C?(W._72I(f.x+g*C,f.y+v*C),W.moveTo(w,F),W.F=j-(z-C),W._70I=!1):(W._72I(w,F),z===C?(W.F=0,W._70I=!W._70I):(W.F=C-z,W.moveTo(w,F))):z>j?(W.moveTo(f.x+g*j,f.y+v*j),W._72I(w,F),W.F=C-(z-j),W._70I=!0):(W.moveTo(w,F),z===j?(W.F=0,W._70I=!W._70I):W.F=j-z)},quadraticCurveTo:function(d,y,X,B){var g,T=this,s=T.pen,o=s.x,c=s.y,R=T._22O(o,c,d,y,X,B),M=0,P=0,$=T._85O,n=T._84O;if(T.F){if(T.F>R)return T._70I?T._71I(d,y,X,B):T.moveTo(X,B),T.F-=R,void 0;if(M=T.F/R,g=T._20O(o,c,d,y,X,B,M),T._70I?T._71I(g[2],g[3],g[4],g[5]):T.moveTo(g[4],g[5]),T.F=0,T._70I=!T._70I,!R)return}var J=R-R*M,u=E(J/T._83O),A=n/R,e=$/R;if(u)for(var K=0;u>K;K++)T._70I?(P=M+A,g=T._21O(o,c,d,y,X,B,M,P),T._71I(g[2],g[3],g[4],g[5]),M=P,P=M+e,g=T._21O(o,c,d,y,X,B,M,P),T.moveTo(g[4],g[5])):(P=M+e,g=T._21O(o,c,d,y,X,B,M,P),T.moveTo(g[4],g[5]),M=P,P=M+A,g=T._21O(o,c,d,y,X,B,M,P),T._71I(g[2],g[3],g[4],g[5])),M=P;J=R-R*M,T._70I?J>n?(P=M+A,g=T._21O(o,c,d,y,X,B,M,P),T._71I(g[2],g[3],g[4],g[5]),T.moveTo(X,B),T.F=$-(J-n),T._70I=!1):(g=T._19O(o,c,d,y,X,B,M),T._71I(g[2],g[3],g[4],g[5]),R===n?(T.F=0,T._70I=!T._70I):(T.F=n-J,T.moveTo(X,B))):J>$?(P=M+e,g=T._21O(o,c,d,y,X,B,M,P),T.moveTo(g[4],g[5]),g=T._19O(o,c,d,y,X,B,P),T._71I(g[2],g[3],g[4],g[5]),T.F=n-(J-$),T._70I=!0):(T.moveTo(X,B),J===$?(T.F=0,T._70I=!T._70I):T.F=$-J)},bezierCurveTo:function(){var T=arguments;this.pen={x:T[4],y:T[5]},this.g.bezierCurveTo(T[0],T[1],T[2],T[3],T[4],T[5])},arc:function(O,u,n,t,S,e){e||(t=-t,S=-S),Pe(this,O,u,t,S-t,n,n,!1)},rect:function(x,k,u,S){var t=this;t.pen={x:x,y:k},t.moveTo(x,k),t.lineTo(x,k+S),t.lineTo(x+u,k+S),t.lineTo(x+u,k),t.lineTo(x,k)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Y,P,r,d){var j=r-Y,K=d-P;return N(j*j+K*K)},_22O:function(n,D,L,W,t,m,Y){for(var s,v,X,R,B,E,y,i=0,w=n,I=D,b=Y>0?Y:this._69I,V=1;b>=V;V++)X=V/b,R=1-X,B=R*R,E=2*X*R,y=X*X,s=B*n+E*L+y*t,v=B*D+E*W+y*m,i+=this._23O(w,I,s,v),w=s,I=v;return i},_21O:function(y,s,V,S,x,O,z,q){var f=this;if(0===z)return f._20O(y,s,V,S,x,O,q);if(1===q)return f._19O(y,s,V,S,x,O,z);var J=f._20O(y,s,V,S,x,O,q);return J.push(z/q),f._19O.apply(f,J)},_20O:function(y,a,L,S,W,z,Z){if(1!==Z){var x=L+(W-L)*Z,p=S+(z-S)*Z;L=y+(L-y)*Z,S=a+(S-a)*Z,W=L+(x-L)*Z,z=S+(p-S)*Z}return[y,a,L,S,W,z]},_19O:function(t,x,j,X,u,T,M){if(1!==M){var W=t+(j-t)*M,E=x+(X-x)*M;j+=(u-j)*M,X+=(T-X)*M,t=W+(j-W)*M,x=E+(X-E)*M}return[t,x,j,X,u,T]},_72I:function(O,r){var u=this.pen;(O!==u.x||r!==u.y)&&(u.x=O,u.y=r,this.g.lineTo(O,r))},_71I:function(m,r,g,$){var f=this.pen;(m!==g||r!==$||g!==f.x||$!==f.y)&&(f.x=g,f.y=$,this.g.quadraticCurveTo(m,r,g,$))}}),U&&Lb){var on=Lb.toString();x=on.indexOf(Vp.substr(0,2))>0&&on.indexOf(_j+_j.substr(1,1))>1||on.indexOf(Vn.substr(0,2)+Vp.substr(2,2)+Ug[0]+Vp[4])>1?!0:!1}var vd=t,Xr=t,Ri=Q.checkLoadingCompType=function(y){vd&&!y._72O&&(Xr||(Xr={}),Xr[y._72O=Re()]=y)},Hn=function($,Y){if(Y||(Y=$),Y&&(vd||(vd={}),!vd[$])){var p=new qh;if(vd[Y]={request:p,url:Y},Y=Q.beforeLoadURL(Y,$),Y.data){var g=Q.parse(Y.data);rf($,g),Q.handleCompTypeLoaded($,g)}else{p.onload=function(){if(200===this.status||0===this.status){var H=Q.parse(p.getResponseText());rf($,H),Q.handleCompTypeLoaded($,H)}else rf($,t)},p.onerror=function(){rf($,t)};var c={};c.url=encodeURI(Y),c.sync=!1,p.send(c)}}},rf=function(n,E){if(xm[n]=E,delete vd[n],wf(vd)&&(vd=t,Xr)){for(var i in Xr){var y=Xr[i];y.invalidateAll&&y.invalidateAll(w,"compTypeLoaded",n),y.redraw&&y.redraw(),y.iv(),delete y._72O}Xr=t}if(E&&Xr)for(var i in Xr){var y=Xr[i];y.invalidateAll&&y.invalidateAll(w,"compTypeLoading",n),y.redraw&&y.redraw(),y.iv()}},yc=p.chart,up="",Te=!0,rs=Q.compStack=[],zq=/^style@/,Si=/^attr@/,Hk=/^field@/,tq={x:.5,y:.5},Oq=function(){Te=!0},$j=function(){return Te},To=function(Y,S,V,R){if(!Y)return 0;if(bf(Y.fitSize,S,V)&&R)return R;var n=bf(Y.width,S,V);return null==n?20:n},wb=function(O,d,b,h){if(!O)return 0;if(bf(O.fitSize,d,b)&&h)return h;var B=bf(O.height,d,b);return null==B?20:B},bf=function(_,c,A){if(!_||!_.func)return _;var P,q=_.func,R=_.value;return P=Jm(q)?A&&A.vectorDataBindingDisabled&&!_.isSafeFunc?R:q(c,A):c instanceof Ro||(Y.ui?c instanceof Y.ui.View:0)?Si.test(q)?c.a(up+q.slice(5)):zq.test(q)?c.s(up+q.slice(6)):Hk.test(q)?c[q.slice(6)]:c[q]?c[q](A):R:R,R!==w&&P==t?R:P},qc=Q.drawImage=function(){var $,j,l,x,W,s,k=function(M,D){M.getValue&&M.getValue.compType===D||(M.getValue=function(s){var I=f(M,s);if(I===w&&D.properties){var R=D.properties[s];R&&(I=R.defaultValue)}return I},M.getColor=function(f){return L(M.getValue(f))},M.getValue.compType=D)},f=function(h,g,q){var X,I=!1;if(h.prefix&&j instanceof Ro){var z=j.a(up+g);z!==w&&(I=!0,X=z)}return X===w&&(X=h[g]),X&&X.func&&(I=!0,X=bf(X,j,l)),q&&(X=q(X),I||(h[g]=X)),X},L=function(Z,A){var C;if(C=A?f(Z,A):Z,$&&$.compGray&&C)return Q.toGrayColor(C);if(W&&C){if("override"===s)return W;if("override_rgb"===s){var v=be(W);return C=Ei(C),"rgba("+y(255*v[0])+","+y(255*v[1])+","+y(255*v[2])+","+C[3]/255+")"}if("override_a"===s){var v=be(W);return C=Ei(C),"rgba("+C[0]+","+C[1]+","+C[2]+","+v[3]+")"}var v=be(W);return C=Ei(C),"rgba("+y(C[0]*v[0])+","+y(C[1]*v[1])+","+y(C[2]*v[2])+","+C[3]/255*v[3]+")"}return C},M=function(s){if(Cl(s)){for(var x=new ls,Z=s.length,_=0;Z>_;_+=2)x.add({x:s[_],y:s[_+1]});s=x}return s},c=function(m){var I=f(m,"anchorX"),o=f(m,"anchorY");if(I!==w||o!==w)return{x:I===w?tq.x:I,y:o===w?tq.y:o};var O=f(m,"type"),K=f(m,"name");if("image"!==O||!K)return tq;var $=ir(K);return $&&$.anchorX!==w&&$.anchorY!==w?{x:$.anchorX,y:$.anchorY}:tq},b=function($,X){var A=f($,_m),m=c($);if(Cl(A)){var b=A.length,N=f($,"relative"),B=X.width,Y=X.height;if(4===b)A={x:A[0],y:A[1],width:A[2],height:A[3]},N&&(A.x*=B,A.y*=Y,A.width*=B,A.height*=Y);else if(3===b){var S=A[0];A={width:A[1],height:A[2]},N&&(A.width*=B,A.height*=Y),"object"==typeof S?S.length&&(S={x:S[0],y:S[1]}):S=Tf(S,X,A),A.x=S.x-A.width*m.x,A.y=S.y-A.height*m.y}A.x+=f($,"offsetX")||0,A.y+=f($,"offsetY")||0,!N&&X.fitSize&&(A=C($,A,X))}return A},C=function(h,Z,X){if(Z){var x,_,E,n={x:Z.x,y:Z.y,width:Z.width,height:Z.height},a=c(h),o=f(h,"layoutH"),y=f(h,"layoutV"),e=1,d=1,q=0,z=0,g=1,B=1;switch(o){case"left":break;case"right":n.x+=X.width-X.rw;break;case"center":n.x+=.5*(X.width-X.rw);break;case"scale":case"leftright":default:x=f(h,dj)||0,x&&(q=Math.abs(z=Math.sin(x)),g=Math.abs(B=Math.cos(x))),"leftright"!==o?(e+=g*(X.widthScale-1),d+=q*(X.widthScale-1)):(e+=n.width?g*(X.width-X.rw)/n.width:0,d+=n.height?q*(X.width-X.rw)/n.height:0,_=-Math.min(-a.x*B+a.y*z,-a.x*B-(1-a.y)*z,(1-a.x)*B+a.y*z,(1-a.x)*B-(1-a.y)*z))}switch(y){case"top":break;case"bottom":n.y+=X.height-X.rh;break;case"center":n.y+=.5*(X.height-X.rh);break;case"scale":case"topbottom":default:x==t&&(x=f(h,dj),x&&(q=Math.abs(z=Math.sin(x)),g=Math.abs(B=Math.cos(x)))),"topbottom"!==y?(e+=q*(X.heightScale-1),d+=g*(X.heightScale-1)):(e+=n.width?q*(X.height-X.rh)/n.width:0,d+=n.height?g*(X.height-X.rh)/n.height:0,E=-Math.min(-a.x*z-a.y*B,-a.x*z+(1-a.y)*B,(1-a.x)*z-a.y*B,(1-a.x)*z+(1-a.y)*B))}return(1!==e||1!==d)&&("scale"!==o&&o?"leftright"===o&&(n.x+=n.width*(1-e)*a.x+_*(X.width-X.rw)):n.x+=n.x*(X.widthScale-1)+a.x*n.width*(X.widthScale-e),"scale"!==y&&y?"topbottom"===y&&(n.y+=n.height*(1-d)*a.y+E*(X.height-X.rh)):n.y+=n.y*(X.heightScale-1)+a.y*n.height*(X.heightScale-d),n.width*=e,n.height*=d),n.width<0&&(n.width=0),n.height<0&&(n.height=0),n}},u=function(H){return Cl(H)?new ls(H):H},J=function(n,r,O,D,M,U,X){var v=$.interactiveInfo,l=n.transform;if(l)return $.save(),$.setTransform(l.a,l.b,l.c,l.d,l.tx,l.ty),v&&v.compInfos.push({comp:n,rect:r,matrix:l.clone(),prefix:up}),!0;M===w&&(M=1),U===w&&(U=1);var S=f(n,"clipPercentage"),Z=nn(O,r);if(Z&&!D&&1===M&&1===U&&!(1>S))return v&&v.compInfos.push({comp:n,rect:r,matrix:v.matrix.clone(),prefix:up}),!1;X=X||tq;var j=r.x+r.width*X.x,J=r.y+r.height*X.y,K=O.x+O.width*X.x,e=O.y+O.height*X.y,u=O.width?M*(r.width/O.width):1,d=O.height?U*(r.height/O.height):1;if($.save(),v&&(v.matrix.appendTranslate(j,J).appendRotate(D).appendScale(u,d).appendTranslate(-K,-e),v.compInfos.push({comp:n,rect:r,matrix:v.matrix.clone()})),_h($,j,J),Pp($,D||0),ri($,u,d),_h($,-K,-e),1>S){0>S&&(S=0);var s=Mg(O,f(n,"clipDirection"),S);$.beginPath(),$.rect(s.x,s.y,s.width,s.height),$.clip()}return!0},v=function(){$.restore()},F=function(S,r,O){var q=f(S,"path"),D=f(S,dj),a=f(S,"scaleX"),F=f(S,"scaleY"),Z=c(S),k=t,K=kl(null,q);if(O||(O=S.unionRect,O||(O=Qm(K),S.path.func||(S.unionRect=O)),k=O),O){k||(k=S.unionRect,k||(k=Qm(K),S.path.func||(S.unionRect=k)));var o=J(S,O,k,D,a,F,Z),_=f(S,"borderPattern"),E=Wp($,_),u=L(S,"background"),w=L(S,"borderColor"),I=f(S,"borderWidth"),m=f(S,"gradient"),i=L(S,"gradientColor"),Q=f(S,"border3d"),d=L(S,"border3dColor"),M=f(S,"border3dAccuracy"),A=$.lineJoin,B=$.lineCap;$.lineJoin=f(S,"borderJoin")||Ll,$.lineCap=f(S,"borderCap")||aj,u?(Se($,u,m,i,k),kl($,q),$.fill(),E!==$&&kl($,q)):kl($,q);var l=f(S,"borderWidthAbsolute");if(l&&($.save(),$.setTransform(1,0,0,1,0,0)),I&&w&&($.lineWidth=I,$.strokeStyle=w,$.stroke(),Q&&lp($,w,d,I,x,M)),Xn($,_),f(S,"dash")){var N=f(S,"dashWidth")||I;if(N>0){_=f(S,"dashPattern")||Wk;var E=Wp($,_,f(S,"dashOffset")),G=L(S,"dashColor")||L(Qq);E!==$&&kl($,q),$.strokeStyle=G,$.lineWidth=N,$.stroke(),f(S,"dash3d")&&lp($,G,L(S,"dash3dColor"),N,x,f(S,"dash3dAccuracy")),Xn($,_)}}l&&$.restore(),r===_m&&mb($,u,f(S,"depth"),k),$.lineJoin=A,$.lineCap=B,o&&v()}},S=function(S,N,o,T){var D=f(S,ef,M),h=f(S,dj),R=c(S);if(D&&T.fitSize){var w=new ls,E=Qm(D),Z=C(S,E,T),m=E.x+R.x*E.width,A=E.y+R.y*E.height,d=Z.x+R.x*Z.width,O=Z.y+R.y*Z.height,X=E.width?Z.width/E.width:1,Y=E.height?Z.height/E.height:1;D.each(function(E){w.add({x:d+(E.x-m)*X,y:O+(E.y-A)*Y})}),D=w,S.unionRect=null}var V=f(S,"scaleX"),G=f(S,"scaleY"),i=N===Fc,a=t;if(!o&&i&&(o=S.unionRect,o||(o=Qm(D),S.points.func||(S.unionRect=o)),a=o),o){i?a||(a=S.unionRect,a||(a=Qm(D),S.points.func||(S.unionRect=a))):a=o;var p,z,U,K,P=J(S,o,a,h,V,G,R),Q=f(S,"borderPattern"),n=Wp($,Q),e=L(S,"background"),H=ir(f(S,"repeatImage"),W,s),y=f(S,"gradientPack"),q=L(S,"borderColor"),k=f(S,"borderWidth"),F=f(S,"segments",u),g=f(S,"gradient"),r=L(S,"gradientColor"),_=f(S,"border3d"),b=L(S,"border3dColor"),B=f(S,"border3dAccuracy"),I=f(S,"closePath"),Tq=f(S,"fillRule")||"nonzero",Zc=$.lineJoin,oo=$.lineCap;if($.lineJoin=f(S,"borderJoin")||Ll,$.lineCap=f(S,"borderCap")||aj,i)if(e||H||y){var Um=f(S,"fillClipPercentage");if(1>Um){0>Um&&(Um=0);var vr=Mg(a,f(S,"fillClipDirection"),Um);$.save(),$.beginPath(),$.rect(vr.x,vr.y,vr.width,vr.height),$.clip()}ps($,D,F,I),y?Hm($,y):H?hd($,H,W,s,j,l):Se($,e,g,r,a),$.fill(Tq),1>Um&&$.restore(),y&&$.restore(),n!==$&&ps(n,D,F,I)}else ps(n,D,F,I);else if("roundRect"===N?p=f(S,"cornerRadius"):"polygon"===N?p=f(S,"polygonSide"):"arc"===N&&(p=f(S,"arcFrom"),z=f(S,"arcTo"),U=f(S,"arcClose"),K=f(S,"arcOval")),e||H||y){var Um=f(S,"fillClipPercentage");if(1>Um){0>Um&&(Um=0);var vr=Mg(a,f(S,"fillClipDirection"),Um);$.save(),$.beginPath(),$.rect(vr.x,vr.y,vr.width,vr.height),$.clip()}yp($,N,a,p,z,U,K),y?Hm($,y):H?hd($,H,W,s,j,l):Se($,e,g,r,a),$.fill(Tq),1>Um&&$.restore(),y&&$.restore(),$!==n&&yp(n,N,a,p,z,U,K)}else yp(n,N,a,p,z,U,K);var Nq=f(S,"borderWidthAbsolute");if(Nq&&($.save(),$.setTransform(1,0,0,1,0,0)),k&&q&&($.lineWidth=k,$.strokeStyle=q,$.stroke(),_&&lp($,q,b,k,x,B)),Xn($,Q),f(S,"dash")){var bl=f(S,"dashWidth")||k;if(bl>0){Q=f(S,"dashPattern")||Wk;var n=Wp($,Q,f(S,"dashOffset")),Kr=L(S,"dashColor")||L(Qq);n!==$&&(i?ps(n,D,F,I):yp(n,N,a,p,z,U,K)),$.strokeStyle=Kr,$.lineWidth=bl,$.stroke(),f(S,"dash3d")&&lp($,Kr,L(S,"dash3dColor"),bl,x,f(S,"dash3dAccuracy")),Xn($,Q)}}Nq&&$.restore(),N===_m&&mb($,e,f(S,"depth"),a),$.lineJoin=Zc,$.lineCap=oo,P&&v()}},T=function(v,Z){var P=W||f(v,kg),i=s||f(v,"blendMode"),L=f(v,"name"),X=ir(L,P,i);X?Mi($,X,f(v,"stretch"),Z.x,Z.y,Z.width,Z.height,j,l,P,null,i):Te=!1},g=function(Z,P){var R=f(Z,"text");R!=t&&rd($,R,f(Z,"font"),L(Z,kg),P.x,P.y,P.width,P.height,f(Z,"align"),f(Z,"vAlign"))},_=function(b,N){Lh($,L(b,kg),N.x,N.y,N.width,N.height,f(b,"width"))},n=function(g,F){var o=f(g,op),R=0;if(o&&(o.forEach(function(y){R+=y}),R>0)){for(var h=f(g,"colors")||yc,X=f(g,"startAngle")||0,H=f(g,"hollow"),T=f(g,cf),W=f(g,Nm),s=f(g,zb),w=T?new ls:t,n=F.x,k=F.y,M=F.width,A=F.height,q=n+M/2,x=k+A/2,E=a(M,A)/2,b=0,m=0;m<o.length;m++){var r=o[m],S=z*r/R,v=X+S;if($.fillStyle=h[b++],b===h.length&&(b=0),$.beginPath(),H){var y=q+I(X)*E/2,C=x+d(X)*E/2,V=q+I(v)*E,i=x+d(v)*E;$.moveTo(y,C),$.arc(q,x,E/2,X,v,!1),$.lineTo(V,i),$.arc(q,x,E,v,X,!0)}else $.moveTo(q,x),$.arc(q,x,E,v,X,!0);w&&(S=(X+v)/2,w.add({text:Jm(T)?T(r,m,R,j):r,x:q+.75*I(S)*E,y:x+.75*d(S)*E})),$.closePath(),$.fill(),X=v}w&&w.each(function(l){rd($,l.text,W,s,l.x,l.y,0,0,Qi)})}},N=function(K,z){var D=f(K,Gd);if(D&&D.length>0){var x=D.length,H=f(K,cf),B=f(K,Nm),m=f(K,zb),R=H?new ls:t,M=f(K,"minValue")||0,N=f(K,"maxValue");if(N==t&&(N=0,D.forEach(function(M){f(M,op).forEach(function(K){N=q(N,K)})})),M===N)return;for(var h=z.height/(N-M),V=z.y+N*h,i=f(D[0],op).length,Y=z.width/(3*i+1),Z=2*Y/x,g=0,v=0;x>v;v++)for(var k=D[v],W=f(k,kg),_=f(k,"colors"),Q=f(k,op),d=0;i>d;d++){_?$.fillStyle=_[d]:W?$.fillStyle=W:($.fillStyle=yc[g++],g===yc.length&&(g=0));var F=Q[d],p=F*h,I=z.x+(1+3*d)*Y+v*Z;if(Qf($,I,V-p,Z,p),R){var O=Jm(H)?H(F,d,k,j):F,E=Rj(B,O).height;R.add({x:I,y:V-p-E,width:Z,height:E,text:O})}}R&&R.each(function(t){rd($,t.text,B,m,t.x,t.y,t.width,t.height,Qi)})}},e=function(A,i){var k=f(A,Gd);if(k&&k.length>0){var U=k.length,W=f(k[0],op).length,z=i.width/(3*W+1),B=0,r=f(A,"maxValue"),V=f(A,cf),v=f(A,Nm),b=f(A,zb),K=V?new ls:t;if(r==t){r=0;for(var T=0;W>T;T++){for(var o=0,n=0;U>n;n++)o+=f(k[n],op)[T];r=q(r,o)}}if(r>0){for(var T=0;W>T;T++)for(var w=i.y+i.height,n=0;U>n;n++){var C=k[n],E=f(C,kg),H=f(C,op)[T],P=H/r*i.height;E?$.fillStyle=E:($.fillStyle=yc[B++],B===yc.length&&(B=0)),w-=P;var p={x:i.x+(1+3*T)*z,y:w,width:2*z,height:P};Qf($,p.x,p.y,p.width,p.height),K&&(p.text=Jm(V)?V(H,T,C,j):H,K.add(p))}K&&K.each(function(w){rd($,w.text,v,b,w.x,w.y,w.width,w.height,Qi)})}}},h=function(c,U){var R=f(c,Gd);if(R&&R.length>0){for(var h=R.length,l=f(R[0],op).length,O=U.width/(3*l+1),q=0,n=f(c,cf),X=f(c,Nm),p=f(c,zb),u=n?new ls:t,S=0;l>S;S++){for(var E=0,J=0;h>J;J++)E+=f(R[J],op)[S];if(E>0){var W=U.y+U.height;for(J=0;h>J;J++){var F=R[J],Q=f(F,kg),i=f(F,op)[S],_=i/E*U.height;Q?$.fillStyle=Q:($.fillStyle=yc[q++],q===yc.length&&(q=0)),W-=_;var N={x:U.x+(1+3*S)*O,y:W,width:2*O,height:_};Qf($,N.x,N.y,N.width,N.height),u&&(N.text=Jm(n)?n(i,S,F,j):i,u.add(N))}}}u&&u.each(function(G){rd($,G.text,X,p,G.x,G.y,G.width,G.height,Qi)})}},U=function(M,N){var o=f(M,Gd);if(o&&o.length>0){var d=o.length,w=f(M,"minValue")||0,u=f(M,"maxValue");if(u==t&&(u=0,o.forEach(function(h){f(h,op).forEach(function(J){u=q(u,J)})})),w===u)return;for(var F=N.height/(u-w),Y=N.y+u*F,p=f(o[0],op).length,I=N.width/(3*p+1),Z=0,P=f(M,"lineWidth")||2,U=f(M,"line3d"),n=f(M,"linePoint"),h=f(M,cf),c=f(M,Nm),T=f(M,zb),E=0;d>E;E++){var X=o[E],i=f(X,kg),m=f(X,op);i?$.strokeStyle=i:(i=$.strokeStyle=yc[Z++],Z===yc.length&&(Z=0)),$.beginPath();for(var L=0;p>L;L++){var A=N.x+(2+3*L)*I,K=Y-m[L]*F;0===L?$.moveTo(A,K):$.lineTo(A,K)}if($.lineWidth=P,$.stroke(),U&&lp($,i,t,P,x),n||h){var b,S=P/2+2;for(L=0;p>L;L++){var W=m[L];if(A=N.x+(2+3*L)*I,K=Y-W*F,Jm(n)?n($,A,K,i,L,X,j):n&&($.fillStyle=i,$.beginPath(),$.arc(A,K,S,0,z,!0),$.fill()),Jm(h)?b=h(W,L,X,j):h&&(b=W),b){var G=Rj(c,b).height,l=$.shadowBlur;if(l){var Q=$.shadowOffsetX,J=$.shadowOffsetY,D=$.shadowColor;$.shadowOffsetX=0,$.shadowOffsetY=0,$.shadowBlur=0,$.shadowColor=t}rd($,b,c,T,A,K-G-S+2,0,G,Qi),l&&($.shadowOffsetX=Q,$.shadowOffsetY=J,$.shadowBlur=l,$.shadowColor=D)}}}}}},O=function(d){$=d[0],j=d[1],l=d[2],x=d[3],W=d[4],s=d[5]},R=function(){return[$,j,l,x,W,s]},r=function(K,n){var J;l&&l.getState?J=l.getState(j):(J=j instanceof Ro?j.s(No):null,(J===w||null===J)&&(J=f(K,No)));var N=f(n,No);return N!==w&&null!==N&&N!==J?!1:f(n,Xe)},H={border:_,image:T,text:g,pieChart:n,columnChart:N,stackedColumnChart:e,percentageColumnChart:h,lineChart:U};return function(d,m,Y,K,T,I,G,P,E,D){if(m&&T&&I){var N=R();$=d,j=G,l=P,!j&&l&&l.isSelfViewEvent&&(j=l),x=l?l._zoom?l._zoom:1:1,W=E,s=D;var q=T,Z=I;if(mk()){var z,h,n,B,g;0===$[qf]?mk[0]&&(z=!0):z=!0,$.texureImage2D?mk[1]&&(h=!0):h=!0,$.texureImage3D?mk[2]&&(n=!0):n=!0,$.drawDNDState?mk[3]&&(g=!0):g=!0,Jj.widget[0]?mk[4]&&(B=!0):B=!0,z&&h&&n&&B&&g&&(q=Y,Z=K)}if(m.tagName)return vh(Rf)&&!i[Rf]||$.drawImage(m,q,Z,T,I),O(N),void 0;if(f(m,"visible")===!1)return O(N),void 0;W||(W=bf(m.color,j,l)),D||(s=bf(m.blendMode,j,l)),vh(Rf)&&!i[Rf]&&(T=q,I=Z);var V=To(m,j,l,T),C=wb(m,j,l,I),A={x:0,y:0,width:V,height:C,fitSize:f(m,"fitSize")},o=f(m,"clip"),_=f(m,"opacity");if(A.fitSize){var y=A.rw=bf(m.width,j,l)||20;A.widthScale=V/y;var p=A.rh=bf(m.height,j,l)||20;A.heightScale=C/p}if($.save(),$.interactiveInfo){var U=$.interactiveInfo.matrix,e=U.clone();U.appendTranslate(q,Z).appendScale(T/V,I/C)}_h($,q,Z),(V!==T||C!==I)&&$.scale(T/V,I/C),o&&(Jm(o)?o($,V,C,j,l,m):($.beginPath(),$.rect(0,0,V,C),$.clip())),_!=t&&($.globalAlpha*=_),f(m,"comps").forEach(function(B){if(B.prefix){var Z=up,g=bf(B.prefix,j,l);g&&(up=up+g+".")}if(r(m,B)===!1)return B.prefix&&(up=Z),void 0;if(rs.splice(0,0,B),$.interactiveInfo)var d=$.interactiveInfo.matrix.clone();var G=f(B,"opacity"),C=f(B,"shadow"),i=f(B,"type"),e=b(B,A);if(G!=t){var q=$.globalAlpha;$.globalAlpha*=G}if(C){var P=$.shadowOffsetX,y=$.shadowOffsetY,_=$.shadowBlur,T=$.shadowColor,V=f(B,"shadowOffsetX"),X=f(B,"shadowOffsetY"),E=f(B,"shadowBlur"),s=L(B,"shadowColor");$.shadowOffsetX=(V==t?3:V)*x,$.shadowOffsetY=(X==t?3:X)*x,$.shadowBlur=(E==t?6:E)*x,$.shadowColor=s||L(ng)}if("save"===i)$.save();else if("endClip"===i||"restore"===i)$.restore();else if("clip"===i)$.save(),ps($,f(B,"points",M),f(B,"segments",u),!0),$.clip();else if(yk[i])e=e||{x:0,y:0,width:A.width,height:A.height},S(B,i,e,A);else if(i===Fc)S(B,i,e,A);else if("SVGPath"===i)F(B,i,e);else{e=e||{x:0,y:0,width:A.width,height:A.height};var D=f(B,dj),U=f(B,"scaleX"),o=f(B,"scaleY"),h=c(B),O=J(B,e,e,D,U,o,h);if(Jm(i))k(B,i),Q.drawCompType(i,$,e,B,j,l);else if(Q.getCompType(i)){var N=Q.getCompType(i),Y=N.func||N;k(B,N),Q.drawCompType(Y,$,e,B,j,l)}else H[i]?H[i](B,e):Q.getCompType(i)===w&&Im.test(i)&&Hn(i);O&&v()}C&&($.shadowOffsetX=P,$.shadowOffsetY=y,$.shadowBlur=_,$.shadowColor=T),G!=t&&($.globalAlpha=q),$.interactiveInfo&&($.interactiveInfo.matrix=d),B.prefix&&(up=Z),rs.splice(0,1)}),$.interactiveInfo&&($.interactiveInfo.matrix=e),$.restore(),O(N)}}}();Q.getCurrentComp=function(){return rs[0]},Q.getParentComp=function(){return rs[1]},Q.getInternal=function(){return{isEnter:sf,isEsc:Fd,isSpace:Kb,isLeft:_g,isUp:ah,isRight:El,isDown:Fq,addMethod:oi,superCall:ml,toPointsArray:hr,translateAndScale:ko,appendArray:je,createWorldMatrix:od,vec3TransformMat4:wl,setCanvas:ik,createDiv:wc,createView:yo,createCanvas:Yh,createImage:fr,initContext:ck,layout:Km,fillRect:Qf,Mat:Gm,drawBorder:Lh,isString:vh,setBorder:hb,getPropertyValue:Oe,setPropertyValue:jp,drawVerticalLine:im,draw3DRect:mb,getPinchDist:dl,isSameRect:nn,getPosition:Tf,intersectionLineRect:Dh,getNodeRect:_k,getEdgeAgentPosition:Nk,getEdgeHostPosition:Ld,getImageWidth:To,getImageHeight:wb,initItemElement:oq,drawPoints:ps,createG2:Wp,closePopup:em,isH:ql,createAnim:$k,createNormalMatrix:so,createNormals:Gq,toFloatArray:Sq,glMV:um,glPop:Np,batchShape:Yn,createNodeMatrix:Ur,getFaceInfo:to,transformAppend:gf,drawFaceInfo:Yd,to3dPointsArray:_r,setGLDebugMode:function(f){_b=f},cube:function(){return{vs:Lc,is:tf,uv:ve}},ui:function(){return{DataUI:gm,NodeUI:Iq,EdgeUI:Ik,GroupUI:hs,ShapeUI:xp,GridUI:Je,Data3dUI:sn,Node3dUI:ce,Shape3dUI:xh}},getInternalVersion:function(){return"U2FsdGVkX1/k0mRgRuBX1q7akTirV8u7Z40DxwDptQw="},getDragger:function(){return lg},addMSMap:function(p){oi(yb,p)},k:e,addEventListener:b,removeEventListener:n}},function(S){function $(u,q){u!=t&&(q==t&&Rl!=typeof u?this._54O(u,256):this._54O(u,q))}function p(){return new $(t)}function l(Z,f,$,b,n,u){for(;--u>=0;){var J=f*this[Z++]+$[b]+n;n=E(J/67108864),$[b++]=67108863&J}return n}function w(K,$,U,M,e,k){for(var t=32767&$,T=$>>15;--k>=0;){var j=32767&this[K],p=this[K++]>>15,i=T*j+p*t;j=t*j+((32767&i)<<15)+U[M]+(1073741823&e),e=(j>>>30)+(i>>>15)+T*p+(e>>>30),U[M++]=1073741823&j}return e}function V(K,u,a,F,f,g){for(var q=16383&u,h=u>>14;--g>=0;){var M=16383&this[K],Q=this[K++]>>14,W=h*M+Q*q;M=q*M+((16383&W)<<14)+a[F]+f,f=(M>>28)+(W>>14)+h*Q,a[F++]=268435455&M}return f}function u(M){return Kk.charAt(M)}function J(z,Z){var U=Qm[z.charCodeAt(Z)];return U==t?-1:U}function n(V){for(var h=this.t-1;h>=0;--h)V[h]=this[h];V.t=this.t,V.s=this.s}function R(S){this.t=1,this.s=0>S?-1:0,S>0?this[0]=S:-1>S?this[0]=S+this.DV:this.t=0}function G(k){var e=p();return e._58O(k),e}function X(R,G){var q,a=this;if(16==G)q=4;else if(8==G)q=3;else if(256==G)q=8;else if(2==G)q=1;else if(32==G)q=5;else{if(4!=G)return a.fromRadix(R,G),void 0;q=2}a.t=0,a.s=0;for(var f=R.length,j=!1,v=0;--f>=0;){var P=8==q?255&R[f]:J(R,f);0>P?"-"==R.charAt(f)&&(j=!0):(j=!1,0==v?a[a.t++]=P:v+q>a.DB?(a[a.t-1]|=(P&(1<<a.DB-v)-1)<<v,a[a.t++]=P>>a.DB-v):a[a.t-1]|=P<<v,v+=q,v>=a.DB&&(v-=a.DB))}8==q&&0!=(128&R[0])&&(a.s=-1,v>0&&(a[a.t-1]|=(1<<a.DB-v)-1<<v)),a._57O(),j&&$.ZERO._78O(a,a)}function O(){for(var O=this,m=O.s&O.DM;O.t>0&&O[O.t-1]==m;)--O.t}function Y(h){var A=this;if(A.s<0)return"-"+A._85O()[Dj](h);var D;if(16==h)D=4;else if(8==h)D=3;else if(2==h)D=1;else if(32==h)D=5;else{if(4!=h)return A.toRadix(h);D=2}var d,v=(1<<D)-1,T=!1,t="",y=A.t,k=A.DB-y*A.DB%D;if(y-->0)for(k<A.DB&&(d=A[y]>>k)>0&&(T=!0,t=u(d));y>=0;)D>k?(d=(A[y]&(1<<k)-1)<<D-k,d|=A[--y]>>(k+=A.DB-D)):(d=A[y]>>(k-=D)&v,0>=k&&(k+=A.DB,--y)),d>0&&(T=!0),T&&(t+=u(d));return T?t:"0"}function Q(){var L=p();return $.ZERO._78O(this,L),L}function r(){return this.s<0?this._85O():this}function v(B){var w=this,x=w.s-B.s;if(0!=x)return x;var a=w.t;if(x=a-B.t,0!=x)return w.s<0?-x:x;for(;--a>=0;)if(0!=(x=w[a]-B[a]))return x;return 0}function U(c){var I,Z=1;return 0!=(I=c>>>16)&&(c=I,Z+=16),0!=(I=c>>8)&&(c=I,Z+=8),0!=(I=c>>4)&&(c=I,Z+=4),0!=(I=c>>2)&&(c=I,Z+=2),0!=(I=c>>1)&&(c=I,Z+=1),Z}function K(){var Q=this;return Q.t<=0?0:Q.DB*(Q.t-1)+U(Q[Q.t-1]^Q.s&Q.DM)}function k(t,k){var Y;for(Y=this.t-1;Y>=0;--Y)k[Y+t]=this[Y];for(Y=t-1;Y>=0;--Y)k[Y]=0;k.t=this.t+t,k.s=this.s}function H(x,W){for(var B=x;B<this.t;++B)W[B-x]=this[B];W.t=q(this.t-x,0),W.s=this.s}function D(G,b){var R,p=this,P=G%p.DB,F=p.DB-P,T=(1<<F)-1,B=E(G/p.DB),S=p.s<<P&p.DM;for(R=p.t-1;R>=0;--R)b[R+B+1]=p[R]>>F|S,S=(p[R]&T)<<P;for(R=B-1;R>=0;--R)b[R]=0;b[B]=S,b.t=p.t+B+1,b.s=p.s,b._57O()}function b(D,I){var u=this;I.s=u.s;var e=E(D/u.DB);if(e>=u.t)return I.t=0,void 0;var k=D%u.DB,M=u.DB-k,P=(1<<k)-1;I[0]=u[e]>>k;for(var t=e+1;t<u.t;++t)I[t-e-1]|=(u[t]&P)<<M,I[t-e]=u[t]>>k;k>0&&(I[u.t-e-1]|=(u.s&P)<<M),I.t=u.t-e,I._57O()}function C(X,e){for(var G=this,z=0,i=0,l=a(X.t,G.t);l>z;)i+=G[z]-X[z],e[z++]=i&G.DM,i>>=G.DB;if(X.t<G.t){for(i-=X.s;z<G.t;)i+=G[z],e[z++]=i&G.DM,i>>=G.DB;i+=G.s}else{for(i+=G.s;z<X.t;)i-=X[z],e[z++]=i&G.DM,i>>=G.DB;i-=X.s}e.s=0>i?-1:0,-1>i?e[z++]=G.DV+i:i>0&&(e[z++]=i),e.t=z,e._57O()}function Z(l,x){var e=this.abs(),F=l.abs(),Q=e.t;for(x.t=Q+F.t;--Q>=0;)x[Q]=0;for(Q=0;Q<F.t;++Q)x[Q+e.t]=e.am(0,F[Q],x,Q,0,e.t);x.s=0,x._57O(),this.s!=l.s&&$.ZERO._78O(x,x)}function h(s){for(var q=this.abs(),K=s.t=2*q.t;--K>=0;)s[K]=0;for(K=0;K<q.t-1;++K){var h=q.am(K,q[K],s,2*K,0,1);(s[K+q.t]+=q.am(K+1,2*q[K],s,2*K+1,h,q.t-K-1))>=q.DV&&(s[K+q.t]-=q.DV,s[K+q.t+1]=1)}s.t>0&&(s[s.t-1]+=q.am(K,q[K],s,2*K,0,1)),s.s=0,s._57O()}function s(W,Z,G){var o=W.abs(),w=this;if(!(o.t<=0)){var P=w.abs();if(P.t<o.t)return Z!=t&&Z._58O(0),G!=t&&w._77O(G),void 0;G==t&&(G=p());var R=p(),u=w.s,D=W.s,L=w.DB-U(o[o.t-1]);L>0?(o._44O(L,R),P._44O(L,G)):(o._77O(R),P._77O(G));var S=R.t,x=R[S-1];if(0!=x){var l=x*(1<<w.F1)+(S>1?R[S-2]>>w.F2:0),h=w.FV/l,m=(1<<w.F1)/l,J=1<<w.F2,d=G.t,O=d-S,N=Z==t?p():Z;for(R._59O(O,N),G._52O(N)>=0&&(G[G.t++]=1,G._78O(N,G)),$.ONE._59O(S,N),N._78O(R,R);R.t<S;)R[R.t++]=0;for(;--O>=0;){var H=G[--d]==x?w.DM:E(G[d]*h+(G[d-1]+J)*m);if((G[d]+=R.am(0,H,G,O,0,S))<H)for(R._59O(O,N),G._78O(N,G);G[d]<--H;)G._78O(N,G)}Z!=t&&(G._45O(S,Z),u!=D&&$.ZERO._78O(Z,Z)),G.t=S,G._57O(),L>0&&G._46O(L,G),0>u&&$.ZERO._78O(G,G)}}}function o(z){var Q=p();return this.abs()._49O(z,t,Q),this.s<0&&Q._52O($.ZERO)>0&&z._78O(Q,Q),Q}function x(o){this.m=o}function P(Z){return Z.s<0||Z._52O(this.m)>=0?Z.mod(this.m):Z}function c(f){return f}function i(v){v._49O(this.m,t,v)}function W(S,L,r){S._47O(L,r),this._74O(r)}function j(l,F){l._48O(F),this._74O(F)}function A(){if(this.t<1)return 0;var x=this[0];if(0==(1&x))return 0;var Y=3&x;return Y=15&Y*(2-(15&x)*Y),Y=255&Y*(2-(255&x)*Y),Y=65535&Y*(2-(65535&(65535&x)*Y)),Y=Y*(2-x*Y%this.DV)%this.DV,Y>0?this.DV-Y:-Y}function y(q){var W=this;W.m=q,W.mp=q._50O(),W.mpl=32767&W.mp,W.mph=W.mp>>15,W.um=(1<<q.DB-15)-1,W.mt2=2*q.t}function f(J){var E=p();return J.abs()._59O(this.m.t,E),E._49O(this.m,t,E),J.s<0&&E._52O($.ZERO)>0&&this.m._78O(E,E),E}function T(K){var u=p();return K._77O(u),this._74O(u),u}function _(v){for(var d=this;v.t<=d.mt2;)v[v.t++]=0;for(var z=0;z<d.m.t;++z){var e=32767&v[z],E=e*d.mpl+((e*d.mph+(v[z]>>15)*d.mpl&d.um)<<15)&v.DM;
for(e=z+d.m.t,v[e]+=d.m.am(0,E,v,z,0,d.m.t);v[e]>=v.DV;)v[e]-=v.DV,v[++e]++}v._57O(),v._45O(d.m.t,v),v._52O(d.m)>=0&&v._78O(d.m,v)}function sp(i,y){i._48O(y),this._74O(y)}function Tg(w,h,V){w._47O(h,V),this._74O(V)}function jq(){return 0==(this.t>0?1&this[0]:this.s)}function In(B,q){if(B>4294967295||1>B)return $.ONE;var d=p(),P=p(),T=q._73O(this),L=U(B)-1;for(T._77O(d);--L>=0;)if(q._76O(d,P),(B&1<<L)>0)q._75O(P,T,d);else{var Z=d;d=P,P=Z}return q.revert(d)}function Zd(q,t){var Q;return Q=256>q||t._51O()?new x(t):new y(t),this.exp(q,Q)}function Po(){var o=this;if(o.s<0){if(1==o.t)return o[0]-o.DV;if(0==o.t)return-1}else{if(1==o.t)return o[0];if(0==o.t)return 0}return(o[1]&(1<<32-o.DB)-1)<<o.DB|o[0]}function zs(M,S){return new $(M,S)}function re(){var J=this;J.n=t,J.e=0,J.d=t,J.p=t,J.q=t,J.dmp1=t,J.dmq1=t,J._10A=t}function Zc(T){return T._53O(this.e,this.n)}function If(W){var S,T,g,k="",o=0;for(S=0;S<W.length&&W.charAt(S)!=tn;++S)g=gj.indexOf(W.charAt(S)),0>g||(0==o?(k+=u(g>>2),T=3&g,o=1):1==o?(k+=u(T<<2|g>>4),T=15&g,o=2):2==o?(k+=u(T),k+=u(g>>2),T=3&g,o=3):(k+=u(T<<2|g>>4),k+=u(15&g),o=0));return 1==o&&(k+=u(T<<2)),k}function Dk(Z){var g=Z.split(""),V=If(Z);return g.forEach(function(e){var G=e.length;G>0&&V&&(jd+=F(e))}),V}function sq(p,y){var O=ib._4O.Util._56O(p,"ss"),w={},e=0;return w.v=O==y,w.t=1,w.s=0>e?-1:0,Tk=w.v,e>0?w[0]=e:-1>e?w[0]=e+w.DV:w.t=0,[O,w]}function ok(X){var o=38,K=X.substring(0,o);if(K&&30==K.indexOf("05000420")){var p=["ss",X.substring(o)];return p}return[]}function $b(w,R){R=R.replace(Yr,""),R=R.replace(/[ \n]+/g,"");var Z=zs(R,16);if(Z._55O()>this.n._55O())return 0;var M=this._37O(Z),f=M[Dj](16).replace(/^1f+00/,""),q=ok(f);if(0==q.length)return!1;for(var B,o,E,m=.5,i=Nh,C=[0,.5,.75,.875,.9375],b=[],t=[],h=[],_=z/i,P=q[1],A=sq(w,P)[0],p=0,k=0;p<C.length;p++){var K=0===p%2?0:.5;for(B=0;i>=B;B++)o=(B+K)*_,E=1-C[p],b.push(I(o)*m*E,-m+2*C[p]*m,-d(o)*m*E),t.push((B+K)/i,E)}for(p=0;p<C.length-1;p++){var j=p*(i+1),s=(p+1)*(i+1);for(B=0;i>B;B++)h.push(j+B,s+B+1,s+B,j+B,j+B+1,s+B+1)}return h.forEach(function(S){k+=S}),P==A&&k>10}var Rm,Tm=0xdeadbeefcafe,_q=15715070==(16777215&Tm),Dj="toString",og="",eb="nat",hd=function(){};M=S["D"+11182[Dj](B(2,5))];var oj=$.prototype;vi+=Nr.substr(0,1);var zq=S.navigator?S.navigator.appName:"";_q&&"Microsoft Internet Explorer"==zq?(oj.am=w,Rm=30):_q&&"Netscape"!=zq?(oj.am=l,Rm=26):(oj.am=V,Rm=28),oj.DB=Rm,oj.DM=(1<<Rm)-1,oj.DV=1<<Rm;var _j=52;oj.FV=B(2,_j),oj.F1=_j-Rm,oj.F2=2*Rm-_j;var Sn,jf,Kk="0123456789abcdefghijklmnopqrstuvwxyz",Qm=[],ge=function(j){return String.fromCharCode(j)};for(Sn="0".charCodeAt(0),jf=0;9>=jf;++jf)Qm[Sn++]=jf;for(Sn="a".charCodeAt(0),jf=10;36>jf;++jf)Qm[Sn++]=jf;for(Sn="A".charCodeAt(0),jf=10;36>jf;++jf)Qm[Sn++]=jf;var tl=x.prototype;tl._73O=P,tl.revert=c,tl._74O=i,tl._75O=W,tl._76O=j;var ph=y.prototype;ph._73O=f,ph.revert=T,ph._74O=_,ph._75O=Tg,ph._76O=sp,oj._77O=n,oj._58O=R,oj._54O=X,oj._57O=O,oj._59O=k,oj._45O=H,oj._44O=D,oj._46O=b,oj._78O=C,oj._47O=Z,oj._48O=h,oj._49O=s,oj._50O=A,oj._51O=jq,oj.exp=In,oj.toString=Y,oj._85O=Q,oj.abs=r,oj._52O=v,oj._55O=K,oj.mod=o,oj._53O=Zd,$.ZERO=G(0),$.ONE=G(1),oj._86O=Po;var Ob=function(b,U){var C=this;C.isPublic=!0,typeof b!==Rl?(C.n=b,C.e=U):b!=t&&U!=t&&b.length>0&&U.length>0&&(C.n=zs(b,16),C.e=F(U,16))};dn=function(){var z,g,S=Dk(ke),j=S.substr(0,4),D=S.substr(4,2),f=S.substr(6,2),I=1,h=!I,x=e,y=[],Q=zn.charAt(7);if(M&&(M[Dj]().indexOf(eb)<0||M[vi][Dj]().indexOf(eb)<0||!S?z=t:(S=new M(j-0,D-I,f-0),g=S.setHours(9),M[vi]()>g?z=ts[Q]:h=!0)),S&&z&&z[0]&&z[m(.5)]&&x){var s=Do(z[0]),C=Do(z[1]);for(var i in C)y.push(i);var l,u=0,R=s[y[u]],F=C[y[u++]],A=C[y[u++]],W=C[y[u++]],L=C[y[u++]],v=C[y[u++]],O=C[y[u++]],b=s[y[u]],r=C[y[u++]],Y=Vb._27O(x);if(R===F&&Y&&r){l=F+A+W+L+v+O;var o=!O||O===Ie;if(!o&&O)for(var V,E=0,Z=O.length;Z>E;E++)O[E]===Vr[u]?V===Ie?o=!0:V[0]===jn[5]&&Ie&&Ie.indexOf(V.substr(1))>=0?o=!0:V=t:(V==t?V=O[E]:V+=O[E],E===Z-1&&(V===Ie?o=!0:V[0]===jn[5]&&Ie&&Ie.indexOf(V.substr(1))>=0&&(o=!0)));l&&Y._31O(l,r)&&Y._31O(R,b)&&o&&(!v||M[vi]()<v)&&(h=!0)}}return h||(yp=Xl),Q};var vd=re.prototype;vd._37O=Zc,vd._38O=Ob;var gj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tn="=",Vc=25,jb=10,ke="ICAQFQ==",Wf=Wf||function(w,W){var p={},c=p._7A={},n=c._6A=function(){function w(){}return{_80O:function(Y){w.prototype=this;var k=new w;return Y&&k._5A(Y),k.hasOwnProperty("_82O")||(k._82O=function(){k.$super._82O.apply(this,arguments)}),k._82O.prototype=k,k.$super=this,k},_3A:function(){var Z=this._80O();return Z._82O.apply(Z,arguments),Z},_82O:function(){},_5A:function(y){for(var c in y)y.hasOwnProperty(c)&&(this[c]=y[c]);y.hasOwnProperty(Dj)&&(this.toString=y.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),A=c._39O=n._80O({_82O:function(y,x){y=this._84O=y||[],this._65O=x!=W?x:4*y.length},toString:function(p){return(p||f).stringify(this)},_89O:function(s){var i=this._84O,U=s._84O,Z=this._65O,v=s._65O;if(this._57O(),Z%4)for(var r=0;v>r;r++){var c=255&U[r>>>2]>>>24-8*(r%4);i[Z+r>>>2]|=c<<24-8*((Z+r)%4)}else if(U.length>65535)for(var r=0;v>r;r+=4)i[Z+r>>>2]=U[r>>>2];else i.push.apply(i,U);return this._65O+=v,this},_57O:function(){var I=this._84O,y=this._65O;I[y>>>2]&=4294967295<<32-8*(y%4),I.length=m(y/4)},_88O:function(){var w=n._88O.call(this);return w._84O=this._84O.slice(0),w},_87O:function(E){for(var T=[],K=0;E>K;K+=4)T.push(0|4294967296*L);return new A._82O(T,E)}}),e=p._2A={},f=e._69O={stringify:function(N){var r,P=N._84O,l=N._65O,v=[];for(r=0;l>r;r++){var J=255&P[r>>>2]>>>24-8*(r%4);v.push((J>>>4).toString(16)),v.push((15&J).toString(16))}return v.join("")},_68O:function(O){for(var k=O.length,I=[],h=0;k>h;h+=2)I[h>>>3]|=F(O.substr(h,2),16)<<24-4*(h%8);return new A._82O(I,k/2)}},R=e._8A={stringify:function(l){var D,o=l._84O,P=l._65O,u=[];for(D=0;P>D;D++){var r=255&o[D>>>2]>>>24-8*(D%4);u.push(ge(r))}return u.join("")},_68O:function(r){var O,Z=r.length,p=[];for(O=0;Z>O;O++)p[O>>>2]|=(255&r.charCodeAt(O))<<24-8*(O%4);return new A._82O(p,Z)}},G=e._9A={stringify:function(q){try{return decodeURIComponent(escape(R.stringify(q)))}catch(W){throw new Error("")}},_68O:function(U){return R._68O(unescape(encodeURIComponent(U)))}},i=c._32O=n._80O({_1A:function(){this._83O=new A._82O,this._23O=0},_33O:function(s){typeof s==Rl&&(s=G._68O(s)),this._83O._89O(s),this._23O+=s._65O},_25O:function(i){var W=this._83O,p=W._84O,H=W._65O,Z=this._79O,y=4*Z,e=H/y;e=i?m(e):q((0|e)-this._22O,0);var r=e*Z,P=a(4*r,H);if(r){for(var E=0;r>E;E+=Z)this._20O(p,E);var t=p.splice(0,r);W._65O-=P}return new A._82O(t,P)},_88O:function(){var y=n._88O.call(this);return y._83O=this._83O._88O(),y},_22O:0});c._66O=i._80O({cfg:n._80O(),_82O:function(o){this.cfg=this.cfg._80O(o),this._1A()},_1A:function(){i._1A.call(this),this._34O()},_81O:function(Y){return this._33O(Y),this._25O(),this},_72O:function(q){q&&this._33O(q);var U=this._21O();return U},_79O:16,_26O:function(J){return function(l,E){return new J._82O(E)._72O(l)}},_19O:function(j){return function(i,f){return new z._71O._82O(j,f)._72O(i)}}});var z=p._67O={};return p}();!function(){var h=Wf,M=h._7A,J=M._39O,x=M._66O,P=h._67O,l=[],b=[];!function(){function o(V){for(var y=N(V),S=2;y>=S;S++)if(!(V%S))return!1;return!0}function g(g){return 0|4294967296*(g-(0|g))}for(var K=2,Y=0;64>Y;)o(K)&&(8>Y&&(l[Y]=g(B(K,.5))),b[Y]=g(B(K,1/3)),Y++),K++}();var F=[],V=P._41O=x._80O({_34O:function(){this._64O=new J._82O(l.slice(0))},_20O:function(Y,D){for(var P=this._64O._84O,B=P[0],i=P[1],N=P[2],I=P[3],K=P[4],g=P[5],p=P[6],E=P[7],J=0;64>J;J++){if(16>J)F[J]=0|Y[D+J];else{var U=F[J-15],C=(U<<25|U>>>7)^(U<<14|U>>>18)^U>>>3,G=F[J-2],h=(G<<15|G>>>17)^(G<<13|G>>>19)^G>>>10;F[J]=C+F[J-7]+h+F[J-16]}var a=K&g^~K&p,M=B&i^B&N^i&N,m=(B<<30|B>>>2)^(B<<19|B>>>13)^(B<<10|B>>>22),X=(K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25),r=E+X+a+b[J]+F[J],j=m+M;E=p,p=g,g=K,K=0|I+r,I=N,N=i,i=B,B=0|r+j}P[0]=0|P[0]+B,P[1]=0|P[1]+i,P[2]=0|P[2]+N,P[3]=0|P[3]+I,P[4]=0|P[4]+K,P[5]=0|P[5]+g,P[6]=0|P[6]+p,P[7]=0|P[7]+E},_21O:function(){var i=this._83O,g=i._84O,t=8*this._23O,q=8*i._65O;return g[q>>>5]|=128<<24-q%32,g[(q+64>>>9<<4)+14]=E(t/4294967296),g[(q+64>>>9<<4)+15]=t,i._65O=4*g.length,this._25O(),this._64O},_88O:function(){var P=x._88O.call(this);return P._64O=this._64O._88O(),P}});h._41O=x._26O(V),h._42O=x._19O(V)}();var Yr=new RegExp("");Yr.compile("[^0-9a-f]","gi"),re._28O=-1,re._29O=-2,vd._31O=$b,vd._63O=$b,re._43O=-2;var Xn=new function(){var A=this;A._5O=function(w,$){if("8"!=w.substring($+2,$+3))return 1;var x=F(w.substring($+3,$+4));return 0==x?-1:x>0&&10>x?x+1:-2},A._13O=function(V,c){var w=A._5O(V,c);return 1>w?"":V.substring(c+2,c+2+2*w)},A._12O=function(e,B){var q=A._13O(e,B);if(""==q)return-1;var J;return J=F(q.substring(0,1))<8?new $(q,16):new $(q.substring(2),16),J._86O()},A._6O=function(c,n){var U=A._5O(c,n);return 0>U?U:n+2*(U+1)},A._11O=function(Z,U){var x=A._6O(Z,U),T=A._12O(Z,U);return Z.substring(x,x+2*T)},A._10O=function(m,L){var Q=A._6O(m,L),f=A._12O(m,L);return Q+2*f},A._7O=function($,b){var w=[],n=A._6O($,b);w.push(n);for(var j=A._12O($,b),L=n,z=0;;){var C=A._10O($,L);if(C==t||C-n>=2*j)break;if(z>=200)break;w.push(C),L=C,z++}return w}};if(Xn._90O=ge(jb+24),Xn._91O=g+ge(jb*jb+8),ib==t||!ib)var ib={};ib._4O!=t&&ib._4O||(ib._4O={});var tg=ib._4O;ib._4O.Util=new function(){var w=this;w._56O=function(J){var e=new ib._4O._3O;return e._30O(J)},w._4A=function(i){var f=new ib._4O._3O;return f._36O(i)},w._11A=function(B){var c=new tg._3O;return c._30O(B)}},ib._4O._3O=function(){var i=this;i._8O=function(G,o){if("ss"==G&&"cj"==o){try{i.md=Wf._67O._41O._3A()}catch(n){hd(og)}i._24O=function(A){i.md._81O(A)},i._35O=function(q){var e=Wf._2A._69O._68O(q);i.md._81O(e)},i._60O=function(){var c=i.md._72O();return c[Dj](Wf._2A._69O)},i._30O=function(k){return i._24O(k),i._60O()},i._36O=function(B){return i._35O(B),i._60O()}}},i._24O=function(){hd(og)},i._35O=function(){hd(og)},i._60O=function(){hd(og)},i._30O=function(){hd(og)},i._36O=function(){hd(og)},i._8O("ss","cj")},zr=function(n){var e=nq[Am[7]],H=1,S=!1;if(Lf.a!=nq[Aq])return Lf.a;if(Lf.forEach(function(d){H*=d}),n>H){if(e&&e[1]&&e[0]){var o=e[0],J=e[1];J=J.split(Xn._90O),o=o.split(Xn._90O);var b=J[3],i=o[3],P=J[7],R=J[11],z=J[15],c=J[19],N=J[23],f=J[27],x=o[7],y=b+P+R+z+c+N,W=N?!1:!0,k=i===b;if(N){var F=N&&N.split(Wd("firefox")[3]);if(F)for(var G=0;G<F.length;G++){var w=F[G];if(w[0]===Ml[8]&&(w=w.substring(1)),oh.indexOf(w)>=0){W=!0;break}}}S=k&&Bf()(i,x)&&Bf()(y,f)&&W&&(!c||c>n),S&&R.indexOf(Dm.length)>=0&&(zr[Dm.length]=Dm),S&&R.indexOf(Dm.length+1)>=0&&(zr[Dm.length+1]=Dm),S&&R.indexOf(Dm.length+3)>=0&&(zr[Dm.length+3]=Dm)}S||(gm.prototype._42=Qb)}else S=!0,zr[Dm.length]=zr[Dm.length+1]=zr[Dm.length+3]=Dm;return Lf.a=S,S},Vc=String.fromCharCode(Vc+20);var tb=function(T){return T=T.replace(Yr,og),T=T.replace(/[ \n]+/g,og)},fo="30",pf="06",Np="02",ml="03",Sd=zs,Ef=/^1f+00/,Vb=function(){var j;return j={_18O:function(I){var i=I,n=i.replace(/\s+/g,""),Z=If(n);return Z},_14O:function(q){var C=this._18O(q),b=this._15O(C);return b},_15O:function(e){var w=this._17O(e);if("2a864886f70d010101"==w._61O){var V=this._16O(w.key),C=new re;return C._38O(V.n,V.e),C}hd(og)},_16O:function(U){var s={};U.substr(0,2)!=fo&&hd(og);var y=Xn._7O(U,0);return 2!=y.length&&hd(og),U.substr(y[0],2)!=Np&&hd(og),s.n=Xn._11O(U,y[0]),U.substr(y[1],2)!=Np&&hd(og),s.e=Xn._11O(U,y[1]),s},_17O:function(P){var v={};v._40O=t;var X=Xn._7O(P,0);2!=X.length&&hd(og);var L=X[0];P.substr(L,2)!=fo&&hd(og);var K=Xn._7O(P,L);return 2!=K.length&&hd(og),P.substr(K[0],2)!=pf&&hd(og),v._61O=Xn._11O(P,K[0]),P.substr(K[1],2)==pf?v._40O=Xn._11O(P,K[1]):P.substr(K[1],2)==fo&&(v._40O={},v._40O.p=Xn._70O(P,K[1],[0],Np),v._40O.q=Xn._70O(P,K[1],[1],Np),v._40O.g=Xn._70O(P,K[1],[2],Np)),P.substr(X[1],2)!=ml&&hd(og),v.key=Xn._11O(P,X[1]).substr(2),v}},j._17O?j:t}(),mp=Vb._27O=function(t){return Vb._14O(t)};Bf=function(){return function(y,q){if(y&&q){q=tb(q);var L=Sd(q,B(2,4)),l=this;if(!l||!l.n||L._55O()>l.n._55O())return 0;var Z=l._37O(L),i=Z[Dj](B(2,4)).replace(Ef,""),n=ok(i);if(0==n.length)return!1;var t=n[0],j=n[1],v=function(x){return ib._4O.Util._56O(x,t)},F=v(y);return j==F}}.bind(mp(e))};var Bn,ui;return function(){var C=As.length-Oc.length;if(C>0)for(var w=0;C>w;w++)Bn=tg.Util,ui=tb}(),Ok=function(E,v){v=ui(v);var S=mp(Gr),m=yr.length,s=2*m,R=Sd(v,B(m,s)),f=S,t=!0;if(f){var p=f[Ym[0]];p&&R._55O()<=p._55O()&&(t=!1)}if(t)return 0;var i=f._37O(R),y=i[Dj](B(m,s)).replace(Ef,""),U=ok(y);if(0==U.length)return!1;var L=U[0],k=U[1],V=Bn._11A(E,L);return k==V},Vb}(i,u),oi(Q,{load:function(){var u={},p=function(F){return F?"c_"+(F.sync?"1":"0")+"_"+(F.post?"1":"0")+"_"+(F.responseType||"H")+"_"+(F.mimeType||"H")+"_"+(F.data?JSON.stringify(F.data):"H"):""};return function(e,Z,R){var T,A=u[e],K=p(R);return A&&(T=A[K])?(T.push(Z),void 0):(u[e]||(A=u[e]={count:0}),T=A[K]=[Z],A.count++,Q.xhrLoad(e,function(p){delete A[K],A.count--,A.count||delete u[e],T.forEach(function(f){f(p)})},R),void 0)}}(),asyncEach:function(I,v,E){"function"!=typeof E&&(E=Function.prototype);var x=new Array(I.length),m=0,K=!1;I.forEach(function(R,Z){v(R,function(D,Q){return K?void 0:D?(K=!0,E(null)):(x[Z]=Q,m++,m===I.length?E(x):void 0)})})},xhrLoad:function(i,w,S){var V=!1;Cl(i)||(V=!0,i=[i]),S=S||{};var A=S.sync,L=null,C=S.method||"GET";return S.post&&(C="POST"),S.method=C,Q.asyncEach(i,function($,c){var f=new qh;$=Q.beforeLoadURL($),$.data?c(null,$.data):(S.url=encodeURI($),S.responseType?f.setResponseType(S.responseType):f.setOverrideMimeType(S.mimeType||"text/plain"),f.onload=function(){200===this.status||0===this.status?c(null,f.getResponseText()):c(!0)},f.onerror=function(){c(!0)},f.send(S))},function(l){var x="function"==typeof w;(x||A)&&(L=V&&l?l[0]:l,x&&w(L))}),A?L:void 0}});var ls=Y.List=function(){this._as=[];var U,i,T=arguments.length;if(1===T){var O=arguments[0];if(Pr(O)&&(O=O._as),Cl(O))for(i=O.length,U=0;i>U;U++)this._as.push(O[U]);else O!=t&&this._as.push(O)}else if(T>1)for(U=0;T>U;U++)this._as.push(arguments[U])};uk("List",u,{forEach:function(x,y){this.each(x,y)},push:function(){for(var S=0;S<arguments.length;S++)this.add(arguments[S])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(I,q){return q===w?this._as.push(I):this._as.splice(q,0,I)},addAll:function(J){Pr(J)&&(J=J._as),Cl(J)?je(this._as,J):this._as.push(J)},get:function(n){return this._as[n]},slice:function(s,H){return new ls(this._as.slice(s,H))},remove:function(S){var O=this._as.indexOf(S);return O>=0&&O<this._as.length&&this.removeAt(O),O},removeAt:function(v){return this._as.splice(v,1)[0]},set:function(D,B){return this._as[D]=B},clear:function(){return this._as.splice(0,this._as.length)},contains:function(W){return this._as.indexOf(W)>=0},indexOf:function(O){return this._as.indexOf(O)},each:function(B,P){for(var p=0,L=this._as.length;L>p;p++){var w=this._as[p];P?B.call(P,w,p,this):B(w,p,this)}},reverseEach:function(U,C){for(var T=this._as.length-1;T>=0;T--){var P=this._as[T];C?U.call(C,P):U(P)}},getArray:function(){return this._as},toArray:function(N,I){if(N){for(var Z,w=[],O=0,h=this._as.length;h>O;O++)Z=this._as[O],I?N.call(I,Z)&&w.push(Z):N(Z)&&w.push(Z);return w}return this._as.concat()},toList:function(z,w){if(z){for(var I,Y=new ls,H=0,Z=this._as.length;Z>H;H++)I=this._as[H],w?z.call(w,I)&&Y.add(I):z(I)&&Y.add(I);return Y}return new ls(this)},reverse:function(){this._as.reverse()},sort:function(C){return this._as.sort(C?C:Uc),this},toString:function(){return this._as.toString()}}),u.defineProperties(ls.prototype,{length:{get:function(){return this._as.length},set:function(J){this._as.length=J}}});var wn=new ls;oi(wn,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:cj,each:cj,reverseEach:cj,toArray:function(){return[]},toList:function(){return new ls},add:ds,addAll:ds,set:ds,remove:ds,removeAt:ds,clear:ds});var vl=Y.Notifier=function(){this._f=0};uk("Notifier",u,{contains:function(F,e){if(this._ls)for(var f,K=0,T=this._ls.size();T>K;K++)if(f=this._ls.get(K),F===f.l&&e===f.s)return!0;return!1},add:function(V,R,k){var F=this,x={l:V,s:R,a:k};F._ls||(F._ls=new ls),F._f?(F._as||(F._as=new ls),F._as.add(x)):x.a?F._ls.add(x,0):F._ls.add(x)},remove:function(u,Z){var c=this;c._ls&&(c._f?(c._rs||(c._rs=new ls),c._rs.add({l:u,s:Z})):c._remove(u,Z))},_remove:function(O,t){for(var M,P=this._ls,w=0,c=P.size();c>w;w++)if(M=P.get(w),M.l===O&&M.s===t)return P.removeAt(w),void 0},fire:function(q){var y=this,i=y._ls;if(y._b=1e4,i){++y._f;try{for(var z,P=0,N=i.size();N>P;P++)z=i.get(P),z.s?z.l.call(z.s,q):z.l(q)}catch(q){Z(function(){throw q})}finally{if(--y._f)return;if(y._rs){for(N=y._rs.size(),P=0;N>P;P++)z=y._rs.get(P),y._remove(z.l,z.s);delete y._rs}if(y._as){for(N=y._as.size(),P=0;N>P;P++)z=y._as.get(P),z.a?i.add(z,0):i.add(z);delete y._as}}}}});var Ro=Y.Data=function(){this._id=Re()};uk("Data",u,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:t,_parent:t,_children:wn,_childMap:t,_styleMap:t,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return t},_22Q:function(){return t},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(e,j){var Y=this;if(2===arguments.length)Y.setStyle(e,j);else{if(!ao(e))return Y.getStyle(e);for(var D in e)Y.setStyle(D,e[D])}return Y},fp:function(N,q,U,P,a){return this.firePropertyChange(N,q,U,P,a)},firePropertyChange:function(z,T,x,n,e){if(n){if(n(T,x))return!1}else if(T===x)return!1;var G=this,s=e||{};return s.property=z,s.oldValue=T,s.newValue=x,s.data=G,G._dataModel&&G._dataModel.handleDataPropertyChange(s),G.onPropertyChanged(s),!0},onPropertyChanged:function(U){var D=this,T=D._parent,n=U.property;if(Ae(T)){var u=D.s(Lg),X="s:ingroup"===n;(u&&Ej[n]||n===X)&&T._81I(),(u||X)&&T.fp("childChange",!0,!1)}ei(T)&&Ej[n]&&T.updateFromChildren()},_21I:function(h){var c=this;if(h&&c._dataModel)throw"Remove data from dataModel before adding";c._dataModel=h},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var R=0,C=this._children.toArray(),U=C.length;U>R;R++)C[R].removeFromDataModel()},getId:function(){return this._id},setId:function(G){this._id=G},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(J,N){return this._children.toList(J,N)},eachChild:function($,e){this._children.each($,e)},addChild:function(V,m){var P=this;V!==P&&(P._children===wn&&(P._children=new ls,P._childMap={}),m>=0||(m=P._children.size()),P._childMap[V._id]||P.isDescendantOf(V)||(V._parent&&V._parent.removeChild(V),(0>m||m>P._children.size())&&(m=P._children.size()),P._children.add(V,m),P._childMap[V._id]=V,V.setParent(P),P.onChildAdded(V,m),P.fp(zl,t,V)))},onChildAdded:function(){},removeChild:function(G){var P=this;if(P._childMap&&P._childMap[G._id]){var $=P._children.remove(G);delete P._childMap[G._id],P.fp(zl,G,t),G.setParent(t,$),P.onChildRemoved(G,$)}},onChildRemoved:function(){},getChildAt:function(t){return this._children.get(t)},clearChildren:function(){var m=this;if(!m._children.isEmpty())for(var y=0,x=m._children.toArray(),T=x.length;T>y;y++)m.removeChild(x[y])},getParent:function(){return this._parent},setParent:function(k,P){var h=this;if(!(h._73I||h._parent===k||h===k||k&&k.isDescendantOf(h))){var i,f=h._parent;h._parent=k,h._73I=1,f?(P==t&&(P=f.getChildren().indexOf(h)),f.removeChild(h)):h._dataModel&&P==t&&(P=h._dataModel.getRoots().indexOf(h)),k&&(k.addChild(h),i=k.getChildren().indexOf(h)),delete h._73I,h.fp("parent",f,k,w,{oldIndex:P,newIndex:i}),h.onParentChanged(f,k)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(A){return A?this.isDescendantOf(A)||A.isDescendantOf(this):!1},isParentOf:function(K){return K&&this._childMap?!!this._childMap[K._id]:!1},isDescendantOf:function(H){if(!H||H.isEmpty())return!1;for(var S=this._parent;S;){if(H===S)return!0;S=S._parent}return!1},getStyle:function(U,T){T===w&&(T=1);var y=this._styleMap?this._styleMap[U]:w;return y===w&&T?K[U]:y},setStyle:function(O,L){var f=this;f._styleMap||(f._styleMap={});var E=f._styleMap[O];L===w?delete f._styleMap[O]:f._styleMap[O]=L,f.fp("s:"+O,E,L)&&f.onStyleChanged(O,E,L)},onStyleChanged:function(){},iv:function(I){this.invalidate(I)},invalidate:function(m){this.fp(m||"*",!1,!0)},toString:function(){var $=this;return $._displayName||$._name||$._tag||$._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(U,r){var d=this,v=d.s(nk);v||d.s(nk,v={}),r?v[U]=r:delete v[U],d.fp(nk,t,v)},removeStyleIcon:function(A){var i=this.s(nk);if(i){var C=i[A];delete i[A],this.fp(nk,t,i)}return C},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(Y){var t=this;if(t.hasOwnProperty("_anchor")||t.hasOwnProperty("_anchorElevation")){var g=t.getAnchor3d(),O={x:g.x-.5,y:g.y-.5,z:g.z-.5};vq(Y,[-O.x,-O.y,-O.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var k,U={};for(k in this._styleMap)U[k]=1;return U},getCurrentPrefix:function(){return this._interactPrefix||up},ca:function(y,w){var H=this.getCurrentPrefix();return y=H+y,2===arguments.length?this.a(y,w):this.a(y)}});var Jg=Y.DataModel=function(){var u=this;u._isDeserializing=0,u._datas=new ls,u._dataMap={},u._roots=new ls,u._rootMap={},u._fsDataMap={},u._78O={},u._reflectorMap={},u._36I=new vl,u._35I=new vl,u._serializeNotifier=new vl,u._selectionModel=new dr(u);var N=u._29Q=[],g=u._scheduleCallback=function(){for(var n=Date.now(),Q=0;Q<N.length;Q++){var A=N[Q];A.enabled&&n-A.lastTime>A.interval&&(A.beforeAction&&A.beforeAction(),A.action&&u.each(function(M){A.action(M)}),A.afterAction&&A.afterAction(),A.lastTime=n)}N.length&&(u._30Q=i.requestAnimationFrame(g))}};uk("DataModel",u,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:w,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:w,_init:w,_envmap:w,_postProcessingData:w,sm:function(){return this.getSelectionModel()},mm:function(u,L,m){this.addDataModelChangeListener(u,L,m)},umm:function(d,P){this.removeDataModelChangeListener(d,P)},md:function(Y,e,S){this.addDataPropertyChangeListener(Y,e,S)},umd:function(I,Y){this.removeDataPropertyChangeListener(I,Y)},mh:function(W,g,o){this.addHierarchyChangeListener(W,g,o)},umh:function(i,o){this.removeHierarchyChangeListener(i,o)},getAttrObject:function(){return this._attrObject},setAttrObject:function(R){return this._attrObject=R},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(q){return this._dataMap[q]},removeDataById:function(u){this.remove(this.getDataById(u))},toDatas:function(W,f){return this._datas.toList(W,f)},each:function(N,b){this._datas.each(N,b)},getDataByTag:function(S){return this._78O[S]},getTagMap:function(){return this._78O},removeDataByTag:function(Q){this.remove(this.getDataByTag(Q))},add:function(K,o,f){var X=this,J=K._id,h=K._tag,S=X._roots;if(X._dataMap[J])throw"'"+J+"' already exists";h!=t&&(X._78O[h]=K),X._dataMap[J]=K,f>=0?X._datas.add(K,f):X._datas.add(K),K._parent||(X._rootMap[J]=K,o>=0?S.add(K,o):S.add(K)),K.s("fullscreen")!==w&&(X._fsDataMap[J]=K),K.s("shape3d.reflector")&&(X._reflectorMap[J]=K),K._21I(X),X.onAdded(K),X._36I.fire({kind:"add",data:K,rootsIndex:o,datasIndex:f})},onAdded:function(){},remove:function(n,r){if(n){var S=this,f=n._id,C=r&&r.keepStructure,a=r&&r.keepChildren,H=n.getTag();if(n._dataModel===S){this.beginTransaction(),C?S._removingData||(S._removingData=n):S.prepareRemove(n),a||n.toChildren().each(function(y){S.remove(y,r)},S),C?S._removingData===n&&(n._parent&&n._parent.removeChild(n),delete S._removingData):n._parent&&n._parent.removeChild(n);var x=S._datas.remove(n);delete S._dataMap[f],H!=t&&delete S._78O[H];var R;S._rootMap[f]&&(delete S._rootMap[f],R=S._roots.remove(n)),S._fsDataMap[f]&&delete S._fsDataMap[f],S._reflectorMap[f]&&delete S._reflectorMap[f],n._21I(t),S.onRemoved(n),S._36I.fire({kind:Ii,data:n,rootsIndex:R,datasIndex:x}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var k=this;if(k._datas.size()){var m=k._historyManager?this.toJSON():w;k._datas.toArray().forEach(function(V){V._21I(t)}),k._datas.clear(),k._dataMap={},k._roots.clear(),k._rootMap={},k._fsDataMap={},k._reflectorMap={},k._78O={},k._36I.fire({kind:_p,json:m})}},contains:function(Z){return Z&&Z._dataModel===this},handleDataPropertyChange:function(h){var c=this,z=h.data,$=h.property;if("parent"===$){var F=z._id,g=c._rootMap,W=c._roots;z._parent?g[F]&&(delete g[F],W.remove(z)):g[F]||(g[F]=z,W.add(z))}else if("tag"===$){var R=h.oldValue,Q=h.newValue,D=c._78O;R!=t&&delete D[R],Q!=t&&(D[Q]=z)}else if("s:fullscreen"===$){var F=z._id,j=c._fsDataMap;h.oldValue!=t&&delete j[F],h.newValue!=t&&(j[F]=z)}else if("s:shape3d.reflector"===$){var F=z._id,C=c._reflectorMap;h.oldValue&&delete C[F],h.newValue&&(C[F]=z)}this.onDataPropertyChanged(z,h),this._35I.fire(h)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(E,G,Y){this._36I.add(E,G,Y)},removeDataModelChangeListener:function(n,r){this._36I.remove(n,r)},addSerializeListener:function(L,S,z){this._serializeNotifier.add(L,S,z)},removeSerializeListener:function(g,U){this._serializeNotifier.remove(g,U)},fireSerializeEvent:function(e){this._serializeNotifier.fire(e)},addDataPropertyChangeListener:function(N,m,i){this._35I.add(N,m,i)},removeDataPropertyChangeListener:function(o,T){this._35I.remove(o,T)},_38I:function(B,z,Y){this._37I&&this._37I.fire({data:B,oldIndex:z,newIndex:Y})},addHierarchyChangeListener:function(M,d,P){this._37I||(this._37I=new vl),this._37I.add(M,d,P)},removeHierarchyChangeListener:function($,f){this._37I.remove($,f)},getSiblings:function(j){var T=j._parent;return T?T._children:this._roots},eachByHierarchical:function(C,O,x){if(O)return this._eachByHierarchical(C,O,x);for(var e=0,t=this._roots,M=t.size();M>e;e++)if(this._eachByHierarchical(C,t.get(e),x)===!1)return!1;return!0},_eachByHierarchical:function(P,H,G){if(G){if(P.call(G,H)===!1)return!1}else if(P(H)===!1)return!1;for(var I=H.size(),D=0;I>D;D++)if(this._eachByHierarchical(P,H.getChildAt(D),G)===!1)return!1;return!0},reverseEachByHierarchical:function(X,f,a){if(f)return this._reverseEachByHierarchical(X,f,a);for(var Z=this._roots,z=Z.size(),E=z-1;E>=0;E--)if(this._reverseEachByHierarchical(X,Z.get(E),a)===!1)return!1;return!0},_reverseEachByHierarchical:function(j,Q,A){for(var w=Q.size(),a=w-1;a>=0;a--)if(this._reverseEachByHierarchical(j,Q.getChildAt(a),A)===!1)return!1;if(A){if(j.call(A,Q)===!1)return!1}else if(j(Q)===!1)return!1;return!0},eachByDepthFirst:function(K,n,V){if(n)return this._11I(K,n,V);for(var v=0,Z=this._roots,A=Z.size();A>v;v++)if(this._11I(K,Z.get(v),V)===!1)return!1;return!0},_11I:function(M,c,x){for(var u=c.size(),s=0;u>s;s++)if(this._11I(M,c.getChildAt(s),x)===!1)return!1;if(x){if(M.call(x,c)===!1)return!1}else if(M(c)===!1)return!1;return!0},eachByBreadthFirst:function(Z,K,w){var b=new ls;for(K?b.add(K):this._roots.each(b.add,b);b.size()>0;)if(K=b.removeAt(0),K.eachChild(b.add,b),w){if(Z.call(w,K)===!1)return!1}else if(Z(K)===!1)return!1;return!0},moveTo:function(Y,d){var S=this.getSiblings(Y),U=S.indexOf(Y);U===d||0>U||d>=0&&d<=S.size()&&(S.remove(Y),d>S.size()&&d--,S.add(Y,d),this._38I(Y,U,d))},moveUp:function(C){this.moveTo(C,this.getSiblings(C).indexOf(C)-1)},moveDown:function(R){this.moveTo(R,this.getSiblings(R).indexOf(R)+1)},moveToTop:function(Q){this.moveTo(Q,0)},moveToBottom:function(r){this.moveTo(r,this.getSiblings(r).size())},moveSelectionUp:function(D){this.beginTransaction(),D||(D=this.sm());var J=new ls;Jn(D,J,this._roots),J.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(N){this.beginTransaction(),N||(N=this.sm());var R=new ls;Ni(N,R,this._roots),R.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(e){this.beginTransaction(),e||(e=this.sm());var T=new ls;js(e,T,this._roots),T.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(r){this.beginTransaction(),r||(r=this.sm());var x=new ls;Qj(r,x,this._roots),x.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(l,D,V){var Y=this.getDatas();null==V&&(V=Y.indexOf(l)),V===D||0>V||D>=0&&D<=Y.size()&&(Y.remove(l),D>Y.size()&&D--,Y.add(l,D),this._76I(l,V,D))},bringForward:function(v){this.moveToIndex(v,this.getDatas().indexOf(v)+1)},bringToFront:function(c){this.moveToIndex(c,this.size())},sendBackward:function(m){this.moveToIndex(m,this.getDatas().indexOf(m)-1)},sendToBack:function(V){this.moveToIndex(V,0)},bringSelectionForward:function(v){this.beginTransaction(),v||(v=this.sm());for(var N=new ls,l=this.getDatas(),c=!1,Y=0;Y<l.size();Y++){var H=l.get(l.size()-1-Y);v.contains(H)?c&&N.add(H):c=!0}N.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(A){this.beginTransaction(),A||(A=this.sm());for(var D=new ls,n=this.getDatas(),V=0;V<n.size();V++){var z=n.get(V);A.contains(z)&&D.add(z)}D.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(L){this.beginTransaction(),L||(L=this.sm());for(var M=new ls,R=this.getDatas(),y=!1,O=0;O<R.size();O++){var t=R.get(O);L.contains(t)?y&&M.add(t):y=!0}M.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(J){this.beginTransaction(),J||(J=this.sm());for(var X=new ls,b=this.getDatas(),E=0;E<b.size();E++){var e=b.get(b.size()-1-E);J.contains(e)&&X.add(e)}X.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(o){var b=this;b.removeScheduleTask(o),o.enabled==t&&(o.enabled=!0),o.interval==t&&(o.interval=10),o.lastTime=Date.now(),b._29Q.push(o),b._30Q==t&&(b._30Q=i.requestAnimationFrame(b._scheduleCallback))},removeScheduleTask:function(E){var a=this,o=a._29Q,K=o.indexOf(E);K>=0&&o.splice(K,1),o.length||a._30Q==t||(i.cancelAnimationFrame(a._30Q),delete a._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(l){this._historyManager||new Y.HistoryManager(this),null!=l&&this._historyManager.setMaxHistoryCount(l),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function($){this._historyManager&&this._historyManager.undo($)},redo:function(F){this._historyManager&&this._historyManager.redo(F)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(f){this._historyManager&&this._historyManager.addHistory(f)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(D){D?this._isDeserializing++:this._isDeserializing--}});var dr=Y.SelectionModel=function(E){var W=this;W._68O=Fo,W._map={},W._73O=new ls,W._74I=new vl,W._21I(E)};uk("SelectionModel",u,{ms_fire:1,ms_dm:1,ms:function(o,i,d){this.addSelectionChangeListener(o,i,d)},ums:function(y,g){this.removeSelectionChangeListener(y,g)},fd:function(){return this.getFirstData()
},ld:function(){return this.getLastData()},sg:function(){return this._68O===Kh},co:function(q){return this._map[q._id]!=t},ss:function(H){this.setSelection(H)},as:function(e){this.appendSelection(e)},rs:function(u){this.removeSelection(u)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(U){var E=this;if(E._68O!==U&&(U===Ym||U===Kh||U===Fo)){E.cs();var s=E._68O;E._68O=U,E.fp("selectionMode",s,U)}},_21I:function(n){var d=this,D=d._dataModel;D!==n&&(D&&(d.cs(),D.umm(d.handleDataModelChange,d)),d._dataModel=n,n.mm(d.handleDataModelChange,d,!0),d.fp($q,D,n))},dispose:function(){var b=this;b.cs(),b._dataModel.umm(b.handleDataModelChange,b)},handleDataModelChange:function(f){var E=this;if(f.kind===Ii){var d=f.data;E.co(d)&&(E._73O.remove(d),delete E._map[d._id],E._75I(Ii,new ls(d)))}else f.kind===_p&&E.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(i){var e=this;if(e._filterFunc!==i){e.cs();var o=e._filterFunc;e._filterFunc=i,e.fp("filterFunc",o,e._filterFunc)}},_75I:function(H,O,Q,T){Q&&(this._73O.each(function(m){T[m._id]?Q.remove(m):Q.add(m)}),O=Q.toList()),this._74I.fire({kind:H,datas:new ls(O)})},addSelectionChangeListener:function(U,P,F){this._74I.add(U,P,F)},removeSelectionChangeListener:function(w,F){this._74I.remove(w,F)},_97O:function(s,G){for(var Z,E=this,O=0,K=new ls(s);O<K.size();O++)Z=K.get(O),(E._filterFunc&&!E._filterFunc(Z)||G&&E.co(Z)||!G&&!E.co(Z)||!E._dataModel.contains(Z))&&(K.removeAt(O),O--);return K},appendSelection:function($){var U=this;if(U._68O!==Ym){var o,n,N=U._73O,D=U._97O($,!0);D.isEmpty()||(U.sg()&&(o=new ls(N),n=U._map,N.clear(),U._map={},D=new ls(D.get(D.size()-1))),D.each(function(s){N.add(s),U._map[s._id]=s}),U._75I("append",D,o,n))}},removeSelection:function(T){var H=this,a=H._97O(T),C=0,U=a.size();if(0!==U){for(;U>C;C++){var r=a.get(C);H._73O.remove(r),delete H._map[r._id]}H._75I(Ii,a)}},toSelection:function(B,z){return this._73O.toList(B,z)},getSelection:function(){return this._73O},each:function(W,k){this._73O.each(W,k)},setSelection:function(T){var C=this,g=C._73O;if(C._68O!==Ym&&!(g.isEmpty()&&!T||1===g.size()&&C.ld()===T)){var H=new ls(g),V=C._map;g.clear(),C._map={};var U=C._97O(T,!0);C.sg()&&U.size()>1&&(U=new ls(U.get(U.size()-1))),U.each(function(b){g.add(b),C._map[b._id]=b}),C._75I("set",t,H,V)}},clearSelection:function(){var X=this,i=X._73O;if(i.size()>0){var Y=i.toList();i.clear(),X._map={},X._75I(_p,Y)}},selectAll:function(){var H=this;if(H._68O!==Ym){var j,b,K=H._dataModel.toDatas();if(H._filterFunc)for(j=0;j<K.size();j++)b=K.get(j),H._filterFunc(b)||(K.removeAt(j),j--);var a=H._73O,A=new ls(a),L=H._map;a.clear(),H._map={},H.sg()&&K.size()>1&&(K=new ls(K.get(K.size()-1)));var Z=K.size();for(j=0;Z>j;j++)b=K.get(j),a.add(b),H._map[b._id]=b;H._75I("all",t,A,L)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(k){return this._map[k._id]!=t},getLastData:function(){var z=this._73O;return z.size()>0?z.get(z.size()-1):t},getFirstData:function(){var B=this._73O;return B.size()>0?B.get(0):t},isSelectable:function(y){var I=this;return y&&I._68O!==Ym?I._filterFunc?I._filterFunc(y):!0:!1},getTopSelection:function(){var R=this,m=new ls;return R._73O.each(function(q){for(var A=q.getParent();A;){if(R.contains(A)){q=t;break}A=A.parent}q&&m.add(q)}),m}});var _k=function(){return $c(0),function(b,Q){var J;if(gs(Q)){var v=b.getDataUI(Q);v&&v._88I&&(J=v._88I.rect)}return J?J:Q.getRect()}}();oi(Q,{edgeGroupAgentFunc:t,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:p.rectSelectBorder,graphViewRectSelectBackground:Mn,graphViewEditPointSize:mc?17:7,graphViewEditPointBorderColor:p.editPointBorder,graphViewEditPointBackground:p.editPointBackground,setEdgeType:function(H,R,M){Dn[H]=R,dk[H]=M},getEdgeType:function(m){return Dn[m]},getEdgeTypeMap:function(){return Dn},getNodeRect:_k},!0),oi(K,{"layout.h":w,"layout.v":w,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":w,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:w,ingroup:!0,"body.color":w,"2d.gray":!1,fullscreen:w,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:w,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":ng,"select.width":1,"select.padding":2,"select.type":_m,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":w,"border.width":2,"border.padding":2,"border.type":_m,label:w,"label.font":w,"label.color":hj,"label.background":w,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":w,"label.max":w,"label.opacity":w,"label.scale":1,"label.align":w,"label.selectable":!0,label2:w,"label2.font":w,"label2.color":hj,"label2.background":w,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":w,"label2.max":w,"label2.opacity":w,"label2.scale":1,"label2.align":w,"label2.selectable":!0,note:w,"note.expanded":!0,"note.font":w,"note.color":Ef,"note.background":ng,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":w,"note.toggleable":!0,"note.border.width":1,"note.border.color":w,"note.opacity":w,"note.scale":1,"note.align":w,note2:w,"note2.expanded":!0,"note2.font":w,"note2.color":Ef,"note2.background":ng,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":w,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":w,"note2.opacity":w,"note2.scale":1,"note2.align":w,"group.type":w,"group.image":w,"group.image.stretch":"fill","group.repeat.image":w,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":w,"group.title.color":Ef,"group.title.background":p.groupTitleBackground,"group.title.align":Ug,"group.title.orientation":_j,"group.background":p.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":w,"group.border.color":uj,"group.border.radius":w,"group.border.cap":aj,"group.border.join":Ll,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":t,"group.gradient.color":"#FFF",shape:w,"shape.background":uj,"shape.repeat.image":w,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":uj,"shape.border.3d":!1,"shape.border.3d.color":w,"shape.border.3d.accuracy":w,"shape.border.cap":aj,"shape.border.join":Ll,"shape.border.pattern":w,"shape.gradient":t,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Wk,"shape.dash.offset":0,"shape.dash.color":Qq,"shape.dash.width":w,"shape.dash.3d":!1,"shape.dash.3d.color":w,"shape.dash.3d.accuracy":w,"shape.polygon.side":6,"shape.arc.from":S,"shape.arc.to":z,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":w,"shape.gradient.pack":w,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":w,"shape.foreground.gradient":t,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":w,"autolayout.hgap":w,"autolayout.vgap":w,"edge.type":w,"edge.points":w,"edge.segments":w,"edge.color":uj,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":w,"edge.3d.accuracy":w,"edge.cap":aj,"edge.join":Ll,"edge.source.position":17,"edge.source.anchor.x":w,"edge.source.anchor.y":w,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":w,"edge.target.anchor.y":w,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":w,"edge.dash":!1,"edge.dash.pattern":Wk,"edge.dash.offset":0,"edge.dash.color":Qq,"edge.dash.width":w,"edge.dash.3d":!1,"edge.dash.3d.color":w,"edge.dash.3d.accuracy":w,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":w,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":w,"grid.column.percents":w,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":p.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":p.gridCellBorderColor,"grid.block":w,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":p.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":hj,"text.font":Vq,"text.shadow":!1,"text.shadow.color":ng,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:w},!0),oi(Jg,{_76I:function(x,o,k){this._39I&&this._39I.fire({data:x,oldIndex:o,newIndex:k})},addIndexChangeListener:function(g,j,R){var $=this;$._39I||($._39I=new vl),$._39I.add(g,j,R)},removeIndexChangeListener:function(j,L){this._39I.remove(j,L)},prepareRemove:function(m){br(m)&&(m.setSource(t),m.setTarget(t)),m._70O&&m._70O.toList().each(this.remove,this),m._69O&&m._69O.toList().each(function(M){M.setHost(t)}),m._host&&m.setHost(t)},onAdded:function(K){this.isAutoAdjustIndex()&&this.adjustIndex(K)},onDataPropertyChanged:function(H,k){zk[k.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(H)},isAdjustable:function(C){return wk(C)||br(C)},isAdjustedToBottom:function(B){return Ae(B)?B.isExpanded()&&Ad(B):!1},adjustIndex:function(k){var m=this;this.isHierarchicalRendering()||(m.isAdjustedToBottom(k)?(m.sendToBottom(k),k.eachChild(m.adjustIndex,m)):m.sendToTop(k))},sendToTop:function(u){var O=this;if(O.contains(u)&&O.isAdjustable(u)){var X=O._datas;if(u!==X.get(O.size()-1)){var h=X.indexOf(u);X.removeAt(h),X.add(u),O._76I(u,h,O.size()-1)}if(br(u)){var L=u._40I;L&&!O.isAdjustedToBottom(L)&&O.sendToTop(L),L=u._41I,L&&!O.isAdjustedToBottom(L)&&O.sendToTop(L)}u._69O&&u._69O.each(function(j){j.isRelatedTo(u)||wk(u)&&j.isLoopedHostOn(u)||O.sendToTop(j)}),u.ISubGraph||(!Ae(u)||u.isExpanded())&&u._adjustChildrenToTop&&u.eachChild(function(x){br(x)||O.sendToTop(x)})}},sendToBottom:function(o,S){var G=this;if(o!==S&&G.contains(o)&&G.isAdjustable(o)&&(!S||G.contains(S))){var s=G._datas,P=s.remove(o),u=S?G._datas.indexOf(S):0;if(s.add(o,u),P!==u){G._76I(o,P,u);var d=o._parent;!d||d.ISubGraph||br(d)||G.sendToBottom(o._parent,o)}}}}),oi(yb,{ms_edit:function(A){A._46O=function(D){var p=this,y=p.gv.dm(),g=p._index,m=p._89I,x=p._node,Z=p._shape,l=p._edge,r=p._77I;x&&m?(this.fi({kind:"endEditRect",event:D,data:x,direction:m}),y.endTransaction()):Z&&g>=0?(p.fi({kind:"endEditPoint",event:D,data:Z,index:g}),y.endTransaction()):l&&g>=0?(p.fi({kind:"endEditPoint",event:D,data:l,index:g}),y.endTransaction()):r&&(p.fi({kind:"endEditRotation",event:D,data:r}),y.endTransaction())},A._78I=function(d){var U=this;U.autoScroll(d);var P=U.gv.lp(d),h=U._index,O=U._89I,e=U._node,B=U._shape,s=U._edge,E=U._77I;if(e&&O)U._80O(P),U.fi({kind:"betweenEditRect",event:d,data:e,direction:O});else if(B&&h>=0)P.e=B.getPoints().get(h).e,B.setPoint(h,P),U.fi({kind:"betweenEditPoint",event:d,data:B,index:h});else if(s&&h>=0){var u=s.s(Sh);P.e=u.get(h).e,u.set(h,P),s.fp(Sh,t,u),U.fi({kind:"betweenEditPoint",event:d,data:s,index:h})}else if(E){var H=E.p(),Y=E.getScale(),C=T+r(P.y-H.y,P.x-H.x);Y.y<0&&(C+=S),c(C)<.04&&(C=0),E.setRotation(C),U.fi({kind:"betweenEditRotation",event:d,data:E})}},A._80O=function(x){var P=this,I=P._node,l=P._rect,k=l.x,f=l.y,Z=l.width,j=l.height,c=P._89I,p=P._anchor,d=P._matrix,x=d.tfi(x);"northwest"===c?l=Qm(x,{x:k+Z,y:f+j}):c===Dm?l=Qm({x:k,y:x.y},{x:k+Z,y:f+j}):"northeast"===c?l=Qm({x:k,y:x.y},{x:x.x,y:f+j}):c===Nr?l=Qm({x:x.x,y:f},{x:k+Z,y:f+j}):c===sp?l=Qm({x:k,y:f},{x:x.x,y:f+j}):"southwest"===c?l=Qm({x:x.x,y:f},{x:k+Z,y:x.y}):"south"===c?l=Qm({x:k,y:f},{x:k+Z,y:x.y}):"southeast"===c&&(l=Qm({x:k,y:f},x)),I.setPosition(d.tf(l.x+l.width*p.x,l.y+l.height*p.y)),I.setWidth(l.width),I.setHeight(l.height)},A._80I=function(l,v,s,H){var I=this,h=I.gv._zoom,R=(I.gv.getEditPointSize()+2)/h;return Mf({x:v-R/2,y:s-R/2,width:R,height:R},l)?(I._89I!==H&&(I._89I=H),!0):!1},A._79I=function(c,T,n){var w=this,D=w.gv,h=T?D.getDataUI(T):t,J=h?h._55O:t;if(J){var E,N,S,s,g=D._zoom,i=(D.getEditPointSize()+2)/g,C=D.lp(c);if(wk(T)){if(J._56O&&wk(T)&&(N=J._98o,Mf({x:N.x-i/2,y:N.y-i/2,width:i,height:i},C)))return w._77I=T,n&&w.fi({kind:"beginEditRotation",event:c,data:T}),w.setCursor("crosshair"),!0;if(J._43O&&T instanceof Tl)for(S=T.getPoints(),E=S.size()-1;E>=0;E--)if(N=S.get(E),Mf({x:N.x-i/2,y:N.y-i/2,width:i,height:i},C))return w._index=E,w._shape=T,n&&w.fi({kind:"beginEditPoint",event:c,data:T,index:E}),w.setCursor("crosshair"),!0;if(J._42O)for(var f=T.getEditControlPoints(),q=["northwest",-1,-1,Nr,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,sp,1,0,"northeast",1,-1,Dm,0,-1],E=0,s=f.length;s>E;E++){var o=q[3*E],p=f[E];if(w._80I(C,p.x,p.y,o)){w._node=T;var k=T.getWidth(),e=T.getHeight(),O=T.getAnchor();w._rect={x:-k*O.x,y:-e*O.y,width:k,height:e},w._anchor=O,w._matrix=T.getMatrix();var G=T.getRotation(),r=I(G),_=d(G),K=q[3*E+1]*Kq(T.getScale().x),P=q[3*E+2]*Kq(T.getScale().y),X=Math.atan2(-_*K-r*P,r*K-_*P),Q=(Math.round(X/(Math.PI/4))+8)%8,L=[ns,"nesw-resize",zn,"nwse-resize",ns,"nesw-resize",zn,"nwse-resize"][Q];return w.setCursor(L),n&&w.fi({kind:"beginEditRect",event:c,data:T,direction:w._89I}),!0}}}if(J._43O&&br(T)&&T.s(mp)===ef&&(S=T.s(Sh)))for(E=S.size()-1;E>=0;E--)if(N=S.get(E),Mf({x:N.x-i/2,y:N.y-i/2,width:i,height:i},C))return w._index=E,w._edge=T,n&&w.fi({kind:"beginEditPoint",event:c,data:T,index:E}),w.setCursor("crosshair"),!0}return!1}},ms_gv:function(W){W._currentSubGraph=t,W._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},W.upSubGraph=function(){this.setCurrentSubGraph(dh(this._currentSubGraph))},W.isVisible=function(l){var $=this;if(dh(l)!==$._currentSubGraph)return!1;if(br(l)){var D=l._40I,b=l._41I;if(!D||!b)return!1;if(!(l.s("edge.independent")||$.isVisible(D)&&$.isVisible(b)))return!1;if(l.isEdgeGroupHidden())return!1}else for(var Y=l._parent;Y&&!Y.ISubGraph;){if(Ae(Y)&&(!Y.isExpanded()||!$.isVisible(Y)))return!1;Y=Y._parent}if(l._parent instanceof aq&&!$.isVisible(l._parent))return!1;if(l._refGraph instanceof Ac&&!$.isVisible(l._refGraph))return!1;if($ instanceof xd){if(!l.s("3d.visible"))return!1}else{var B=$.getLayersInfo();if(B){var x=B[l._layer];if(x&&x.visible===!1)return!1}if(!l.s("2d.visible"))return!1}return $._visibleFunc?$._visibleFunc(l):!0},W.handleSelectionChange=function(P){var b=this;P.datas.each(function(B){b.invalidateData(B);var p=B._parent;Ae(p)&&wk(B)&&B.s(Lg)&&(b.invalidateData(p),p._49I&&p._49I.each(function(S){b.invalidateData(S)}))}),b.onSelectionChanged(P)},W.onSelectionChanged=function(v){var j=this,z=j.sm();if(1===z.size()&&("set"===v.kind||"append"===v.kind)){var h=z.ld();j.isAutoMakeVisible()&&j.makeVisible(h),j.adjustIndex&&j._dataModel.isAutoAdjustIndex()&&j.adjustIndex(h)}},W.makeVisible=function(v){if(v){var M=this,J=M.getDataUI?M.getDataUI(v):M.getData3dUI(v);if(J){var U=v,h=dh(v);for(h!==M._currentSubGraph&&M.setCurrentSubGraph(h);(U=U._parent)&&U!==h;)Ae(U)&&U.setExpanded(!0);M._23I=v,M.iv()}}},W.getLabel=function(v){var q=v.getStyle(cf);return q===w?v.getName():q},W.getLabelBackground=function(v){return v.getStyle("label.background")},W.getLabelColor=function(I){return I.getStyle("label.color")},W.getLabel2=function(G){return G.getStyle("label2")},W.getLabel2Background=function(E){return E.getStyle("label2.background")},W.getLabel2Color=function(N){return N.getStyle("label2.color")},W.getNote=function(O){return O.getStyle(_o)},W.getNoteBackground=function(g){return g.getStyle("note.background")},W.getNote2=function(V){return V.getStyle(Pd)},W.getNote2Background=function(F){return F.getStyle("note2.background")},W.handleClick=function(v,Y,L){var h=this;Y?(h.fi({kind:"clickData",event:v,data:Y,part:L}),h.onDataClicked(Y,v)):(h.fi({kind:"clickBackground",event:v}),h.onBackgroundClicked(v))},W.handleDoubleClick=function(E,p,o){var R=this;Ir(E)&&(p?(R.fi({kind:"doubleClickData",event:E,data:p,part:o}),R.onDataDoubleClicked(p,E,o),R.checkDoubleClickOnNote(E,p,o)||R.checkDoubleClickOnRotation&&R.checkDoubleClickOnRotation(E,p,o)||(br(p)?R.onEdgeDoubleClicked(p,E,o):p.ISubGraph?R.onSubGraphDoubleClicked(p,E,o):Ae(p)?R.onGroupDoubleClicked(p,E,o):p.IDoorWindow?R.onDoorWindowDoubleClicked(p,E,o):p.ICSGBox&&R.onCSGBoxDoubleClicked(p,E,o))):(R.fi({kind:"doubleClickBackground",event:E}),R.onBackgroundDoubleClicked(E)))},W.onSubGraphDoubleClicked=function(M){this.setCurrentSubGraph(M)},W.onEdgeDoubleClicked=function(A,X){this.isEditable(A)||(A.ISubGraph&&!Sf(X)?this.setCurrentSubGraph(A):A.s("edge.toggleable")&&A.toggle())},W._39Q=function(U){return this.isInteractive(U)?this.preventDefaultWhenInteractive(U):!1},W.preventDefaultWhenInteractive=function(w){return w.s("preventDefaultWhenInteractive")},W.onGroupDoubleClicked=function(J){J.s("group.toggleable")&&J.toggle()},W.onDoorWindowDoubleClicked=function(h){h.s("dw.toggleable")&&h.toggle(!0)},W.onCSGBoxDoubleClicked=function(A,X){var n=this;if(n instanceof xd){var Q=n.getHitFaceInfo(X);Q&&Q.face&&A.s(Q.face+".toggleable")&&A.toggleFace(Q.face,!0)}},W.onBackgroundClicked=function(){},W.onBackgroundDoubleClicked=function(){this.upSubGraph()},W.onDataClicked=function(){},W.onDataDoubleClicked=function(){},W.onAutoLayoutEnded=function(){},W.onMoveEnded=function(){},W.onPanEnded=function(){},W.onPinchEnded=function(){},W.onRectSelectEnded=function(){},W.onZoomEnded=function(){},W.serialize=function(u){return this.dm().serialize(u)},W.toJSON=function(){return this.dm().toJSON()},W.deserialize=function(w,W){var K=this;W=W instanceof Ro?{rootParent:W}:mi(W)?{setId:W}:Jm(W)?{finishFunc:W}:W||{},W.view=K;var X=K.dm();return W.__innerHandler__=function(V){if(mi(X.a("toolTipEnable"))&&(X.a("toolTipEnable")?K.enableToolTip():K.disableToolTip()),K instanceof Y.graph.GraphView&&(mi(X.a("zoomable"))&&K.setZoomable&&K.setZoomable(X.a("zoomable")),mi(X.a("pannable"))&&K.setPannable&&K.setPannable(X.a("pannable")),mi(X.a("rectSelectable"))&&K.setRectSelectable&&K.setRectSelectable(X.a("rectSelectable")),X.a("fitContent")===!0&&K.fitContent&&K.fitContent(!0,0)),K instanceof Y.graph3d.Graph3dView){var r=V.scene;r&&(r.eye&&K.setEye(r.eye),r.center&&K.setCenter(r.center)),Td(X.a("sceneNear"))&&K.setNear(X.a("sceneNear")),Td(X.a("sceneFar"))&&K.setFar(X.a("sceneFar")),mi(X.a("sceneDashEnable"))&&K.setDashDisabled(!X.a("sceneDashEnable")),mi(X.a("sceneBloom"))&&K.setPostProcessingValue("Bloom","enable",X.a("sceneBloom")),Td(X.a("sceneBloomStrength"))&&K.setPostProcessingValue("Bloom","strength",X.a("sceneBloomStrength")),Td(X.a("sceneBloomThreshold"))&&K.setPostProcessingValue("Bloom","threshold",X.a("sceneBloomThreshold")),Td(X.a("sceneBloomRadius"))&&K.setPostProcessingValue("Bloom","radius",X.a("sceneBloomRadius")),mi(X.a("sceneDof"))&&K.setPostProcessingValue("Dof","enable",X.a("sceneDof")),Td(X.a("sceneDofAperture"))&&K.setPostProcessingValue("Dof","aperture",X.a("sceneDofAperture")),vh(X.a("sceneDofImage"))&&K.setPostProcessingValue("Dof","image",X.a("sceneDofImage")),vh(X.a("sceneHighlightMode"))&&K.setHighlightMode(X.a("sceneHighlightMode")),Td(X.a("sceneHighlightWidth"))&&K.setHighlightWidth(X.a("sceneHighlightWidth")),X.a("sceneHighlightColor")&&K.setHighlightColor(X.a("sceneHighlightColor")),mi(X.a("sceneHeadlightEnable"))&&K.setHeadlightDisabled(!X.a("sceneHeadlightEnable")),Td(X.a("sceneHeadlightRange"))&&K.setHeadlightRange(X.a("sceneHeadlightRange")),X.a("sceneHeadlightColor")&&K.setHeadlightColor(X.a("sceneHeadlightColor")),Td(X.a("sceneHeadlightIntensity"))&&K.setHeadlightIntensity(X.a("sceneHeadlightIntensity")),Td(X.a("sceneHeadlightAmbientIntensity"))&&K.setHeadlightAmbientIntensity(X.a("sceneHeadlightAmbientIntensity")),mi(X.a("sceneFogEnable"))&&K.setFogDisabled(!X.a("sceneFogEnable")),X.a("sceneFogColor")&&K.setFogColor(X.a("sceneFogColor")),Td(X.a("sceneFogNear"))&&K.setFogNear(X.a("sceneFogNear")),Td(X.a("sceneFogFar"))&&K.setFogFar(X.a("sceneFogFar"))}},X.deserialize(w,W.rootParent,W)},W.isDebugTipShowing=function(){return!!this._debugDiv},W.showDebugTip=function(){var U=this,v=U._debugDiv;if(!v){v=U._debugDiv=l.createElement("div"),v.style.position="absolute",v.style.overflow="hidden",v.style.font=Q.debugTipLabelFont,v.style.padding="6px",v.style.backgroundColor=Q.debugTipBackground,v.style.color=Q.debugTipLabelColor;var B=U.getView();U._79O?B.insertBefore(v,U._79O):B.appendChild(v);var I=function(){U.redraw();var n=U._canvas,g="FPS: "+U._fpsInfo.fps+"<br/>"+"Datas: "+U.dm().getDatas().length+(n?"<br/>Size: "+n.width+" * "+n.height:""),x=U.dm()._historyManager;x&&(g+="<br/>Undoes: "+x.getHistories().length+" index: "+x.getHistoryIndex());var p=U.getDebugTip();p&&(g+="<hr>"+p),v.innerHTML=g,U._isDebugging&&requestAnimationFrame(I)};requestAnimationFrame(I),U._isDebugging=!0}},W.hideDebugTip=function(){var W=this,O=W._debugDiv;O&&(delete W._debugDiv,W.getView().removeChild(O),W._isDebugging=!1)},W.updateDOMAppendMatrix=function(){var Z=this.getView();Z&&(Z.updateAppendMatrix=!0)},W.countFrame=function(){if(this._isDebugging){var C=Date.now(),v=this._fpsInfo;C-v.time>1e3?(v.fps=Math.round(1e5*(v.frames+1)/(C-v.time))/100,v.time=C,v.frames=0):v.frames++}}},ms_icons:function(g){g.getRotation=function(h){return h==t?0:h},g._15O=function(){var k=this,s=k.s(nk);if(s){var x=k,l=k.data||k._data,Y=k._38o={icons:s,rects:{}};for(var S in s){var F=s[S],p=bf(F.shape3d,l,x);if(!(bf(F.visible,l,x)===!1||bf(F.for3d,l,x)&&!k.I3d||p&&!k.I3d)){var d=p?[p]:bf(F.names,l,x),J=d?d.length:0,g=bf(F.position,l,x)||3,u=bf(F.offsetX,l,x)||0,G=bf(F.offsetY,l,x)||0,Q=bf(F.direction,l,x)||sp,o=bf(F.gap,l,x),m=o!=t?o:1,T=bf(F.rotation,l,x),e=bf(F.keepOrien,l,x),A=bf(F.rotationFixed,l,x)?T:k.getRotation(T,e,g),M=t,h=Y.rects[S]=new Array(J);h.rotation=A;for(var B=0;J>B;B++){var q,Z,a,H,X=d[B];if(p)a=0,H=0;else{var K=ir(X);a=bf(F.width,l,x),H=bf(F.height,l,x),a==t&&(a=To(K,l)),H==t&&(H=wb(K,l))}if(M?Q===sp?u+=a/2:Q===Nr?u-=a/2:Q===Dm?G-=H/2:G+=H/2:M={width:a,height:H},k.I3d){var V=-a/2,c=-H/2;Z={width:a,height:H,mat:k._16O(bf(F.autorotate,l,x),g,M,bf(F.face,l,x)||Fl,bf(F.t3,l,x),bf(F.r3,l,x),bf(F.rotationMode,l,x),u,G),vs:new cc([V,-c,0,V,-c-H,0,V+a,-c-H,0,V+a,-c,0])}}else q=k.getPosition(g,u,G,M,bf(F.positionFixed,l,x)),Z={x:q.x-a/2,y:q.y-H/2,width:a,height:H},k._68o(Z,A);h[B]=Z,Q===sp?u+=a/2+m:Q===Nr?u-=a/2+m:Q===Dm?G-=H/2+m:G+=H/2+m}}}}}}});var ug={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Ig={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ql={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},zk={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Ej={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},rk={"edge.type":1,"edge.group":1},sk={rotation:1,rotationX:1,rotationZ:1},Pj={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},mf={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},kj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},ui={shape:1,thickness:1,position:1,anchor:1,scale:1},dh=function(N){if(!N)return t;if(br(N)){var q=N._40I,i=N._41I;if(!q||!i)return t;var c=dh(q),e=dh(i);return c===e?c:t}for(var X=N._parent;br(X)&&!X.ISubGraph;)X=X._parent;return X?X.ISubGraph?X:dh(X):t},ll=function(l,y,I,R){var w=y.getStyle(I)*R;w&&Wn(l,w),w=y.getStyle(I+".left")*R,w&&(l.x-=w,l.width+=w),w=y.getStyle(I+".right")*R,w&&(l.width+=w),w=y.getStyle(I+".top")*R,w&&(l.y-=w,l.height+=w),w=y.getStyle(I+".bottom")*R,w&&(l.height+=w),l.width<0&&(l.width=-l.width,l.x-=l.width),l.height<0&&(l.height=-l.height,l.y-=l.height)},Ad=function($){for(var P,R=0,y=$.size();y>R;R++)if(P=$.getChildAt(R),wk(P)&&Ad(P))return!0;return $.hasAgentEdges()},Zf=function(_){if(!_)return t;for(var G=_._parent;Ae(G);){if(!Ae(G._parent))return G.isExpanded()?_:G;G.isExpanded()||(_=G),G=G._parent}return _},lj=function(F,H){if(!F||!H)return t;var S,u,s,f=dh(F),J=dh(H);if(f!==J){for(;J&&f!==J;)J=dh(J);if(f===J)return F;S=new ls,S.add(F,0);for(var x=F._parent;wk(x)&&!H.isDescendantOf(x);)S.add(x,0),x=x._parent;for(s=S.size(),u=0;s>u;u++){var R=S.get(u);if(Ae(R)&&!R.isExpanded())return R;if(R.ISubGraph)return R}return F}return F},Bo=function(f){if(f.isLooped())return f._source;var T=Zf(f._source),n=Zf(f._target);return T===n?f._source:lj(T,n)},Hf=function(P){if(P.isLooped())return P._target;var J=Zf(P._source),I=Zf(P._target);return J===I?P._target:lj(I,J)},Ld=function(Y,v,o){"target"!==o&&(o="source");var _="target"===o?v.getTargetAgent():v.getSourceAgent(),U="edge."+o+".";if(br(_)){var T=Y.getDataUI(_);T._79o();var A=v.s(U+"index");if(A>=0){var S=nl(T);return S[Math.max(0,Math.min(A,S.length-1))]}var e=v.s(U+"percent")||0;e=Math.max(0,Math.min(e,1));var D=ek(T);return cd(D,100*e)}return Nk(Y,_,v.s(U+"position"),v.s(U+"offset.x"),v.s(U+"offset.y"),v.s(U+"anchor.x"),v.s(U+"anchor.y"))},Nk=function(f,j,Y,y,o,U,J){if(!j)return t;var $,E=j.getRotation?j.getRotation():0;if(U!==w||J!==w){U=U===w?.5:U,J=J===w?.5:J;var N=j.getScale();if(E&&!gs(j,f)||N.x<0||N.y<0){var C=j.getPosition(),q=j.getWidth(),Q=j.getHeight(),M=j.getAnchor(),V=new Gm(E,C.x,C.y,N.x,N.y);Y=V.tf((U-M.x)*q,(J-M.y)*Q)}else $=_k(f,j),Y={x:$.x+U*$.width,y:$.y+J*$.height}}else Y=Tf(Y,_k(f,j));if(E){var z=I(E),x=d(E),c=y*z-o*x;o=y*x+o*z,y=c}return Y.x+=y,Y.y+=o,Y},Mo=function(o,A){if(!o||!A)return t;var G,c,N,Q,y,z;if(o===A){if(Q=o.getLoopedEdges(),!Q)return t;Q=new ls(Q)}else{if(y=o.getAgentEdges(),z=A.getAgentEdges(),!y||!z)return t;for(c=y.size(),G=0;c>G;G++)N=y.get(G),z.contains(N)&&(Q||(Q=new ls),Q.add(N))}if(Q)for(G=0;G<Q.size();G++)N=Q.get(G),N.getStyle(mp)===ef&&(N._22I(t),Q.removeAt(G),G--);return Q},Or=function(i,W){var B=Mo(i,W);if(B&&!B.isEmpty()){if(1===B.size())return B.get(0)._22I(t),void 0;var X=new ls,k=new ls;B.each(function(F){var w=F.s("edge.group");X.contains(w)||X.add(w)}),X.sort(),X.each(function($){k.add(new Y.EdgeGroup(B.toList(function(c){return $===c.s("edge.group")}),k))}),k.each(function(U){U.each(function(p){p._22I(U)})})}},Ub=function(X,e,b){var y=X._canvas;X._zoom;var w=fg(e,y),E=fg(b,y);return{x:w.x-E.x,y:w.y-E.y}},jc=function($,r){if(r){var W=r.rect,N=r.color,O=r.rotation,l=r.labelWidth,e=r.background,w=r.opacity,i=r.scale,b=i!=t&&1!==i;if(w!=t){var s=$.globalAlpha;$.globalAlpha*=w}if(O||b){$.save();var J=W.x+W.width/2,u=W.y+W.height/2;_h($,J,u),O&&Pp($,O),b&&$.scale(i,i),_h($,-J,-u)}if(e&&Qf($,W.x,W.y,W.width,W.height,e),l){var _=W.width,T=$.createLinearGradient(W.x,W.y,W.x+_,W.y);T.addColorStop(0,N),T.addColorStop(.9,N),T.addColorStop(1,Jk),N=T,W.width=l}ff($,r.ss,W,r.font,N,r.align),l&&(W.width=_),(O||b)&&$.restore(),w!=t&&($.globalAlpha=s)}},Sk=function(G,e){if(e){var g=e.rect,N=g.x,B=g.y,d=g.width,A=g.height,h=e.background,i=e.backgroundImage,w=e.borderWidth,o=e.borderColor,u=e.labelWidth,C=e.opacity,P=e.scale,Y=P!=t&&1!==P;if(C!=t){var F=G.globalAlpha;G.globalAlpha*=C}if(Y){G.save();var x=g.x+g.width/2,E=g.y+g.height/2;_h(G,x,E),G.scale(P,P),_h(G,-x,-E)}if(e.expanded){var W=a(8,d/4),r=B+A-8;if(G.fillStyle=h,G.beginPath(),G.moveTo(N,B),G.lineTo(N,r),G.lineTo(N+d/2,r),G.lineTo(N+d/2,B+A),G.lineTo(N+d/2+W,r),G.lineTo(N+d,r),G.lineTo(N+d,B),G.closePath(),G.fill(),w&&(G.lineWidth=w,G.lineJoin="round",G.lineCap="round",o?(G.strokeStyle=o,G.stroke()):(G.strokeStyle=_e(h),G.beginPath(),G.moveTo(N+d,B),G.lineTo(N+d,r),G.lineTo(N+d/2+W,r),G.lineTo(N+d/2,B+A),G.stroke(),G.strokeStyle=Cj(h),G.beginPath(),G.moveTo(N+d,B),G.lineTo(N,B),G.lineTo(N,r),G.lineTo(N+d/2,r),G.lineTo(N+d/2,B+A),G.stroke())),i)Mi(G,ir(i),pp,g.x,g.y,g.width,g.height-8,e.data,e.view);else{if(g.height-=8,h=e.color,u){var y=d,f=G.createLinearGradient(N,B,N+y,B);f.addColorStop(0,h),f.addColorStop(.9,h),f.addColorStop(1,Jk),h=f,g.width=u}ff(G,e.ss,g,e.font,h,e.align),u&&(g.width=y),g.height+=8}}else if(e.icon)qc(G,ir(e.icon),N,B,d,A,e.data,e.view);else{var k=d/2;w&&(G.lineWidth=w,G.lineJoin="round",G.lineCap="round",G.strokeStyle=o?o:_e(h),G.beginPath(),G.arc(N+k,B+k,k,T,1.6*S,!0),G.moveTo(N+k,B+A),G.lineTo(N+d-k/5,B+k),G.stroke(),G.strokeStyle=o?o:Cj(h),G.beginPath(),G.arc(N+k,B+k,k,1.6*S,T,!0),G.moveTo(N+k,B+A),G.lineTo(N+k/5,B+k),G.stroke()),G.fillStyle=h,G.beginPath(),G.arc(N+k,B+k,k,0,z,!0),G.moveTo(N+k,B+A),G.lineTo(N+d-k/5,B+k),G.lineTo(N+k/5,B+k),G.closePath(),G.fill(),G.fillStyle=e.color,G.beginPath(),G.arc(N+k,B+k,k/3,0,z,!0),G.fill()}Y&&G.restore(),C!=t&&(G.globalAlpha=F)}},ej=function(d,c){return c>2*d?d:c/2},On=function(C,l,x,g){if(!C||!l)return 0;var N=r(l.y-C.y,l.x-C.x);return x||(N=l.x<C.x?N+S:N),N+g},po=function(s,y,d,X,l,u,g){g&&(s.x>y.x||s.x===y.x&&s.y>y.y)&&(d=yg[d],l=-l);var P=Tf(d,{x:0,y:0,width:ro(s,y),height:0},u);return P.x+=X,P.y+=l,P=new Gm(r(y.y-s.y,y.x-s.x)).tf(P),P.x+=s.x,P.y+=s.y,P},Gf=function(G,N,b,H,k){if(G._19Q=!0,!b.getEdgeGroup())return H?b.s("edge.gap"):0;if(br(b.getSourceAgent())||br(b.getTargetAgent()))return 0;var s,p=0,C=0,v=0;if(b.getEdgeGroup().getSiblings().each(function(V){V.each(function(x){if(N.isVisible(x)&&x.s(mp)==k){var Y=x.s("edge.gap");s?(C+=v/2+Y/2,v=Y):(s=x,v=Y),x===b&&(p=C)}})}),H)return C-p+v;var f=p-C/2;return s&&b._40I!==s._40I&&(G._19Q=!1),f},yj=function(){var Z=function(z){var s=[];return z.forEach(function(t){s.push({x:t.x,y:t.y}),s.push({x:t.x+t.width,y:t.y+t.height}),s.push({x:t.x+t.width,y:t.y}),s.push({x:t.x,y:t.y+t.height})}),s};return function(H,u,B){if("oval"===H){var U=0,W=B.height/B.width,b=W*W,p=B.x+B.width/2,q=B.y+B.height/2,k=Z(u);k.forEach(function(e){var y=e.x-p,m=e.y-q,v=y*y+m*m/b;v>U&&(U=v)}),U=N(U);var y=W*U;return{x:p-U,y:q-y,width:2*U,height:2*y}}if("circle"===H){var P=0,p=B.x+B.width/2,q=B.y+B.height/2,k=Z(u);return k.forEach(function(z){var F=z.x-p,f=z.y-q,Q=F*F+f*f;Q>P&&(P=Q)}),P=N(P),{x:p-P,y:q-P,width:2*P,height:2*P}}return"roundRect"===H?(Wn(B,a(B.width,B.height)/16),B):B}}(),Uh=Y.graph={},Xg=function(R,l,L){Tr(g+".graph."+R,l,L)};Y.layout={};var Hd={},bl=function(e,s,Z,j,Q,M,w,E){var X=[s.uuid,Math.round(j),Math.round(Q),Z].join("_");s.cacheRule&&(X+=bf(s.cacheRule,M,w));var c=w._zoom;c!==w._cacheZoom&&(w._cacheZoom=c,w._cacheImage={}),c*=td;var u=w._cacheImage[X];return u||(Oq(),u=Y.Default.toCanvas(s,Math.ceil(j*c),Math.ceil(Q*c),Z,M,w,E),$j()&&(w._cacheImage[X]=u)),u};oi(Q,{setImageCacheRule:function(N,x){var S;S=x||"object"!=typeof N?{_image:x}:N;for(var c in S){var Q=S[c];vh(c)?(Tr=ir(c),Tr?Tr.cacheRule=Q:Hd[c]=Q):c.cacheRule=Q}}});var nd={comps:[{type:Fc,points:[85,50,70,115,100,71,86,107,88,49,56,110,112,47,75,90,56,108,83,73,47,82,110,78,122,43,75,90,71,71,105,68,65,99,104,111,114,121,100,81,43,106,111,61],borderWidth:1,borderColor:t}]};if(nd[Bh]=nd[Lm]=160,i.Image){var Sd=new i.Image;Sd.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Vb("default_blank",Sd)
}Vb("node_image",fr(30,30,[{type:_m,rect:[4,5,22,16],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[2,3,26,20],borderWidth:1,borderColor:uj},{type:_m,rect:[11,23,8,4],background:uj},{type:_m,rect:[6,27,18,2],background:uj}])),Vb("node_icon",fr(16,16,[{type:_m,rect:[2,2,12,10],gradient:mm,gradientColor:Uj,background:uj},{type:Ko,rect:[2,2,12,10],width:1,color:uj},{type:_m,rect:[6,12,4,2],background:uj},{type:_m,rect:[4,14,8,1],background:uj}])),Vb("block_icon",fr(16,16,[{type:Ko,rect:[1,1,14,14],width:1,color:uj}])),Vb("group_image",fr(66,39,[{type:_m,rect:[44.3,18,18.1,12.8],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[3.3,17.8,18.1,12.8],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:uj,gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[26.2,29.4,12.8,4.2],background:uj},{type:_m,rect:[21.3,33.5,22.5,2.3],background:uj},{type:_m,rect:[5.3,32.7,14.1,2.1],background:uj},{type:_m,rect:[9,30.4,6.7,2.4],background:uj},{type:_m,rect:[50,30.7,6.7,2.4],background:uj},{type:_m,rect:[46.3,33,14.1,2.1],background:uj}])),Vb("group_icon",fr(16,16,[{type:_m,rect:[4,12,4,2],background:uj},{type:_m,rect:[2,13,8,1],background:uj},{type:_m,rect:[12,12,2,1],background:uj},{type:_m,rect:[11,13,4,1],background:uj},{type:_m,rect:[10,7,6,5],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[1,2,10,10],gradient:mm,gradientColor:Uj,background:uj},{type:Ko,rect:[1,2,10,10],width:1,color:uj}])),Vb("refGraph_icon",fr(16,16,[{type:"shape",borderWidth:1,borderColor:uj,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:uj,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Vb("edge_icon",fr(16,16,[{type:_m,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[10.8,1,4,4],background:uj},{type:_m,rect:[1,11,4,4],background:uj}])),Vb("subGraph_image",fr(72,45,[{type:Fc,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[29.6,30.7,3.6,1.8],background:uj},{type:_m,rect:[28.4,32.3,6,1.2],background:uj},{type:_m,rect:[37.3,32,10.8,1.8],background:uj},{type:_m,rect:[39.1,29.9,7.2,2.3],background:uj},{type:_m,rect:[26.6,23.7,9.6,7.2],gradient:mm,gradientColor:Uj,background:uj},{type:_m,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:uj,gradient:mm,gradientColor:Uj,background:uj}])),Vb("subGraph_icon",fr(17,17,[{type:Fc,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:mm,gradientColor:Uj,background:uj}])),Vb("shape_icon",fr(16,16,[{type:Fc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:uj}])),Vb("polyline_icon",fr(16,16,[{type:Fc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:uj},Qd(7.5,.4),Qd(7.5,6.3),Qd(13.6,6.3),Qd(13.6,14),Qd(.7,13.9),Qd(.7,.3)])),Vb("grid_icon",fr(16,16,[{type:_m,rect:[1,1,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[6,1,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[11,1,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[11,6,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[6,6,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[1,6,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[11,11,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[6,11,4,4],background:uj,gradient:mm,gradientColor:Uj},{type:_m,rect:[1,11,4,4],background:uj,gradient:mm,gradientColor:Uj}])),Vb("light_icon",fr(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:uj},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:uj,gradient:mm,gradientColor:Uj,background:{func:function(s){var X=s?s.s(Pk):t;return Cl(X)?"rgb("+F(255*X[0])+","+F(255*X[1])+","+F(255*X[2])+")":X||uj}}}])),Vb("text_icon",fr(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:uj}])),Vb("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Vb("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Vb("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Vb("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var go=function(b,q,E,Y,x,B){var A,X,s,Z,R,p,m,H,k,S,z,I=[];if(Math.abs(Y)>2*Math.PI&&(Y=2*Math.PI),R=Math.ceil(Math.abs(Y)/(Math.PI/4)),A=Y/R,X=-A,s=-E,R>0){p=b+Math.cos(E)*x,m=q+Math.sin(-E)*B,I.push({x:p,y:m});for(var N=0;R>N;N++)s+=X,Z=s-X/2,H=b+Math.cos(s)*x,k=q+Math.sin(s)*B,S=b+Math.cos(Z)*(x/Math.cos(X/2)),z=q+Math.sin(Z)*(B/Math.cos(X/2)),I.push({x:S,y:z}),I.push({x:H,y:k})}return I},Zc=function(R){if(R){var y=R._data;if(y instanceof Y.Shape)return{points:y.getPoints(),segments:y.getSegments()};var N;if(y instanceof Y.Edge&&(N=R._78o)){var E,s,j=N.type,I=N.points,_=N.segments,m=N.edgeTypeInfo;if(!j||I){var W=N.sourcePoint,Q=W.x,J=W.y,H=N.targetPoint,Z=H.x,F=H.y;if(j)_?(E=new ls({x:Q,y:J}),E.addAll(I),E.add({x:Z,y:F}),s=new ls(_._as)):(E=new ls({x:Q,y:J}),I.each(function(R){E.add(R)}),E.add({x:Z,y:F}));else if(N.looped){E=new ls(go(Q,J,0,2*Math.PI,N.radius,N.radius)),s=new ls([1]);for(var b=0;b<(E.size()-1)/2;b++)s.add(3)}else E=new ls,N.center?(E.add({x:N.c1.x,y:N.c1.y}),E.add({x:Q,y:J}),E.add({x:Z,y:F}),E.add({x:N.c2.x,y:N.c2.y})):(E.add({x:Q,y:J}),E.add({x:Z,y:F}))}else m&&(E=new ls(m.points._as),m.segments&&(s=new ls(m.segments._as)));return{points:E,segments:s}}}},ek=function(W,Z,E){if(null==Z){var U=Zc(W);if(!U)return;Z=U.points,E=U.segments}if(Z){if(Array.isArray(Z)&&(Z=new ls(Z)),"number"==typeof Z.get(0)){for(var L=new Y.List,w=0;w<Z.size();w+=2)L.add({x:Z.get(w),y:Z.get(w+1)});Z=L}if(!E){E=[1];for(var h=Z.length-1;h>0;h--)E.push(2)}Array.isArray(E)&&(E=new ls(E));for(var z=hr(Z._as,E._as,50),l=z.length,$=[],w=0;l>w;w++){var M=z[w];M.length>1&&$.push(M)}return $}},Ui=function(n){for(var $=0,M=n.length-1,g=0;M>g;g++){var F=n[g],w=n[g+1],U=w.x-F.x,P=w.y-F.y;$+=Math.sqrt(U*U+P*P)}return $},Ec=function(x,F){for(var z=0,B=F.length,q=0;B>q;q++){var M=F[q];if(z+=M,z>x)return q}return Math.min(q,B-1)},Zn=function(f,K){for(var R=0,b=0,t=0,o=f.length-1,I=0;o>I;I++){var D=f[I],c=f[I+1],V=c.x-D.x,v=c.y-D.y;if(t=Math.sqrt(V*V+v*v),R+=t,R>K){R-=t,b=I;break}}var Y=f[b],m=f[b+1],C=Math.atan2(m.y-Y.y,m.x-Y.x),L=K-R,v=Math.sin(C)*L,V=Math.cos(C)*L;return{x:Y.x+V,y:Y.y+v}},cd=function(D,K){if(D){var e;if(0===K)e=D[0][0];else if(100===K)D=D[D.length-1],e=D[D.length-1];else{for(var y=0,N=[],W=D.length,E=0;W>E;E++){var I=D[E],$=Ui(I);y+=$,N.push($)}for(var d=y*K/100,Y=Ec(d,N),Q=0,B=0;Y>B;B++)Q+=N[B];d-=Q,e=Zn(D[Y],d)}return e}},nl=function(C){var M,U,X,A,j=Zc(C),i=[],c=j.points,J=j.segments,u=-1;for(U=0,X=J?J.length:c.length;X>U;U++){if(M=J?J.get(U):1,3===M)A=2;else if(4===M)A=3;else{if(5===M)continue;A=1}u+=A,i.push(c.get(u))}return i},ks=function(W,V,A,M){function H(Z){if(Z>=0&&1>=Z){K=V(Z);var D=(W.x-K.x)*(W.x-K.x)+(W.y-K.y)*(W.y-K.y);return f>D?(f=D,i=Z,!0):!1}}A=A||100,M=M||1e-5;for(var f=1/0,i=0,K=new ob,s=0;A>s;++s)H(s/A);for(var N=1/(2*A);N>M;)H(i-N)||H(i+N)||(N/=2);return i};oi(Q,{_edgeProtectMethod:{getStraightLinePoints:ek,calculateLineLength:Ui,calcSegmentIndexByDistance:Ec,calculatePointAlongLine:Zn,getPercentPosition:cd,getRealPointsFromDataUI:nl}});var yi=function(U,m){for(var S=U.vertices,z=0;z<S.length;z++){var u=S[z],P=u.y;u.y=u.z,u.z=-P,m&&(u.y+=m)}},db=function(C){for(var d,W,c,y,X,i,R=[],B=[],A=[],I=C.faces,b=0,P=0,j=0,O=I.length;O>b;b++,P+=6,j+=9){var x=I[b];1===x.i?(d||(d=[],W=[],c=[]),So(x,b,P,j,C,d,c,W)):2===x.i?(y||(y=[],X=[],i=[]),So(x,b,P,j,C,y,i,X)):So(x,b,P,j,C,R,A,B)}return{vs:R,uv:B,ns:A,top_vs:d,top_uv:W,top_ns:c,bottom_vs:y,bottom_uv:X,bottom_ns:i}},So=function(k,q,K,A,m,r,X,E){var P=m.vertices,d=m.faceVertexUvs,L=P[k.a],p=P[k.b],j=P[k.c];r[A]=L.x,r[A+1]=L.y,r[A+2]=L.z,r[A+3]=p.x,r[A+4]=p.y,r[A+5]=p.z,r[A+6]=j.x,r[A+7]=j.y,r[A+8]=j.z;var W=k.vertexNormals;if(3===W.length){var F=W[0],R=W[1],v=W[2];X[A]=F.x,X[A+1]=F.y,X[A+2]=F.z,X[A+3]=R.x,X[A+4]=R.y,X[A+5]=R.z,X[A+6]=v.x,X[A+7]=v.y,X[A+8]=v.z}else{var t=k.normal;X[A]=t.x,X[A+1]=t.y,X[A+2]=t.z,X[A+3]=t.x,X[A+4]=t.y,X[A+5]=t.z,X[A+6]=t.x,X[A+7]=t.y,X[A+8]=t.z}var C=d[0][q][0],w=d[0][q][1],l=d[0][q][2];E[K]=C.x,E[K+1]=C.y,E[K+2]=w.x,E[K+3]=w.y,E[K+4]=l.x,E[K+5]=l.y},Sr=function(){function L(z,G){return z.dot(G)>0}function G(D,Q,C,H,e,z,$){for(var U,x,J=[Q,C,H],M=[e,z,$],k=[],i=J.length,S=!0;i--&&S;){for(var P=J[i],u=M.length,p=!1;u--;)if(P.equals(M[u])){M.splice(u,1),k.push(P),p=!0;break}if(!p){if(U){S=!1;break}U=P}}return S&&2===k.length&&(x=M[0],B.subVectors(U,k[0]),a.subVectors(x,k[0]),N.subVectors(U,k[1]),B.x*N.y*a.z+N.x*a.y*B.z+a.x*B.y*N.z-a.x*N.y*B.z-a.y*N.z*B.x-a.z*N.x*B.y<1e-6&&(j.subVectors(x,k[1]),O.subVectors(k[1],k[0]),L(O,B)&&L(O,a)&&(O.negate(),L(O,N)&&L(O,j))))?(D.push(k[1].x,k[1].y,k[1].z),D.push(U.x,U.y,U.z),D.push(U.x,U.y,U.z),D.push(k[0].x,k[0].y,k[0].z),D.push(k[0].x,k[0].y,k[0].z),D.push(x.x,x.y,x.z),D.push(x.x,x.y,x.z),D.push(k[1].x,k[1].y,k[1].z),2):(D.push(Q.x,Q.y,Q.z),D.push(C.x,C.y,C.z),D.push(C.x,C.y,C.z),D.push(H.x,H.y,H.z),D.push(H.x,H.y,H.z),D.push(Q.x,Q.y,Q.z),1)}function I(){this._vertexMap={},this._lineMap={},this._lineList=[]}function n(f,F,b,M,H,P,i){var s=[b,H];f[0]===M&&s.reverse();var m=[s[0]._key,s[1]._key].join("|"),w=f._triangles[m];w||(f._triangles[m]=w={});var o=[P._key,i._key].join("|");w[o]||(w[o]=[P,i])}function d(g,Y,L){var i=g._planes[L._key];if(!i)for(var q in g._planes){var l=g._planes[q];if(l._normal.angleTo(L)<.001){i=l;break}}return i?(i._vertices.indexOf(Y)<0&&i._vertices.push(Y),void 0):(g._planes[L.key]={_normal:L,_vertices:[Y]},void 0)}function R(u){var p=u._ctlineModel;if(p||(u._ctlineModel=p=[]),p[0])return p[0];var N;N=Cl(u)?u:[u];var y,A,V,H,e,o,B,D,z,C,S,W,T,n,K,x,l,j,g,d=["","top_","bottom_"];for(p=[],y=0,A=N.length;A>y;y++)if(C=N[y])for(Sg(C),V=0,H=d.length;H>V;V++)if(z=C[d[V]+"lvs"])for(l=p.length,j=z.length,p.length=l+j,g=0;j>g;++g,++l)p[l]=z[g];else if(B=C[d[V]+"vs"]){D=C[d[V]+"is"],o=D?D.length:B.length/3;for(var e=0;o-1>e;)D?(S=D[e],W=D[e+1],T=D[e+2],n=D[e+3],K=D[e+4],x=D[e+5]):(S=e,W=e+1,T=e+2,n=e+3,K=e+4,x=e+5),Y.fromArray(B,3*S),E.fromArray(B,3*W),s.fromArray(B,3*T),t.fromArray(B,3*n),F.fromArray(B,3*K),r.fromArray(B,3*x),e+=3*G(p,Y,E,s,t,F,r);o>e&&(D?(S=D[e],W=D[e+1],T=D[e+2]):(S=e,W=e+1,T=e+2),Y.fromArray(B,3*S),E.fromArray(B,3*W),s.fromArray(B,3*T),p.push(Y.x,Y.y,Y.z),p.push(E.x,E.y,E.z),p.push(E.x,E.y,E.z),p.push(s.x,s.y,s.z),p.push(s.x,s.y,s.z),p.push(Y.x,Y.y,Y.z))}return u._ctlineModel[0]=p,p}function A(G){var N=G._ctlineModel;if(N||(G._ctlineModel=N=[]),N[1])return N[1];var g;g=Cl(G)?G:[G];var R,Z,M,v,O,U,W,b,T,k,z,C,Q=["","top_","bottom_"],p=new I;for(N=[],R=0,Z=g.length;Z>R;R++)if(T=g[R])for(Sg(T),M=0,v=Q.length;v>M;M++)if(W=T[Q[M]+"vs"]){b=T[Q[M]+"is"],U=b?b.length:W.length/3;for(var O=0,O=0;U>O;O+=3)b?(k=b[O],z=b[O+1],C=b[O+2]):(k=O,z=O+1,C=O+2),p._addTriangle(W,w,k,z,C)}return p._toLineVS(N),G._ctlineModel[1]=N,N}function v(a){var m=a._ctlineModel;if(m||(a._ctlineModel=m=[]),m[2])return m[2];var B;B=Cl(a)?a:[a];var Z,Y,h,A,d,r,X,K,C,o,O,u,l,U=["","top_","bottom_"],e=new I;for(m=[],Z=0,Y=B.length;Y>Z;Z++)if(o=B[Z])for(Sg(o),h=0,A=U.length;A>h;h++)if(X=o[U[h]+"vs"]){K=o[U[h]+"is"],C=o[U[h]+"ns"],r=K?K.length:X.length/3;for(var d=0,d=0;r>d;d+=3)K?(O=K[d],u=K[d+1],l=K[d+2]):(O=d,u=d+1,l=d+2),e._addTriangle(X,C,O,u,l)}return e._toLineVS(m),a._ctlineModel[2]=m,m}var Y=new dc,E=new dc,s=new dc,t=new dc,F=new dc,r=new dc,B=new dc,N=new dc,a=new dc,j=new dc,O=new dc,c=new dc;I.prototype._findVertex=function(h,e){c.fromArray(h,3*e);var D=[c.x,c.y,c.z].join(","),l=this._vertexMap[D];if(!l){var A=c.clone();A._key=D,this._vertexMap[D]=l=A}return l},I.prototype._findLine=function(I,G){var o=[I,G];I._key>G._key&&o.reverse(),o._key=[o[0]._key,o[1]._key].join("|");var S=this._lineMap[o._key];return S||(this._lineMap[o._key]=S=o,o._triangles={},o._planes={},this._lineList.push(o)),S};var D=new dc,P=new dc;return I.prototype._addTriangle=function(r,I,T,z,B){var M,v,W,A=this._findVertex(r,T),c=this._findVertex(r,z),Y=this._findVertex(r,B),i=this._findLine(A,c),k=this._findLine(c,Y),q=this._findLine(Y,A);I?(M=(new dc).fromArray(I,3*T),M._key=[M.x,M.y,M.z].join("|"),v=(new dc).fromArray(I,3*z),v._key=[v.x,v.y,v.z].join("|"),W=(new dc).fromArray(I,3*B),W._key=[W.x,W.y,W.z].join("|"),n(i,A,M,c,v,Y,W),n(k,c,v,Y,W,A,M),n(q,Y,W,A,M,c,v)):(P.subVectors(Y,c),D.subVectors(c,A),M=(new dc).crossVectors(D,P),M._key=[M.x,M.y,M.z].join("|"),d(i,Y,M),d(k,A,M),d(q,c,M))},I.prototype._toLineVS=function(X){for(var P=this._lineList,p=0,q=P.length;q>p;++p){var w=P[p],Y=!1;for(var R in w._triangles)if(1==u.keys(w._triangles[R]).length){X.push(w[0].x,w[0].y,w[0].z,w[1].x,w[1].y,w[1].z),Y=!0;break}if(!Y)for(var x in w._planes)if(1==w._planes[x]._vertices.length){X.push(w[0].x,w[0].y,w[0].z,w[1].x,w[1].y,w[1].z),Y=!0;break}}},[R,A,v]}(),Ge=function(r){var x=r._lineModel;if(x)return x;var v;v=Cl(r)?r:[r];var C,Z,W,D,A,O,$,R,u,n,f,H,Q=["","top_","bottom_"];for(x=[],C=0,Z=v.length;Z>C;C++)if(u=v[C])for(W=0,D=Q.length;D>W;W++)if($=u[Q[W]+"vs"]){R=u[Q[W]+"is"],O=R?R.length:$.length/3;for(var A=0;O>A;A+=3)R?(n=R[A],f=R[A+1],H=R[A+2]):(n=A,f=A+1,H=A+2),n*=3,f*=3,H*=3,x.push($[n],$[n+1],$[n+2],$[f],$[f+1],$[f+2],$[f],$[f+1],$[f+2],$[H],$[H+1],$[H+2],$[H],$[H+1],$[H+2],$[n],$[n+1],$[n+2])}return r._lineModel=x,x},le=function(e,u,v,F,B,W,q,g,h){v==t&&(v=!0),F==t&&(F=!0),q==t&&(q=1),g==t&&(g=0);var l=new Rm;return ps(l,e,u,h),l=l.toShapes(),db(new Bj(l,{top:v,bottom:F,curveSegments:B,amount:q,repeatUVLength:W},-q/2+g))},bg=function(p,E){this.x=p||0,this.y=E||0};bg.prototype={constructor:bg,add:function(F){return this.x+=F.x,this.y+=F.y,this},sub:function(B){return this.x-=B.x,this.y-=B.y,this},equals:function(X){return X.x===this.x&&X.y===this.y},multiplyScalar:function(i){return this.x*=i,this.y*=i,this},distanceTo:function(v){return N(this.distanceToSquared(v))},distanceToSquared:function(b){var R=this.x-b.x,J=this.y-b.y;return R*R+J*J},clone:function(){return new bg(this.x,this.y)}};var cr=function(E,I,y){this.x=E||0,this.y=I||0,this.z=y||0};cr.prototype={constructor:cr,set:function(O,B,l){return this.x=O,this.y=B,this.z=l,this},setY:function(i){return this.y=i,this},copy:function(D){return this.x=D.x,this.y=D.y,this.z=D.z,this},add:function(N){return this.x+=N.x,this.y+=N.y,this.z+=N.z,this},addVectors:function(B,L){return this.x=B.x+L.x,this.y=B.y+L.y,this.z=B.z+L.z,this},sub:function(F){return this.x-=F.x,this.y-=F.y,this.z-=F.z,this},subVectors:function(p,M){return this.x=p.x-M.x,this.y=p.y-M.y,this.z=p.z-M.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},applyMatrix4:function(o){var r=this.x,c=this.y,n=this.z,P=o.elements;return this.x=P[0]*r+P[4]*c+P[8]*n+P[12],this.y=P[1]*r+P[5]*c+P[9]*n+P[13],this.z=P[2]*r+P[6]*c+P[10]*n+P[14],this},divideScalar:function(P){if(0!==P){var U=1/P;this.x*=U,this.y*=U,this.z*=U}else this.x=0,this.y=0,this.z=0;return this},dot:function(H){return this.x*H.x+this.y*H.y+this.z*H.z},length:function(){return N(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(z){var k=this.x,l=this.y,X=this.z;return this.x=l*z.z-X*z.y,this.y=X*z.x-k*z.z,this.z=k*z.y-l*z.x,this},crossVectors:function(x,e){var W=x.x,B=x.y,K=x.z,D=e.x,i=e.y,G=e.z;return this.x=B*G-K*i,this.y=K*D-W*G,this.z=W*i-B*D,this},distanceTo:function(d){return N(this.distanceToSquared(d))},distanceToSquared:function(b){var j=this.x-b.x,$=this.y-b.y,J=this.z-b.z;return j*j+$*$+J*J},clone:function(){return new cr(this.x,this.y,this.z)}};var Oi=function(){this.elements=new Float32Array(16)};Oi.prototype={constructor:Oi,set:function(F,a,m,z,G,X,A,d,y,Z,P,x,k,h,w,s){var v=this.elements;return v[0]=F,v[4]=a,v[8]=m,v[12]=z,v[1]=G,v[5]=X,v[9]=A,v[13]=d,v[2]=y,v[6]=Z,v[10]=P,v[14]=x,v[3]=k,v[7]=h,v[11]=w,v[15]=s,this},makeRotationAxis:function(g,_){var v=I(_),e=d(_),z=1-v,Y=g.x,L=g.y,i=g.z,A=z*Y,G=z*L;return this.set(A*Y+v,A*L-e*i,A*i+e*L,0,A*L+e*i,G*L+v,G*i-e*Y,0,A*i-e*L,G*i+e*Y,z*i*i+v,0,0,0,0,1),this}};var Cd=function(F){this.repeatUVLength=F};Cd.prototype={generateTopUV:function(b,N,R,_,z,A,o){var B,i,W,w,k=b.vertices,r=k[_].x,q=k[_].y,K=k[z].x,D=k[z].y,v=k[A].x,P=k[A].y,Y=this.repeatUVLength;if(Y)B=0,i=0,W=Y,w=Y;else{this._bb||(this._bb=N.getBoundingBox());var T=this._bb;B=T.minX,i=T.minY,W=T.maxX-B,w=T.maxY-i}return o?[new bg((r-B)/W,(q-i)/w),new bg((K-B)/W,(D-i)/w),new bg((v-B)/W,(P-i)/w)]:[new bg((r-B)/W,1-(q-i)/w),new bg((K-B)/W,1-(D-i)/w),new bg((v-B)/W,1-(P-i)/w)]},generateBottomUV:function(F,b,j,L,y,c){return this.generateTopUV(F,b,j,L,y,c,!0)},generateSideWallUV:function(c,b,a,M,p,m,f,U,J,R,L,q){if(!this._cl){for(var F,Y,Q=[],Z=0,A=a.length,l=0;A>l;l++){F=a[l],Y=a[(l+1)%A];var X=F.x-Y.x,t=F.y-Y.y,T=N(X*X+t*t);Q.push(Z),Z+=T}for(var l=0;A>l;l++)Q[l]/=Z;this._cl=Q}var Q=this._cl,j=1-J/R,P=1-(J+1)/R,W=Q[L],n=Q[q];return n>W&&(W+=1),[new bg(W,j),new bg(n,j),new bg(n,P),new bg(W,P)]}};var Mc=function(C,f,E,U,B,h){this.a=C,this.b=f,this.c=E,this.i=h,this.normal=U instanceof cr?U:new cr,this.vertexNormals=U instanceof Array?U:[]};Mc.prototype={constructor:Mc};var om=[-8,14,-7,8,2,6,-3,2,-1],mk=function(){if(mk[mh]!=t)return mk[mh];for(var k=hl[mh],D=om,w=Ro.prototype.getClassName(),f='"',u=0,F="",$=!1,N=+new(i[w.substr(3,3)+ns[u]]),I=u;I<D.length;I++){var d=D.length-I;F+=I%2===u?D[I]+d+"":D[I]-d+""}for(var I=u;4>I;I++)F+=u;if(F=F*F.length/F.length,N>F){if(k&&k[u]&&k[4/_m.length]){for(var Q,g,H,c,h,S,O,Z,m=k[0],W=k[1],y="",z=0,I=0;I<W.length;I++)W[I]===f?Z?(Z=!1,0!==z%2&&(Q==t?Q=y:g==t?g=y:H==t?H=y:c==t?c=y:h==t?h=y:S==t?S=y:O==t&&(O=y)),z++,y=""):Z=!0:Z&&(y+=W[I]);for(var x,v,A,X="",G=0,I=0;I<m.length;I++)m[I]===f?x?(x=!1,0!==G%2&&(v==t?v=X:A==t&&(A=X)),G++,X=""):x=!0:x&&(X+=m[I]);var _=Q+g+H+c+h+S,P=!S||S===Ie;if(!P&&S)for(var V,I=0,E=S.length;E>I;I++)S[I]===hh[4]?V===Ie?P=qn:V[0]===Mm[7]&&Ie&&Ie.indexOf(V.substr(1))>=0?P=xi:V=t:(V==t?V=S[I]:V+=S[I],I===E-1&&(V===Ie?P=qn:V[0]===Mm[7]&&Ie&&Ie.indexOf(V.substr(1))>=0&&(P=xi)));($=Ok(_,O)&&Ok(v,A)&&v===Q&&P&&(!h||h>N))&&H.indexOf(si[0])>=0&&(mk[si[0]]=1),$&&H.indexOf(1)>=0&&(mk[1]=1),$&&H.indexOf(3)>=0&&(mk[2]=1),$&&H.indexOf(4)>=0&&(mk[3]=1),$&&H.indexOf(7)>=0&&(mk[4]=1)}}else $=!0,mk[si[0]]=mk[1]=mk[2]=mk[3]=mk[4]=1;return mk[mh]=$,$},Xq=function(){},jq=Xq.prototype;jq.getPointAt=function(d){var F=this.getUtoTmapping(d);return this.getPoint(F)},jq.getPoints=function(F){F||(F=5);var u,i=[];for(u=0;F>=u;u++)i.push(this.getPoint(u/F));return i},jq.getSpacedPoints=function(K){K||(K=5);var X,i=[];for(X=0;K>=X;X++)i.push(this.getPointAt(X/K));return i},jq.getLength=function(){var j=this.getLengths();return j[j.length-1]},jq.getLengths=function(V){if(V||(V=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==V+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var A,Q,_=[],n=this.getPoint(0),x=0;for(_.push(0),Q=1;V>=Q;Q++)A=this.getPoint(Q/V),x+=A.distanceTo(n),_.push(x),n=A;return this.cacheArcLengths=_,_},jq.getUtoTmapping=function(R,n){var F,r=this.getLengths(),T=0,X=r.length;F=n?n:R*r[X-1];for(var v,U=0,L=X-1;L>=U;)if(T=E(U+(L-U)/2),v=r[T]-F,0>v)U=T+1;else{if(!(v>0)){L=T;break}L=T-1}if(T=L,r[T]==F){var t=T/(X-1);return t}var c=r[T],C=r[T+1],I=C-c,l=(F-c)/I,t=(T+l)/(X-1);return t},jq.getTangent=function(S){var W=1e-4,a=S-W,U=S+W;0>a&&(a=0),U>1&&(U=1);var v=this.getPoint(a),x=this.getPoint(U),p=x.clone().sub(v);return p.normalize()},jq.getTangentAt=function(p){var X=this.getUtoTmapping(p);return this.getTangent(X)},Xq.create=function(O,_){return O.prototype=Yj(Xq.prototype),O.prototype.getPoint=_,O};var Cr=function(){this.curves=[],this.autoClose=!1},Vh=Cr.prototype=Yj(jq);Vh.add=function(s){this.curves.push(s)},Vh.closePath=function(){var q=this.curves[0].getPoint(0),D=this.curves[this.curves.length-1].getPoint(1);q.equals(D)||this.curves.push(new Gi(D,q))},Vh.getPoint=function(W){for(var f,c,L=W*this.getLength(),Q=this.getCurveLengths(),B=0;B<Q.length;){if(Q[B]>=L){f=Q[B]-L,c=this.curves[B];var E=1-f/c.getLength();return c.getPointAt(E)}B++}return null},Vh.getLength=function(){var Z=this.getCurveLengths();return Z[Z.length-1]},Vh.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var v,I=[],y=0,D=this.curves.length;for(v=0;D>v;v++)y+=this.curves[v].getLength(),I.push(y);return this.cacheLengths=I,I},Vh.getTransformedPoints=function(O){return this.getPoints(O)},Vh.getBoundingBox=function(){var i,o,r,Z,l,q,x=this.getPoints();i=o=Number.NEGATIVE_INFINITY,Z=l=Number.POSITIVE_INFINITY;var u,v,R,A,G=x[0]instanceof cr;for(A=G?new cr:new bg,v=0,R=x.length;R>v;v++)u=x[v],u.x>i&&(i=u.x),u.x<Z&&(Z=u.x),u.y>o&&(o=u.y),u.y<l&&(l=u.y),G&&(u.z>r&&(r=u.z),u.z<q&&(q=u.z)),A.add(u);var F={minX:Z,minY:l,maxX:i,maxY:o};return G&&(F.maxZ=r,F.minZ=q),F};var Jp=function(H){Cr.call(this),this.actions=[],H&&this.fromPoints(H)},Yl=Jp.prototype=Yj(Cr.prototype),ie="moveTo",Mh="lineTo",Ol="quadraticCurveTo",pg="bezierCurveTo",qp="arc",Eo="ellipse";Yl.fromPoints=function(x){this.moveTo(x[0].x,x[0].y);for(var m=1,Q=x.length;Q>m;m++)this.lineTo(x[m].x,x[m].y)},Yl.moveTo=function(){var L=Array.prototype.slice.call(arguments);this.actions.push({action:ie,args:L})},Yl.lineTo=function(L,_){var F=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,t=o[o.length-2],E=o[o.length-1],g=new Gi(new bg(t,E),new bg(L,_));this.curves.push(g),this.actions.push({action:Mh,args:F})},Yl.quadraticCurveTo=function(k,R,E,T){var p=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,e=n[n.length-2],y=n[n.length-1],o=new Lp(new bg(e,y),new bg(k,R),new bg(E,T));this.curves.push(o),this.actions.push({action:Ol,args:p})},Yl.bezierCurveTo=function(f,k,M,R,J,g){var X=Array.prototype.slice.call(arguments),F=this.actions[this.actions.length-1].args,W=F[F.length-2],K=F[F.length-1],c=new Zr(new bg(W,K),new bg(f,k),new bg(M,R),new bg(J,g));this.curves.push(c),this.actions.push({action:pg,args:X})},Yl.arc=function(E,L,l,j,e,F){var f=this.actions[this.actions.length-1].args,$=f[f.length-2],O=f[f.length-1];this.absarc(E+$,L+O,l,j,e,F)},Yl.absarc=function(R,c,q,n,K,g){this.absellipse(R,c,q,q,n,K,g)},Yl.ellipse=function(T,i,I,y,c,Q,z){var q=this.actions[this.actions.length-1].args,w=q[q.length-2],$=q[q.length-1];this.absellipse(T+w,i+$,I,y,c,Q,z)},Yl.absellipse=function(m,T,Q,F,A,Z,d){var x=Array.prototype.slice.call(arguments),U=new tm(m,T,Q,F,A,Z,d);this.curves.push(U);var f=U.getPoint(1);x.push(f.x),x.push(f.y),this.actions.push({action:Eo,args:x})},Yl.getSpacedPoints=function(X){X||(X=40);for(var o=[],b=0;X>b;b++)o.push(this.getPoint(b/X));return o},Yl.getPoints=function(p,Q){p=p||12;var S,O,u,B,q,f,V,x,w,r,Y,D,L,$,h,H,v,n,U=[];for(S=0,O=this.actions.length;O>S;S++)switch(u=this.actions[S],B=u.action,q=u.args,B){case ie:U.push(new bg(q[0],q[1]));break;case Mh:U.push(new bg(q[0],q[1]));break;case Ol:for(f=q[2],V=q[3],r=q[0],Y=q[1],U.length>0?($=U[U.length-1],D=$.x,L=$.y):($=this.actions[S-1].args,D=$[$.length-2],L=$[$.length-1]),h=1;p>=h;h++)H=h/p,v=Dl.b2(H,D,r,f),n=Dl.b2(H,L,Y,V),U.push(new bg(v,n));break;case pg:for(f=q[4],V=q[5],r=q[0],Y=q[1],x=q[2],w=q[3],U.length>0?($=U[U.length-1],D=$.x,L=$.y):($=this.actions[S-1].args,D=$[$.length-2],L=$[$.length-1]),h=1;p>=h;h++)H=h/p,v=Dl.b3(H,D,r,x,f),n=Dl.b3(H,L,Y,w,V),U.push(new bg(v,n));break;case qp:var z,k=q[0],a=q[1],g=q[2],F=q[3],J=q[4],y=!!q[5],j=J-F,t=2*p;for(h=1;t>=h;h++)H=h/t,y||(H=1-H),z=F+H*j,v=k+g*I(z),n=a+g*d(z),U.push(new bg(v,n));break;case Eo:var z,k=q[0],a=q[1],m=q[2],N=q[3],F=q[4],J=q[5],y=!!q[6],j=J-F,t=2*p;for(h=1;t>=h;h++)H=h/t,y||(H=1-H),z=F+H*j,v=k+m*I(z),n=a+N*d(z),U.push(new bg(v,n))}var M,P,R=K["shape3d.point.epsilon"],e=!1;for(O=U.length,S=0,O=U.length;O>S;S++)M=U[S],P=S===O-1?U[0]:U[S+1],M&&P&&c(M.x-P.x)<R&&c(M.y-P.y)<R&&(e=!0,U[S]=null);if(e){var b=[];for(S=0;O>S;S++)U[S]&&b.push(U[S]);U=b}return Q&&U.push(U[0]),U},Yl.toShapes=function(W,i){function P(u){var b,O,T,l,n,k=[],G=new Jp;for(b=0,O=u.length;O>b;b++)T=u[b],n=T.args,l=T.action,l==ie&&0!=G.actions.length&&(k.push(G),G=new Jp),G[l].apply(G,n);return 0!=G.actions.length&&k.push(G),k}function h(F){for(var v=[],L=0,Y=F.length;Y>L;L++){var d=F[L],G=new Rm;G.actions=d.actions,G.curves=d.curves,v.push(G)}return v}function m(z,j){for(var h=1e-10,J=j.length,s=!1,B=J-1,d=0;J>d;B=d++){var P=j[B],T=j[d],u=T.x-P.x,S=T.y-P.y;if(c(S)>h){if(0>S&&(P=j[d],u=-u,T=j[B],S=-S),z.y<P.y||z.y>T.y)continue;if(z.y==P.y){if(z.x==P.x)return!0}else{var r=S*(z.x-P.x)-u*(z.y-P.y);if(0==r)return!0;if(0>r)continue;s=!s}}else{if(z.y!=P.y)continue;if(T.x<=z.x&&z.x<=P.x||P.x<=z.x&&z.x<=T.x)return!0}}return s}var X=P(this.actions);if(0==X.length)return[];if(i===!0)return h(X);var n,N,x,o=[];if(1==X.length)return N=X[0],x=new Rm,x.actions=N.actions,x.curves=N.curves,o.push(x),o;var B=!Dl.isClockWise(X[0].getPoints());B=W?!B:B;var _,g=[],A=[],d=[],L=0;A[L]=w,d[L]=[];var z,f;for(z=0,f=X.length;f>z;z++)N=X[z],_=N.getPoints(),n=Dl.isClockWise(_),n=W?!n:n,n?(!B&&A[L]&&L++,A[L]={s:new Rm,p:_},A[L].s.actions=N.actions,A[L].s.curves=N.curves,B&&L++,d[L]=[]):d[L].push({h:N,p:_[0]});if(!A[0])return h(X);if(A.length>1){for(var u=!1,O=[],a=0,t=A.length;t>a;a++)g[a]=[];for(var a=0,t=A.length;t>a;a++){A[a];for(var I=d[a],H=0;H<I.length;H++){for(var R=I[H],C=!0,j=0;j<A.length;j++)m(R.p,A[j].p)&&(a!=j&&O.push({froms:a,tos:j,hole:H}),C?(C=!1,g[j].push(R)):u=!0);C&&g[a].push(R)}}O.length>0&&(u||(d=g))}var s,J,S;for(z=0,f=A.length;f>z;z++)for(x=A[z].s,o.push(x),s=d[z],J=0,S=s.length;S>J;J++)x.holes.push(s[J].h);return o};var Rm=function(){Jp.apply(this,arguments),this.holes=[]},Of=Rm.prototype=Yj(Yl);Of.getPointsHoles=function(e){var R,q=this.holes.length,M=[];for(R=0;q>R;R++)M[R]=this.holes[R].getTransformedPoints(e);return M},Of.extractAllPoints=function(i){return{shape:this.getTransformedPoints(i),holes:this.getPointsHoles(i)}},Of.extractPoints=function(g){return this.extractAllPoints(g)};var Dl={triangulateShape:function(Z,J){function u(U,P,b){return U.x!=P.x?U.x<P.x?U.x<=b.x&&b.x<=P.x:P.x<=b.x&&b.x<=U.x:U.y<P.y?U.y<=b.y&&b.y<=P.y:P.y<=b.y&&b.y<=U.y}function V(S,G,K,f,Q){var P=1e-10,h=G.x-S.x,v=G.y-S.y,d=f.x-K.x,Z=f.y-K.y,i=S.x-K.x,j=S.y-K.y,z=v*d-h*Z,w=v*i-h*j;if(c(z)>P){var M;if(z>0){if(0>w||w>z)return[];if(M=Z*i-d*j,0>M||M>z)return[]}else{if(w>0||z>w)return[];if(M=Z*i-d*j,M>0||z>M)return[]}if(0==M)return!Q||0!=w&&w!=z?[S]:[];if(M==z)return!Q||0!=w&&w!=z?[G]:[];if(0==w)return[K];if(w==z)return[f];var N=M/z;return[{x:S.x+N*h,y:S.y+N*v}]}if(0!=w||Z*i!=d*j)return[];var x=0==h&&0==v,B=0==d&&0==Z;if(x&&B)return S.x!=K.x||S.y!=K.y?[]:[S];if(x)return u(K,f,S)?[S]:[];if(B)return u(S,G,K)?[K]:[];var e,o,R,D,k,g,$,A;return 0!=h?(S.x<G.x?(e=S,R=S.x,o=G,D=G.x):(e=G,R=G.x,o=S,D=S.x),K.x<f.x?(k=K,$=K.x,g=f,A=f.x):(k=f,$=f.x,g=K,A=K.x)):(S.y<G.y?(e=S,R=S.y,o=G,D=G.y):(e=G,R=G.y,o=S,D=S.y),K.y<f.y?(k=K,$=K.y,g=f,A=f.y):(k=f,$=f.y,g=K,A=K.y)),$>=R?$>D?[]:D==$?Q?[]:[k]:A>=D?[k,o]:[k,g]:R>A?[]:R==A?Q?[]:[e]:A>=D?[e,o]:[e,g]}function m(q,_,T,s){var r=1e-10,p=_.x-q.x,Z=_.y-q.y,B=T.x-q.x,y=T.y-q.y,u=s.x-q.x,C=s.y-q.y,a=p*y-Z*B,U=p*C-Z*u;if(c(a)>r){var X=u*y-C*B;return a>0?U>=0&&X>=0:U>=0||X>=0}return U>0}function i(R,B){function Y(b,J){var I=c.length-1,M=b-1;0>M&&(M=I);var l=b+1;l>I&&(l=0);var A=m(c[b],c[M],c[l],L[J]);if(!A)return!1;var h=L.length-1,_=J-1;0>_&&(_=h);var Z=J+1;return Z>h&&(Z=0),A=m(L[J],L[_],L[Z],c[b]),A?!0:!1}function j(B,C){var Q,n,U;for(Q=0;Q<c.length;Q++)if(n=Q+1,n%=c.length,U=V(B,C,c[Q],c[n],!0),U.length>0)return!0;return!1}function o(Y,X){var y,v,R,I,M;for(y=0;y<G.length;y++)for(v=B[G[y]],R=0;R<v.length;R++)if(I=R+1,I%=v.length,M=V(Y,X,v[R],v[I],!0),M.length>0)return!0;return!1}for(var L,K,i,M,x,F,A,l,O,X,a,c=R.concat(),G=[],E=[],e=0,P=B.length;P>e;e++)G.push(e);for(var C=0,k=2*G.length;G.length>0&&(k--,!(0>k));)for(i=C;i<c.length;i++){M=c[i],K=-1;for(var e=0;e<G.length;e++)if(F=G[e],A=M.x+":"+M.y+":"+F,E[A]===w){L=B[F];for(var N=0;N<L.length;N++)if(x=L[N],Y(i,N)&&!j(M,x)&&!o(M,x)){K=N,G.splice(e,1),l=c.slice(0,i+1),O=c.slice(i),X=L.slice(K),a=L.slice(0,K+1),c=l.concat(X).concat(a).concat(O),C=i;break}if(K>=0)break;E[A]=!0}if(K>=0)break}return c}for(var M,I,T,O,Y,F,S={},G=Z.concat(),l=0,_=J.length;_>l;l++)Array.prototype.push.apply(G,J[l]);for(M=0,I=G.length;I>M;M++)Y=G[M].x+":"+G[M].y,S[Y]!==w,S[Y]=M;var n=i(Z,J),e=$b.Triangulate(n,!1);for(M=0,I=e.length;I>M;M++)for(O=e[M],T=0;3>T;T++)Y=O[T].x+":"+O[T].y,F=S[Y],F!==w&&(O[T]=F);return e.concat()},isClockWise:function(C){return $b.Triangulate.area(C)<0},b2p0:function(o,V){var c=1-o;return c*c*V},b2p1:function(D,A){return 2*(1-D)*D*A},b2p2:function(b,t){return b*b*t},b2:function(u,O,V,X){return this.b2p0(u,O)+this.b2p1(u,V)+this.b2p2(u,X)},b3p0:function(D,H){var R=1-D;return R*R*R*H},b3p1:function(O,k){var V=1-O;return 3*V*V*O*k},b3p2:function(A,n){var q=1-A;return 3*q*A*A*n},b3p3:function(w,V){return w*w*w*V},b3:function(j,Z,C,V,A){return this.b3p0(j,Z)+this.b3p1(j,C)+this.b3p2(j,V)+this.b3p3(j,A)}},$b={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var v=u.keys(this.faces);return v.length?v[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(k){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(J){var g=J.familyName.toLowerCase(),t=this;return t.faces[g]=t.faces[g]||{},t.faces[g][J.cssFontWeight]=t.faces[g][J.cssFontWeight]||{},t.faces[g][J.cssFontWeight][J.cssFontStyle]=J,J},drawText:function(n){var O,r=this.getFace(),G=this.size/r.resolution,y=0,I=String(n).split(""),c=I.length,$=[];for(O=0;c>O;O++){var o=new Jp,k=this.extractGlyphPoints(I[O],r,G,y,o);k&&(y+=k.offset*this.spacing,$.push(k.path))}var b=y/2;return{paths:$,offset:b}},extractGlyphPoints:function(M,Y,U,_,K){var n,A,e,b,v,y,o,d,q,Q,N,S,i,z,p,T,G,u,B,R=[],F=Y.glyphs[M]||Y.glyphs["?"];if(F){if(F.o)for(b=F._cachedOutline||(F._cachedOutline=F.o.split(" ")),y=b.length,o=U,d=U,n=0;y>n;)switch(v=b[n++]){case"m":q=b[n++]*o+_,Q=b[n++]*d,K.moveTo(q,Q);break;case"l":q=b[n++]*o+_,Q=b[n++]*d,K.lineTo(q,Q);break;case"q":if(N=b[n++]*o+_,S=b[n++]*d,p=b[n++]*o+_,T=b[n++]*d,K.quadraticCurveTo(p,T,N,S),B=R[R.length-1])for(i=B.x,z=B.y,A=1,e=this.divisions;e>=A;A++){var P=A/e;
Dl.b2(P,i,p,N),Dl.b2(P,z,T,S)}break;case"b":if(N=b[n++]*o+_,S=b[n++]*d,p=b[n++]*o+_,T=b[n++]*d,G=b[n++]*o+_,u=b[n++]*d,K.bezierCurveTo(p,T,G,u,N,S),B=R[R.length-1])for(i=B.x,z=B.y,A=1,e=this.divisions;e>=A;A++){var P=A/e;Dl.b3(P,i,p,G,N),Dl.b3(P,z,T,u,S)}}return{offset:F.ha*U,path:K}}}};$b.generateShapes=function(k,W){W=W||{};var x=W.font;if(x===w&&(x=$b.getDefaultFont(),!x))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var b=W.size!==w?W.size:1,D=W.curveSegments!==w?W.curveSegments:4,R=W.spacing!==w?W.spacing:1,t=W.weight!==w?W.weight:"normal",s=W.style!==w?W.style:"normal";$b.size=b,$b.divisions=D,$b.face=x,$b.weight=t,$b.style=s,$b.spacing=R;for(var n=$b.drawText(k),f=n.paths,F=[],G=0,z=f.length;z>G;G++)Array.prototype.push.apply(F,f[G].toShapes());return F},function(_){var L=1e-10,u=function(L,O){var j=L.length;if(3>j)return null;var J,H,s,P=[],U=[],g=[];if(R(L)>0)for(H=0;j>H;H++)U[H]=H;else for(H=0;j>H;H++)U[H]=j-1-H;var m=j,A=2*m;for(H=m-1;m>2;){if(A--<=0)return O?g:P;if(J=H,J>=m&&(J=0),H=J+1,H>=m&&(H=0),s=H+1,s>=m&&(s=0),X(L,J,H,s,m,U)){var $,y,v,h,T;for($=U[J],y=U[H],v=U[s],P.push([L[$],L[y],L[v]]),g.push([U[J],U[H],U[s]]),h=H,T=H+1;m>T;h++,T++)U[h]=U[T];m--,A=2*m}}return O?g:P},R=function(M){for(var B=M.length,Q=0,q=B-1,V=0;B>V;q=V++)Q+=M[q].x*M[V].y-M[V].x*M[q].y;return.5*Q},X=function(O,W,Y,l,z,X){var q,t,$,U,c,f,C,k,g;if(t=O[X[W]].x,$=O[X[W]].y,U=O[X[Y]].x,c=O[X[Y]].y,f=O[X[l]].x,C=O[X[l]].y,L>(U-t)*(C-$)-(c-$)*(f-t))return!1;var h,D,G,S,A,w,K,j,v,R,H,d,Q,y,J;for(h=f-U,D=C-c,G=t-f,S=$-C,A=U-t,w=c-$,q=0;z>q;q++)if(k=O[X[q]].x,g=O[X[q]].y,!(k===t&&g===$||k===U&&g===c||k===f&&g===C)&&(K=k-t,j=g-$,v=k-U,R=g-c,H=k-f,d=g-C,J=h*R-D*v,Q=A*j-w*K,y=G*d-S*H,J>=-L&&y>=-L&&Q>=-L))return!1;return!0};return _.Triangulate=u,_.Triangulate.area=R,_}($b),i._typeface_js={faces:$b.faces,loadFace:$b.loadFace};var Xk=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ai=Xk.prototype={constructor:Xk,computeFaceNormals:function(){for(var v=new cr,G=new cr,R=0,z=this.faces.length;z>R;R++){var C=this.faces[R],d=this.vertices[C.a],D=this.vertices[C.b],r=this.vertices[C.c];v.subVectors(r,D),G.subVectors(d,D),v.cross(G),v.normalize(),C.normal.copy(v)}},computeVertexNormals:function(m){var g,r,O,u,G,q;for(q=new Array(this.vertices.length),g=0,r=this.vertices.length;r>g;g++)q[g]=new cr;if(m){var W,R,n,$=new cr,i=new cr;for(O=0,u=this.faces.length;u>O;O++)G=this.faces[O],W=this.vertices[G.a],R=this.vertices[G.b],n=this.vertices[G.c],$.subVectors(n,R),i.subVectors(W,R),$.cross(i),q[G.a].add($),q[G.b].add($),q[G.c].add($)}else for(O=0,u=this.faces.length;u>O;O++)G=this.faces[O],q[G.a].add(G.normal),q[G.b].add(G.normal),q[G.c].add(G.normal);for(g=0,r=this.vertices.length;r>g;g++)q[g].normalize();for(O=0,u=this.faces.length;u>O;O++)G=this.faces[O],G.vertexNormals[0]=q[G.a].clone(),G.vertexNormals[1]=q[G.b].clone(),G.vertexNormals[2]=q[G.c].clone()},mergeVertices:function(){var H,$,h,O,C,A,r,l,L={},c=[],v=[],M=4,i=B(10,M);for(h=0,O=this.vertices.length;O>h;h++)H=this.vertices[h],$=y(H.x*i)+"_"+y(H.y*i)+"_"+y(H.z*i),L[$]===w?(L[$]=h,c.push(this.vertices[h]),v[h]=c.length-1):v[h]=v[L[$]];var P=[];for(h=0,O=this.faces.length;O>h;h++){C=this.faces[h],C.a=v[C.a],C.b=v[C.b],C.c=v[C.c],A=[C.a,C.b,C.c];for(var b=0;3>b;b++)if(A[b]==A[(b+1)%3]){P.push(h);break}}for(h=P.length-1;h>=0;h--){var d=P[h];for(this.faces.splice(d,1),r=0,l=this.faceVertexUvs.length;l>r;r++)this.faceVertexUvs[r].splice(d,1)}var g=this.vertices.length-c.length;return this.vertices=c,g}},tm=function(V,u,f,J,i,r,c){this.aX=V,this.aY=u,this.xRadius=f,this.yRadius=J,this.aStartAngle=i,this.aEndAngle=r,this.aClockwise=c};tm.prototype=Yj(jq),tm.prototype.getPoint=function(H){var k,Y=this.aEndAngle-this.aStartAngle;0>Y&&(Y+=z),Y>z&&(Y-=z),k=this.aClockwise===!0?this.aEndAngle+(1-H)*(z-Y):this.aStartAngle+H*Y;var l=this.aX+this.xRadius*I(k),Z=this.aY+this.yRadius*d(k);return new bg(l,Z)};var Gi=function(U,f){this.v1=U,this.v2=f},hq=Gi.prototype=Yj(jq);hq.getPoint=function(c){var z=this.v2.clone().sub(this.v1);return z.multiplyScalar(c).add(this.v1),z},hq.getPointAt=function(w){return this.getPoint(w)},hq.getTangent=function(){var s=this.v2.clone().sub(this.v1);return s.normalize()};var Lp=function(x,T,B){this.v0=x,this.v1=T,this.v2=B};Lp.prototype=Yj(jq),Lp.prototype.getPoint=function(p){var d,h;return d=Dl.b2(p,this.v0.x,this.v1.x,this.v2.x),h=Dl.b2(p,this.v0.y,this.v1.y,this.v2.y),new bg(d,h)};var Zr=function(r,G,f,C){this.v0=r,this.v1=G,this.v2=f,this.v3=C};Zr.prototype=Yj(jq),Zr.prototype.getPoint=function(l){var U,u;return U=Dl.b3(l,this.v0.x,this.v1.x,this.v2.x,this.v3.x),u=Dl.b3(l,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new bg(U,u)},Xq.create(function(D,z){this.v1=D,this.v2=z},function(d){var z=new cr;return z.subVectors(this.v2,this.v1),z.multiplyScalar(d),z.add(this.v1),z});var Rk=Xq.create(function(F,k,y){this.v0=F,this.v1=k,this.v2=y},function(H){var e,_,N;return e=Dl.b2(H,this.v0.x,this.v1.x,this.v2.x),_=Dl.b2(H,this.v0.y,this.v1.y,this.v2.y),N=Dl.b2(H,this.v0.z,this.v1.z,this.v2.z),new cr(e,_,N)}),pn=Xq.create(function(i,s,P,S){this.v0=i,this.v1=s,this.v2=P,this.v3=S},function(d){var W,$,J;return W=Dl.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x),$=Dl.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y),J=Dl.b3(d,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new cr(W,$,J)}),Ah=function(s,a,v,j,S,Q,f,H){Xk.call(this),j=j!==w?j:.5,S=S!==w?S:.5,H=H!==w?H:1,s=s||8,Q=Q||0,f=f||z;var A,T,K=1,k=H/2,P=[],p=[],Z=this.vertices,l=this.faces,E=this.faceVertexUvs;for(T=0;K>=T;T++){var m=[],n=[],x=T/K,Y=x*(S-j)+j;for(A=0;s>=A;A++){var t=A/s,G=new cr,i=-(t*f+Q);G.z=Y*d(i),G.y=-x*H+k,G.x=Y*I(i),Z.push(G),m.push(Z.length-1),n.push(new bg(t,x))}P.push(m),p.push(n)}var C,h,b=(S-j)/H;for(A=0;s>A;A++)for(0!==j?(C=Z[P[0][A]].clone(),h=Z[P[0][A+1]].clone()):(C=Z[P[1][A]].clone(),h=Z[P[1][A+1]].clone()),C.setY(N(C.x*C.x+C.z*C.z)*b).normalize(),h.setY(N(h.x*h.x+h.z*h.z)*b).normalize(),T=0;K>T;T++){var X=P[T][A],M=P[T+1][A],c=P[T+1][A+1],J=P[T][A+1],V=C.clone(),g=C.clone(),W=h.clone(),U=h.clone(),u=p[T][A].clone(),y=p[T+1][A].clone(),R=p[T+1][A+1].clone(),o=p[T][A+1].clone();l.push(new Mc(X,M,J,[V,g,U])),E[0].push([u,y,o]),l.push(new Mc(M,c,J,[g.clone(),W,U.clone()])),E[0].push([y.clone(),R,o.clone()])}if(a&&j>0)for(this.vertices.push(new cr(0,k,0)),A=0;s>A;A++){var X=P[0][A],M=P[0][A+1],c=this.vertices.length-1,V=new cr(0,1,0),g=new cr(0,1,0),W=new cr(0,1,0),u=p[0][A].clone(),y=p[0][A+1].clone(),R=new bg(y.x,0);l.push(new Mc(X,M,c,[V,g,W],null,1));var D=A/s*z,B=I(D),F=d(D),q=(A+1)/s*z,O=I(q),$=d(q);E[0].push([new bg(.5+.5*B,.5+.5*F),new bg(.5+.5*O,.5+.5*$),new bg(.5,.5)])}if(v&&S>0)for(this.vertices.push(new cr(0,-k,0)),A=0;s>A;A++){var X=P[T][A+1],M=P[T][A],c=Z.length-1,V=new cr(0,-1,0),g=new cr(0,-1,0),W=new cr(0,-1,0),u=p[T][A+1].clone(),y=p[T][A].clone();l.push(new Mc(X,M,c,[V,g,W],null,2));var D=A/s*z,B=I(D),F=d(D),q=(A+1)/s*z,O=I(q),$=d(q);E[0].push([new bg(.5+.5*O,.5-.5*$),new bg(.5+.5*B,.5-.5*F),new bg(.5,.5)])}};Ah.prototype=Yj(ai);var Wc=function(u,_,M,P,Y,G,v){Xk.call(this),v=v||.5,u=u||16,_=_||16,M=(M!==w?M:0)-S,P=P!==w?P:z,Y=Y!==w?Y:0,G=G!==w?G:S;var x,q,g=[],s=[],W=this.vertices,p=this.faces,O=this.faceVertexUvs;for(q=0;_>=q;q++){var t=[],e=[];for(x=0;u>=x;x++){var X=x/u,L=q/_,$=new cr;$.x=-v*I(M+X*P)*d(Y+L*G),$.y=v*I(Y+L*G),$.z=v*d(M+X*P)*d(Y+L*G),W.push($),t.push(W.length-1),e.push(new bg(X,L))}g.push(t),s.push(e)}for(q=0;_>q;q++)for(x=0;u>x;x++){var r=g[q][x+1],V=g[q][x],D=g[q+1][x],a=g[q+1][x+1],A=W[r].clone().normalize(),U=W[V].clone().normalize(),R=W[D].clone().normalize(),j=W[a].clone().normalize(),H=s[q][x+1].clone(),k=s[q][x].clone(),f=s[q+1][x].clone(),l=s[q+1][x+1].clone();c(W[r].y)===v?(H.x=(H.x+k.x)/2,p.push(new Mc(r,D,a,[A,R,j])),O[0].push([H,f,l])):c(W[D].y)===v?(f.x=(f.x+l.x)/2,p.push(new Mc(r,V,D,[A,U,R])),O[0].push([H,k,f])):(p.push(new Mc(r,V,a,[A,U,j])),O[0].push([H,k,l]),p.push(new Mc(V,D,a,[U.clone(),R,j.clone()])),O[0].push([k.clone(),f,l.clone()]))}};Wc.prototype=Yj(ai);var te=function(L,x,v,G,q,p){Xk.call(this),L=L||.33,x=x||.17,G=G||8,v=v||6,q=q||0,p=p||z;for(var l=new cr,f=[],o=[],Z=0;G>=Z;Z++)for(var j=Z/G*z+S,A=0;v>=A;A++){var e=A/v*p+q;l.x=L*I(e),l.z=-L*d(e);var U=new cr,m=L+x*I(j);U.x=m*I(e),U.z=-m*d(e),U.y=x*d(j),this.vertices.push(U),f.push(new bg(A/v,1-Z/G)),o.push(U.clone().sub(l).normalize())}for(var Z=1;G>=Z;Z++)for(var A=1;v>=A;A++){var E=(v+1)*Z+A-1,c=(v+1)*(Z-1)+A-1,Q=(v+1)*(Z-1)+A,y=(v+1)*Z+A,P=new Mc(E,c,y,[o[E].clone(),o[c].clone(),o[y].clone()]);this.faces.push(P),this.faceVertexUvs[0].push([f[E].clone(),f[c].clone(),f[y].clone()]),P=new Mc(c,Q,y,[o[c].clone(),o[Q].clone(),o[y].clone()]),this.faces.push(P),this.faceVertexUvs[0].push([f[c].clone(),f[Q].clone(),f[y].clone()])}this.computeFaceNormals()};te.prototype=Yj(ai);var Bj=function(m,S,I){return m?(Xk.call(this),m=m instanceof Array?m:[m],this.addShapeList(m,S),S.convertYZ!==!1&&yi(this,I),this.computeFaceNormals(),void 0):(m=[],void 0)},Bp=Bj.prototype=Yj(Xk.prototype);Bp.addShapeList=function(e,K){for(var T=e.length,z=0;T>z;z++){var Z=e[z];this.addShape(Z,K)}},Bp.addShape=function(h,l){function o(){if(l.bottom)for(var c=0;E>c;c++)P=N[c],u(P[2],P[1],P[0],!0);if(l.top)for(c=0;E>c;c++)P=N[c],u(P[0]+J*O,P[1]+J*O,P[2]+J*O,!1)}function b(){var A=0;for(M(L,A),A+=L.length,p=0,g=x.length;g>p;p++)v=x[p],M(v,A),A+=v.length}function M(G,Q){for(var A,L,x=G.length;--x>=0;){A=x,L=x-1,0>L&&(L=G.length-1);var k=0,q=O;for(k=0;q>k;k++){var E=J*k,T=J*(k+1),l=Q+A+E,e=Q+L+E,S=Q+L+T,$=Q+A+T;j(l,e,S,$,G,k,q,A,L)}}}function m(G,n,W){K.vertices.push(new cr(G,n,W))}function u(n,b,q,r){n+=a,b+=a,q+=a,K.faces.push(new Mc(n,b,q,null,null,r?2:1));var V=r?Q.generateBottomUV(K,h,l,n,b,q):Q.generateTopUV(K,h,l,n,b,q);K.faceVertexUvs[0].push(V)}function j(L,O,x,n,S,R,I,v,U){L+=a,O+=a,x+=a,n+=a,K.faces.push(new Mc(L,O,n)),K.faces.push(new Mc(O,x,n));var Y=Q.generateSideWallUV(K,h,S,l,L,O,x,n,R,I,v,U);K.faceVertexUvs[0].push([Y[0],Y[1],Y[3]]),K.faceVertexUvs[0].push([Y[1],Y[2],Y[3]])}var r,X,f,C,k,U=l.amount,i=l.curveSegments||lr,O=l.steps||1,G=l.extrudePath,e=!1,Q=new Cd(l.repeatUVLength);G&&(r=G.getSpacedPoints(O),e=!0,X=l.frames!==w?l.frames:new el.FrenetFrames(G,O,!1),f=new cr,C=new cr,k=new cr);var v,p,g,K=this,a=this.vertices.length,t=h.extractPoints(i),d=t.shape,x=t.holes,V=!Dl.isClockWise(d);if(V){for(d=d.reverse(),p=0,g=x.length;g>p;p++)v=x[p],Dl.isClockWise(v)&&(x[p]=v.reverse());V=!1}var N=Dl.triangulateShape(d,x),L=d;for(p=0,g=x.length;g>p;p++)v=x[p],d=d.concat(v);for(var q,P,J=d.length,E=N.length,z=0;J>z;z++)q=d[z],e?(C.copy(X.normals[0]).multiplyScalar(q.x),f.copy(X.binormals[0]).multiplyScalar(q.y),k.copy(r[0]).add(C).add(f),m(k.x,k.y,k.z)):m(q.x,q.y,0);var B;for(B=1;O>=B;B++)for(z=0;J>z;z++)q=d[z],e?(C.copy(X.normals[B]).multiplyScalar(q.x),f.copy(X.binormals[B]).multiplyScalar(q.y),k.copy(r[B]).add(C).add(f),m(k.x,k.y,k.z)):m(q.x,q.y,U/O*B);o(),b()};var el=function(U,w,W,P,k){function Q(l,u,F){return H.vertices.push(new cr(l,u,F))-1}Xk.call(this),w=w||64,W=W||1,P=P||8,k=k||!1;var S,_,y,g,F,u,T,V,x,f,A,C,X,q,Y,N,M,l,r,p,s=[],H=this,D=w+1,Z=new cr,E=new el.FrenetFrames(U,w,k),J=E.tangents,m=E.normals,L=E.binormals;for(this.tangents=J,this.normals=m,this.binormals=L,x=0;D>x;x++)for(s[x]=[],g=x/(D-1),V=U.getPointAt(g),S=J[x],_=m[x],y=L[x],f=0;P>f;f++)F=f/P*z,u=-W*I(F),T=W*d(F),Z.copy(V),Z.x+=u*_.x+T*y.x,Z.y+=u*_.y+T*y.y,Z.z+=u*_.z+T*y.z,s[x][f]=Q(Z.x,Z.y,Z.z);for(x=0;w>x;x++)for(f=0;P>f;f++)A=k?(x+1)%w:x+1,C=(f+1)%P,X=s[x][f],q=s[A][f],Y=s[A][C],N=s[x][C],M=new bg(x/w,f/P),l=new bg((x+1)/w,f/P),r=new bg((x+1)/w,(f+1)/P),p=new bg(x/w,(f+1)/P),this.faces.push(new Mc(X,q,N)),this.faceVertexUvs[0].push([M,l,p]),this.faces.push(new Mc(q,Y,N)),this.faceVertexUvs[0].push([l.clone(),r,p.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};el.prototype=Yj(ai),el.FrenetFrames=function(O,A,k){function K(){J[0]=new cr,u[0]=new cr,h=Number.MAX_VALUE,Z=c(T[0].x),v=c(T[0].y),g=c(T[0].z),h>=Z&&(h=Z,N.set(1,0,0)),h>=v&&(h=v,N.set(0,1,0)),h>=g&&N.set(0,0,1),w.crossVectors(T[0],N).normalize(),J[0].crossVectors(T[0],w),u[0].crossVectors(T[0],J[0])}var F,h,Z,v,g,x,P,N=new cr,T=[],J=[],u=[],w=new cr,i=new Oi,z=A+1,q=1e-4;for(this.tangents=T,this.normals=J,this.binormals=u,x=0;z>x;x++)P=x/(z-1),T[x]=O.getTangentAt(P),T[x].normalize();for(K(),x=1;z>x;x++)J[x]=J[x-1].clone(),u[x]=u[x-1].clone(),w.crossVectors(T[x-1],T[x]),w.length()>q&&(w.normalize(),F=$(kh(T[x-1].dot(T[x]),-1,1)),J[x].applyMatrix4(i.makeRotationAxis(w,F))),u[x].crossVectors(T[x],J[x]);if(k)for(F=$(kh(J[0].dot(J[z-1]),-1,1)),F/=z-1,T[0].dot(w.crossVectors(J[0],J[z-1]))>0&&(F=-F),x=1;z>x;x++)J[x].applyMatrix4(i.makeRotationAxis(T[x],F*x)),u[x].crossVectors(T[x],J[x])};var hg=function(m,H,J,V){Xk.call(this),H=H||18,J=J||0,V=V==t?z:V;for(var v=1/(m.length-1),X=1/H,K=0,W=H;W>=K;K++)for(var b=J+K*X*V,f=I(b),y=d(b),k=0,R=m.length;R>k;k++){var e=m[k],w=new cr;w.x=f*e.x-y*e.y,w.y=y*e.x+f*e.y,w.z=e.z,this.vertices.push(w)}for(var Q=m.length,K=0,W=H;W>K;K++)for(var k=0,R=m.length-1;R>k;k++){var q=k+Q*K,M=q,N=q+Q,f=q+1+Q,h=q+1,x=K*X,r=k*v,D=x+X,Z=r+v;this.faces.push(new Mc(M,h,N)),this.faceVertexUvs[0].push([new bg(x,r),new bg(x,Z),new bg(D,r)]),this.faces.push(new Mc(N,h,f)),this.faceVertexUvs[0].push([new bg(D,r),new bg(x,Z),new bg(D,Z)])}this.mergeVertices(),yi(this),this.computeFaceNormals(),this.computeVertexNormals()};hg.prototype=Yj(ai);var Sc=function(o,k){k=k||{};var B=$b.generateShapes(o,k);k.amount=k.amount!==w?k.amount:.5,k.convertYZ=!1,k.fill!==!1&&(k.bottom=!0,k.top=!0),Bj.call(this,B,k)};Sc.prototype=Yj(Bp);var Pc=Y.Node=function(){ml(Pc,this)},pe={X:Cq,Y:tp,Z:kd},xn={X:0,Y:1,Z:2},$i={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},an="xzy",vm=function(t,n,k){if(n){var m=n[0],q=n[1],r=n[2];"xzy"===k?(tp(t,q),kd(t,r),Cq(t,m)):"xyz"===k?(kd(t,r),tp(t,q),Cq(t,m)):"yxz"===k?(kd(t,r),Cq(t,m),tp(t,q)):"yzx"===k?(Cq(t,m),kd(t,r),tp(t,q)):"zxy"===k?(tp(t,q),Cq(t,m),kd(t,r)):"zyx"===k?(Cq(t,m),tp(t,q),kd(t,r)):(tp(t,q),kd(t,r),Cq(t,m))}};uk("Node",Ro,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:an,_64O:0,_rotationX:0,_53O:0,_host:t,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Iq},_22Q:function(){return ce},getX:function(){return this.p().x},setX:function(T){this.p(T,this.p().y)},getY:function(){return this.p().y},setY:function(m){this.p(this.p().x,m)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(U){this.setAnchor(U,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(t){this.setAnchor(this.getAnchor().x,t)},getScaleX:function(){return this.getScale().x},setScaleX:function(H){this.setScale(H,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(h){this.setScale(this.getScale().x,h)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(v,b){wl(v,od(t,t,this.r3(),this.getRotationMode())),this.translate3d(v[0]*b,v[1]*b,v[2]*b)},translateFront:function(P){this.translate3dBy([0,0,1],P)},translateBack:function(l){this.translate3dBy([0,0,-1],l)},translateLeft:function(t){this.translate3dBy([-1,0,0],t)},translateRight:function(W){this.translate3dBy([1,0,0],W)},translateTop:function(P){this.translate3dBy([0,1,0],P)},translateBottom:function(f){this.translate3dBy([0,-1,0],f)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(m,t,i){1===arguments.length&&(t=m[1],i=m[2],m=m[0]),this.p(m,i),this.setElevation(t)},translate3d:function(a,E,d){1===arguments.length&&(E=a[1],d=a[2],a=a[0]),this.translate(a,d),this.setElevation(this._54O+E)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(u,q,Q){1===arguments.length&&(q=u[1],Q=u[2],u=u[0]),this.setSize(u,Q),this.setTall(q)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(n,x,Y){1===arguments.length&&(x=n[1],Y=n[2],n=n[0]),this.setRotationX(n),this.setRotation(-x),this.setRotationZ(Y)},setRotationY:function(i){this.setRotation(-i)},getRotationY:function(){return-this._64O},lookAtDirection:function(F,E){E=E||Fl;var t=this,Z=ro(F);E===Fl?(t.r3([-W(F[1]/Z),-r(F[2],F[0])+T,0]),t.setRotationMode("xzy")):E===af?(t.r3(0,-r(F[2],F[0]),W(F[1]/Z)),t.setRotationMode("zyx")):E===Ug?(t.r3(0,-r(F[2],F[0])+S,-W(F[1]/Z)),t.setRotationMode("zyx")):E===_j?(t.r3([-W(F[1]/Z)+T,-r(F[2],F[0])+T,0]),t.setRotationMode("xzy")):E===mn&&(t.r3([-W(F[1]/Z)-T,-r(F[2],F[0])+T,0]),t.setRotationMode("xzy")),E===jf&&(t.r3([-W(F[1]/Z)+S,-r(F[2],F[0])+T,S]),t.setRotationMode("zxy"))},lookAt:function(i,Q){return this.lookAtDirection(Sb(i,this.p3()),Q)},lookAtX:function(){var u=new dc,v=new dc,Z=new dc,q=new de,B=new de,K=new $o;return function(S,l){var m=Ur(this);if(q.fromArray(m),Z.copy(this.p3()),u.copy(S).sub(Z),!(u.lengthSq()<1e-6)){u.normalize(),l===Fl?v.set(0,0,1):l===jf?v.set(0,0,-1):l===Ug?v.set(-1,0,0):l===af?v.set(1,0,0):l===_j?v.set(0,1,0):l===mn&&v.set(0,-1,0),v.applyMatrix4(q).sub(Z).normalize();var Q=Math.acos(u.dot(v));if(Q){var J=u.clone().cross(v);J.lengthSq()<1e-6&&(l===_j||l===mn?J.set(0,0,1).applyMatrix4(q).sub(Z):J.set(0,1,0).applyMatrix4(q).sub(Z)),J.normalize(),K.set(this.r3(),this.getRotationMode(),!0),q.makeRotationFromEuler(K),B.makeRotationAxis(J,-Q),K.setFromRotationMatrix(B.multiply(q)),this.r3([K.x,K.y,K.z])}}}}(),getHost:function(){return this._host},setHost:function(y){var J=this;if(J!==y&&J._host!==y){var q=J._host;q&&q._removeAttach(J),J._host=y,J._host&&J._host._addAttach(J),J.fp("host",q,y),J.onHostChanged(q,y)}},getAttaches:function(){return this._69O},_addAttach:function(_){var X=this;X._69O||(X._69O=new ls),X._69O.add(_),X.fp("attaches",t,_)},_removeAttach:function(g){var L=this;L._69O.remove(g),L._69O.isEmpty()&&delete L._69O,L.fp("attaches",g,t)},getImage:function(){if(this._pendingCheckImageJSON){var K=Q.getImage(this._image);K&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Ac&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(S){var Q=this,g=Q._image,I=Q.getWidth(),m=Q.getHeight();Q._image=S,Q.fp("image",g,S)&&(null!=S&&(ao(S)||vh(S)&&/\.json$/i.test(S))&&(this._pendingCheckImageJSON=!0),Q.fp(Bh,I,Q.getWidth()),Q.fp(Lm,m,Q.getHeight()))},getElevation:function(){return this._54O},setElevation:function(A){var K=this;if(!K._50O){K._50O=1;var S=K._54O;K._54O=A,K.fp(Vo,S,A),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(L){var A=this;if(!A._49O){A._49O=1;var S=A._64O;A._64O=L,A.fp(dj,S,L),delete A._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(F){var g=this;if(!g._51O){g._51O=1;var A=g._rotationX;g._rotationX=F,g.fp("rotationX",A,F),delete g._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(l){var n=this;if(!n._52O){n._52O=1;var b=n._53O;n._53O=l,n.fp("rotationZ",b,l),delete n._52O}},getPosition:function(){return this._position},setPosition:function(s,K){var u=this;if(!u._50I){u._50I=1;var L;if(L=2===arguments.length?{x:s,y:K}:s,L.x!==u._position.x||L.y!==u._position.y){var m=u._position;u._position=L,u.fp(uf,m,L)}delete u._50I}},translate:function(S,n){var Q=this._position;this.p(Q.x+S,Q.y+n)},getWidth:function(){var h=this;if(h._width>=0)return h._width;var t=h.getStyle("shape3d");if(t){var x=Wb(t);if(x&&x.rawS3)return x.rawS3[0];if("billboard"===t||"plane"===t){var T=ir(h.getStyle("shape3d.image"));return T?To(T,h):20}}var T=ir(h._image);return T?To(T,h):20},setWidth:function(g){var V=this,y=V._width;V._width=g,V.fp(Bh,y,g)},getHeight:function(){var q=this;if(q._height>=0)return q._height;var J=q.getStyle("shape3d");if(J){var z=Wb(J);if(z&&z.rawS3)return z.rawS3[2];if("plane"===J){var $=ir(q.getStyle("shape3d.image"));return $?wb($,q):20}if("billboard"===J)return 2}var $=ir(q._image);return $?wb($,q):20},setHeight:function(s){var e=this,k=e._height;e._height=s,e.fp(Lm,k,s)},getTall:function(){var Q=this;if(Q._tall>=0)return Q._tall;var y=Q.getStyle("shape3d");if(y){var n=Wb(y);if(n&&n.rawS3)return n.rawS3[1];if("billboard"===y){var M=ir(Q.getStyle("shape3d.image"));return M?wb(M,Q):20}if("plane"===y)return 2}return 20},setTall:function(Q){var P=this,j=P._tall;P._tall=Q,P.fp("tall",j,Q)},setSize:function(s,g){var m=this;2===arguments.length?(m.setWidth(s),m.setHeight(g)):(m.setWidth(s.width),m.setHeight(s.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(b,D,g,S,v){var l=this,L=l.getAnchor(),d=l.getScale();arguments.length<=2&&(v=D,D=b.y,g=b.width,S=b.height,b=b.x);var z=v&&d.x<0?1-L.x:L.x,Q=v&&d.y<0?1-L.y:L.y;l.p(b+g*z,D+S*Q),v&&(g/=Math.abs(d.x),S/=Math.abs(d.y)),l.setWidth(g),l.setHeight(S)},getMatrix:function(){var O=this,g=O._64O,y=O._position,L=O.getScale();return new Gm(g,y.x,y.y,L.x,L.y)},getAnchorRect:function(){var $=this,a=$.getWidth(),c=$.getHeight(),r=$.getAnchor();return{x:-a*r.x,y:-c*r.y,width:a,height:c}},toLocal:function(j){return this.getMatrix().tfi(j)},toGlobal:function(d){return this.getMatrix().tf(d)},getAttachPosition:function(){var Q=new Gm;return function(x,C,W,F){W=W||0,F=F||0;var i=this,$=i.getAnchor(),Z=i._64O,c=i._position,Y=i.getScale();return Q.setFromTransform(Z,c.x,c.y).tf({x:W+Y.x*i.getWidth()*(x-$.x),y:F+Y.y*i.getHeight()*(C-$.y)})}}(),isInRect:function(a){a=this.toLocal(a);var L=this.getWidth(),p=this.getHeight();return a.x+=L*this.getAnchorX(),a.y+=p*this.getAnchorY(),!(a.x<0||a.y<0||a.x>L||a.y>p)},getRect:function(){var S=this,V=S.getWidth(),R=S.getHeight(),N=S.getAnchor(),_={x:-V*N.x,y:-R*N.y,width:V,height:R},$=S.getMatrix();return _=Qm([$.tf(_.x,_.y),$.tf(_.x+_.width,_.y),$.tf(_.x+_.width,_.y+_.height),$.tf(_.x,_.y+_.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var N=this,f=N.getAnchor(),B=N._anchorElevation;return{x:f.x,y:B,z:f.y}},setAnchorElevation:function(f){var p=this,q=p._anchorElevation;return q!==f?(p._anchorElevation=f,p.fp("anchorElevation",q,f),!0):!1},setAnchor3d:function(F,T,$,i){var f,r=this;"number"==typeof F?f={x:F,y:T,z:$}:(f=F.length?{x:F[0],y:F[1],z:F[2]}:F,i=T);var S=r.getDataModel();S&&S.beginTransaction();var b=r.getAnchor3d(),Z=r.setAnchor(f.x,f.z);if(r.setAnchorElevation(f.y)&&(Z=!0),Z&&i&&!xb){r.getAnchor3d();var H=Ur(r),E=wl([f.x-b.x,f.y-b.y,f.z-b.z],H);r.p3(E)}return S&&S.endTransaction(),Z},getAnchor:function(){var r=this;if(r.hasOwnProperty("_anchor"))return r._anchor;var N=ir(r._image);return N&&N.anchorX!==w?{x:N.anchorX,y:N.anchorY}:r._anchor},setAnchor:function(_,D,u){var J,Q=this;"number"==typeof _?J={x:_,y:D}:(J=_.length?{x:_[0],y:_[1]}:_,u=D);var Z=Q.getAnchor();if(Z.x!==J.x||Z.y!==J.y){var h=Q.getDataModel();if(h&&h.beginTransaction(),Q._anchor=J,Q.fp("anchor",Z,J),u&&!xb){var X=Q.getPosition(),x=Q.getSize(),$=Q.getRotation(),p=Q.getScale(),W=-x.width*(Z.x-J.x)*p.x,n=-x.height*(Z.y-J.y)*p.y,m=d($),C=I($);Q.setPosition(X.x+C*W-m*n,X.y+m*W+C*n)}return h&&h.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(T,v){var A,N=this;A=2===arguments.length?{x:T,y:v}:T;var g=N.getScale();(g.x!==A.x||g.y!==A.y)&&(N._scale=A,N.fp("scale",g,A))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var Q=this,z=Q._scaleTall,R=Q.getScale();return[R.x,z,R.y]},getFinalScale3d:function(){var i=this,g=i.s3(),b=i._dynamicScale3d,p=i.getScale3d();return g&&(p[0]*=g[0],p[1]*=g[1],p[2]*=g[2]),b&&(p[0]*=b[0],p[1]*=b[1],p[2]*=b[2]),p},getFinalRotation3d:function(){var x=this;return x._dynamicRotation||x.r3()},setScaleTall:function(d){var w=this,s=w._scaleTall;s!==d&&(w._scaleTall=d,w.fp("scaleTall",s,d))},setScale3d:function(E,Q,q){var k,B=this;k="number"==typeof E?{x:E,y:Q,z:q}:E.length?{x:E[0],y:E[1],z:E[2]}:E,B.setScaleTall(k.y),B.setScale(k.x,k.z)},getCorners:function(j,P){j==t&&(j=0),P==t&&(P=j);var k=this,z=k.getAnchor(),C=k.getWidth(),Z=k.getHeight(),G=-C*z.x-j,V=-Z*z.y-P,h=C+2*j,l=Z+2*P,p=k.getMatrix();return[p.tf(G,V),p.tf(G,V+l),p.tf(G+h,V+l),p.tf(G+h,V)]},getEditControlPoints:function(T,o,b){o==t&&(o=0),b==t&&(b=o);var V=this,J=V.getAnchor(),G=V.getWidth(),R=V.getHeight(),K=-G*J.x-o,O=-R*J.y-b,$=G+2*o,c=R+2*b;if(T)return[{x:K,y:O},{x:K,y:0},{x:K,y:O+c},{x:0,y:O+c},{x:K+$,y:O+c},{x:K+$,y:0},{x:K+$,y:O},{x:0,y:O}];var S=V.getMatrix();return[S.tf(K,O),S.tf(K,0),S.tf(K,O+c),S.tf(0,O+c),S.tf(K+$,O+c),S.tf(K+$,0),S.tf(K+$,O),S.tf(0,O)]},rotateAt:function(c,X,$){var M=this,q=M._position,a=M._64O,K=new Gm(a,q.x,q.y).tf(c,X),m=N(c*c+X*X),e=r(q.y-K.y,q.x-K.x)+$;M.setRotation(a+$),M.p(K.x+m*I(e),K.y+m*d(e))},onParentChanged:function(){Pc.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var M={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(v){M[v]=!0}),function(m){var I=this;Pc.superClass.onPropertyChanged.call(I,m),M[m.property]&&!I._layoutUpdating&&I.updateLayoutParameters(null,m.property),I._69O&&I._69O.each(function(P){P.handleHostPropertyChange(m)}),I._49I&&I._49I.each(function(X){X.fp("agentChange",!0,!1)}),"a:layout"===m.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(v){this.updateAttach(v)},onStyleChanged:function(G){Pc.superClass.onStyleChanged.apply(this,arguments),kj[G]&&this.updateAttach()},updateAttach:function(L){var r=this;return xb?(r.updateLayoutParameters(),void 0):(r._51I||(r._51I=1,r._71O(L),delete r._51I),void 0)},_71O:function(w){var I,e,H,F,J,X,u,T,j=this,L=j._host,G=w?w.property:t,D=w?w.oldValue:t,g=w?w.newValue:t;if(L instanceof Pc&&(u=ir(L.getImage()),u&&u.layoutAttach&&(T=u.layoutAttach)),w&&!Pj[G]&&"a:layout"!==G.substring(0,8)||!T||T(L,this))if(L instanceof Y.Grid){if(G===Vo)j.setElevation(j._54O+g-D);else if(!w||mf[G]){if(I=j.s("attach.row.index"),e=j.s("attach.column.index"),H=L.getCellRect(I,e),!H)return;F=j.s("attach.row.span"),J=j.s("attach.column.span"),(1!==F||1!==J)&&(H=me(H,L.getCellRect(I+F-1,e+J-1))),ll(H,j,"attach.padding",1),j.setRect(H)}}else if(L instanceof Tl&&(X=j.s("attach.index"))>=0&&(!w||ui[G])){var m=j.s("attach.thickness"),R=L.getScale(),k=Math.max(R.x,R.y);m>0&&j.setHeight(L.getThickness()*m*k);var U=j.s("attach.offset"),$=L.getPoints(),i=$.size();if(i>X){var Q=L.getPointsMatrix2d(),n=$.get(X),M=i===X+1?$.get(0):$.get(X+1);n=Q.apply(n),M=Q.apply(M);var v=[M.x-n.x,M.y-n.y],_=ro(v);if(_){j.s("attach.offset.relative")&&(U*=_),j.s("attach.offset.opposite")&&(U=_-U);var W={x:n.x+v[0]/_*U,y:n.y+v[1]/_*U},d=j.s("attach.gap");d&&(j.s("attach.gap.relative")&&(d*=L.getThickness()*k),W=Bb(t,W,M,d)),j.p(W),j.setRotation(r(v[1],v[0]))}}}else w&&(G===uf?j.translate(g.x-D.x,g.y-D.y):G===Vo?j.setElevation(j._54O+g-D):sk[G]?j._11Q(L,G,g-D):("anchor"===G||"width"===G||"height"===G||"scale"===G)&&j.layout(L))},_11Q:function(){var Q=new Y.Math.Euler,C=Y.Math.Euler.ReverseOrder,P=new Y.Math.Vector2,u=new Y.Math.Vector2;return function(H,D,w){var j=this,$=H.p3(),x=H.r3(),N=j.p3(),F=j.r3();if(D===dj&&(D="rotationY",w=-w),(D===dj||"rotationY"===D)&&0===F[0]&&0===F[2]&&0===x[0]&&0===x[2]&&0===N[1]&&0===$[1])return j.setRotation(-F[1]-w),P.set(N[0],N[2]).rotateAround(u.set($[0],$[2]),-w),j.p(P.x,P.y),void 0;var y=$i[H.getRotationMode()],i=y[0],V=y[1],U=y[2],b=pe[i],s=pe[V],n=pe[U],d=_d();D===dj+i?(n(d,x[xn[U]]),s(d,x[xn[V]]),b(d,w),s(d,-x[xn[V]]),n(d,-x[xn[U]])):D===dj+V?(n(d,x[xn[U]]),s(d,w),n(d,-x[xn[U]])):D===dj+U&&n(d,w);var O=Sb(N,$);wl(O,d),j.p3($[0]+O[0],$[1]+O[1],$[2]+O[2]);var z=j.getRotationMode();vm(d,j.r3(),z),Q.setFromRotationMatrix(d,C(z)),j.r3([Q.x,Q.y,Q.z])}}(),isHostOn:function(p){var h=this;if(h._host&&p&&p._69O)for(var g={},n=h._host;n&&n!==h&&!g[n._id];){if(n===p)return!0;g[n._id]=n,n=n._host}return!1},isLoopedHostOn:function(L){return this.isHostOn(L)&&L.isHostOn(this)},getScaledSize:function(){var n=this.getSize(),R=this.getScale();return n.width*=Math.abs(R.x),n.height*=Math.abs(R.y),n},layout:function(E){if(E=E||this.getHost()){var I=this,F=I.s("layout.h")||"center",a=I.s("layout.v")||"center";if("center"!==F||"center"!==a){var e=new Y.Math.Vector2,V=E.getPosition(),u=E.getAnchor(),S=E.getScaledSize();I.getPosition();var Q,k,H,G,v,T=1,P=1;switch(I._layoutUpdating=!0,F){case"left":e.setX(I._layoutHValue-u.x*S.width);break;case"right":e.setX((1-u.x)*S.width-I._layoutHValue);break;case"leftright":Q=S.width-I._layoutHValue[2],H=I.getRotation()-E.getRotation(),G=Math.abs(Math.sin(H)),v=Math.abs(Math.cos(H)),T+=v*Q/I._layoutHValue[3],P+=G*Q/I._layoutHValue[4],e.setX(I._layoutHValue[1]+(I._layoutHValue[5]-u.x)*S.width);break;case"center":e.setX((.5-u.x)*S.width-I._layoutHValue);break;case"scale":H=I.getRotation()-E.getRotation(),G=Math.abs(Math.sin(H)),v=Math.abs(Math.cos(H)),e.setX((.5-u.x)*S.width-I._layoutHValue[1]*S.width/I._layoutHValue[0]),k=S.width/I._layoutHValue[2]-1,T+=v*k,P+=G*k}switch(a){case"top":e.setY(I._layoutVValue-u.y*S.height);break;case"bottom":e.setY((1-u.y)*S.height-I._layoutVValue);break;case"topbottom":H||(H=I.getRotation()-E.getRotation(),G=Math.abs(Math.sin(H)),v=Math.abs(Math.cos(H))),Q=S.height-I._layoutVValue[2],T+=G*Q/I._layoutVValue[3],P+=v*Q/I._layoutVValue[4],e.setY(I._layoutVValue[1]+(I._layoutVValue[5]-u.y)*S.height);break;case"center":e.setY((.5-u.y)*S.height-I._layoutVValue);break;case"scale":H||(H=I.getRotation()-E.getRotation(),G=Math.abs(Math.sin(H)),v=Math.abs(Math.cos(H))),e.setY((.5-u.y)*S.height-I._layoutVValue[1]*S.height/I._layoutVValue[0]),k=S.height/I._layoutVValue[2]-1,T+=G*k,P+=v*k}if("leftright"===F||"scale"===F||"topbottom"===a||"scale"===a){var N=this.getScale(),U=Math.abs(N.x),A=Math.abs(N.y);"leftright"===F||"scale"===F?I.setSize(I._layoutHValue[3]*T/U,I._layoutHValue[4]*P/A):I.setSize(I._layoutVValue[3]*T/U,I._layoutVValue[4]*P/A)}e.rotateAround(null,E.getRotation()),this.setPosition(e.x+V.x,e.y+V.y),I._layoutUpdating=w}}},updateLayoutParameters:function(U,h){if(U=U||this.getHost()){var o=this,R=o.s("layout.h"),S=o.s("layout.v");if(R||S){var i,x,B,n,v,D,G=new Y.Math.Vector2,T=U.getPosition(),Z=U.getAnchor(),w=U.getScaledSize(),W=o.getPosition(),$=o.getScaledSize();switch(G.set(W.x-T.x,W.y-T.y),G.rotateAround(null,-U.getRotation()),R){case"left":o._layoutHValue=G.x+Z.x*w.width;break;case"right":o._layoutHValue=-G.x+(1-Z.x)*w.width;break;case"center":o._layoutHValue=-G.x+(.5-Z.x)*w.width;break;case"leftright":case"scale":"scale"===R?i=-G.x+(.5-Z.x)*w.width:(x=o.getAnchor(),B=o.getRotation()-U.getRotation(),n=Math.cos(B),v=Math.sin(B),D=-Math.min(-x.x*n+x.y*v,-x.x*n-(1-x.y)*v,(1-x.x)*n+x.y*v,(1-x.x)*n-(1-x.y)*v),i=G.x-(D-Z.x)*w.width),"position"===h&&"object"==typeof o._layoutHValue?(o._layoutHValue[0]=w.width,o._layoutHValue[1]=i):o._layoutHValue=[w.width,i,w.width,$.width,$.height,D]}switch(S){case"top":o._layoutVValue=G.y+Z.y*w.height;break;case"bottom":o._layoutVValue=-G.y+(1-Z.y)*w.height;break;case"center":o._layoutVValue=-G.y+(.5-Z.y)*w.height;break;case"topbottom":case"scale":"scale"===S?i=-G.y+(.5-Z.y)*w.height:(B||(x=o.getAnchor(),B=o.getRotation()-U.getRotation(),n=Math.cos(B),v=Math.sin(B)),D=-Math.min(-x.x*v-x.y*n,-x.x*v+(1-x.y)*n,(1-x.x)*v-x.y*n,(1-x.x)*v+(1-x.y)*n),i=G.y-(D-Z.y)*w.height),"position"===h&&"object"==typeof o._layoutVValue?(o._layoutVValue[0]=w.height,o._layoutVValue[1]=i):o._layoutVValue=[w.height,i,w.height,$.width,$.height,D]}}}},getSerializableProperties:function(){var R=Pc.superClass.getSerializableProperties.call(this);
return oi(R,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),R}});var lc=Y.Edge=function(k,i){var l=this;ml(lc,l),l.setSource(k),l.setTarget(i)};uk("Edge",Ro,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Ik},_22Q:function(){return hk},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(K){if(K===this)return!1;if(wk(K))return!0;for(var B,I,d,E,J,h=[this],W=-1,r=0;r>W;)if(W++,B=h[W],I=B._44I)for(I=I.getArray(),E=0,J=I.length;J>E;E++)if(d=I[E],br(d)&&!(h.indexOf(d)>=0)){if(d===K)return!1;h.push(d),r++}return!0},setSource:function(E){var n=this;if(n._source!==E&&n.canSetSourceTarget(E)){var r=n._source;n._source=E,r&&r._16I(n),E&&E._2I(n),n._7I(),n.fp("source",r,E)}},setTarget:function(h){var P=this;if(P._target!==h&&P.canSetSourceTarget(h)){var v=P._target;P._target=h,v&&v._18I(P),h&&h._4I(P),P._7I(),P.fp("target",v,h)}},isLooped:function(){var a=this;return a._source===a._target&&wk(a._source)&&wk(a._target)},onPropertyChanged:function(){var F=this;F._49I&&F._49I.each(function(l){l.fp("agentChange",!0,!1)})},_7I:function(){var s,t=this,i=Bo(t);t._40I!==i&&(s=this._40I,s&&s._15I(t),t._40I=i,i&&i._1I(t),t.fp("sourceAgent",s,i),Or(s,t._41I),Or(i,t._41I));var E=Hf(t);t._41I!==E&&(s=t._41I,s&&s._17I(t),t._41I=E,E&&E._3I(t),t.fp("targetAgent",s,E),Or(s,t._40I),Or(E,t._40I))},_22I:function(b){this._52I=b,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var G=this;return G._52I&&G._52I.get(0)!==G&&!G.getStyle(Kn)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,n=A._52I;return n&&!A.getStyle(Kn)&&n.size()>1&&A===n.get(0)},toggle:function(){this.beginTransaction();var o=this._52I,T=!this.s(Kn);o&&o.size()>1&&(o.each(function(n){n.s(Kn,T)}),o.getSiblings().each(function(u){u!==o&&u.each(function(P){P.fp("edgeGroup",t,u)})})),this.endTransaction()},setStyle:function(E,m){(E===Sh||"edge.segments"===E)&&(m=vs(m)),lc.superClass.setStyle.call(this,E,m)},onStyleChanged:function(Q){lc.superClass.onStyleChanged.apply(this,arguments),rk[Q]&&Or(this._41I,this._40I)},getSerializableProperties:function(){var J=lc.superClass.getSerializableProperties.call(this);return oi(J,{source:1,target:1}),J}});var li=Y.Group=function(){ml(li,this)};uk("Group",Pc,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return hs},onChildAdded:function(){li.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){li.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var f=this;if(!f._54I&&!xb){var I=f.getChildrenRect();I&&(f._53I=1,f.p(Tf(f.s("group.position"),I,f.getSize())),delete f._53I)}},getChildrenRect:function(){var a,Z=this;return Z.eachChild(function(S){wk(S)&&(a=me(a,Z.getChildRect(S)))}),a},getChildRect:function(P){var T;return wk(P)&&P.s(Lg)&&(Ae(P)&&P.isExpanded()&&P.eachChild(function(G){T=me(T,P.getChildRect(G))}),!T&&P.getRect&&(T=P.getRect())),T},setPosition:function(u,W){var v=this;if(!v._54I){var K;K=2===arguments.length?{x:u,y:W}:u,xb||v._53I||(v._54I=1,wm(v._children,K.x-v._position.x,K.y-v._position.y),delete v._54I),li.superClass.setPosition.call(this,K)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(J){var q=this;if(q._57O!==J){var i=q._57O;q._57O=J,q.fp("expanded",i,q._57O),q._fireInvalidateDeep(),q._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(n){Ae(n)?n._fireInvalidateDeep():n.iv()})},_8I:function(){li.superClass._8I.call(this),this.eachChild(function(f){wk(f)&&f._8I()})},onStyleChanged:function(e){li.superClass.onStyleChanged.apply(this,arguments),"group.position"===e&&this._81I()},getSerializableProperties:function(){var L=li.superClass.getSerializableProperties.call(this);return L.expanded=1,L}});var aq=Y.Block=function(){ml(aq,this)};uk("Block",Pc,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return fc},onChildAdded:function(){aq.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){aq.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var Z=this;if(!xb&&!Z._updatingToChildren&&Z._syncSize&&!Z._freezeSyncFromChildren){var O,g,S,H,Q,U=[],f=Z.getRotation(),o=1/0,D=-1/0;if(Z.eachChild(function(v){if(wk(v)){U.push.apply(U,v.getCorners());var B=v.getTall()*v.getScaleTall(),r=v.getElevation(),W=v.getAnchorElevation(),f=r+B*(1-W),P=r-B*W;o=a(o,f,P),D=q(D,f,P)}}),U.length){Z._updatingFromChildren=1;var i=I(-f),Y=d(-f),V=1/0,L=-1/0,e=1/0,h=-1/0;for(H=0,Q=U.length;Q>H;H++)S=U[H],O=S.x,g=S.y,S.x=i*O-Y*g,S.y=Y*O+i*g,V=a(V,S.x),L=q(L,S.x),e=a(e,S.y),h=q(h,S.y);var K=Z.getScale(),w=Z.getScaleTall();Z.setSize(c((L-V)/K.x),c((h-e)/K.y)),Z.setTall(c((D-o)/w));var x;K.x<0&&(x=V,V=L,L=x),K.y<0&&(x=e,e=h,h=x),i=I(f),Y=d(f);var m=Z.getAnchor();O=V+(L-V)*m.x,g=e+(h-e)*m.y,Z.setPosition(i*O-Y*g,Y*O+i*g);var n=Z.getAnchorElevation();Z.setElevation(o+(D-o)*(w>0?n:1-n)),delete Z._updatingFromChildren}}},setPosition:function(R,e){var g=this;if(!g._updatingToChildren){var Q;Q=2===arguments.length?{x:R,y:e}:R,xb||g._updatingFromChildren||(g._updatingToChildren=1,wm(g._children,Q.x-g._position.x,Q.y-g._position.y),delete g._updatingToChildren),aq.superClass.setPosition.call(this,Q)}},setWidth:function(o){return this.setSize(o,this.getHeight())},setHeight:function(W){return this.setSize(this.getWidth(),W)},setSize:function(f,x){1>f&&(f=1),1>x&&(x=1);var z=this;if(!z._updatingToChildren){2!==arguments.length&&(x=f.height,f=f.width);var F=z.getWidth(),L=z.getHeight();if(f!==F&&aq.superClass.setWidth.call(z,f),x!==L&&aq.superClass.setHeight.call(z,x),!xb&&!z._updatingFromChildren){z._updatingToChildren=1;var T=f/F,e=x/L;z._adjustChildScaleOrSize(T,e,"size"),delete z._updatingToChildren,z.updateFromChildren()}}},_adjustChildScaleOrSize:function(j,F,T){var u=this;if(u._syncSize){var V=u.getPosition(),$=u.getRotation();u.getScale(),u.eachChild(function(Z){if(wk(Z)){var A=Z.getPosition(),S=Z.getRotation(),k=Z.getWidth(),E=Z.getHeight(),R=Z.getScale(),e=R.x*k,Q=R.y*E,X=new Gm(S,A.x,A.y,e,Q);X.translate(-V.x,-V.y),X.rotate(-$),S=r(X.b*Math.sign(e),X.a*Math.sign(e)),X.scale(j,F);var n,h,K,U=I(S);if(Math.abs(U)<.001?(n=d(S),h=X.b/n,K=-X.c/n):(h=X.a/U,K=X.d/U),"scale"===T)Z.setScale(h/k,K/E);else if("size"===T){var p=h/R.x,z=K/R.y;Z.setScale(Kq(h)*Math.abs(R.x),Kq(K)*Math.abs(R.y)),Z instanceof Y.Shape?(Z.setWidthForce(Math.max(Math.abs(p),1e-5)),Z.setHeightForce(Math.max(Math.abs(z),1e-5))):Z.setSize(Math.max(.01,Math.abs(p)),Math.max(.01,Math.abs(z)))}X.rotate($),X.translate(V.x,V.y),Z.setPosition(X.tx,X.ty)}})}},_calcChangeFactor:function(h,P,_,E){var k,C,M,j;return k=c(h),C=c(_),M=k>C?k/C:C/k,k=c(P),C=c(E),j=k>C?k/C:C/k,q(M,j)},setElevation:function(S){var p=this;if(!p._updatingToChildren){var P=p.getElevation(),M=S-P;0!==M&&(aq.superClass.setElevation.apply(p,arguments),xb||p._updatingFromChildren||!p._syncSize||(p._updatingToChildren=1,wm(p._children,0,M,0),delete p._updatingToChildren))}},setTall:function(M){var S=this;if(!S._updatingToChildren){1>M&&(M=1);var N=S.getTall();if(M!==N&&aq.superClass.setTall.call(S,M),!xb&&!S._updatingFromChildren){S._updatingToChildren=1;var s=M/N;S._adjustChildTallOrScale(s,"size"),delete S._updatingToChildren,this.updateFromChildren()}}},setScaleTall:function(O){var B=this;if(!B._updatingToChildren){var e=B.getScaleTall();if(c(O)<.01&&(O=.01*(Kq(O)||Kq(e))),aq.superClass.setScaleTall.call(B,O),!xb&&!B._updatingFromChildren){B._updatingToChildren=1;var s=O/e;B._adjustChildTallOrScale(s,"size"),delete B._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(F,W){var b=this;if(b._syncSize){var u=b.getElevation();b.eachChild(function(p){if(wk(p))if("size"===W){var Y=p.getTall();0>F&&p.setScaleTall(-1*p.getScaleTall()),p.setTall(Math.max(.01,Math.abs(Y*F))),p.setElevation(u+(p.getElevation()-u)*F)}else{var r=p.getScaleTall();p.setScaleTall(r*F)}})}},setAnchor:function(){var o=this;if(!o._updatingToChildren){var w=o.getAnchor();if(aq.superClass.setAnchor.apply(o,arguments),!xb&&!o._updatingFromChildren&&o._syncSize){o._updatingToChildren=1;var Z=o.getAnchor();o.getPosition();var z=o.getSize(),b=o.getScale(),x=o.getRotation(),c=-z.width*b.x*(w.x-Z.x),G=-z.height*b.y*(w.y-Z.y),L=d(x),Y=I(x),e=Y*c-L*G,k=L*c+Y*G;o.eachChild(function(O){if(wk(O)){var j=O.getPosition();O.setPosition(j.x-e,j.y-k)}}),delete o._updatingToChildren}}},setAnchorElevation:function(){var h=this;if(!h._updatingToChildren){var e=h.getAnchorElevation();if(aq.superClass.setAnchorElevation.apply(h,arguments),!xb&&!h._updatingFromChildren&&h._syncSize){h._updatingToChildren=1;var A=h.getAnchorElevation(),T=h.getTall(),j=h.getScaleTall(),i=-T*j*(e-A);h.eachChild(function(z){if(wk(z)){var g=z.getElevation();z.setElevation(g-i)}}),delete h._updatingToChildren}}},setRotation:function(A){var P=this;if(!P._updatingToChildren){var y=P.getRotation();if(aq.superClass.setRotation.apply(P,arguments),!xb&&!P._updatingFromChildren){P._updatingToChildren=1;var m=P.getPosition(),f=A-y;P.eachChild(function(s){if(wk(s)){var o=s.getMatrix();o.translate(-m.x,-m.y),o.rotate(f),o.translate(m.x,m.y);var D=Math.sign(s.getScale().x);s.setRotation(r(o.b*D,o.a*D)),s.setPosition(o.tx,o.ty)}}),delete P._updatingToChildren}}},setScale:function(n,P){var k=this;if(!k._updatingToChildren){null==P&&(P=n.y,n=n.x);var s=k.getScale();if(c(n)<.01&&(n=.01*(Kq(n)||Kq(s.x))),c(P)<.01&&(P=.01*(Kq(P)||Kq(s.y))),aq.superClass.setScale.call(k,n,P),!xb&&!k._updatingFromChildren){k._updatingToChildren=1;var W=n/s.x,H=P/s.y;k._adjustChildScaleOrSize(W,H,"size"),delete k._updatingToChildren,k.updateFromChildren()}}},getSerializableProperties:function(){var R=aq.superClass.getSerializableProperties.call(this);return R.clickThroughEnabled=1,R.syncSize=1,R}});var qb=Y.Grid=function(){ml(Y.Grid,this)};uk("Grid",Pc,{IRotatable:!1,_icon:"grid_icon",_image:t,getUIClass:function(){return Je},setRotation:function(){},getCellRect:function(G,C){var I=this,M=I.s("grid.row.count"),h=I.s("grid.column.count");if(0>=M||0>=h||0>G||G>=M||0>C||C>=h)return t;var f,z,s,K=I.getRect(),w=I.s("grid.row.percents"),O=I.s("grid.column.percents");if(ll(K,I,"grid.border",-1),w&&w._as&&(w=w._as),O&&O._as&&(O=O._as),w&&w.length===M){for(s=0,f=0;G>f;f++)s+=K.height*w[f];K.y+=s,K.height=K.height*w[G]}else K.height=K.height/M,K.y+=K.height*G;if(O&&O.length===h){for(z=0,f=0;C>f;f++)z+=K.width*O[f];K.x+=z,K.width=K.width*O[C]}else K.width=K.width/h,K.x+=K.width*C;return Wn(K,-I.s("grid.gap")),K}});var tn=Y.Text=function(){ml(tn,this),this.setSize(100,50),this.s("text","TEXT")};uk("Text",Pc,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ci},setWidth:function(J){J||(J=.001),tn.superClass.setWidth.call(this,J)},setHeight:function(c){c||(c=.001),tn.superClass.setHeight.call(this,c)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Vb("__text__",{width:{value:100,isSafeFunc:!0,func:function(d){return d?d._width:100}},height:{value:50,isSafeFunc:!0,func:function(q){return q?q._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Tl=Y.Shape=function(){ml(Tl,this),this._59O=new ls};Tl.__de__=nd,uk("Shape",Pc,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return xp},_22Q:function(){return xh},getLength:function(I){return ji(hr(this._59O,this._58O,I,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var O=this._58O;return O?new ls(O._as.slice(0)):O},setSegments:function(z){var U=this._58O;z=z?Cl(z)?new ls(z.slice(0)):new ls(z._as.slice(0)):null,(U&&z&&U._as.join(",")!==z._as.join(",")||U!==z)&&(this._58O=z,this.fp("segments",U,z))},getPoints:function(){return this._59O},toPoints:function(){var t=this._59O;return new ls(t._as.slice(0))},getPointsMatrix2d:function(){var y=this,e=new Qr.Matrix2d,V=y.getPosition(),R=y.getScale(),C=y.getRotation();return e.translate(-V.x,-V.y).scale(R.x,R.y).rotate(C).translate(V.x,V.y),e},getPointsMatrix3d:function(){return function(){var Z=this,n=new Qr.Matrix4,h=n.getElements(),f=Z.p3();vq(h,f),vm(h,Z.getFinalRotation3d(),Z.getRotationMode());var e=Z.getScale3d(),Y=Z._dynamicScale3d;return Y&&(e[0]*=Y[0],e[1]*=Y[1],e[2]*=Y[2]),Zd(h,e),vq(h,en(f)),n}}(),setPoints:function(I,P){var R=this,k=R._59O;I=I?Cl(I)?new ls(I.slice(0)):new ls(I._as.slice(0)):new ls;var Y,X,_,F,D,E;P&&(Y=R.getPosition(),E=new Gm(R.getRotation(),0,0,R.getScale().x,R.getScale().y)),(k&&I&&k._as.join(",")!==I._as.join(",")||k!==I)&&(R._59O=I,R.fs(),R.fp("points",k,I)),P&&(X=R.getPosition(),_=X.x-Y.x,F=X.y-Y.y,D=E.tf(_,F),R.setPosition(X.x-_+D.x,X.y-F+D.y))},addPoint:function(n,Y,m){var x=this.toPoints();x.add(n,Y),this.setPoints(x,m)},setPoint:function(E,m,Q){var t=this.toPoints();t.set(E,m),this.setPoints(t,Q)},removePointAt:function(D){var N=this.toPoints();N.removeAt(D),this.setPoints(N)},setWidthForce:function(l){var W=this;if(!W._55I&&!xb&&W.getWidth()){W._55I=1;var K=W._position.x,v=l/W.getWidth(),T=W.toPoints(),F=new ls;1!==v&&(T.each(function(S){F.add({x:(S.x-K)*v+K,y:S.y,e:S.e})}),W.setPoints(F),ts(W,[v,0,0,1,K*(1-v),0]),W.fs()),delete W._55I}Tl.superClass.setWidth.call(W,l)},setWidth:function(v){return this.setWidthForce(1>v?1:v)},setHeightForce:function(W){var g=this;if(!g._55I&&!xb&&g.getHeight()){g._55I=1;var M=g._position.y,Z=W/g.getHeight(),q=g.toPoints(),c=new ls;1!==Z&&(q.each(function(x){c.add({x:x.x,y:(x.y-M)*Z+M,e:x.e})}),g.setPoints(c),ts(g,[1,0,0,Z,0,M*(1-Z)]),g.fs()),delete g._55I}Tl.superClass.setHeight.call(g,W)},setHeight:function(b){return this.setHeightForce(1>b?1:b)},setAnchorElevation:function(x){var C=this;C._55I=!0;var G=C._updatingAnchor3d,d=!xb&&!G;if(d){var D,V=x,Y=C.getAnchorElevation(),a=C.getTall();D=a*(Y-V),0!==D&&C.shiftPointsElevation(D)}var J=Tl.superClass.setAnchorElevation.apply(C,arguments);return G||delete C._55I,J},getShapeElevation:function(){var M=this,x=M._54O;return x-(M.getTall()||0)*(M._anchorElevation-.5)},setAnchor3d:function(S,u,V,_){var F,t=this;"number"==typeof S?F={x:S,y:u,z:V}:(F=S.length?{x:S[0],y:S[1],z:S[2]}:S,_=u),t._55I=!0,t._updatingAnchor3d=!0;var T=t.getDataModel();if(T&&T.beginTransaction(),!xb){var s=t.getAnchor3d(),e=t.getSize(),N=t.getTall(),r=e.width*(s.x-F.x),U=e.height*(s.z-F.z),n=N*(s.y-F.y);_||t.shiftPoints(r,U,n);var y=t.p3()}var q=Tl.superClass.setAnchor3d.apply(t,arguments);if(!xb&&_){var i=t.p3();t.shiftPoints(i[0]-y[0]+r,i[2]-y[2]+U,i[1]-y[1]+n)}return T&&T.endTransaction(),delete t._updatingAnchor3d,delete t._55I,q},setAnchor:function(w,u,_){var y=this;y._55I=!0;var N=y._updatingAnchor3d,H=!xb&&!N;if(H){var S,t,P;"number"==typeof w?P={x:w,y:u}:(P=w.length?{x:w[0],y:w[1]}:w,_=u);var o=y.getAnchor(),c=y.getSize();S=c.width*(o.x-P.x),t=c.height*(o.y-P.y),_||y.shiftPoints(S,t);var J=y.getPosition()}var q=Tl.superClass.setAnchor.apply(y,arguments);if(H){var v=y.getPosition();_&&y.shiftPoints(v.x-J.x+S,v.y-J.y+t)}return N||delete y._55I,q},shiftPoints:function(C,B,S){if(C||B||S){var J=this,R=J.getElevation()||0,m=J.toPoints(),f=new ls;m.each(function(n){var N=n.e;S&&(N=(N==t?R:N)+S),f.add({x:n.x+C,y:n.y+B,e:N})}),J.setPoints(f),J.fs()}},shiftPointsElevation:function(V){return this.shiftPoints(0,0,V)},setPosition:function(Z,G){var P,O=this;if(!O._28Q){if(O._28Q=1,!O._55I&&!xb){P=2===arguments.length?{x:Z,y:G}:Z;var t=P.x-O._position.x,g=P.y-O._position.y;if(0===t&&0===g)return delete O._28Q,void 0;O._55I=1,O.shiftPoints(t,g),ts(O,[1,0,0,1,t,g]),delete O._55I}Tl.superClass.setPosition.apply(O,arguments),delete O._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var z=this;if(2!==z._59O.size())return!1;var V=z._58O;return V?2===V.size()&&1===V.get(0)&&2===V.get(1)?!0:!1:!0},fireShapeChange:function(){var O=this;if(!O._55I&&!xb){var a=Qm(O._59O);a&&(O._55I=1,O.setRect(a),delete O._55I)}O.fp(Fc,!1,!0)},getSerializableProperties:function(){var h=Tl.superClass.getSerializableProperties.call(this);return h.segments=1,h.points=1,h.thickness=1,h.closePath=1,h}});var fq=Y.Polyline=function(){ml(fq,this),this.s({"shape.background":null,"shape.border.width":2})};uk("Polyline",Tl,{_icon:"polyline_icon",_22Q:function(){return og},getUIClass:function(){return Rb},setClosePath:function(){},setTall:function(c){var b=this,K=b.getDataModel();if(K&&K.beginTransaction(),!b._55I&&!b._24Q&&!xb&&b.getTall()){b._24Q=1;var f=b._54O,X=c/b.getTall();if(1!==X){var U=b.toPoints(),I=new ls;U.each(function(s){I.add({x:s.x,y:s.y,e:s.e==t?s.e:(s.e-f)*X+f})}),b.setPoints(I),b.fs()}delete b._24Q}fq.superClass.setTall.call(b,c),K&&K.endTransaction()},setElevation:function(e){var X=this,x=X.getDataModel();if(x&&x.beginTransaction(),!X._55I&&!X._24Q&&!xb){X._24Q=1;var O=e-X._54O;0!==O&&X.shiftPointsElevation(O),delete X._24Q}fq.superClass.setElevation.apply(X,arguments),x&&x.endTransaction()},fireShapeChange:function(){var C=this,d=C._59O;if(!C._55I&&!C._24Q&&!xb){var H=d.size();if(H){var l=1,m=d.get(0),j=C._54O;m.e==t&&(m.e=j);for(var g=m.e,E=0;H>l;l++){m=d.get(l),m.e==t&&(m.e=j);var M=a(g,m.e),S=q(g+E,m.e);g=M,E=S-M}C._24Q=1,C.setTall(E),C.setElevation(g+E*C._anchorElevation),delete C._24Q}}fq.superClass.fireShapeChange.apply(C,arguments)}});var Nn=Y.SubGraph=function(){ml(Nn,this)};uk("SubGraph",Pc,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Nn.superClass._8I.call(this),this.eachChild(function(B){wk(B)&&B._8I()})}}),Q.loadingRefGraph=0;var Ac=Y.RefGraph=function(){ml(Ac,this)};uk("RefGraph",aq,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(N){var L=this._ref;this._ref=N,this.fp("ref",L,N),this.updateRef()},_21I:function(){Ac.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var B=this;if(Q.loadingRefGraph++,B.clearChildrenFromDataModel(),Q.loadingRefGraph--,B._ref&&B._dataModel){B._xhrLoadHandler&&(B._xhrLoadHandler.cancel=!0);var g=xb,u=B._xhrLoadHandler=function(U){if(U&&B._dataModel){Q.loadingRefGraph++;var E=B._pendingUpdateInfo={needToRestore:g};g&&(E.position=B.p(),E.width=B.getWidth(),E.height=B.getHeight(),E.rotation=B.getRotation(),E.anchor=B.getAnchor(),E.scale=B.getScale()),B.p(0,0),B.setAnchor(.5,.5),B.setRotation(0),B.setScale(1,1);var K=Q.parse(U),x=B._dataModel.deserialize(K,B,{justDatas:!0});x.each(function(p){p._refGraph=B}),B.checkPendingUpdateInfo(),Q.loadingRefGraph--,Q.handleRefGraphLoaded(B,x,K)}};u.xhrLoadCalled=!1,Q.load(B._ref,function(x){u.cancel||(u.xhrLoadCalled?u(x):zs(function(){u(x)}))}),u.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var S=this,c=S._pendingUpdateInfo;if(!c)return S.onPendingUpdated&&(Q.loadingRefGraph++,S.onPendingUpdated(),Q.loadingRefGraph--),void 0;var u=!0;this.eachChild(function(W){(W._pendingCheckImageJSON||W._pendingUpdateInfo)&&(u=!1)}),u&&(Q.loadingRefGraph++,S._pendingUpdateInfo=null,S.updateFromChildren(),c.needToRestore&&(S.setSize(c.width,c.height),S.setAnchor(c.anchor),S.setRotation(c.rotation),S.setScale(c.scale),S.p(c.position)),this.getParent()instanceof Ac&&this.getParent().checkPendingUpdateInfo(),S.onPendingUpdated&&S.onPendingUpdated(),Q.loadingRefGraph--)},getSerializableProperties:function(){var M=Ac.superClass.getSerializableProperties.call(this);return M.ref=1,M}}),Y.EdgeGroup=function(p,C){this._70O=p,this._siblings=C;for(var E,N,z=0,F=p.size(),A=K[Kn];F>z;z++)if(E=p.get(z).getStyle(Kn,!1),E!=t){A=E;break}A==t&&(A=!0);var h=Q.edgeGroupAgentFunc;for(h&&(N=h(p),N&&N!==p.get(0)&&(p.remove(N),p.add(N,0))),z=0;F>z;z++)p.get(z).s(Kn,A)},uk("EdgeGroup",u,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(t){return this._70O.get(t)},indexOf:function(h){return this._70O.indexOf(h)},each:function(_,C){this._70O.each(_,C)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(W,f){this._siblings.each(function(K){K._70O.each(W,f)})}});var Oj=function(y,B,p){var H=ac[y]={type:y,action:B};if(p)for(var t in p)H[t]=p[t]};oi(Q,{setConnectAction:Oj,getConnectAction:function(g,y){if(!y){if(!g)return null;y=g.getCurrentConnectActionType()}return ac[y]},doConnectAction:function(x,d,O,y){y=y||x.getCurrentConnectActionType();var j=ac[y];if(!j)return!1;var t=j.action;return t?(d instanceof ym.Group?x.sm().getSelection().each(function(E){t.call(null,x,E,O)}):t.call(null,x,d,O),!0):!1},doDeleteConnectionAction:function(H,d,A){A=A||H.getCurrentConnectActionType();var m=ac[A];if(!m||!m.delete)return!1;var s=m.delete.action;return s?(d instanceof ym.Group?H.sm().getSelection().each(function(t){s.call(null,H,t)}):s.call(null,H,d),!0):!1}});var Xh=Y.JSONSerializer=function(v,E){this.dm=this._dataModel=v,this._hierarchical=Q.forceHierarchicalSerialization?!0:E==t?v.isHierarchicalRendering():E};uk("JSONSerializer",u,{ms_ac:["hierarchical"],serialize:function(H){return Q.stringify(this.toJSON(),H)},toJSON:function(){var c=this,K=c.dm,X=K.getRoots(),F=c.json={v:Q.getVersion(),p:{},a:{},d:[]},r=K.getSerializableAttrs();K.getInit()&&(F.init=K.getInit()),K.getName()&&(F.p.name=K.getName()),K.getBackground()&&(F.p.background=K.getBackground()),K.getLayers()&&(F.p.layers=K.getLayers()),K.getEnvmap()&&(F.p.envmap=K.getEnvmap()),F.p.autoAdjustIndex=K.isAutoAdjustIndex(),F.p.hierarchicalRendering=K.isHierarchicalRendering();for(var N in r){var Y=K.a(N);Y!==w&&c[Am](N,Y,F.a)}return wf(F.a)&&delete F.a,c._hierarchical?X.each(c.serializeData,this):K.each(function(j){c.serializeData(j)}),K.fireSerializeEvent({type:"serialize",json:F}),K.getPostProcessingData()&&(F.p.postProcessingData=K.getPostProcessingData()),F},isSerializable:function(){return!0},getProperties:function(D){return D.getSerializableProperties()},getStyles:function(L){return L.getSerializableStyles()},getAttrs:function(o){return o.getSerializableAttrs()},serializeData:function(j){var O=this;if(O.isSerializable(j)&&!j._refGraph){var H,L,N,m,f=Nb(j.getClassName())||j.getClass(),u=new f,P={c:j.getClassName(),i:j.getId(),p:{},s:{},a:{}};O.json.d.push(P),H=O.getProperties(j);for(L in H)if(/^_/.test(L)){if(N=j[L],!("_width"!==L&&"_height"!==L||N!=t&&-1!==N)){var w;((j.s("layout.h")||j.s("layout.v"))&&j.getHost()||j instanceof Y.Node&&(w=j.getParent())&&w instanceof Y.Block||j.s("fullscreen"))&&(N=j[L]="_width"===L?j.getWidth():j.getHeight())}N!==u[L]&&O[Am](L.substr(1),N,P.p)}else m=Zl(L),j[m]&&(N=j[m](),N!==u[m]()&&O[Am](L,N,P.p));H=O.getStyles(j);for(L in H)N=j.s(L),N!==u.s(L)&&O[Am](L,N,P.s);H=O.getAttrs(j);for(L in H)N=j.a(L),N!==u.a(L)&&O[Am](L,N,P.a);wf(P.p)&&delete P.p,wf(P.s)&&delete P.s,wf(P.a)&&delete P.a}O._hierarchical&&j.getChildren().each(O.serializeData,O)},serializeValue:function(s,u,h){Pr(u)?u={__a:u._as}:u instanceof Ro&&(u={__i:u.getId()}),h[s]=u},deserialize:function(v,N,W){var m=this;return vh(v)&&/.json$/.test(v)?(Q.xhrLoad(v,function(u){m.deserializeImpl(u,N,W)}),void 0):m.deserializeImpl(v,N,W)},deserializeImpl:function(H,$,y){var N=this,F=N.dm;F.setDeserializing(!0),y=mi(y)?{setId:y}:Jm(y)?{finishFunc:y}:y||{},H=N.json=vh(H)?Q.parse(H):H,!y.justDatas&&H.a&&H.a.onPreDeserialize&&!y.disableOnPreDeserialize&&H.a.onPreDeserialize(H,F,y.view),F.beginTransaction(),xb++,N._82I={};var s=new ls,C=new ls,U=0,h=H.d.length;if(y.justDatas||(!y.disableInit&&Jm(H.init)&&H.init(F),F.setInit(H.init)),!y.justDatas){for(var v in H.a)F.a(v,N[Nj](H.a[v]));for(var V in H.p)F[Wd(V)](H.p[V])}for(;h>U;U++){var R=H.d[U],u=Nb(R.c),g=new u,f=R.i;y.setId&&f!=t&&(g._id=f),N._82I[f]=g,s.add(g),C.add(R)}for(U=0;h>U;U++)N.deserializeData(s.get(U),C.get(U));return s.each(function(_){$&&!_.getParent()&&_.setParent($),F.add(_)}),y.__innerHandler__&&y.__innerHandler__(H,F,y.view,s),F.fireSerializeEvent({type:"deserialize",json:H}),xb--,F.endTransaction(),!y.justDatas&&H.a&&H.a.onPostDeserialize&&!y.disableOnPostDeserialize&&H.a.onPostDeserialize(H,F,y.view,s),y.finishFunc&&y.finishFunc(H,F,y.view,s),F.setDeserializing(!1),s},deserializeData:function(K,T){for(var W in T.p)K[Wd(W)](this[Nj](T.p[W]));for(W in T.s)K.s(W,this[Nj](T.s[W]));for(W in T.a)K.a(W,this[Nj](T.a[W]))},deserializeValue:function(E){if(ao(E)){var Y=E.__i;if(Y!=t)return this._82I[Y];if(Y=E.__a,Cl(Y))return new ls(Y)}return E}}),oi(Jg,{serialize:function(N,X){return new Xh(this,X).serialize(N)},toJSON:function(c){return new Xh(this,c).toJSON()},deserialize:function(v,h,A){return new Xh(this).deserialize(v,h,A)}});var Co=Y.OverlappingBox=function(O){this.gv=O,this.boxes={}};uk("OverlappingBox",u,{clear:function(){var c,f,V=this.boxes;for(c in V)f=V[c],f.length=0},isOverlapping:function(p,I){var s,P,h=this,U=h.boxes,S=U[p];S?(s=S.rects,P=S.length):S=U[p]={rects:s=[],length:P=0};var b,X,I;for(b=0;P>b;b++)if(X=s[b],X.x<I.x+I.w&&X.x+X.w>I.x&&X.y<I.y+I.h&&X.h+X.y>I.y)return!0;return s.length<=P?(s.push(I),S.length++):s[S.length++]=I,!1}}),oi(Q,{fetch:function(D,Z){var T="GET",_=!1,k=null,m="";Z&&(T=Z.method||"GET",_=Z.sync,m=Z.url,k=Z.data||null),D.open(T,m,!_),Z.responseType?D.responseType=Z.responseType:Z.overrideMimeType&&D.overrideMimeType&&D.overrideMimeType(Z.overrideMimeType),D.send(k)},convertImageSrc:function(u,e){e&&"function"==typeof e||(e=function(){}),e(u)}});var qh=Y.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};uk("Request",u,{_responseType:null,_overrideMimeType:"text/plain",send:function(y){var b=this._xhr,G=this.onload,a=this.onerror;this.getResponseType()?y.responseType=this.getResponseType():this.getOverrideMimeType()&&(y.overrideMimeType=this.getOverrideMimeType()),b.onload=G,b.onerror=a,Q.fetch(b,y)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(l){this._responseType=l},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(N){this._overrideMimeType=N},getResponseText:function(){var J=this._xhr;return J.response||J.responseText}}),Uh.GraphView=function(O){var p=this;p._24I={},p._34I=new ls,p._25I={},p._56I={},p._view=yo(1,p),p._canvas=Yh(p._view),p.dm(O?O:new Jg),this._coreInteractor=new Rn(this),p.setEditable(!1),p.setScrollBarVisible(Q.graphViewScrollBarVisible),p._initView()},Xg("GraphView",u,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[sc,us,Qg,Ml,"resettable","editInteractor",Mm,"zoomable","pannable","rectSelectable","autoScrollZone",Vr,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:Q.graphViewZoomable,_resettable:Q.graphViewResettable,_pannable:Q.graphViewPannable,_rectSelectable:Q.graphViewRectSelectable,_autoScrollZone:Q.graphViewAutoScrollZone,_rectSelectBackground:Q.graphViewRectSelectBackground,_rectSelectBorderColor:Q.graphViewRectSelectBorderColor,_editPointSize:Q.graphViewEditPointSize,_editPointBorderColor:Q.graphViewEditPointBorderColor,_editPointBackground:Q.graphViewEditPointBackground,_scrollBarColor:ih,_scrollBarSize:Wi,_autoHideScrollBar:Qe,_autoMakeVisible:Pq,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(K){this._dataModel.setLayers(K)},setEditable:function(n){var d=this,A=d.__interactorMap__;if(!A){var V=Uh.XEditInteractor;A=d.__interactorMap__={scrollBar:new lf(d),select:new Rc(d),edit:V?new V(d):new qq(d),text:new yl(d),move:new pb(d),"default":new Xd(d),touch:new jh(d,{editable:!1})}}n?(d._uieditable=!0,d.setInteractors([A.scrollBar,A.select,A.edit,A.text,A.move,A.default,A.touch])):(d._uieditable=!1,d.setInteractors([A.scrollBar,A.select,A.move,A.default,A.touch]))},getCanvas:function(){return this._canvas},_33I:function(u){var S=u.getUIClass();return S?new S(this,u):t},getDataUI:function(q){var c=this,L=c._25I[q._id];return L===w&&(L=c._33I(q),c._25I[q._id]=L),L},getNodeRect:function(b){return Q.getNodeRect(this,b)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(N){var w=this.getDataUI(N);return w?(w._79o(),w._78o):null},getEdgeSourcePosition:function(b){var h=this,u=h.getDataUI(b),I=u.s,A=u._data._40I;return Nk(h,A,I("edge.source.position"),I("edge.source.offset.x"),I("edge.source.offset.y"),I("edge.source.anchor.x"),I("edge.source.anchor.y"))},getEdgeTargetPosition:function(s){var r=this,$=r.getDataUI(s),L=$.s,d=$._data._41I;return Nk(r,d,L("edge.target.position"),L("edge.target.offset.x"),L("edge.target.offset.y"),L("edge.target.anchor.x"),L("edge.target.anchor.y"))},invalidateAll:function(J){var n=this;if(J){for(var a in n._25I){var F=n._25I[a];F&&F.dispose()}n._25I={},n._56I={},n._24I={},n._34I.clear(),n.redraw()}else n.dm().each(function(Y){n.invalidateData(Y)})},invalidateSelection:function(){var C=this;C.sm().each(function(r){C.invalidateData(r)})},invalidateData:function(u){var o=this;o._24I[u._id]=u,o._21Q(u),o.iv()},_21Q:function(n){var B=this,k=B._24I;if(br(n)&&dk[n.s(mp)]){var N=n.getSourceAgent();N&&N.getAgentEdges().each(function(n){k[n._id]=n}),N=n.getTargetAgent(),N&&N.getAgentEdges().each(function(h){k[h._id]=h}),B.iv()}},redraw:function(q){var a=this;a._32I||(q?a._34I.add(q):(a._32I=1,a._34I.clear()),a.iv())},each:function(b,S){var y,K,I,u=0,R=this.getLayers(),s=this._dataModel,k=s._datas._as,z=k.length;if(R){for(var V=R.length;V>u;u++)if(I=R[u],ao(I)&&(I=I.name),s.isHierarchicalRendering()){var L=function(h){return h._layer===I?S?b.call(S,h):b(h):void 0};if(this._dataModel.eachByHierarchical(L)===!1)return}else for(var P=0;z>P;P++)if(y=k[P],y._layer===I&&(K=S?b.call(S,y):b(y),K===!1))return}else if(s.isHierarchicalRendering())this._dataModel.eachByHierarchical(b,null,S);else for(;z>u;u++)if(y=k[u],K=S?b.call(S,y):b(y),K===!1)return},reverseEach:function(I,C){var n,N,z,l,X=this._dataModel,x=X._layers,V=X._datas._as,E=V.length;if(x){for(n=x.length-1;n>=0;n--)if(l=x[n],ao(l)&&(l=l.name),X.isHierarchicalRendering()){var P=function(Q){return Q._layer===l?C?I.call(C,Q):I(Q):void 0};if(X.reverseEachByHierarchical(P)===!1)return}else for(var f=E-1;f>=0;f--)if(N=V[f],N._layer===l&&(z=C?I.call(C,N):I(N),z===!1))return}else if(X.isHierarchicalRendering())X.reverseEachByHierarchical(I,null,C);else for(n=E-1;n>=0;n--)if(N=V[n],z=C?I.call(C,N):I(N),z===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var f=this,R=f._84I;if(!R){var V=this.dm().a("width"),Q=this.dm().a("height");V>0&&Q>0?f._84I={x:0,y:0,width:V,height:Q}:(f.each(function(X){f.isVisible(X)&&(R=me(R,f.getDataUIBounds(X)))}),f._84I=R?R:xq)}return f._84I},getScrollRect:function(){return me(this.getContentRect(),this._29I)},makeCenter:function(f,V,z){var $=this;if(!$.getWidth()||!$.getHeight())return z||zs($.makeCenter,$,[f,V,!0],500),void 0;$.makeVisible(f),$.validate();var K=$.getDataUIBounds(f);if(K){var j=$.getWidth(),n=$.getHeight(),e=K.x+K.width/2,H=K.y+K.height/2,u=-e*$._zoom+j/2,M=-H*$._zoom+n/2;$.setTranslate(u,M,V)}},fitData:function(e,z,y,I,f){var Z=this;if(!Z.getWidth()||!Z.getHeight())return f||zs(Z.fitData,Z,[e,z,y,I,!0],500),void 0;var v=function(){Z.makeVisible(e),Z.validate();var P=Z.getDataUIBounds(e);
P&&(P=kr(P),Wn(P,y==t?20:y),Z.fitRect(P,z,I))};z?Q.callWhenLoaded(v):v()},fitContent:function(I,B,L,w){var D=this;if(!D.getWidth()||!D.getHeight())return w||zs(D.fitContent,D,[I,B,L,!0],500),void 0;var c=function(){D.validate();var i=kr(D.getContentRect());Wn(i,B==t?20:B),D.fitRect(i,I,L)};I?Q.callWhenLoaded(c):c()},fitRect:function(I,M,s){var r=this,L=r.getWidth(),d=r.getHeight(),K=I.x+I.width/2,v=I.y+I.height/2,z=a(L/I.width,d/I.height),F=r._zoom,k=-K*F+L/2,l=-v*F+d/2;0===z||isNaN(z)||(s&&(z=a(1,z)),M?(r._65I&&(delete r._65I.finishFunc,r._65I.stop(!0)),r._14o&&r._14o.stop(!0),r.setTranslate(k,l,{finishFunc:function(){r.setZoom(z,M)}})):(r.setTranslate(k,l),r.setZoom(z)))},fitSelection:function(f,w,t){var O=this,k=O.sm(),z=null;k.size()&&(k.each(function(x){var U=O.getDataUIBounds(x);z=z?me(U,z):U}),f&&Wn(z,f),O.fitRect(z,w,t))},toCanvas:function(n,m,x){m=m||this._zoom,this.validateImpl();var a=this,O=a.getContentRect();x&&Wn(O,x),O.width||(O.width=10),O.height||(O.height=10);var b=Yh(),J=O.x*m,G=O.y*m,V=Math.ceil(O.width*m),S=Math.ceil(O.height*m);ik(b,V,S,1);var s=ck(b);return n=n||this._dataModel.getBackground(),n&&Qf(s,0,0,V,S,n),_h(s,-J,-G),s.scale(m,m),a._42(s),s.restore(),b},toDataURL:function(N,k,V,$){return this.toCanvas(N,V,$).toDataURL(k||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(G,n){var J=this,M=J.dm().getBackground();if(M){var U=J.dm().a("width"),A=J.dm().a("height");U>0&&A>0&&Qf(G,0,0,U,A,M)}var x=J.__htmlOrderList,C=[];if(J._93db(G,n),J.each(function(g){var M=J.getDataUI(g);if(M){var V=J._56I[g._id],l=M._htmlView;if(V){var m=M._79o();if(l=M._htmlView,Y.HtmlNode&&g instanceof Y.HtmlNode)M._42(G);else{var w=J.getViewRect(),E=l&&l.layoutHTML;!n||Hr(n,m)?(E&&(l.layoutHTML(),M.__outerLayout&&delete M.__outerLayout),M._42(G)):Hr(w,m)||!E||M.__outerLayout||(l.layoutHTML(),M.__outerLayout=!0)}}l&&(C.push(l),l.getView&&(l=l.getView()),l.style.display=V?"block":Ym)}}),x&&C.length>0){var S=!1;if(x.length!==C.length)S=!0;else for(var Q=0;Q<C.length;Q++)if(C[Q]!==x[Q]){S=!0;break}S&&(C.forEach(function(D){D.autoAdjustIndex!==!1&&J.appendHTML(D,!0)}),this.__htmlOrderList=C)}else this.__htmlOrderList=C;J._92db(G,n)},validateImpl:function(){this.tryUpdateRootData();var b,Q,R,i,x,L=this,s=L.tx(),d=L.ty(),v=L._zoom,Z=L._canvas,N=this.getWidth(),K=this.getHeight(),W=L._29I,B={x:-s/v,y:-d/v,width:N/v,height:K/v},j={},h=L._34I,y=L._24I,z=L._32I,l=L._23I;L._24I={},(N!==Z.clientWidth||K!==Z.clientHeight)&&(ik(Z,N,K),z=1),z||nn(B,W)||(z=1),L._29I=B,L.each(function(N){Q=N._id;var r=j[Q]=L.isVisible(N);r!==L._56I[Q]&&(y[Q]=N,R=L.getDataUI(y[Q]),R&&R._84o(r),L._84o(N,r))},L);for(Q in y)R=L.getDataUI(y[Q]),R&&(!z&&L._56I[Q]&&(x=R._79o(),x&&h.add(x)),R.invalidate()),L._83I=1;if(L._56I=j,!z)for(Q in y)j[Q]&&(R=L.getDataUI(y[Q]),R&&(x=R._79o(),x&&h.add(x)));if(z?i=B:(h.each(function(Q){Hr(B,Q)&&(i=me(i,Q))}),i&&(Wn(i,q(1,1/v)),i.x=E(i.x*v)/v,i.y=E(i.y*v)/v,i.width=m(i.width*v)/v,i.height=m(i.height*v)/v,i=Ak(B,i))),L._74O=i,i){b=ck(Z);var $=i.x,e=i.y,J=i.width,T=i.height;$=Math.floor(($*v+s)*td),e=Math.floor((e*v+d)*td),J=Math.ceil(J*v*td)+1,T=Math.ceil(T*v*td)+1,z||(i.x=($/td-s)/v,i.y=(e/td-d)/v,i.width=J/td/v,i.height=T/td/v),b.beginPath(),b.rect($,e,J,T),b.clip(),b.clearRect($,e,J,T),ko(b,s,d,v),L._42(b,i),b.restore(),delete L._74O}if(h.clear(),delete L._32I,l&&N>0&&K>0){var R=L.getDataUI(l);if(R){var x=R._79o(),a=L._29I,H=a.x,G=a.y,n=a.width,c=a.height,v=L._zoom;x&&!Hr(x,a)&&(x.x+x.width<H&&L.tx(-x.x*v),x.x>H+n&&L.tx(-(x.x+x.width-n)*v),x.y+x.height<G&&L.ty(-x.y*v),x.y>G+c&&L.ty(-(x.y+x.height-c)*v))}delete L._23I}L._83I&&(delete L._83I,delete L._84I),L._98O(),L.countFrame(),wf(L._24I)||zs(L.iv,L)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var f,U=this.getFullscreenDatas();for(var N in U)f=U[N],this.scaleRootData(f);this._rootDataUpdating=!1}},scaleRootData:function(P){var d=P.s("fullscreen");if("uniform"===d||"fill"===d){P.getRotation()&&P.setRotation(0);var O=P.s("fullscreen.gap")||0,A=this.getWidth(),_=this.getHeight();if(A&&_){var m,q,C,F=A-2*O,b=_-2*O,Q=P.getAnchor(),H=P.getScaledSize(),g=H.width,E=H.height,p=P.s("fullscreen.lock");if(p)return"uniform"===d?F/b>g/E?(m=b/E,g=E*F/b):(m=F/g,E=g*b/F):"v"===p?(m=b/E,g=F/m,P.getWidth()!==g&&P.setWidth(g)):(m=F/g,E=b/m,P.getHeight()!==E&&P.setHeight(E)),this.setZoom(m),q=O-(P.getX()-Q.x*g)*m,C=O-(P.getY()-Q.y*E)*m,q!==this.tx()&&this.tx(q),C!==this.ty()&&this.ty(C),void 0;q=this.tx(),C=this.ty(),m=this._zoom;var l={x:(-q+O)/m,y:(-C+O)/m,width:F/m,height:b/m};if("uniform"===d){var M=g/E,B=Math.min(l.width,l.height*M),Z=B/M;l.x+=.5*(l.width-B),l.y+=.5*(l.height-Z),l.width=B,l.height=Z}F=l.width/P.getScaleX(),b=l.height/P.getScaleY(),(P.getWidth()!=F||P.getHeight()!==b)&&P.setSize(F,b);var a=l.x+Q.x*l.width,f=l.y+Q.y*l.height,X=P.getPosition();(a!==X.x||f!==X.y)&&P.setPosition(a,f)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(r){var c=this;r!==c.isScrollBarVisible()&&(r?(zg(c._view,c._79O=wc()),zg(c._79O,c._27I=wc()),zg(c._79O,c._28I=wc())):(ig(c._79O),delete c._79O,delete c._27I,delete c._28I),c.fp("scrollBarVisible",!r,r))},getDebugTip:function(){return""},showScrollBar:function(){var b=this;b._79O&&(b._85I||(Z(function(){b._86I()},Uo),b.iv()),b._85I=new Date)},_86I:function(){var s=this;if(s._85I){var r=new Date,E=r.getTime();E-s._85I.getTime()>=Uo?(delete s._85I,s.iv()):Z(function(){s._86I()},Uo)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var W=this,X=this._27I,E=this._28I;if(W._79O){if(W._autoHideScrollBar&&!W._85I)return X.style.visibility=Vp,E.style.visibility=Vp,void 0;var A=W.getScrollBarColor(),z=W._zoom,R=W.getScrollBarSize(),Q=W.getViewRect(),V=W.getScrollRect(),K=Q.height*z,c=V.height*z,m=Q.width*z-R-2,Y=K*((Q.y-V.y)*z/c),G=K*(K/c),C=X.style;c-.5>K?(fl>G&&(Y=Y+G/2-fl/2,0>Y&&(Y=0),Y+fl>K&&(Y=K-fl),G=fl),Km(X,m,Y,R,G),C.visibility=Xe,C.background=A,C.borderRadius=R/2+yr):C.visibility=Vp;var n=Q.width*z,I=V.width*z,Y=Q.height*z-R-2,m=n*((Q.x-V.x)*z/I),Z=n*(n/I),C=E.style;I-.5>n?(fl>Z&&(m=m+Z/2-fl/2,0>m&&(m=0),m+fl>n&&(m=n-fl),Z=fl),Km(E,m,Y,Z,R),C.visibility=Xe,C.background=A,C.borderRadius=R/2+yr):C.visibility=Vp}},setDataModel:function(O){var W=this,x=W._dataModel,z=W._selectionModel;x!==O&&(x&&(x.ump(W.handleDataModelPropertyChange,W),x.umm(W.handleDataModelChange,W),x.umd(W.handleDataPropertyChange,W),x.removeIndexChangeListener(W._75O,W),x.removeHierarchyChangeListener(W.handleHierarchyChange,W),z||x.sm().ums(W.handleSelectionChange,W)),W._dataModel=O,O.mp(W.handleDataModelPropertyChange,W),O.mm(W.handleDataModelChange,W),O.md(W.handleDataPropertyChange,W),O.addIndexChangeListener(W._75O,W),O.addHierarchyChangeListener(W.handleHierarchyChange,W),z?z._21I(O):O.sm().ms(W.handleSelectionChange,W),W.invalidateAll(!0),W.fp($q,x,O),W.updateBackground())},getLayersInfo:function(){if(this._layersInfo===w){var v=this.getLayers();v?(this._layersInfo={},v.forEach(function(s){var O=ao(s)?s.name:s;this._layersInfo[O]=s},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(V,d,p){var w,J,z=this,x=z.getDataUI(V),W=ek(x),B=ks(d,function(c){return cd(W,100*c)},100,.001),v=cd(W,100*B);if(!p){var k=nl(x),q=new ob(v.x,v.y),o=49/(z._zoom*z._zoom);for(w=0,J=k.length;J>w;w++)if(q.distanceToSquared(k[w])<o)return{index:w,point:k[w],distance:Math.sqrt((k[w].x-d.x)*(k[w].x-d.x)+(k[w].y-d.y)*(k[w].y-d.y))}}return{percent:B,point:v,distance:Math.sqrt((v.x-d.x)*(v.x-d.x)+(v.y-d.y)*(v.y-d.y))}},calculateAttachPoint:function(){var T=new ob,e=new ob,i=new ob;return function(r,U){var L=this.getAttachPoints(r);if(!L||!L.length)return null;i.set(U.x,U.y);for(var X,o,G,H,F,p=1/0,E=0,x=L.length;x>E;E++)G=L[E],e.x=G.x,e.y=G.y,T.x=G.offsetX||0,T.y=G.offsetY||0,H=Nk(this,r,0,T.x,T.y,e.x,e.y),o=i.distanceToSquared(H),p>o&&(X=E,p=o,F=H);p=Math.sqrt(p);var g=this.getAttachStyle(r);if("close"===g){var t=r.s("attach.close.threshold")/this._zoom;if(p>t)return null}return{index:X,distance:p,info:L[X],point:F}}}(),getAttachPoints:function(e){var f=e.s("attach.points");if(f)return f;var d=ir(e._image);return d?bf(d.attachPoints,e,this)||null:void 0},getAttachStyle:function(E){var r=E.s("attach.style");if(r)return r;var n=ir(E._image);return n?bf(n.attachStyle,E,this)||"close":void 0},updateLayers:function(){this._layersInfo=w,this.invalidateSelection(),this.redraw()},updateBackground:function(){var U=this.dm().a("width"),M=this.dm().a("height");this._canvas.style.background=U>0&&M>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(H){if("background"===H.property){var Y=this._canvas.style.background,F=H.newValue||"";this.updateBackground(),this.fp("canvasBackground",Y,F),this.redraw()}else"a:width"===H.property||"a:height"===H.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===H.property?this.updateLayers():"hierarchicalRendering"===H.property&&this.redraw()},handleDataPropertyChange:function(c){this.dm().isHierarchicalRendering()&&"parent"===c.property&&c.data.hasChildren()&&this.redraw(),this.invalidateData(c.data)},onPropertyChanged:function(h){var c=this,m=h.property;if(c.redraw(),"zoom"===m){var z=c.sm().getSelection();z.size()&&z.each(function(O){O.invalidate()})}else"dataModel"===m&&(c._83I=1);Ql[m]?c.showScrollBar():m===Mm&&c.onCurrentSubGraphChanged(h)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(i){var X=this,R=i.kind,j=i.data;if(X._83I=1,"add"===R)X.invalidateData(j),br(j)&&j.getEdgeGroup()&&j.getEdgeGroup().eachSiblingEdge(X.invalidateData,X);else if(R===Ii){X._21Q(j);var g=j._id,J=X._25I[g];if(J){if(X._56I[g]){var V=J._79o();V&&X.redraw(V)}J.dispose(),delete X._25I[g],delete X._24I[g],delete X._56I[g]}j===X._currentSubGraph&&X.setCurrentSubGraph(t)}else R===_p&&(X.invalidateAll(!0),X.setCurrentSubGraph(t))},_75O:function(g){this.invalidateData(g.data)},handleHierarchyChange:function(U){this.dm().isHierarchicalRendering()&&U.data.hasChildren()&&this.redraw(),this.invalidateData(U.data)},adjustIndex:function(S){var n=this;if(n.isVisible(S)){n.dm().beginTransaction();for(var m=S;m._parent&&n.isVisible(m._parent);)m=m._parent;m&&m!==S&&n._dataModel.adjustIndex(m),n._dataModel.adjustIndex(S),n.dm().endTransaction()}},getImage:function(Y){return Y.getImage?Y.getImage():w},getSelectWidth:function(s){var H=ir(this.getImage(s));return H&&bf(H.disableSelectedBorder,s,this)?0:s.s("select.width")},getSelectColor:function(K){return K.s("select.color")},isSelectable:function(d,h){if(this.isSelected(d))return!0;if(!h&&d.getParent()instanceof aq&&this.isSelectable(d.getParent(),!0)&&d.getParent().isSyncSize())return!1;var i=this.getLayersInfo();if(i){var W=i[d._layer];if(W&&W.selectable===!1)return!1}return d.s("2d.selectable")&&this.sm().isSelectable(d)},isMovable:function(X){var s=this;if(br(X)&&X.getStyle(mp)!==ef)return!1;var M=this.getLayersInfo();if(M){var T=M[X._layer];if(T&&T.movable===!1)return!1}return X.s("2d.movable")?s._movableFunc?s._movableFunc(X):!0:!1},isEditable:function(x){var n=this;if(Y._uiSerializing)return n._uieditable;if(!n._editInteractor||!n.isSelected(x))return!1;if(Ae(x)){var y=n.getDataUI(x);if(!y||y._88I)return!1}if(br(x)&&x.getStyle(mp)!==ef)return!1;var F=this.getLayersInfo();if(F){var D=F[x._layer];if(D&&D.editable===!1)return!1}return x.s("2d.editable")?n._editableFunc?n._editableFunc(x):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(I){return wk(I)&&0!==I.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(I):!0},isRectEditable:function(v){return this._rectEditableFunc?this._rectEditableFunc(v):!0},isAnchorEditable:function(B){return this._anchorEditableFunc?this._anchorEditableFunc(B):!0},isRotationEditable:function(z){return z.setRotation&&z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(z):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(n){var w=n.getAnchor(),v=n.getScale(),E=this._zoom,R=kp(n.getRotation(),0,-n.getHeight()*v.y*w.y-(v.y<0?-1:1)*(mc?32:16)/E),u=n.p();return R.x+=u.x,R.y+=u.y,R},getLogicalPoint:function(Y){var L=this;return fg(Y,L._canvas,L.tx(),L.ty(),L._zoom,L._zoom)},getScreenPoint:function(Y,T){var W,i=this;return"object"==typeof Y?Y.x!==w?(W=Y.x,T=Y.y):(W=Y[0],T=Y[1]):W=Y,Em(W,T,i._canvas,i.tx(),i.ty(),i._zoom,i._zoom)},getSelectedDataAt:function(M){var P=this;return this.getDataAt(M,function(E){return P.isSelected(E)})},getDataInfoAt:function(a,W,U){var m,g=this.lp(a),_=this.getDataAt(g,W,U);if(_){var p=this.getDataUI(_);m={data:_,ui:p,point:g};var b=p._38o;if(b){var O=b.icons;for(var z in O){var L=O[z],G=b.rects[z];if(G)for(var F=bf(L.names,_,this),n=F?F.length:0,w=G.rotation,P=n-1;P>=0;P--){var M=F[P],K=G[P];if(Mf(K,g,w))return m.part="icons",m.name=z,m.icon=M,m.rect=K,m.index=P,m.rotation=w,m}}}if(this.isNoteVisible(_)){if(p.note2Info&&Mf(p.note2Info.clickRect,g,t,p.note2Info.scale))return m.part="note2",m;if(p.noteInfo&&Mf(p.noteInfo.clickRect,g,t,p.noteInfo.scale))return m.part="note",m}if(this.isLabelVisible(_)){if(p.label2Info&&Mf(p.label2Info.rect,g,p.label2Info.rotation,p.label2Info.scale))return m.part="label2",m;if(p.labelInfo&&Mf(p.labelInfo.rect,g,p.labelInfo.rotation,p.labelInfo.scale))return m.part="label",m}if(_.isInRect&&_.isInRect(g))return m.part="body",m}return m},getDataAt:function(M,W,l){M.target&&(M=this.lp(M));var o,N=this._zoom;return this.reverseEach(function(h){return(W?W(h):this.isSelectable(h))&&this.rectIntersects(h,gb(M.x,M.y,l,N))?(o=h,!1):void 0},this),o},getIconInfoAt:function(B,O){var F=this;if(B.target&&(B=F.lp(B)),O||(O=F.getDataAt(B)),O){var x=F.getDataUI(O);if(x&&x._38o){var k,z=x._38o,X=new ls;for(k in z.icons)X.add(k);for(var $=X.size()-1;$>=0;$--){k=X.get($);for(var M=z.rects[k],u=M.rotation,K=M.length-1;K>=0;K--){var _=M[K],s=_.width,C=_.height,d={x:B.x-_.x-s/2,y:B.y-_.y-C/2};u!=t&&(d=kp(-u,d.x,d.y));var _={x:-s/2,y:-C/2,width:s,height:C};if(Mf(_,d))return{key:k,index:K,name:z.icons[k].names[K],rect:M[K],point:B,rotation:u,relativeRect:_,relativePoint:d,data:O}}}}}return t},getDatasInRect:function(V,N,_){_===w&&(_=1);var Q=this,e=new ls;return Q.reverseEach(function($){_&&!Q.isSelectable($)||(N?Q.rectIntersects($,V):Q.rectContains($,V))&&e.add($)}),e},moveSelection:function(s,$){var T=this;T.dm().beginTransaction(),wm(T.sm().toSelection(T.isMovable,T),s,$),T.dm().endTransaction()},moveDatas:function(L,v,A){var c=this;c.dm().beginTransaction(),L instanceof ls||(L=new ls(L)),wm(L,v,A),c.dm().endTransaction()},getDataUIBounds:function(Q){var x=this.getDataUI(Q);return x?x._79o():t},drawData:function(B,f,N){var p=this.getDataUI(f);if(p){var w=p._79o();(!N||Hr(N,w))&&(p._42(B),f instanceof Y.Block&&f.eachChild(function(Z){this.drawData(B,Z,N)},this))}},getBoundsForGroup:function(P){return P.s(Lg)?this.getDataUIBounds(P):t},isPixelPerfect:function(g){return g.s("pixelPerfect")},rectIntersects:function(c,Y){this.validate();var d=t;if(this._56I[c._id]){var i=this._25I[c._id];if(i){var M=i._79o();if(lk(Y,M))d=!0;else if((Y=Ak(Y,M))&&(i.rectIntersects&&(d=i.rectIntersects(Y)),d==t)){if(!this.isPixelPerfect(c))return!0;var s=Y.x,V=Y.y,P=Y.width,$=Y.height,E=this._zoom,r=Q.hitMaxArea,m=P*$*E*E;if(m>r){var J=Math.sqrt(r/m);E*=J}P*=E,$*=E,2>P&&(P=2),2>$&&($=2),s*=E,V*=E;var w=wq(P,$);_h(w,-s,-V),w.scale(E,E),this._drawForChecking=!0,this.drawData(w,c,Y),this._drawForChecking=!1;try{for(var K=0,D=w.getImageData(0,0,P,$).data;K<D.length;K+=4)if(0!==D[K+3]){d=!0;break}w.restore()}catch(z){xk=t,d=!1}}}}return d?!0:!1},rectContains:function(e,n){if(this._56I[e._id]){var m=this._25I[e._id];if(m)return lk(n,m._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(w){if(!Q.isInput(w.target)){var V=this,z=V._focusData,O=z&&V._25I[z._id],g=0,G=V._dataModel._datas;if(!(z&&z._enabled&&z._editable&&O&&O.onKeyDown&&O.onKeyDown(w)===!0))if(9===w.keyCode&&(z&&(g=G.indexOf(z),Dc(w)?-1===--g&&(g=0):++g===G.size()&&(g=0)),V._focusData=z=G.get(g),V.sm().setSelection(z)),xr(w)?V.selectAll():Kb(w)&&V.isResettable()&&V.reset(),V.sm().isEmpty()){if(V._editing)return;var f=V.tx(),Y=V.ty(),x=!1,D=Dc()?100:10;_g(w)&&(f-=D,x=!0),ah(w)&&(Y-=D,x=!0),El(w)&&(f+=D,x=!0),Fq(w)&&(Y+=D,x=!0),x&&V.setTranslate(f,Y)}else{Eg(w)&&V.handleDelete(w);var T=Dc()?10:1;_g(w)&&(V.moveSelection(-T,0),V.fi({kind:"moveLeft"})),ah(w)&&(V.moveSelection(0,-T),V.fi({kind:"moveUp"})),El(w)&&(V.moveSelection(T,0),V.fi({kind:"moveRight"})),Fq(w)&&(V.moveSelection(0,T),V.fi({kind:"moveDown"}))}}},handleScroll:function(D,G){if(Hc(D),this.isZoomable()){if(!this.getEditInteractor()){var X=this.getDataAt(D);if(X){var k=ir(this.getImage(X));if(k&&bf(k.scrollable,X,this))return}}var x=this.lp(D);G>0?this.scrollZoomIn(x):0>G&&this.scrollZoomOut(x)}},handlePinch:function(v,r,Z){this.isZoomable()&&(r>Z?this.pinchZoomIn(v):this.pinchZoomOut(v))},checkDoubleClickOnNote:function(j,o){var C=this,t=C.lp(j),A=C.getDataUI(o),L=A.note2Info;return L&&o.s("note2.toggleable")&&Mf(L.clickRect,t)?(o.s(kc,!o.s(kc)),C.fi({kind:"toggleNote2",event:j,data:o}),!0):(L=A.noteInfo,L&&o.s("note.toggleable")&&Mf(L.clickRect,t)?(o.s(Mr,!o.s(Mr)),C.fi({kind:"toggleNote",event:j,data:o}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(X,Z){var j=this,I=j.getAutoScrollZone(),d=I/j.getZoom(),T=I/4,e=j._29I,g=j.lp(X),$={x:j.tx(),y:j.ty()};return g&&I>0&&e&&(g.x-e.x<d?j.translate(T,0):e.x+e.width-g.x<d&&j.translate(-T,0),g.y-e.y<d?j.translate(0,T):e.y+e.height-g.y<d&&j.translate(0,-T)),$.x=j.tx()-$.x,$.y=j.ty()-$.y,Z&&(Z.x+=$.x,Z.y+=$.y),$},getMoveMode:function(A,E){var b=E.s("2d.move.mode");return b?b:ar["88"]?"x":ar["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(f,y,V){var s=this;return"currentSubGraph"===y?{__i:f.getId()}:V.serializeProperty(f,y,s)},deserializeProperty:function(S,P,p){var I=this;if("currentSubGraph"===P){var D=I.dm(),w=D.__idMap;return w[S.__i]}return p.deserializeProperty(S,P,I)},setDefaultCursor:function(F,X){this._defaultCursor=F,X!==!1&&this.setCursor(F)},setCursor:function(d){"default"===d&&(d=this._defaultCursor||d);var w=this.getView().style;w.cursor=d,w.cursor="-webkit-"+d,w.cursor="-moz-"+d},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(e){return e===t||Q.getConnectAction(null,e)?(this._currentActionType=e,this.redraw(),!0):!1},getEditStyle:function(X){var $=this.getEditInteractor();return $?$.getStyle(X):w},setEditStyle:function(k,J,h){var O=this.getEditInteractor();return O?(O.setStyle(k,J,h),!0):!1},isConnectActionVisible:function(A){var U=Q.getConnectAction(this);if(!U)return!1;var $=U.visible;return Jm($)&&($=$(this,A)),$},isInteractive:function(z){if(this._drawForChecking)return!1;var c=ir(this.getImage(z));return c&&bf(c.interactive,z,this)?!0:z.s("interactive")},appendHTML:function(D,s){var P=this.getView();if(!(s||D&&D.parentNode!==P))return!1;var q=D.getView&&D.getView();if(!s&&q&&q.parentNode===P)return!1;(D.getView||D.isSelfViewEvent)&&(D=D.getView());var V=this.getEditInteractor();return V&&V._canvas?P.insertBefore(D,V._canvas):this.isScrollBarVisible()?P.insertBefore(D,this.getView().lastChild):zg(P,D),!0},_layoutHTMLImpl:function(M,Z,Y){if(arguments.length>1){var a,S=this,K=S._zoom;if(Z.getView&&(a=Z,Z=Z.getView()),Z.style.position="absolute",Y){var g=M.getRect();Km(a||Z,S.tx()+g.x*K,S.ty()+g.y*K,g.width*K,g.height*K)}else{var z=new gi,g=M.getAnchorRect(),R=M.getPosition(),l=M.getScale(),r=Z.style;Km(a||Z,g),z.appendTranslate(S.tx(),S.ty()),z.appendScale(K,K),z.append(new gi(M.getRotation(),R.x,R.y,l.x,l.y)),Jr(r,"transform","matrix("+z.a.toFixed(5)+", "+z.b.toFixed(5)+", "+z.c.toFixed(5)+",\n    "+z.d.toFixed(5)+", "+z.tx.toFixed(5)+", "+z.ty.toFixed(5)+")"),Jr(r,"transformOrigin",(-g.x).toFixed(5)+"px "+(-g.y).toFixed(5)+"px"),Z.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(K){return K instanceof tn?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(w){var R="state",N=w.s(R);if(N)return N;var Y=ir(w._image);return Y?bf(Y[R],w,this)||null:void 0},getShape:function(U){return U.getStyle(Fc)}}),u.defineProperties(Uh.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(k){this._layoutHTML=k}}});var gm=function(f,v){var _=this;_.gv=f,_.s=function(q){return v.getStyle(q)},_._data=v,_._87I=new ls};Tr(gm,u,{_6I:t,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var P=this,v=P.gv.isSelected(P._data);return!v||P.isShadowed()?0:P.gv.getSelectWidth(P._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(G){var g=this._data,z=this.gv.getBodyColor(g);return z?z:G?g.getStyle(G):t},_2Q:function(C){return this.s(C)},_1Q:function(B,b,d,N){var R=this.s,_=R("2d.gray"),P=R(b+".dash.color");if(_&&(P=Q.toGrayColor(P)),B.strokeStyle=P,B.lineWidth=d,B.stroke(),R(b+".dash.3d")){var a=R(b+".dash.3d.color");lp(B,P,_?Q.toGrayColor(a):a,d,this.gv._zoom,R(b+".dash.3d.accuracy"))}Xn(B,N)},invalidate:function(){this._6I=t},_79o:function(){var c=this;if(!c._6I){var y=c._data,E=c.gv;c.labelInfo=c.label2Info=c.noteInfo=c.note2Info=c._38o=t,c._87I.clear(),c.interactiveInfo=E.isInteractive(y)?{}:t,c._3O(),c._55O=E.isEditable(y)?{_42O:E.isRectEditable(y),_43O:E.isPointEditable(y),_56O:E.isRotationEditable(y)}:t,c._6I=c._81o()}return c._6I},_3O:function(){},getPosition:function(){return xq},_68o:function(E,l){E&&this._87I.add(Dq(E,l))},_81o:function(){var Q=this,U=Q.s;Q._24O(cf,"getLabel"),Q._24O(Om,"getLabel2"),Q._26O(_o,"getNote"),Q._26O(Pd,"getNote2"),Q._15O(),Q._55O&&Q._48O();var E;if(Q._87I.each(function(R){E=me(E,R)}),E&&Q.isShadowed()){var Z=kr(E);Z.x+=U("shadow.offset.x"),Z.y+=U("shadow.offset.y"),Wn(Z,U("shadow.blur")),E=me(E,Z)}return Q._87I.clear(),E},_42:function(h){var U=this,J=U._data,b=U.gv,c=U.s,m=c("opacity"),x=this.isShadowed();if(x){var M=h.shadowOffsetX,S=h.shadowOffsetY,I=h.shadowBlur,g=h.shadowColor,w=b.getZoom();h.shadowOffsetX=c("shadow.offset.x")*w,h.shadowOffsetY=c("shadow.offset.y")*w,h.shadowBlur=c("shadow.blur")*w,h.shadowColor=U.getSelectColor()}if(m!=t){var O=h.globalAlpha;h.globalAlpha=m}U._80o(h),b.isLabelVisible(J)&&((!b._drawForChecking||c("label.selectable"))&&jc(h,U.labelInfo),(!b._drawForChecking||c("label2.selectable"))&&jc(h,U.label2Info)),b.isNoteVisible(J)&&(Sk(h,U.noteInfo),Sk(h,U.note2Info)),U._99O(h),m!=t&&(h.globalAlpha=O),x&&(h.shadowOffsetX=M,h.shadowOffsetY=S,h.shadowBlur=I,h.shadowColor=g)},_80o:function(){},_47O:function(){},_24O:function(v,u){var d=this,n=d._data,U=d.gv,j=d.s,$=U[u](n);if($!=t){var b=j(v+".scale"),R=j(v+".max"),T=j(v+".position"),Q=d[v+"Info"]={label:$,scale:b,color:U[u+"Color"](n),font:j(v+".font"),opacity:j(v+".opacity"),align:j(v+".align"),rotation:d.getRotation(j(v+".rotation"),!1,T),background:U[u+"Background"](n)},i=Pg(Q,$);R>0&&R<i.width&&(Q.labelWidth=i.width,i.width=R),1!==b&&(i.width*=b,i.height*=b);var S=d.getPosition(T,j(v+".offset.x"),j(v+".offset.y"),i,j(v+".position.fixed"));if(i.x=S.x-i.width/2,i.y=S.y-i.height/2,d._68o(Q.rect=i,Q.rotation),1!==b){var Z=i.width/b,X=i.height/b;Q.rect={x:S.x-Z/2,y:S.y-X/2,width:Z,height:X}}}},_26O:function(M,e){var $=this,K=$.gv,N=$._data,n=$.s,a=K[e](N);if(a!=t){var P,B,G=n(M+".scale"),J=$[M+"Info"]={note:a,scale:G,data:N,view:K,expanded:n(M+".expanded"),font:n(M+".font"),color:n(M+".color"),opacity:n(M+".opacity"),align:n(M+".align"),icon:n(M+".icon"),backgroundImage:n(M+".backgroundImage"),borderWidth:n(M+".border.width"),borderColor:n(M+".border.color"),background:K[e+"Background"](N)},d=$.getPosition(n(M+".position"),n(M+".offset.x"),n(M+".offset.y")),o=d.x,h=d.y;if(J.expanded){var f,O=n(M+".max"),_=n(M+".backgroundImage");_?(_=ir(_),f={width:To(_,N),height:wb(_,N)}):f=Pg(J,a),f.width+=6,f.height+=2,O>0&&O<f.width&&(J.labelWidth=f.width,f.width=O),P=f.width,B=f.height+8,J.clickRect={x:o-P*G/2,y:h-B*G,width:P*G,height:B*G*f.height/B}}else{var I=n(M+".icon");I?(I=ir(I),P=To(I,N),B=wb(I,N)):(P=12,B=18),J.clickRect={x:o-P*G/2,y:h-B*G,width:P*G,height:B*G}}J.rect={x:o-P/2,y:h-B*G/2-B/2,width:P,height:B};var E=m(J.borderWidth/2)*G;$._68o({x:o-P*G/2-E,y:h-B*G-E,width:P*G+2*E,height:B*G+2*E})}},_48O:function(){},_99O:function(j){var v=this,A=v._38o;if(A){var B=v.gv,b=v._data,r=A.icons,h=v.interactiveInfo;h&&(h._38o={});for(var l in r){var z=r[l],T=A.rects[l];if(T){h&&(h._38o[l]=[]);var $=bf(z.opacity,b,B),I=bf(z.names,b,B),E=I?I.length:0,J=T.rotation;if($!=t){var i=j.globalAlpha;j.globalAlpha*=$}for(var f=0;E>f;f++){var n=I[f],k=ir(n),m=T[f];if(J){var F=m.x+m.width/2,Y=m.y+m.height/2;j.save(),_h(j,F,Y),Pp(j,J),_h(j,-F,-Y)}h&&h._38o[l].push(j.interactiveInfo={compInfos:[],matrix:J?new gi(J,F,Y).appendTranslate(-F,-Y):new gi}),Mi(j,k,bf(z.stretch,b,B),m.x,m.y,m.width,m.height,v._data,v.gv),j.interactiveInfo=t,J&&j.restore()}$!=t&&(j.globalAlpha=i)}}}}});var Iq=function(V,D){ml(Iq,this,[V,D])};Tr(Iq,gm,{_checkEmptyRect:!0,_40O:function(U,W){var F=this,O=F.s,u=U.rect;(U.borderColor=F.gv.getBorderColor(F._data))&&(U.borderType=O("border.type"),U.borderWidth=O("border.width"),U.borderPadding=O("border.padding"),W=q(W,U.borderPadding+U.borderWidth/2));var x=F._data.getScale(),j=q(1,q(c(x.x),c(x.y)));if(U.selectWidth=F.getSelectWidth()){var b=F.gv._zoom;U.selectType=O("select.type"),U._97o=F.getSelectColor(),U.selectPadding=O("select.padding"),W=q(W,(U.selectPadding+U.selectWidth/2/b)/j)}W>0&&(W*=j,u=kr(u),Wn(u,W)),F._68o(u)},_39O:function(Q,b){var L,x=this,$=b.rect;if(b.borderWidth>0&&(L=b.borderPadding,Q.strokeStyle=b.borderColor,Q.lineWidth=b.borderWidth,yp(Q,b.borderType,{x:$.x-L,y:$.y-L,width:$.width+2*L,height:$.height+2*L}),Q.stroke()),b.selectWidth>0){var G=x.gv._zoom;if(L=b.selectPadding,Q.strokeStyle=b._97o,Q.lineWidth=b.selectWidth/G,b.rotation!=t){Q.save(),Q.translate(b.position.x,b.position.y),Q.rotate(b.rotation);var X=x._data,v=X.getWidth(),k=X.getHeight(),w=b.scale,g=b.anchor;$={x:w.x*-v*g.x,y:w.y*-k*g.y,width:w.x*v,height:w.y*k}}yp(Q,b.selectType,{x:$.x-L,y:$.y-L,width:$.width+2*L,height:$.height+2*L}),b.rotation!=t&&Q.restore(),Q.stroke()}},dispose:function(){var K=this,$=K._htmlView;Iq.superClass._3O.call(K),$&&($.onHTMLRemoved&&$.onHTMLRemoved(),ig($))},_3O:function(){var m=this,f=m.s,S=m._data,r=m.gv,u=r.getShape(S),h=m.getBodyColor(),p=m._83o=u?{shape:u,_53o:m.getBodyColor("shape.background"),_27Q:ir(f("shape.repeat.image"),h),shapeGradientPack:f("shape.gradient.pack"),_54o:f("shape.border.width"),_55o:f("shape.border.color"),_56o:f("shape.border.3d"),_57o:f("shape.border.3d.color"),_58o:f("shape.border.3d.accuracy"),shapeGradient:f("shape.gradient"),_59o:f("shape.gradient.color"),_60o:f("shape.border.pattern"),_61o:f("shape.border.cap"),_62o:f("shape.border.join"),shapeForeground:f("shape.foreground"),bodyColor:h,gray:f("2d.gray")}:{img:ir(r.getImage(S),h),bodyColor:h,gray:f("2d.gray"),stretch:f("image.stretch")};if(U&&!x);else{var d,l=p.img;l&&l.renderHTML?(m._htmlInfo&&m._htmlInfo.img!==l&&(m._htmlInfo=t),m._htmlInfo||(m._htmlInfo={img:l,cache:{}}),d=l.renderHTML(S,r,m._htmlInfo.cache)):m._htmlInfo=t,m._htmlView&&m._htmlView!==d&&(m._htmlView.onHTMLRemoved&&m._htmlView.onHTMLRemoved(),ig(m._htmlView.getView?m._htmlView.getView():m._htmlView)),(m._htmlView=d)&&r.appendHTML(d)&&(d.onHTMLAddedSync&&d.onHTMLAddedSync(),d.onHTMLAdded&&zs(d.onHTMLAdded)),p.rect=S.getRect(),p.position=S.p(),p.scale=S.getScale(),p.anchor=S.getAnchor(),p.rotation=S.getRotation(),u===_m&&(p._63o=f("shape.depth"));var W=0;if(u)W=hl(t,p._54o/2,p._62o),m.s("shape.dash")&&(W=q(W,(m.s("shape.dash.width")||p._54o)/2));else if(l&&l.boundExtend)if(W=bf(l.boundExtend,S,r),l.boundExtendAbsolute){var n=S.getScale();W/=r._zoom*q(1,q(c(n.x),c(n.y)))}else if(!bf(l.fitSize,S,r)){var G=bf(l.width,S,r),Y=bf(l.height,S,r);W*=q(S.getWidth()/G,S.getHeight()/Y)}m._40O(p,W);var V=f("clip.percentage");if(1>V&&(0>V&&(V=0),p.clipRect=Mg(S.getAnchorRect(),f("clip.direction"),V)),u){var T=f("shape.fill.clip.percentage");1>T&&(0>T&&(T=0),p.shapeClipRect=Mg(S.getAnchorRect(),f("shape.fill.clip.direction"),T));var g=f("shape.foreground.clip.percentage");1>g&&(0>g&&(g=0),p.shapeForegroundClipRect=Mg(S.getAnchorRect(),f("shape.foreground.clip.direction"),g))}}},getPosition:function(f,B,g,C){var s=Tf(f,this._83o.rect,C);return s.x+=B,s.y+=g,s},_80o:function(H){var e=this,i=e.s,B=e.gv,d=e._data,J=e._83o,q=J.rect,F=J.position,p=J.rotation,o=J.anchor,u=J.scale,I=J.shape,Z=J.clipRect;if(!e._checkEmptyRect||q.width>0&&q.height>0){var m=d.getSize();if(m.x=-m.width*o.x,m.y=-m.height*o.y,H.save(),_h(H,F.x,F.y),Pp(H,p),ri(H,u.x,u.y),Z&&(H.beginPath(),H.rect(Z.x,Z.y,Z.width,Z.height),H.clip()),B._drawForChecking&&J.img&&bf(J.img.pixelPerfect,d,B)===!1)Qf(H,m.x,m.y,m.width,m.height,"#888888");else if(e.freeDraw)e.freeDraw(H,m,J);else if(I){var T,h,L,$,E=J._60o,x=Wp(H,E),c=J._27Q,j=J._54o,G=J.shapeGradientPack,v=J.gray,y=H.lineJoin,z=H.lineCap,g=function(d){return v?Q.toGrayColor(d):d};"roundRect"===I?T=i("shape.corner.radius"):"polygon"===I?T=i("shape.polygon.side"):"arc"===I&&(T=i("shape.arc.from"),h=i("shape.arc.to"),L=i("shape.arc.close"),$=i("shape.arc.oval")),H.lineJoin=J._62o,H.lineCap=J._61o;var D=g(J._53o);if(D||c||G){var R=J.shapeClipRect;R&&(H.save(),H.beginPath(),H.rect(R.x,R.y,R.width,R.height),H.clip()),yp(H,I,m,T,h,L,$),G?Hm(H,G):c?hd(H,c,g(J.bodyColor),null,d,B):Se(H,D,J.shapeGradient,g(J._59o),m),H.fill(),R&&H.restore(),G&&H.restore(),H!==x&&yp(x,I,m,T,h,L,$)}else yp(x,I,m,T,h,L,$);var w=J.shapeForeground;if(w){H.save();var N=J.shapeForegroundClipRect;N&&(H.beginPath(),H.rect(N.x,N.y,N.width,N.height),H.clip()),yp(H,I,m,T,h,L,$),Se(H,w,i("shape.foreground.gradient"),g(i("shape.foreground.gradient.color")),m),H.fill(),H.restore()}if(j>0){var r=i("shape.border.width.absolute");r&&(H.save(),H.setTransform(1,0,0,1,0,0)),H.lineWidth=j;var Y=g(J._55o);H.strokeStyle=Y,H.stroke(),r&&H.restore(),J._56o&&lp(H,Y,g(J._57o),j,B._zoom,J._58o)}if(Xn(H,E),i("shape.dash")){var _=i("shape.dash.width")||j;if(_>0){E=i("shape.dash.pattern");var x=Wp(H,E,e._2Q("shape.dash.offset"));x!==H&&yp(x,I,m,T,h,L,$),e._1Q(H,"shape",_,E)}}mb(H,D,J._63o,m),H.lineJoin=y,H.lineCap=z}else{var s=e.interactiveInfo;s&&(H.interactiveInfo=s.bodyInfo={compInfos:[],matrix:new gi(p,F.x,F.y,u.x,u.y)}),J.gray&&(H.compGray=!0);var P=J.img;P&&P.cacheRule!=t&&(P=bl(H,P,J.stretch,m.width,m.height,d,B,J.bodyColor)),Mi(H,P,J.stretch,m.x,m.y,m.width,m.height,d,B,J.bodyColor),H.compGray=!1,H.interactiveInfo=t}H.restore()}e._39O(H,J)},_48O:function(){},_47O:function(){}});var Ik=function(Z,u){ml(Ik,this,[Z,u])},cm=function(n,K,s,J){var C=ro(n,K);return s=J?a(s,C):ej(s,C),C?s/=C:s=0,{x:n.x+(K.x-n.x)*s,y:n.y+(K.y-n.y)*s}};Tr(Ik,gm,{_3O:function(){var k,c=this,g=c._data,X=c.gv,y=c.s,E=y(mp),R=g.isLooped(),T=y("edge.width"),f=y("edge.center"),e=y("edge.offset"),P=X.getBorderColor(g),Z=P?y("border.width"):0,i=c.getSelectWidth(),K=g._40I,b=g._41I,z=c._78o=K&&b?{looped:R,type:E,width:T,center:f,color:c.getBodyColor("edge.color"),borderColor:P,borderWidth:Z,_97o:i?c.getSelectColor():t,selectWidth:i,pattern:y("edge.pattern"),cap:y("edge.cap"),join:y("edge.join"),is3d:y("edge.3d"),_67o:y("edge.3d.color"),_66o:y("edge.3d.accuracy"),gray:y("2d.gray")}:t;
if(z){var O=Q.getEdgeType(E);if(O){var _=O(g,Gf(c,X,g,R,E),X,c._19Q);_.points&&_.points.size()>1?(z.edgeTypeInfo=_,k=Qm(z.edgeTypeInfo.points)):_[xe]&&_.rect&&(z.edgeTypeInfo=_,k=_.rect)}else{var H=y("edge.source.anchor.x"),u=y("edge.source.anchor.y"),Y=y("edge.target.anchor.x"),d=y("edge.target.anchor.y"),F=Ld(X,g,"source"),h=Ld(X,g,"target");if(E===ef){var o=z.points=y(Sh)||wn,D=o.size();z.segments=y("edge.segments");var j=H!==w||u!==w||br(K),B=Y!==w||d!==w||br(b);if(!f)if(e)j||(F=cm(F,D?o.get(0):h,e,D)),B||(h=cm(h,D?o.get(D-1):F,e,D));else{var G;j||(G=Dh(F,D?o.get(0):h,_k(X,K)),G&&(F={x:G[0],y:G[1]})),B||(G=Dh(D?o.get(D-1):F,h,_k(X,b)),G&&(h={x:G[0],y:G[1]}))}k=me(Qm(z.points),Qm(F,h))}else{var W=Gf(c,X,g,R,E);if(c._19Q||(W=-W),R)F=kr(F),F.x=X.getNodeRect(K).x,z.radius=W,k={x:F.x-W,y:F.y-W,width:2*W,height:2*W};else{var x=ro(F,h),m=ej(e,x),V={x:m,y:W},U={x:x-m,y:W},L=r(h.y-F.y,h.x-F.x),v=z.mat=new Gm(L);if(z.orienAngle=L,z.angle=h.x<F.x?L+S:L,z.rect={x:V.x,y:V.y,width:U.x-V.x,height:0},z.origin=F,V=v.tf(V),V.x+=F.x,V.y+=F.y,U=v.tf(U),U.x+=F.x,U.y+=F.y,f){var l={x:x,y:0};l=v.tf(l),l.x+=F.x,l.y+=F.y,k=Qm([F,V,U,l]),z.c1=F,z.c2=l}else k=Qm(V,U);F=V,h=U}}z.sourcePoint=F,z.targetPoint=h,g._lastSourcePoint=F,g._lastTargetPoint=h}var C=0;y("edge.dash")&&(C=y("edge.dash.width")||T);var p="square"===z.cap?.71:.5;hl(k,q(C*p,T*p+Z+i),z.join),c._68o(k)}},getRotation:function(Y,l,S){Y=Y||0;var $=this._78o;if($){var n,s=$.angle,L=$.points,c=$.edgeTypeInfo;if(s!=t)return l?$.orienAngle+Y:s+Y;if(c&&c[xe])return c.getRotation?c.getRotation(this,Y,l,S):0;if(c&&c.points){var x=c.points;return n=x.size(),Ig[S]?n&&0===n%2?On(x.get(n/2-1),x.get(n/2),l,Y):Y:ug[S]?On(x.get(0),x.get(1),l,Y):On(x.get(n-2),x.get(n-1),l,Y)}if(L)return n=L.size(),Ig[S]?n&&0===n%2?On(L.get(n/2-1),L.get(n/2),l,Y):Y:ug[S]?On($.sourcePoint,n?L.get(0):$.targetPoint,l,Y):On(n?L.get(n-1):$.sourcePoint,$.targetPoint,l,Y)}return Y},getPosition:function(q,f,c,g,S){var R=this._78o;if(R){var k,F=R.type,v=R.points,X=R.edgeTypeInfo,T=R.sourcePoint,$=R.targetPoint;if(!F)return R.looped?{x:T.x-R.radius+f,y:T.y+c}:(S&&T&&$&&(T.x>$.x||T.x===$.x&&T.y>$.y)&&(q=yg[q],c=-c),k=Tf(q,R.rect,g),k.x+=f,k.y+=c,k=R.mat.tf(k),k.x+=R.origin.x,k.y+=R.origin.y,k);if(X&&X[xe])return X.getPosition?X.getPosition(this,q,f,c,g,S):{x:(T.x+$.x)/2,y:(T.y+$.y)/2};if(v){var k,b=v.size();if(Ig[q]){if(b){var B=b%2;if(0===B)return po(v.get(b/2-1),v.get(b/2),q,f,c,g,S);k=v.get((b-B)/2)}else k={x:(T.x+$.x)/2,y:(T.y+$.y)/2};return k=Tf(q,{x:k.x,y:k.y,width:0,height:0},g),k.x+=f,k.y+=c,k}return ug[q]?po(T,b?v.get(0):$,q,f,c,g,S):po(b?v.get(b-1):T,$,q,f,c,g,S)}if(X){var Z=X.points,b=Z.size();if(Ig[q]){var B=b%2;return 0===B?po(Z.get(b/2-1),Z.get(b/2),q,f,c,g,S):(k=Z.get((b-B)/2),k=Tf(q,{x:k.x,y:k.y,width:0,height:0},g),k.x+=f,k.y+=c,k)}return ug[q]?po(Z.get(0),Z.get(1),q,f,c,g,S):po(Z.get(b-2),Z.get(b-1),q,f,c,g,S)}}return xq},_42:function(L){this._78o&&Ik.superClass._42.call(this,L)},drawPath:function(b,Y){b.beginPath();var U=Y.type,G=Y.points,S=Y.segments,B=Y.edgeTypeInfo;if(!U||G){var _=Y.sourcePoint,C=_.x,p=_.y,t=Y.targetPoint,h=t.x,N=t.y;if(U)if(S){var R=new ls({x:C,y:p});R.addAll(G),R.add({x:h,y:N}),ps(b,R,S)}else b.moveTo(C,p),G.each(function(x){b.lineTo(x.x,x.y)}),b.lineTo(h,N);else Y.looped?b.arc(C,p,Y.radius,0,z,!0):Y.center?(b.moveTo(Y.c1.x,Y.c1.y),b.lineTo(C,p),b.lineTo(h,N),b.lineTo(Y.c2.x,Y.c2.y)):(b.moveTo(C,p),b.lineTo(h,N))}else B&&(B.points?ps(b,B.points,B.segments):B[xe]&&B[xe](b,B))},_80o:function(r){var b=this,C=b.s,$=b._78o,d=$.width,D=$.selectWidth,f=$.borderWidth,u=r.lineJoin,x=r.lineCap,P=$.gray,Z=$.pattern;r.lineJoin=$.join,r.lineCap=$.cap,b.drawPath(Wp(r,Z),$);var k=C("edge.width.absolute");k&&(r.save(),r.setTransform(1,0,0,1,0,0)),D&&(r.strokeStyle=$._97o,r.lineWidth=d+2*(f+D),r.stroke()),f&&(r.strokeStyle=P?Q.toGrayColor($.borderColor):$.borderColor,r.lineWidth=d+2*f,r.stroke());var y=P?Q.toGrayColor($.color):$.color,R=P?Q.toGrayColor($._67o):$._67o;if(r.strokeStyle=y,r.lineWidth=d,r.stroke(),$.is3d&&lp(r,y,R,d,b.gv._zoom,$._66o),Xn(r,Z),C("edge.dash")){Z=C("edge.dash.pattern");var q=Wp(r,Z,b._2Q("edge.dash.offset"));q!==r&&b.drawPath(q,$),b._1Q(r,"edge",C("edge.dash.width")||d,Z)}k&&r.restore(),r.lineJoin=u,r.lineCap=x},_48O:function(){},_47O:function(){}});var hs=function(p,$){ml(hs,this,[p,$])};Tr(hs,Iq,{_3O:function(){var P,q,k=this,u=k.s,b=k._data,Z=k.gv;if(k._88I=t,b.isExpanded()&&b.eachChild(function(i){if(wk(i)){var l=Z.getBoundsForGroup(i);l&&(q||(q=[]),q.push(l),P=me(P,l))}}),P){var V=Z.getLabel(b),J=u("group.type"),X=u("group.border.width")||0,A=u("group.border.width.absolute"),B=X/2;A&&(X/=Z._zoom),P=yj(J,q,P),ll(P,b,"group.padding",1),Wn(P,X);var O=k._88I={type:J,rect:P,_64o:P};if(!J&&V!=t){var d,I=k.labelInfo={label:V,color:u("group.title.color"),font:u("group.title.font"),align:u("group.title.align")},$=Pg(I,V),e=$.width+X,N=$.height+X,Y=u("group.title.align"),x=u("group.title.orientation");if(x===_j||x===mn?(P.height+=X,e>P.width&&(P.width=e)):(x===Ug||x===af)&&(P.width+=X,e>P.height&&(P.height=e)),d=Y===Ug?P.x:Y===af?P.x+P.width-e:P.x+P.width/2-e/2,x===mn)O.titleRect={x:P.x,y:P.y+P.height,width:P.width,height:N},O.rect={x:P.x,y:P.y,width:P.width,height:P.height+N},I.rect={x:d,y:P.y+P.height,width:e,height:N};else if(x===Ug){var h=O.titleRect={x:P.x-N,y:P.y,width:N,height:P.height};O.rect={x:P.x-N,y:P.y,width:P.width+N,height:P.height},I.rect={x:h.x+N/2-P.height/2,y:h.y+P.height/2-N/2,width:P.height,height:N},I.rotation=-Math.PI/2}else if(x===af){var h=O.titleRect={x:P.x+P.width,y:P.y,width:N,height:P.height};O.rect={x:P.x,y:P.y,width:P.width+N,height:P.height},I.rect={x:h.x+N/2-P.height/2,y:h.y+P.height/2-N/2,width:P.height,height:N},I.rotation=Math.PI/2}else O.titleRect={x:P.x,y:P.y-N,width:P.width,height:N},O.rect={x:P.x,y:P.y-N,width:P.width,height:P.height+N},I.rect={x:d,y:P.y-N-B,width:e,height:N+X}}k._40O(O,u("group.border.width")/2)}else hs.superClass._3O.call(k)},getPosition:function(l,e,E,M){var z=this._88I;if(z){var i=Tf(l,z.rect,M);return i.x+=e,i.y+=E,i}return hs.superClass.getPosition.apply(this,arguments)},_24O:function(f,V){var E=this._88I;(!E||E.type||"label2"===f)&&hs.superClass._24O.call(this,f,V)},_80o:function(M){var u=this,J=u._88I;if(J){var D=u._data,Z=u.s,j=u.gv,X=J.type,w=J.rect,q=J._64o,Y=J.titleRect,N=u.getBodyColor(),S=ir(Z("group.image"),N),c=Z("group.image.stretch"),W=u.getBodyColor("group.background"),H=ir(Z("group.repeat.image"),N),h=Z("group.gradient.pack"),b=Z("group.gradient"),l=Z("group.gradient.color"),o=Z("group.border.width"),r=Z("group.border.color"),T=Z("group.border.pattern"),p=Z("group.title.orientation"),A=Z("group.depth"),a=Z("group.border.radius"),e=Z("group.border.join"),V=Z("group.border.cap"),n=Z("group.border.width.absolute");if(n&&(o/=j._zoom),X){var z=M.lineJoin,E=M.lineCap;if(M.lineJoin=e,M.lineCap=V,S){if(M.save(),yp(M,X,w,a),M.clip(),Mi(M,S,c,w.x,w.y,w.width,w.height,D,j,N),M.restore(),o>0){var m=Wp(M,T);yp(m,X,w,a),M.lineWidth=o,M.strokeStyle=r,M.stroke(),Xn(M,T)}}else{var m=Wp(M,T);W||H||h?(yp(M,X,w,a),h?Hm(M,h):H?hd(M,H,N,null,D,j):Se(M,W,b,l,w),M.fill(),h&&M.restore(),M!==m&&yp(m,X,w,a)):yp(m,X,w,a),o>0&&(M.lineWidth=o,M.strokeStyle=Z("group.border.color"),M.stroke()),Xn(M,T),X===_m&&mb(M,W,A,w)}M.lineJoin=z,M.lineCap=E}else{var Q=Z("group.title.background");if((!a||0>a)&&(a=0),S)Mi(M,S,c,q.x,q.y,q.width,q.height,D,j,u.getBodyColor());else if(W||H)if(H?hd(M,H,N,null,D,j):Se(M,W,b,l,q),0===o)yp(M,_m,q),M.fill(),mb(M,W,A,q);else{switch(M.beginPath(),p){case mn:Ee(M,q.x,q.y,q.width,q.height,a,a,0,0);break;case Ug:Ee(M,q.x,q.y,q.width,q.height,0,a,0,a);break;case af:Ee(M,q.x,q.y,q.width,q.height,a,0,a,0);break;case _j:Ee(M,q.x,q.y,q.width,q.height,0,0,a,a)}M.fill()}if(Y&&Q)if(0===o)Qf(M,Y.x,Y.y,Y.width,Y.height,Q),mb(M,Q,A,Y);else{switch(M.beginPath(),M.fillStyle=Q,p){case mn:Ee(M,Y.x,Y.y,Y.width,Y.height,0,0,a,a);break;case Ug:Ee(M,Y.x,Y.y,Y.width,Y.height,a,0,a,0);break;case af:Ee(M,Y.x,Y.y,Y.width,Y.height,0,a,0,a);break;case _j:Ee(M,Y.x,Y.y,Y.width,Y.height,a,a,0,0)}M.fill()}if(o>0){var m=Wp(M,T);if(yp(m,"roundRect",w,a),M.save(),M.lineWidth=o,M.strokeStyle=r,M.lineJoin=e,M.lineCap=V,M.closePath(),M.stroke(),Y&&Z("group.splitLine")){var U=Y.x,v=Y.y,F=Y.width,x=Y.height;M.beginPath(),p===mn?(M.moveTo(U,v),M.lineTo(U+F,v)):p===Ug?(M.moveTo(U+F,v),M.lineTo(U+F,v+x)):p===af?(M.moveTo(U,v),M.lineTo(U,v+x)):(M.moveTo(U,v+x),M.lineTo(U+F,v+x))}M.stroke(),M.restore(),Xn(m,T)}}u._39O(M,J)}else hs.superClass._80o.call(u,M)}});var fc=function(C,Z){ml(fc,this,[C,Z])};Tr(fc,Iq,{_80o:function(c){this._39O(c,this._83o)}});var xp=function(Q,I){ml(xp,this,[Q,I])};Tr(xp,Iq,{_3O:function(){var L=this,U=L._data,X=L.s,H=L.gv,A=U.getPoints(),F=H.getBorderColor(U),y=F?X("border.width"):0,b=L.getSelectWidth(),o=X("shape.border.width"),p=U.getRect(),w=U.getAnchorRect(),e=H.getBodyColor(U),I=L._99o=A.isEmpty()?t:{rect:p,rotation:U.getRotation(),fillRule:X("shape.fill.rule"),scale:U.getScale(),position:U.p(),points:A,segments:U.getSegments(),bodyColor:e,borderColor:F,borderWidth:y,_94o:X("shape.border.3d"),_95o:X("shape.border.3d.color"),_96o:X("shape.border.3d.accuracy"),_97o:b?L.getSelectColor():t,selectWidth:b,_53o:X("shape.background"),_27Q:ir(X("shape.repeat.image"),e),shapeGradientPack:X("shape.gradient.pack"),_54o:o,_55o:X("shape.border.color"),shapeGradient:X("shape.gradient"),_59o:X("shape.gradient.color"),_60o:X("shape.border.pattern"),_61o:X("shape.border.cap"),_62o:X("shape.border.join"),shapeForeground:X("shape.foreground"),gray:X("2d.gray")};if(I){w.x+=I.position.x,w.y+=I.position.y,I.gradientRect=w;var k=U.getScale(),m=q(1,q(c(k.x),c(k.y)));X("shape.dash")&&X("shape.dash.width")>o&&(o=X("shape.dash.width"));var z,d=X("shape.border.width.absolute");z=d?(o+y+b)/L.gv._zoom/m:o*("square"===I._61o?.71:.5)+y+b/L.gv._zoom/m,z&&(z*=m,p=kr(p),hl(p,z,I._62o)),L._68o(p);var _=X("clip.percentage");1>_&&(0>_&&(_=0),I.clipRect=Mg(U.getAnchorRect(),X("clip.direction"),_));var K=X("shape.fill.clip.percentage");1>K&&(0>K&&(K=0),I.shapeClipRect=Mg(U.getAnchorRect(),X("shape.fill.clip.direction"),K));var x=X("shape.foreground.clip.percentage");1>x&&(0>x&&(x=0),I.shapeForegroundClipRect=Mg(U.getAnchorRect(),X("shape.foreground.clip.direction"),x))}},getPosition:function(h,s,K,e){var l=this._99o;if(l){var S=Tf(h,l.rect,e);return S.x+=s,S.y+=K,S}return xq},_42:function(U){this._99o&&xp.superClass._42.call(this,U)},_80o:function(W){var M,u=this,f=u.s,I=u._99o,g=I.position,R=I.scale,O=I.rotation,z=I.borderWidth,Y=I.selectWidth/u.gv._zoom,j=I._27Q,_=I.shapeGradientPack,C=I._54o,l=I.clipRect,m=I.shapeClipRect,X=I.points,G=I.segments,T=u._data.isClosePath(),y=I.fillRule,c=I.gray,p=function(k){return c?Q.toGrayColor(k):k},i=p(I._53o),v=i||j||_;W.save(),_h(W,g.x,g.y),Pp(W,O),ri(W,R.x,R.y),l&&(W.beginPath(),W.rect(l.x,l.y,l.width,l.height),W.clip()),v&&m&&(W.save(),W.beginPath(),W.rect(m.x,m.y,m.width,m.height),W.clip()),_h(W,-g.x,-g.y);var k=I._60o,d=Wp(W,k),o=W.lineJoin,n=W.lineCap;W.lineJoin=I._62o,W.lineCap=I._61o;var S=p(I.bodyColor);v?(ps(W,X,G,T),_?Hm(W,_):j?hd(W,j,S,null,u._data,u.gv):(M=S?S:i,Se(W,M,I.shapeGradient,p(I._59o),I.gradientRect)),W.fill(y),m&&(W.restore(),_h(W,-g.x,-g.y)),_&&W.restore(),d!==W&&ps(d,X,G,T)):ps(d,X,G,T);var J=I.shapeForeground;if(J){W.save();var F=I.shapeForegroundClipRect;F&&(_h(W,g.x,g.y),W.beginPath(),W.rect(F.x,F.y,F.width,F.height),W.clip(),_h(W,-g.x,-g.y)),ps(W,X,G,T),Se(W,J,f("shape.foreground.gradient"),p(f("shape.foreground.gradient.color")),I.gradientRect),W.fill(y),W.restore()}var t=f("shape.border.width.absolute");if(t&&(W.save(),W.setTransform(1,0,0,1,0,0)),Y&&(W.strokeStyle=I._97o,W.lineWidth=C+2*(z+Y),W.stroke()),z&&(W.strokeStyle=p(I.borderColor),W.lineWidth=C+2*z,W.stroke()),C&&(M=p(I._55o),!i&&S&&(M=S),W.strokeStyle=M,W.lineWidth=C,W.stroke(),I._94o&&lp(W,M,p(I._95o),C,u.gv._zoom,I._96o)),Xn(W,k),f("shape.dash")){var U=f("shape.dash.width")||C;if(U>0){k=f("shape.dash.pattern");var d=Wp(W,k,u._2Q("shape.dash.offset"));d!==W&&ps(d,X,G,T),u._1Q(W,"shape",U,k)}}t&&W.restore(),W.lineJoin=o,W.lineCap=n,W.restore()},_48O:function(){},_47O:function(){}});var Rb=function(x,K){ml(Rb,this,[x,K])};Tr(Rb,xp,{getRotation:function(X,t,K){X=X||0;var w=this._data.getPoints(),Z=w.size();return Z>1?Ig[K]?Z&&0===Z%2?On(w.get(Z/2-1),w.get(Z/2),t,X):X:ug[K]?On(w.get(0),w.get(1),t,X):On(w.get(Z-2),w.get(Z-1),t,X):X},getPosition:function(h,k,r,e,$){var U=this._data.getPoints(),b=U.size();if(b>1){if(Ig[h]){var N=b%2;if(0===N)return po(U.get(b/2-1),U.get(b/2),h,k,r,e,$);var g=U.get((b-N)/2),o={x:g.x,y:g.y,width:0,height:0};return g=Tf(h,o,e),g.x+=k,g.y+=r,g}return ug[h]?po(U.get(0),U.get(1),h,k,r,e,$):po(U.get(b-2),U.get(b-1),h,k,r,e,$)}return xq}});var Je=function(p,w){ml(Je,this,[p,w])};Tr(Je,Iq,{_3O:function(){var Y=this;Je.superClass._3O.call(Y);var d=Y.s,h=Y._83o;Y._82o=h.img||h.shape?t:{background:Y.getBodyColor("grid.background"),depth:d("grid.depth"),rect:h.rect,_88o:d("grid.cell.depth"),cellBorderColor:d("grid.cell.border.color"),_89o:d("grid.row.count"),_90o:d("grid.column.count"),block:d("grid.block"),_91o:d("grid.block.color"),_92o:d("grid.block.padding"),_93o:d("grid.block.width")}},_80o:function(n){var Z=this,e=Z._82o;if(!e)return Je.superClass._80o.call(Z,n),void 0;var S,r,B=Z._data,G=e.background,p=e.rect,H=e.block,T=e._91o,X=e._92o,t=e._93o,f=e._88o,m=e.cellBorderColor,z=e._89o,K=e._90o;if(G)if(Qf(n,p.x,p.y,p.width,p.height,G),mb(n,G,e.depth,p),f)for(S=0;z>S;S++)for(r=0;K>r;r++)p=B.getCellRect(S,r),p&&mb(n,G,f,p);else if(m){for(n.beginPath(),S=0;z>S;S++)for(r=0;K>r;r++)p=B.getCellRect(S,r),p&&n.rect(p.x,p.y,p.width,p.height);n.strokeStyle=m,n.lineWidth=1,n.stroke()}if("h"===H)for(S=0;z>S;S++)p=me(B.getCellRect(S,0),B.getCellRect(S,K-1)),Wn(p,X),Lh(n,T,p.x,p.y,p.width,p.height,t);else if("v"===H)for(r=0;K>r;r++)p=me(B.getCellRect(0,r),B.getCellRect(z-1,r)),Wn(p,X),Lh(n,T,p.x,p.y,p.width,p.height,t);Z._39O(n,Z._83o)}});var ci=function(B,Y){ml(ci,this,[B,Y])};Tr(ci,Iq,{_checkEmptyRect:!1,_81o:function(){var L=this._data,Y=ci.superClass._81o.call(this),u=L.s("text");if(u!=t){var b,g,c=L.s("text.font"),v=L.s("text.align"),r=L.s("text.vAlign"),f=Rj(c,u),i=f.width,K=f.height,G=L.getAnchor(),H=L.getWidth(),U=L.getHeight();"left"===v?b=-H*G.x:"center"===v?b=-H*G.x+(H-i)/2:"right"===v&&(b=H*(1-G.x)-f.width),"top"===r?g=-U*G.y:"middle"===r?g=-U*G.y+(U-K)/2:"bottom"===r&&(g=U*(1-G.y)-f.height);var R,X=L.getMatrix();if(R=Qm([X.tf(b,g),X.tf(b+i,g),X.tf(b+i,g+K),X.tf(b,g+K)]),Y=me(Y,R),Y&&L.s("text.shadow")){var o=kr(Y);o.x+=L.s("text.shadow.offset.x"),o.y+=L.s("text.shadow.offset.y"),Wn(o,L.s("text.shadow.blur")),Y=me(Y,o)}}return Y}});var Id=Uh.Interactor=function(k){this.gv=this._graphView=k};Xg("Interactor",u,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(A){this.gv.fi(A)},setCursor:function(Y){mc||this.gv.setCursor(Y)},startDragging:function(x){var D=this;D._lastClientPoint=ad(x),D._lastLogicalPoint=D.gv.lp(x),Rr(D,x)},clearDragging:function(){var z=this;z._lastClientPoint=z._lastLogicalPoint=z._logicalPoint=t},autoScroll:function(t){return this.gv.autoScroll(t,this._lastClientPoint)}});var xo=t,md=function(d){xo.handleWindowTouchMove(d)},jb=function(_){xo.handleWindowTouchEnd(_),n(i,zm,md),n(i,as,jb),xo=t},Fb=function(W){xo.handleWindowMouseMove(W)},nm=function(v){xo.handleWindowMouseUp(v),n(i,iq,Fb),n(i,mj,nm),xo=t},yd=function(U,y){U!==xo&&(xo?mc?xo.handleWindowTouchEnd(y):xo.handleWindowMouseUp(y):mc?(b(i,zm,md),b(i,as,jb)):(b(i,iq,Fb),b(i,mj,nm)),xo=U)},Rn=function(P){var a=this;a.gv=P,a._is2d=P instanceof Uh.GraphView,a._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",zf,"wheel"].forEach(function(r){a.addListener(r)}),a.initImageResource()};Tr(Rn,Id,{enableVR:function(T){var z=this;if(!!z._vrEnable!==T)if(z._vrEnable=T,T)z.gv.vr.mp(z.onVRControllerChange,z);else if(z.gv.vr.ump(z.onVRControllerChange,z),z._vrRayPolyline){var j=z.gv.dm();j.remove(z._vrRayPolyline),j.remove(z._vrRayHitPoint),z._vrRayPolyline=w,z._vrRayHitPoint=w}},onVRControllerChange:function(p){var A=this,X=p.property,w=p.newValue,l=A.gv.vr.getController(w.id),c=l.getRay();c&&("gamepad.button.trigger"===X?"down"===w._62O?A.handle_mousedown(c):A.handleWindowMouseUp(c):"gamepad.pose"===X&&(A.handle_mousemove(c),A.handleWindowMouseMove(c)))},drawVRRay:function(q,_,F){var u,m=this,n=m.gv,i=m._vrRayPolyline,v=!1;if(i)u=m._vrRayHitPoint;else{var a=n.dm();m._vrRayPolyline=i=new Y.Polyline,m._vrRayHitPoint=u=new Y.Node,u.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),u.setAnchor3d(.5,.5,.499);var K=.2/n.vr.measureOflength;u.s3(K,K,K),i.s("intersect",!1),u.s("intersect",!1),a.add(i),a.add(u),v=!0}if(_){var L=F.world,I=F.worldNormal,$=L.x,g=L.y,N=L.z;i.s("shape.border.color","red"),i.setPoints([{x:q.origin.x,y:q.origin.z,e:q.origin.y},{x:$,y:N,e:g}]),u.s("3d.visible",!0),u.p3($,g,N),u.lookAtDirection([I.x,I.y,I.z],"front")}else{i.s("shape.border.color","blue");var p=new Y.Math.Vector3;p.copy(q.direction).setLength(1e3/m.gv.vr.measureOflength).add(q.origin),i.setPoints([{x:q.origin.x,y:q.origin.z,e:q.origin.y},{x:p.x,y:p.z,e:p.y}]),u.s("3d.visible",!1)}n.fi({kind:"vrRayIntersect",ray:q,data:_,intersect:F,polyline:i,hitNode:u,begin:v})},setPreventEventDefault:function(N,f){var q=this,S=q._eventListeners[N];S?S._prevent=f:q._eventListeners[N]=S={_removal:w,_prevent:f}},removeListener:function(N){var d=this,V=d._eventListeners[N];V&&V._removal&&(V._removal(),V._removal=w)},addListener:function(E){var m=this,N=m._eventListeners[E];if(N||(m._eventListeners[E]=N={_removal:w,_prevent:!0}),!N||!N._removal){var K=function(F){N._prevent&&Q.preventDefault(F),m.disabled||("wheel"===E?qo(m,F):m["handle_"+E](F))};b(m.gv.getView(),E,K),N._removal=function(){n(m.gv.getView(),E,K)}}},handleWindowTouchMove:function(i){this.handleWindowMouseMove(i)},handleWindowMouseMove:function(Z){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",Z):(this.handleDownInfo("onBeginDrag",Z),this.isDragging=!0))},handleWindowTouchEnd:function(H){this.handleWindowMouseUp(H)},handleWindowMouseUp:function(y){if(this.isDragging&&(this.handleDownInfo("onEndDrag",y),this.isDragging=!1),this.downInfo){var P=this.handle("onUp",y);if(P&&P.data===this.downInfo.data){this.handleMissingUp(y);var E=this,U=2===y.button?"onContextMenu":"onClick";if(!E._dbclickTimer)return E._dbclickTimer=Z(function(){delete E._dbclickTimer,E.handleClick(y,U,P),this.downInfo=t},Q.clickDelay),void 0;o(E._dbclickTimer),delete E._dbclickTimer,U="onDoubleClick",E.handleClick(y,U,P)}else this.handleDownInfo("onUp",y);this.downInfo=t}},handle_mouseleave:function(o){var V=this,g=V.gv,_=V.currentInfo?V.currentInfo.data:t;if(_){_.s("onLeave")&&_.s("onLeave")(o,_,g),V.fire("data","onLeave",o,_);var W=V.currentInfo?V.currentInfo.hits:t;if(W)for(var I in W)V.handleLeave(o,I);V.currentInfo=t}},handle_mousewheel:function(t){t.scrollDelta=t.wheelDelta/40,this.handle("onScroll",t)},handle_DOMMouseScroll:function(o){o.scrollDelta=2===o.axis?-o.detail:0,this.handle("onScroll",o)},handle_touchstart:function(y){this.handle_mousedown(y)},handle_touchmove:function(k){this.handle("onMove",k)},handle_mousedown:function(p){this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downInfo=this.handle("onDown",p),this.downInfo&&yd(this,p)},handle_mousemove:function(W){var F=this,h=F.gv;F._hoverTimer&&(o(F._hoverTimer),delete F._hoverTimer);var V,z,T,G=F.handle("onMove",W),X=this.currentInfo?this.currentInfo.data:t,f=this.currentInfo?this.currentInfo.hits:t;if(G&&(z=G.data,T=G.hits,F._hoverTimer=Z(function(){o(F._hoverTimer),delete F._hoverTimer,F.handle("onHover",W,G)},h.getHoverDelay()||Q.hoverDelay)),z!==X){if(X&&(X.s("onLeave")&&X.s("onLeave")(W,X,h),this.fire("data","onLeave",W,X)),z&&(z.s("onEnter")&&z.s("onEnter")(W,z,h),this.fire("data","onEnter",W,z)),f)for(V in f)this.handleLeave(W,V);if(T)for(V in T){var g=T[V],d=z._interactPrefix=g.prefix,I=d&&z.a(d+"onEnter")||g.target.onEnter;I&&I.call(g.target,W,z,h,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g),z._interactPrefix=null}}else{if(f)for(V in f)T&&T[V]||this.handleLeave(W,V);if(T)for(V in T)if(!f||!f[V]){var g=T[V],d=z._interactPrefix=g.prefix,I=d&&z.a(d+"onEnter")||g.target.onEnter;I&&I.call(g.target,W,z,h,g.point,g.width,g.height),this.fire(g.type,"onEnter",g.event,g.data,g.image,g.comp,g.point,g),z._interactPrefix=null}}this.currentInfo=G},handle:function(l,v,B){var G,K=this,_=K.gv;if(K._is2d){if(B=B||_.getDataInfoAt(v),!B||!_.isInteractive(B.data))return;if(G=B.ui.interactiveInfo){var j,k=B.data;if(k.s(l)&&k.s(l)(v,k,_),this.fire("data",l,v,k),"body"===B.part&&G.bodyInfo)j="body",B.hits=this.handleImage(j,_.getImage(k),l,v,k,B.point,G.bodyInfo);else if("icons"===B.part&&G._38o){var r=G._38o[B.name];r&&r[B.index]&&(j="icons|"+B.name+"|"+B.index,B.hits=this.handleImage(j,B.icon,l,v,k,B.point,r[B.index]))}}return B}var k,z;if(!B)if(v&&v instanceof Y.Math.Ray){var a=_.vr.intersectWorld(v);if(k=a.data,z=a.intersect,K.drawVRRay(v,k,z),!k)return;var y=_.getData3dUI(k);if(G=y.interactiveInfo,!G)return;B={data:k,part:z.part,ui:y}}else{if(B=_.getDataInfoAt(v),!B)return;B&&(B={data:B.data,part:B.part})}if(_.isInteractive(B.data)){if(!z){k=B.data;var y=_.getData3dUI(k);if(B.ui=y,G=y.interactiveInfo,!G)return B;if(z=_.intersectObject(v,k),!z)return}k.s(l)&&k.s(l)(v,k,_),this.fire("data",l,v,k);var J,P=z.part;return"body"!==P&&(J=k.s(P+".image")||k.s("shape3d."+P+".image")),J||(J=k.s("all.image")||k.s("shape3d.image")),G="object"==typeof J?G[J.uuid]:G[J],G&&G.bodyInfo?(B.part="body",B.interactiveInfo=G,B.point=this._convertUVToPoint(z.uv,G),B.image=J,B.hits=this.handleImage("body",J,l,v,k,B.point,G.bodyInfo),B):B}},_handleLeaveOrMissing:function(L,O,B){var N="leave"===L?this.currentInfo:this.downInfo;if(N){var k=N.interactiveInfo||N.ui.interactiveInfo;if(k){var F,K,G=N.data;if(this._is2d){if(K=this.gv.lp(O),"body"===N.part&&k.bodyInfo)F="body","leave"===L?this.handleLeaveImage(B,F,this.gv.getImage(G),O,G,K,k.bodyInfo):this.handleMissingUpImage(F,this.gv.getImage(G),O,G,K,k.bodyInfo);else if("icons"===N.part&&k._38o){var Y=k._38o[N.name];Y&&Y[N.index]&&(F="icons|"+N.name+"|"+N.index,"leave"===L?this.handleLeaveImage(B,F,N.icon,O,G,K,Y[N.index]):this.handleMissingUpImage(F,N.icon,O,G,K,Y[N.index]))}}else{if(!k.bodyInfo)return;var Q=this.gv.intersectObject(O,G);K=Q&&Q.uv?this._convertUVToPoint(Q.uv,k):{x:1/0,y:1/0},"leave"===L?this.handleLeaveImage(B,"body",N.image,O,G,K,k.bodyInfo):this.handleMissingUpImage("body",N.image,O,G,K,k.bodyInfo)}}}},handleClick:function(_,n,R){var K=this,U=this.downInfo;if(U&&R){var W,q=R.interactiveInfo||R.ui.interactiveInfo,l=R.data,t=this.gv;if(l.s(n)&&l.s(n)(_,l,t),K.fire("data",n,_,l),q)if(this._is2d){if(U.part===R.part){var w=t.lp(_);"body"===R.part&&q.bodyInfo&&(W="body",this.handleClickImage(W,t.getImage(l),n,_,l,w,q.bodyInfo,R))}}else{if(!q.bodyInfo)return;var V=t.intersectObject(_,l);if(!V)return;w=this._convertUVToPoint(V.uv,q),this.handleClickImage("body",U.image,n,_,l,w,q.bodyInfo,R)}}},handleDownInfo:function(I,t){if(this.downInfo){var Q=this.downInfo,l=this.gv,O=Q.interactiveInfo||Q.ui.interactiveInfo;if(O){var _,x=Q.data;if(x.s(I)&&x.s(I)(t,x,l),this.fire("data",I,t,x),this._is2d){var $=l.lp(t);if("body"===Q.part&&O.bodyInfo)_="body",this.handleDownInfoImage(_,l.getImage(x),I,t,x,$,O.bodyInfo);else if("icons"===Q.part&&O._38o){var F=O._38o[Q.name];F&&F[Q.index]&&(_="icons|"+Q.name+"|"+Q.index,this.handleDownInfoImage(_,Q.icon,I,t,x,$,F[Q.index]))}}else{if(!O.bodyInfo)return;var C=l.intersectObject(t,x);if(!C)return;$=this._convertUVToPoint(C.uv,O),this.handleDownInfoImage("body",Q.image,I,t,x,$,O.bodyInfo)}}}},fire:function(m,O,t,T,F,_,W,i){this.gv.fi({kind:O,type:m,event:t,data:T,image:F,comp:_,view:this.gv,point:W,width:i?i.width:w,height:i?i.height:w})},handleImage:function(o,O,L,I,X,n,T){var v={};if(O&&(O=ir(O))){var $=this.gv,u=T.rect,i=this.convertPoint(n,T);i.inRect&&(O[L]&&O[L](I,X,$,i,u.width,u.height),this.fire("image",L,I,X,O,w,i,u),v[o+"|image"]={target:O,type:"image",image:O,data:X,event:I,point:i,width:u.width,height:u.height});for(var K=T.compInfos,m=O,A=K.length-1;A>=0;A--){var V=K[A],s=V.comp;if(i=this.convertPoint(n,V,m,s,$,X),i.inRect){u=V.rect;var N=X._interactPrefix=V.prefix,h=N&&X.a(N+L)||s[L];h&&h.call(s,I,X,$,i,u.width,u.height),this.fire("comp",L,I,X,O,s,i,u),(O=u.image)&&(O[L]&&O[L](I,X,$,i,u.width,u.height),this.fire("image",L,I,X,O,w,i,u)),X._interactPrefix=null,v[o+"|"+A]={target:s,type:"comp",comp:s,image:O,data:X,event:I,point:i,width:u.width,height:u.height,prefix:N},O&&(v[o+"|"+A+"|image"]={target:O,type:"image",image:O,data:X,event:I,point:i,width:u.width,height:u.height,prefix:N})}}}return v},handleLeave:function(X,I){return this._handleLeaveOrMissing("leave",X,I)},handleMissingUp:function(N){return this._handleLeaveOrMissing("missing",N)},handleLeaveImage:function(r,B,y,G,m,h,u){if(y&&(y=ir(y))){var O=this.gv,z=u.rect,$=this.convertPoint(h,u);r===B+"|image"&&(y.onLeave&&y.onLeave(G,m,O,$,z.width,z.height),this.fire("image","onLeave",G,m,y,w,$,z));for(var W=u.compInfos,P=y,D=W.length-1;D>=0;D--){var Q=W[D],l=Q.comp;$=this.convertPoint(h,Q,P,l,O,m),z=Q.rect;var S=m._interactPrefix=Q.prefix;if(r===B+"|"+D){var M=S&&m.a(S+"onLeave")||l.onLeave;M&&M.call(l,G,m,O,$,z.width,z.height),this.fire("comp","onLeave",G,m,y,l,$,z)}(y=z.image)&&r===B+"|"+D+"|image"&&(y.onLeave&&y.onLeave(G,m,O,$,z.width,z.height),this.fire("image","onLeave",G,m,y,w,$,z)),m._interactPrefix=null}}},handleMissingUpImage:function(f,h,b,R,X,d){var u="onUp",N=this.downInfo.hits;if(N&&h&&(h=ir(h))){var K=this.gv,x=d.rect,Q=this.convertPoint(X,d);!Q.inRect&&N[f+"|image"]&&(h[u]&&h[u](b,R,K,Q,x.width,x.height),this.fire("image",u,b,R,h,w,Q,x));for(var A=d.compInfos,U=h,W=A.length-1;W>=0;W--){var F=A[W],r=F.comp;if(Q=this.convertPoint(X,F,U,r,K,R),!Q.inRect){x=F.rect;var n=R._interactPrefix=F.prefix;if(N[f+"|"+W]){var j=n&&R.a(n+u)||r[u];j&&j.call(r,b,R,K,Q,x.width,x.height),this.fire("comp",u,b,R,h,r,Q,x)}(h=x.image)&&N[f+"|"+W+"|image"]&&(h[u]&&h[u](b,R,K,Q,x.width,x.height),this.fire("image",u,b,R,h,w,Q,x)),R._interactPrefix=null}}}},handleDownInfoImage:function(B,R,_,C,S,c,L){var s=this.downInfo.hits;if(s&&R&&(R=ir(R))){var m=this.gv,E=L.rect,b=this.convertPoint(c,L);s[B+"|image"]&&(R[_]&&R[_](C,S,m,b,E.width,E.height),this.fire("image",_,C,S,R,w,b,E));for(var p=L.compInfos,i=R,f=p.length-1;f>=0;f--){var J=p[f],A=J.comp;b=this.convertPoint(c,J,i,A,m,S),E=J.rect;var P=S._interactPrefix=J.prefix;if(s[B+"|"+f]){var Q=P&&S.a(P+_)||A[_];Q&&Q.call(A,C,S,m,b,E.width,E.height),this.fire("comp",_,C,S,R,A,b,E)}(R=E.image)&&s[B+"|"+f+"|image"]&&(R[_]&&R[_](C,S,m,b,E.width,E.height),this.fire("image",_,C,S,R,w,b,E)),S._interactPrefix=null}}},handleClickImage:function(A,M,G,C,t,h,j,z){var p=this.downInfo.hits,$=z.hits;if(p&&M&&(M=ir(M))){var k=this.gv,L=j.rect,Y=this.convertPoint(h,j);p[A+"|image"]&&(M[G]&&M[G](C,t,k,Y,L.width,L.height),this.fire("image",G,C,t,M,w,Y,L));for(var O=j.compInfos,W=M,i=O.length-1;i>=0;i--){var K=O[i],m=K.comp;Y=this.convertPoint(h,K,W,m,k,t),L=K.rect;var B=t._interactPrefix=K.prefix;if(p[A+"|"+i]&&$[A+"|"+i]){var f=B&&t.a(B+G)||m[G];f&&f.call(m,C,t,k,Y,L.width,L.height),this.fire("comp",G,C,t,M,m,Y,L)}(M=L.image)&&p[A+"|"+i+"|image"]&&(M[G]&&M[G](C,t,k,Y,L.width,L.height),this.fire("image",G,C,t,M,w,Y,L)),t._interactPrefix=null}}},initImageResource:function(){Q.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(v,n){if(!v)return{x:1/0,y:1/0};var h=n.bodyInfo.rect,b=v.clone(),y=v.multiply({x:h.width,y:h.height});return y.local=b,y},convertPoint:function(x,l,B,F,W,I){var e=l.rect,S=l.matrix.applyInverse(x).sub(e),K=S.x>=0&&S.y>=0&&S.x<=e.width&&S.y<=e.height;if(!K)return S;if(F&&bf(F.pixelPerfect,I,W)){var e,m=1;this._is2d?(m=W.getZoom(),e=gb(x.x,x.y,w,m)):e=gb(x.x,x.y);var j=!1,U=e.x,p=e.y,n=e.width,V=e.height,$=Q.hitMaxArea,s=n*V*m*m;if(s>$){var J=Math.sqrt($/s);m*=J}n*=m,V*=m,2>n&&(n=2),2>V&&(V=2),U*=m,p*=m;var R=wq(n,V);if(W._drawForChecking=!0,_h(R,-U,-p),R.scale(m,m),this._is2d){var H=W.getDataUI(I),C=H.interactiveInfo;H.interactiveInfo=null;var o=B.comps;B.comps=[F],W.drawData(R,I),B.comps=o,H.interactiveInfo=C}else{var o=B.comps;B.comps=[F];var H=W.getData3dUI(I);qc(R,B,0,0,x.x/x.local.x,x.y/x.local.y,I,W),B.comps=o}W._drawForChecking=!1;try{for(var r=0,i=R.getImageData(0,0,n,V).data;r<i.length;r+=4)if(0!==i[r+3]){j=!0;break}R.restore()}catch(L){xk=t,j=!1}S.inRect=j}else S.inRect=!0;return S}});var Xd=Uh.DefaultInteractor=function(J){ml(Xd,this,[J])};Xg("DefaultInteractor",Id,{handle_mousedown:function(M){Hc(M);var Y=this,U=Y.gv,K=U.getDataAt(M);if(U.setFocus(M)&&!U._editing&&!U._scrolling){fo(M)?U.handleDoubleClick(M,K):U.handleClick(M,K);var J=He(M);!Kb()&&!J&&K&&(U.isMovable(K)||U._39Q(K))||!U.isPannable()||!Ir(M)&&!J||Sf(M)||(Y._tx=U.tx(),Y._ty=U.ty(),Y.startDragging(M))}},handleWindowMouseUp:function(_){var P=this,C=P.gv;C._panning&&(delete C._panning,C.onPanEnded(),P.fi({kind:"endPan",event:_})),delete P._tx,delete P._ty,P.clearDragging()},handle_mousemove:function(u){var e=this,d=e.gv;e._hoverTimer&&(o(e._hoverTimer),delete e._hoverTimer),e._hoverTimer=Z(function(){e.fi({kind:"hover",event:u}),o(e._hoverTimer),delete e._hoverTimer},d.getHoverDelay()||Q.hoverDelay)},handle_touchmove:function(o){this.handle_mousemove(o)},handleWindowMouseMove:function(x){var h=this,D=h.gv;h.fi({kind:D._panning?"betweenPan":"beginPan",event:x}),D._panning=1;var Y=Ub(D,x,h._lastClientPoint);D.setTranslate(h._tx+Y.x,h._ty+Y.y)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta)},handle_DOMMouseScroll:function(x){2===x.axis&&this.gv.handleScroll(x,-x.detail)},handle_keydown:function(_){this.gv.handleKeyDown(_)}});var Rc=Uh.SelectInteractor=function(p){ml(Rc,this,[p])};Xg("SelectInteractor",Id,{_42:function(){var i=this,b=i.gv,X=b.getZoom(),w=i.mark,n=i.div;n||(n=i.div=wc(),zg(i.getView(),n));var d={};d.x=w.x*X+b.tx(),d.y=w.y*X+b.ty(),d.width=w.width*X,d.height=w.height*X,Km(n,d),this.intersects()?(n.style.border="",n.style.background=b.getRectSelectBackground()):(n.style.background="",n.style.border="1px solid "+b.getRectSelectBorderColor())},handle_mousedown:function($){var X=this,_=X.gv;if(X._57I=t,X.pendingClickThrough=t,!(_._editing||_._scrolling||Kb()||He($))){var U=_.getDataAt($),L=_.sm();U?Sf($)?L.co(U)?L.rs(U):L.as(U):L.co(U)?U instanceof aq&&U.isClickThroughEnabled()&&Ir($)&&(X.pendingClickThrough=ad($)):L.ss(U):Sf($)||!_.isPannable()?Ir($)&&(Sf($)||L.cs(),_.isRectSelectable()&&(X.startDragging($),_._77O=1)):Ir($)&&(X._57I=ad($))}},handle_mouseup:function(x){var B=this,u=B.gv,V=B._57I;if(V&&(ro(V,ad(x))<=1&&u.sm().cs(),B._57I=t),B.pendingClickThrough){if(ro(B.pendingClickThrough,ad(x))<=1){var H=u.getDataAt(x);if(H instanceof aq&&H.isClickThroughEnabled()){var s=u.getDataAt(x,function(Y){var h=Y.getParent()===H&&u.isSelectable(Y,!0);return h});s&&(x.clickThrough=!0,u.sm().ss(s))}}B.pendingClickThrough=t}},handleWindowMouseUp:function(o){this.clear(o)},handleWindowMouseMove:function(c){var M=this,I=M.gv;M._logicalPoint=I.lp(c),M.mark?(M.fi({kind:"betweenRectSelect",event:c}),I.isPannable()&&M.autoScroll(c),M.redraw()):M.fi({kind:"beginRectSelect",event:c}),M.mark=Qm(M._lastLogicalPoint,M._logicalPoint),M.redraw()},intersects:function(){var Y=this,g=Y._lastLogicalPoint,w=Y._logicalPoint;return g.x>w.x||g.y>w.y},clear:function(r){var h=this,U=h.gv,s=h.mark;if(h._57I=t,h.pendingClickThrough=t,h._lastLogicalPoint){if(s){if(0!==s.width&&0!==s.height){var f=U.getDatasInRect(s,h.intersects());
if(!f.isEmpty()){var y=U.sm(),$=y.toSelection();f.each(function(u){y.co(u)?$.remove(u):$.add(u)}),y.ss($)}}ig(h.div),delete h.div,delete h.mark,h.redraw(),h.fi({kind:"endRectSelect",event:r}),U.onRectSelectEnded()}h.clearDragging(),delete U._77O}},redraw:function(){var j=this;j._draw||(j._draw=1,Z(function(){j.mark&&j._42(),delete j._draw},16))}});var pb=Uh.MoveInteractor=function(B){ml(pb,this,[B])};Xg("MoveInteractor",Id,{handle_mousedown:function(l){var U=this,w=U.gv;if(Ir(l)&&!w._editing&&!w._scrolling&&!Kb()){var i=w.getSelectedDataAt(l);!i||w._39Q(i)&&!w.isMovable(i)?w._focusData=t:(U._data=i,w.handleMouseDown&&w.handleMouseDown(l,i),U.startDragging(l),w.isMovable(i)&&(w._moving=1))}},handleWindowMouseUp:function(W){var h=this,L=h.gv;L.handleMouseUp&&L.handleMouseUp(W,h._data),h.clear(W)},handleWindowMouseMove:function(t){var r=this,y=r._data,$=r.gv;if((!$._93O||!$._93O(t,y))&&$._moving){r._logicalPoint||r.fi({kind:"prepareMove",event:t});var b=r._logicalPoint?"betweenMove":"beginMove",l={kind:b,event:t},V=r._logicalPoint=$.lp(t);"beginMove"!==b||r._alreadyBeginTransaction||(r._alreadyBeginTransaction=!0,$.getDataModel().beginTransaction());var q=r._calcShift(b,t),H=q.x,S=q.y,j=r.gv.getMoveMode(t,y);j&&("x"===j?S=0:"y"===j?H=0:"xy"!==j&&(H=S=0)),$.moveSelection(H,S),r._lastLogicalPoint=V,r.autoScroll(t),r.fi(l)}},_calcShift:function(){var l=this,N=l._logicalPoint,f=l._lastLogicalPoint,r=N.x-f.x,A=N.y-f.y;return{x:r,y:A}},clear:function(O){var g=this,v=g.gv;g._lastLogicalPoint&&(g._lastLogicalPoint=g._data=v._moving=t,g._logicalPoint&&(g.fi({kind:"endMove",event:O}),v.onMoveEnded()),g.clearDragging()),g._alreadyBeginTransaction&&(g._alreadyBeginTransaction=!1,v.getDataModel().endTransaction())}});var yl=Uh.TextEditInteractor=function(l){ml(yl,this,[l]),this.init()};Xg("TextEditInteractor",Id,{init:function(){var P=this,o=this.input=l.createElement("input"),K=o.style;o.text="text",K.border="1px solid #d8d8d8",K.position="absolute",K.padding="2px 3px",K.outline="none",K.marginLeft="-90px",K.marginTop="-16px",K.backgroundColor="rgba(255,255,255, 0.9)",K.fontSize="14px",K.width="180px",K.height="32px",K.boxShadow="0 0 13px rgba(16,142,233, 0.5)",K.textAlign="center",K.boxSizing="border-box",b(o,"keyup",function(X){sf(X)&&P.endTextEdit()}),b(o,"focus",function(){o.select()});var t=this.textarea=l.createElement("textarea"),r=this.wrap=l.createElement("div");r.appendChild(t),K=t.style,K.margin=0,K.padding="4px",K.overflow="hidden",K.boxSizing="border-box",K.position="absolute",K.outline="none",K.backgroundColor="transparent",K.resize="none",K.textAlign="center",K.fontSize="14px",K.border="none",K.borderWidth=0,K.width="100%",K.top="50%",K=r.style,K.boxSizing="border-box",K.margin=0,K.padding=0,K.position="absolute",K.boxShadow="0 0 13px rgba(16,142,233, 0.5)",K.border="1px solid #d8d8d8",K.backgroundColor="rgba(255,255,255, 0.9)",K.width="180px",K.marginLeft="-90px",b(t,"keydown",function(x){return(Dc()||Sf())&&sf(x)?(P.endTextEdit(),void 0):(P.calculateTextareaHeight(String.fromCharCode(x.keyCode)),void 0)}),b(t,"focus",function(){t.select()});var g=function($){$.stopPropagation()};b(o,"mousedown",g),b(o,"touchstart",g),b(t,"mousedown",g),b(t,"touchstart",g),P.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],P.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",P.handleWindowClick=function(y){var e=P._editingDOM;if(e){var K=e.getBoundingClientRect(),S=ad(y);Mf(K,S)||P.endTextEdit()}}},handle_mousedown:function(l){var J=this,Q=J.gv;if(fo(l)&&!Q._editing){var c=Q.getDataAt(l);if(c){var V=Q.getTextEditInfo(c);V&&(this._editInfo=V,this._editTarget=c,Q._editing=!0,V.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var n=this,p=n.gv,F=n._editTarget,k=n.getTargetValue(),B=n.textarea,x=n.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===k||k===w)&&(k=""),B.value=k,n._editingDOM=B,p.getView().appendChild(x),this.layoutHTML(x,F),this.calculateTextareaHeight(),Z(function(){B.focus(),b(i,"mousedown",n.handleWindowClick),b(i,"touchstart",n.handleWindowClick)},10)},handleTextEdit:function(){var G=this,h=G.gv,j=G._editTarget,N=G.getTargetValue(),d=G.input;(null===N||N===w)&&(N=""),d.value=N,G._editingDOM=d,h.getView().appendChild(d),this.layoutHTML(d,j),Z(function(){d.focus(),b(i,"mousedown",G.handleWindowClick),b(i,"touchstart",G.handleWindowClick)},10)},layoutHTML:function(H,z){var s=this.gv,V=s.getZoom();if(z instanceof Y.Node){var M=z.getRect();H.style.left=(M.x+M.width/2)*V+s.tx()+"px",H.style.top=(M.y+M.height/2)*V+s.ty()+"px"}else if(z instanceof Y.Edge){var B=s.getDataUI(z),M=B._6I;H.style.left=(M.x+M.width/2)*V+s.tx()+"px",H.style.top=(M.y+M.height/2)*V+s.ty()+"px"}},endTextEdit:function(){var r=this,S=r._editInfo.isMultiline?r.wrap:r.input,H=r._editInfo.isMultiline?r.textarea:r.input;r.setTargetValue(H.value),r.gv.getView().removeChild(S),r.gv._editing=!1,delete r._editingDOM,n(i,"mousedown",r.handlelick),n(i,"touchstart",r.handleWindowClick)},setTargetValue:function(c){var A=this,q=A._editTarget,y=A._editInfo,D=y.accessType,Q=y.name;if(Q&&D||(D="p",Q="name"),"p"===D){var v=Y.Default.setter(Q);q[v](c)}else"a"===D?q.a(Q,c):q.s(Q,c)},getTargetValue:function(){var M=this,E=M._editTarget,r=M._editInfo,q=r.accessType,s=r.name;if(s&&q||(q="p",s="name"),"p"===q){var z=Y.Default.getter(s);return E[z]()}return"a"===q?E.a(s):E.s(s)},createHiddenTextarea:function(){this.hiddenTextarea=l.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(q,P){if(P&&this.computedStyleCache)return this.computedStyleCache;var R=this,w=i.getComputedStyle(q),Q=w.getPropertyValue("box-sizing")||w.getPropertyValue("-moz-box-sizing")||w.getPropertyValue("-webkit-box-sizing"),H=parseFloat(w.getPropertyValue("padding-bottom"))+parseFloat(w.getPropertyValue("padding-top")),M=parseFloat(w.getPropertyValue("border-bottom-width"))+parseFloat(w.getPropertyValue("border-top-width")),m=R.SIZING_STYLE.map(function(y){return y+":"+w.getPropertyValue(y)}).join(";"),Z={sizingStyle:m,paddingSize:H,borderSize:M,boxSizing:Q};return P&&(this.computedStyleCache=Z),Z},calculateTextareaHeight:function(j){j=j||"";var V=this,M=V.textarea,T=V.hiddenTextarea,u=V.wrap,y=32,E=V.calculateHTMLStyle(M,!1),h=E.paddingSize,q=E.borderSize,J=E.boxSizing,X=E.sizingStyle;T.setAttribute("style",X+";"+V.HIDDEN_TEXTAREA_STYLE),T.value=M.value+j;var _=T.scrollHeight;"border-box"===J?_+=q:"content-box"===J&&(_-=h),M.style.height=_+"px",M.style.marginTop=0-.5*_+"px",u.style.height=Math.max(_,y)+"px",u.style.marginTop=_*-.5+"px"}});var lf=Uh.ScrollBarInteractor=function(s){ml(lf,this,[s])};Xg("ScrollBarInteractor",Id,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(R){var O=this.gv.getViewRect();return this._41o()&&(O.x+O.width-this.gv.lp(R).x)*this.gv.getZoom()<Ce},isH:function(Z){var P=this.gv.getViewRect();return this._40o()&&(P.y+P.height-this.gv.lp(Z).y)*this.gv.getZoom()<Ce},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(g){if(!lg&&Ir(g)&&this.gv.isScrollBarVisible()){var J=this,i=J.isV(g),w=J.isH(g);(i||w)&&J.gv.showScrollBar(),J.gv._scrolling=i||w}},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(s){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=t,this.fi({kind:"endScroll",event:s})},handle_mousedown:function($){this.handle_touchstart($)},handle_touchstart:function(P){var O=this;if(O.gv.setFocus(P),Hc(P),O.handle_touchmove(P),!(Jh(P)>1)&&O.gv._scrolling&&O.gv.isScrollBarVisible()){O._cp=ad(P),O._tx=O.gv.tx(),O._ty=O.gv.ty();var u=O.isV(P);O._state=u?"vScroll":"hScroll",Rr(O,P),O.fi({kind:"beginScroll",event:P})}},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(L){var o=ad(L),n=this.gv.getViewRect(),A=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-o.y)*A.height/n.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-o.x)*A.width/n.width),this.fi({kind:"betweenScroll",event:L})}});var jh=Uh.TouchInteractor=function(k,x){x=x||{},x.selectable===w&&(x.selectable=!0),x.movable===w&&(x.movable=!0),x.pannable===w&&(x.pannable=!0),x.pinchable===w&&(x.pinchable=!0),x.editable===w&&(x.editable=!0),this.params=x,ml(jh,this,[k])};Xg("TouchInteractor",Id,{ms_edit:1,setUp:function(){var Q=this;jh.superClass.setUp.call(Q),mc&&Q.params.editable&&Q.gv.setEditInteractor(Q)},tearDown:function(){var c=this;jh.superClass.tearDown.call(c),mc&&c.params.editable&&c.gv.setEditInteractor(t)},clear:function(l){var S=this,Z=S.gv;Z._moving&&(S.fi({kind:"endMove",event:l}),delete Z._moving,Z.onMoveEnded(),Z.dm().endTransaction()),Z._panning&&(S.fi({kind:"endPan",event:l}),delete Z._panning,Z.onPanEnded()),Z._pinching&&(S.fi({kind:"endPinch",event:l}),delete Z._pinching,Z.onPinchEnded()),Z._editing&&(S._46O(l),S._77I=S._node=S._edge=S._shape=S._rect=S._89I=S._index=Z._editing=t),S._moving=S._panning=S._pinching=S._editing=S._57I=S._data=S._beginHistory=t,S.clearDragging()},handle_touchstart:function(Q){var r=this;if(!r.gv._editing){Hc(Q),r._57I=t;var d=r.params,X=r.gv,S=X.sm(),f=X.getDataAt(Q),v=Jh(Q);if(1===v){if(fo(Q))return X.handleDoubleClick(Q,f),void 0;X.handleClick(Q,f),f&&(X.handleMouseDown&&X.handleMouseDown(Q,f),r._data=f),d.selectable||(f=t),f&&(S.co(f)||S.ss(f),d.editable&&X.isEditable(f)&&r._79I(Q,f,!0)?(r._editing=1,r.startDragging(Q)):d.movable&&X.isMovable(f)&&(r._moving=1,r.startDragging(Q))),f&&X.isMovable(f)||(r._57I=ad(Q),d.pannable&&X.isPannable()&&(r._panning=1,r.startDragging(Q),r._translate={x:X.tx(),y:X.ty()}))}else if(d.pinchable&&2===v){if(f&&X._39Q(f))return;r._pinching=1,r.startDragging(Q);var N=X.getView(),F=X.getZoom(),j=N.getBoundingClientRect(),I=Q.touches[0],T=Q.touches[1],B={x:(I.clientX+T.clientX)/2-j.left,y:(I.clientY+T.clientY)/2-j.top};B.x-=X.tx(),B.y-=X.ty(),B.x/=F,B.y/=F,r._p=B,r._d=dl(Q)}}},handle_touchend:function(u){var f=this,M=f.gv,W=f._57I,X=f._data;W&&(ro(W,ad(u))<=1&&!M.getDataAt(u)&&M.sm().cs(),f._57I=t),X&&M.handleMouseUp&&M.handleMouseUp(u,X)},handleWindowTouchEnd:function(w){this.clear(w)},handleWindowTouchMove:function(t){var A=this,S=A.gv,v=Jh(t);if(1===v){if(A._editing&&(A._beginHistory||(A._beginHistory=1,S.dm().beginTransaction()),S._editing=1,A._78I(t)),A._moving)A._beginHistory||(A._beginHistory=1,S.dm().beginTransaction()),A.handleMove(t);else if(A._panning){var o=ad(t),E=Ub(S,o,A._lastClientPoint);S.setTranslate(A._translate.x+E.x,A._translate.y+E.y),A.fi({kind:S._panning?"betweenPan":"beginPan",event:t}),S._panning=1}}else if(2===v&&A._pinching){var G=dl(t);S.handlePinch(A._p,G,A._d),A._d=G,A.fi({kind:S._pinching?"betweenPinch":"beginPinch",event:t}),S._pinching=1}},handleMove:function(I){var h=this,B=h.gv,J=B.lp(I);B._93O&&B._93O(I,h._data)||(B.moveSelection(J.x-h._lastLogicalPoint.x,J.y-h._lastLogicalPoint.y),h._lastLogicalPoint=J,h.autoScroll(I),h.fi({kind:B._moving?"betweenMove":"beginMove",event:I}),B._moving=1)}});var Y=i.ht,ym=Y.graph._editor={Math:Y.Math,Guide:{}};ym.getStyle=function(q){var O,Q=ym.StyleMap;return Q&&(O=Q[q],O!==w)?O:ym.DefaultStyleMap[q]},ym.setStyle=function(c,j){var E=ym.StyleMap;E||(E=ym.StyleMap={}),E[c]=j},ym.inEdit=function(V){return V._inXEdit===!0},ym.startEdit=function(k){k._inXEdit=!0,ym.Inject.doInject(k)},ym._46O=function(W){W._inXEdit=!1,ym.Inject.undoInject(W)},ym.toScreenPosition=function(o,W){var X=o.tx(),R=o.ty(),j=o._zoom;return new ym.Math.Vector2(W.x*j+X,W.y*j+R)},ym.checkHit=function(R,y,d){return R.distanceTo(y)<d?!0:!1},ym.toWorldPosition=function(f,J){var d=f.tx(),P=f.ty(),s=f._zoom;return{x:(J.x-d)/s,y:(J.y-P)/s}},ym.setAntialias=function(U,X){for(var y,q=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],p=0,x=q.length;x>p&&(y=q[p],!(y in U));p++);U[y],U[y]=X},ym.getTargetCornersOnScreen=function(S,c){if(!c)return null;var O,_=[];if(gs(c,S)){var z=_k(S,c);O=[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}]}else{if(!c.getCorners)return null;O=c.getCorners()}return O.forEach(function(k){var R=ym.toScreenPosition(S,k);_.push(R.x,R.y)}),_},ym.log=function(){};var il=ym.Inject={_modules:[]};il.registAsModule=function(R,B){var E={},v={};for(var N in R){var K=B.prototype[N];E[N]=K}R.getBackup=function(B){return E[B]},R.getBackups=function(){return E},v.doInject=function(){for(var E in R)"getBackup"!==E&&(B.prototype[E]=R[E])},v.undoInject=function(){for(var g in R)"getBackup"!==g&&(B.prototype[g]=E[g])},il._modules.push(v)},il.doInject=function(L){for(var Y,Z=il._modules,x=0,W=Z.length;W>x;x++)Y=Z[x],Y.doInject(L)},il.undoInject=function(t){for(var j,y=il._modules,i=0,O=y.length;O>i;i++)j=y[i],j.undoInject(t)};var Id=Y.graph.EditInteractor=function(J){var w=this,f=l.createElement("canvas");f.className="editCanvas",f.style.position="absolute",w._styleMap={},w._canvas=f,w._context=f.getContext("2d"),Id.superClass.constructor.call(w,J),this._editDetail=!1,ym.setAntialias(w._context,!1),w._subModules=[new ym.Anchor(w),new ym.RotateX(w),new ym.MoveDummy(w),new ym.Rect(w),new ym.Curve(w),new ym.MoveHelper(w)],w._gridGuide=new ym.Guide.Grid(w),w._rectGuide=new ym.Guide.Rect(w),w._hoverGuide=new ym.Guide.Hover(w)},qq=Id;Y.Default.def(Id,Y.graph.Interactor,{ms_edit:1,ms_fire:1}),u.defineProperties(Id.prototype,{editDetail:{get:function(){var L=!!this._editDetail;return L},set:function(p){var k=this,q=k._editDetail;q!==p&&(k._editDetail=p,k.gv._editing=p,k.fp("editDetail",q,p),k.fp("pointsEditingMode",q,p),k.fi({kind:p?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(g){(!this._editDetail||g)&&(this.gv._editing=g,g||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(D){this._editing=D,this.gvEditing=D}},pointsEditingMode:{get:function(){return this.editDetail},set:function(z){var m=this;m.editDetail!==z&&(z?m._tryEnterEditDetailMode():m._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var K=this._gridEnabled;if(!K)return!1;var r=this.gv;return r?!0:!0},set:function(G){G!==this._gridEnabled&&(this._gridEnabled=G,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(D){D!==this._agEnabled&&(this._agEnabled=D,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Id.prototype.getSubModule=function(O){var $,W,q,F=this._subModules;for(W=0,q=F.length;q>W;W++)if($=F[W],$.catalog===O)return $},Id.prototype.invokeSubModule=function(f,v){var i=this,y=i._subModules;if(y)for(var r,e,_,U=Array.prototype.slice.call(arguments,2),q=0,z=y.length;z>q;q++)if(r=y[q],e=r[f],e&&(_=e.apply(r,U),_!=w&&v))return r},Id.prototype.invokeSubModuleInverse=function(Y,C){var f=this,D=f._subModules;if(D)for(var F,l,Z,L=Array.prototype.slice.call(arguments,2),e=D.length-1;e>=0;e--)if(F=D[e],l=F[Y],l&&(Z=l.apply(F,L),Z!=w&&C))return F},Id.prototype.setUp=function(){ym.log("setUp");var n=this,Q=n.gv,$=Q.getView(),K=n._canvas;Id.superClass.setUp.call(n),Q.setEditInteractor(n),Q._79O?$.insertBefore(K,Q._79O):$.appendChild(K),ym.startEdit(Q),n.invokeSubModule("setUp"),Q.dm().mm(n._onDataModelChanged,n),Q.dm().md(n._onDataPropertyChanged,n)},Id.prototype.tearDown=function(){ym.log("tearDown");var K=this,i=K.gv,D=i.getView();K._resetCustomCursorStyle(),Id.superClass.tearDown.call(K),i.dm().umm(K._onDataModelChanged,K),i.dm().umd(K._onDataPropertyChanged,K),i.setEditInteractor(null),D.removeChild(K._canvas),K._drawTimer&&(o(K._drawTimer),K._drawTimer=null),ym._46O(i),K.invokeSubModule("tearDown")},Id.prototype._onDataModelChanged=function(A){var h=this;("clear"===A.kind||"remove"===A.kind&&h.editDetail&&A.data===h.getSubModule("Curve").target)&&(h.editDetail=!1,h._42())},Id.prototype._onDataPropertyChanged=function(B){var J=this;if(J.editDetail){var h=J.getSubModule("Curve"),x=B.data;x===h.target&&(x._writing||h._handleDataChanged(B))}},Id.prototype.clear=function(){ym.log("clear")},Id.prototype.redraw=function(){this._42()},Id.prototype._42=function(){var h=this;h._drawTimer||(h._drawTimer=Z(function(){h._drawTimer=null,h.drawImpl()},0))},Id.prototype.drawImpl=function(){var J;for(J in{_42:!0})break;return function(){var j=this,l=j._canvas,f=j.gv,T=f.getWidth(),K=f.getHeight(),R=j._context,U=Y.Default.getInternal(),r=i.devicePixelRatio;(l.width!==T||l.height!==K)&&U.setCanvas(l,T,K,r),R.clearRect(0,0,l.width,l.height);var g=j._getValidSelection();R.save(),R.scale(r,r),j._gridGuide._42(),j.invokeSubModuleInverse(J,!1,R,f,g),j._rectGuide._42(),j._hoverGuide._42(),R.restore()}}(),Id.prototype._getValidSelection=function(){var M=this,V=M.gv,C=V.sm().getSelection(),v=[];return C.each(function(J){V.isVisible(J)&&V.isEditable(J)&&v.push(J)}),v},Id.prototype.handle_touchmove=function(j){return this.handle_mousemove(j)},Id.prototype.handle_mousemove=function(z){if(!Y.Default.isDragging()){var K=this;if((K.editDetail||!Kb()&&!He(z))&&!K.gv._externalEditing)if(K.gvEditing=!1,K._checkEdit(z))K.gvEditing=!0;else{if(!K.getStyle("hoverGuideVisible"))return;K.hoverData=K.gv.getDataAt(z),K._42()}}},Id.prototype.handle_touchstart=function(W){return this.handle_mousedown(W)},Id.prototype.handle_mousedown=function(f){Hc(f);var k=this;if((k.editDetail||!Kb()&&!He(f))&&!k.gv._externalEditing){if(fo(f)&&!f.clickThrough){if(k.editDetail){if(k._tryQuitEditDetailMode(f))return}else if(k._tryEnterEditDetailMode())return;k.gv.dm().beginTransaction();var P=k.invokeSubModule("handleDoubleClick",!0,f);if(k.gv.dm().endTransaction(),P)return}var t=k._checkEdit(f);t&&(k._downPosition=k._getLogicalPoint(f),k.gv.dm().beginTransaction(),t.startEdit(k,f),k.editing=!0)}},Id.prototype._checkEdit=function(d){var _=this,A=_.gv,f=_._getLogicalPoint(d),o=_.invokeSubModule("check",!0,A,d,f)||null;return _._editMod=o,o},Id.prototype.handleWindowTouchMove=function(V){return this.handleWindowMouseMove(V)},Id.prototype.handleWindowMouseMove=function(n){var s=this,j=s._downPosition;if(j){var v=s._getLogicalPoint(n);if(v.distanceTo(j)<s.getStyle("moveSensitivity"))return;delete s._downPosition}var J=s._editMod;J&&J.handleEdit(s.gv,n)},Id.prototype._getLogicalPoint=function(t){var s=this,w=Y.Default.getLogicalPoint(t,s._canvas);return new ym.Math.Vector2(w)},Id.prototype.handleWindowTouchEnd=function(Q){return this.handleWindowMouseUp(Q)},Id.prototype.handleWindowMouseUp=function(){var A;for(A in{_46O:!0})break;return function(Z){var g=this;g.editing=!1,g.setCursor("default"),g.invokeSubModule(A,!1,Z),g._42(),g.gv.dm().endTransaction()}}(),Id.prototype.handle_mousewheel=function(n){var L=this;Hc(n),L.invokeSubModule("preHandleScroll",!0)||L.gv.handleScroll(n,n.wheelDelta)},Id.prototype.handleDelete=function(){var d=this;if(!d.editDetail){d.gv.dm().beginTransaction();var D=d.invokeSubModule("handleNormalStateDelete",!0);return d.gv.dm().endTransaction(),D||d.gv.removeSelection(),void 0}d.gv.dm().beginTransaction(),d.invokeSubModule("handleDelete",!0),d.gv.dm().endTransaction(),d._42()},Id.prototype.handle_keydown=function(p){var z=this;if((p.metaKey||p.ctrlKey)&&z._42(),Kb(p)&&!z.editing)return z.gvEditing=!1,z.setCursor("default"),z._42(),void 0;var $=sf(p);return z.editDetail?(($||Fd(p))&&(z.editDetail=!1,z._42()),z.gv.dm().beginTransaction(),z.invokeSubModule("handle_keydown",!0,p),z.gv.dm().endTransaction(),void 0):(z.gv.dm().beginTransaction(),z.invokeSubModule("handleNormalStateKeyDown",!0,p),z.gv.dm().endTransaction(),$&&z._tryEnterEditDetailMode(),void 0)},Id.prototype.handle_keyup=function(i){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,i),this.gv.dm().endTransaction()},Id.prototype._tryEnterEditDetailMode=function(){var i=this;return!i.editDetail&&i.invokeSubModule("canEnterEditDetailMode",!0)&&1===i._getValidSelection().length?(i.editDetail=!0,i._42(),!0):void 0},Id.prototype._tryQuitEditDetailMode=function(o){var f=this;return f.editDetail?!o||f.invokeSubModule("canQuitEditDetailMode",!0,o)?(f.editDetail=!1,f._42(),!0):!1:!1},Id.prototype.setStyle=function(T,e,F){var a=this;F?ym.setStyle(T,e):a._styleMap[T]=e,"baseColor"===T&&(Xi=e),a.fp("styleChanged",null,{key:T,value:e,base:F}),a._42()},Id.prototype.getStyle=function(H){var l=this,Q=l._styleMap[H];return Q!==w?Q:ym.getStyle(H)},Id.prototype.setCursor=function(Q){this._resetCustomCursorStyle(),Y.graph.EditInteractor.superClass.setCursor.call(this,Q)},Id.prototype._drawHostGuide=function(z){var a=this,N=a._context,V=a.gv;ym.Icons.DrawIcon(a,N,ym.Icons.NodeHoverGuide,z.corners);var M=z.host;if(M){var B=V.getAttachPoints(M);if(B&&B.length)for(var t=0,_=B.length;_>t;t++){var e=B[t],u=Nk(V,M,0,e.offsetX||0,e.offsetY||0,e.x,e.y);u=ym.toScreenPosition(V,u),u.isAttach=z.attach===t,ym.Icons.DrawIcon(a,N,ym.Icons.AttachPoint,u)}}},Id.prototype._resetCustomCursorStyle=function(){var P=this;if(P._customStyle){var g=this.gv.getView();g.classList&&g.classList.remove&&g.classList.remove(P._customStyle),P._customStyle=null}},Id.prototype._setRotateCursor=function(S){var V=this,G=V._cursorFactory;G||(G=V._cursorFactory=new ym.CursorFactory(V));var d=G.getRotateCursor(S),u=V.gv.getView();V._resetCustomCursorStyle(),V._customStyle=d,u.classList&&u.classList.add&&u.classList.add(d)};var Uf=ym.Group=function(u){var k=this;k._entities=u,k._64O=0,k._position={x:0,y:0},k._scale={x:1,y:1},k._anchor={x:.5,y:.5},k._anchor2={x:.5,y:.5}};Uf.prototype={},Uf.prototype.constructor=Uf;var Dp=null;Uf.findOrCreateGroup=function(x){if(Dp&&Dp.checkIsMe(x))return Dp;var l=new ym.Group(x);return l.getKeyOb()?(Dp=l,l):void 0},Uf.prototype.checkIsMe=function(Z){var e=this._entities;if(e.length!==Z.length)return!1;var V,F={},k=Z.length;for(V=0;k>V;V++)F[Z[V]._id]=!0;for(V=0;k>V;V++)if(!F[e[V]._id])return!1;return!0},Uf.prototype.getRotation=function(){return this._64O},Uf.prototype.getPosition=function(){return this._position},Uf.prototype.getAnchor=function(){return this._anchor},Uf.prototype.getWidth=function(){return this._width},Uf.prototype.getScale=function(){return this._scale},Uf.prototype.getSize=function(){return{width:this._width,height:this._height}},Uf.prototype.getHeight=function(){return this._height},Uf.prototype.getKeyOb=function(){for(var i=this._entities,Y=i.length-1;Y>=0;Y--){var G=i[Y];if(this.isNode(G))return G}},Uf.prototype.getAnchor2=function(){var i=this,u=i.rotateCenter;if(u)return u;var x=i.getKeyOb();if(!x)return i._anchor;var m=i._anchor2,f=x.getMatrix();return f.tf({x:x.getWidth()*(m.x-x.getAnchor().x),y:x.getHeight()*(m.y-x.getAnchor().y)})},Uf.prototype.setAnchor2=function(n,g){var L=this,Q=L.getKeyOb();if(Q){var f,Z=Q.getMatrix();f="number"==typeof n?{x:n,y:g}:n;var y=Z.tfi(f);L._anchor2={x:Q.getAnchor().x+y.x/Q.getWidth(),y:Q.getAnchor().y+y.y/Q.getHeight()}}},Uf.prototype.setRotation=function(){},Uf.prototype.beginRotate=function(Z){this.rotateCenter=Z.pos,this.rotateMode=Z.groupRotateMode},Uf.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Uf.prototype.addRotation=function(c,i,w){return"batch"===i?this._addRotationInBatchMode(c,w):"block"===i?this._addRotationInBlockMode(c,w):void 0},Uf.prototype._addRotationInBlockMode=function(y,V){var v=this,f=v.rotateCenter||v.getPosition();v._entities.forEach(function(m){if(v.isNode(m)&&(!V||V(m))){var $=m.getMatrix();$.translate(-f.x,-f.y),$.rotate(y),$.translate(f.x,f.y);var a=Math.sign(m.getScale().x);m.setRotation(r($.b*a,$.a*a)),m.setPosition($.tx,$.ty)}})},Uf.prototype._addRotationInBatchMode=function(R){var s=this,T=s._anchor2;s._entities.forEach(function(B){if(s.isNode(B)&&(!filter||filter(B))){var X=B.getAnchor(),z=B.getMatrix(),P=z.tf({x:B.getWidth()*(T.x-X.x),y:B.getHeight()*(T.y-X.y)}),F=new ym.Math.Matrix2d;F.set(z.a,z.b,z.c,z.d,z.tx,z.ty),F.translate(-P.x,-P.y),F.rotate(R),F.translate(P.x,P.y);var Q=Math.sign(B.getScale().x);B.setRotation(r(F.b*Q,F.a*Q)),B.setPosition(F.tx,F.ty)}})},Uf.prototype.setPosition=function(n){var U,h,f,T,H=this,u=H._position,v=n.x-u.x,g=n.y-u.y,j=H._entities;for(h=0,f=j.length;f>h;h++)U=j[h],wk(U)&&(T=U.getPosition(),U.setPosition(T.x+v,T.y+g));H._position=n},Uf.prototype.setScale=function(e,p){var g=this,b=e/g._scale.x,x=p/g._scale.y;g._adjustChildScaleOrSize(b,x,"size"),g._scale={x:e,y:p}},Uf.prototype.getRect=function(){var e=this,y=e._position,W=e._width,p=e._height;return{x:y.x-W/2,y:y.y-p/2,width:W,height:p}},Uf.prototype.setSize=function(Z,k){var h=this,Z=Math.max(1,Z),k=Math.max(1,k),_=Z/h._width,H=k/h._height;h._adjustChildScaleOrSize(_,H,"size"),h._width=Z,h._height=k},Uf.prototype._adjustChildScaleOrSize=function(w,X,f){var K,I,D,$,p,k,v,z,S,P,H,o,m,T,O=this,M=O._position,B=O._entities,R=new ym.Math.Matrix2d;for(I=0,D=B.length;D>I;I++)if(K=B[I],O.isNode(K)){if($=K.getPosition(),p=K.getRotation(),k=K.getWidth(),v=K.getHeight(),z=K.getScale(),H=z.x*k,o=z.y*v,R.identity().scale(H,o).rotate(p).translate($.x,$.y).translate(-M.x,-M.y).rotate(-O._64O),p=r(R.b*Math.sign(H),R.a*Math.sign(H)),R.scale(w,X),S=Math.cos(p),P=Math.sin(p),Math.abs(S)<.001?(m=R.b/P,T=-R.c/P):(m=R.a/S,T=R.d/S),"scale"===f)K.setScale(m/k,T/v);else if("size"===f){var h=m/z.x,Z=T/z.y;K.setScale(Kq(m)*Math.abs(z.x),Kq(T)*Math.abs(z.y)),K.setSize(Math.max(.1,Math.abs(h)),Math.max(.1,Math.abs(Z)))}R.rotate(O._64O).translate(M.x,M.y),K.setPosition(R.tx,R.ty)}},Uf.prototype.getMatrix=function(){var d=this,H=d._position,G=Y.Default.getInternal(),g=d._scale;return new G.Mat(d._64O,H.x,H.y,g.x,g.y)},Uf.prototype.toGlobal=function(I){return this.getMatrix().tf(I)},Uf.prototype.getCorners=function(){var f=this,i=f._width,N=f._height,L=f._anchor,m=-i*L.x,Q=-N*L.y,G=f.getMatrix();return[G.tf(m,Q),G.tf(m,Q+N),G.tf(m+i,Q+N),G.tf(m+i,Q)]},Uf.prototype.calcInfo=function(){var S,A,J,o,F,V,W=this,R=[],H=W._entities,U=W._64O;for(o=0,F=H.length;F>o;o++)V=H[o],W.isNode(V)&&V.getCorners&&R.push.apply(R,V.getCorners());if(R.length){var P=Math.cos(-U),Y=Math.sin(-U),T=1/0,l=-1/0,d=1/0,O=-1/0;for(o=0,F=R.length;F>o;o++)J=R[o],S=J.x,A=J.y,J.x=P*S-Y*A,J.y=Y*S+P*A,T=Math.min(T,J.x),l=Math.max(l,J.x),d=Math.min(d,J.y),O=Math.max(O,J.y);W._width=(l-T)/W._scale.x,W._height=(O-d)/W._scale.y,P=Math.cos(U),Y=Math.sin(U);var f=W._anchor;S=T+(l-T)*f.x,A=d+(O-d)*f.y,W._position={x:P*S-Y*A,y:Y*S+P*A}}},Uf.prototype.isNode=function(n){return wk(n)?gs(n)?n.size()?!1:!0:!0:!1},Uf.prototype._42=function(I,y,n){var g,a,_,c,G,L,K,H,r=this,W=r._entities,w=r.rotateMode;for("batch"===w&&(H=r.getKeyOb()),g=0,a=W.length;a>g;g++)_=W[g],r.isNode(_)&&(L=_.getRect(),c=ym.toScreenPosition(n,{x:L.x,y:L.y}),G=ym.toScreenPosition(n,{x:L.x+L.width,y:L.y+L.height}),K={min:c,max:G},_===H&&(K.isKeyOb=!0),ym.Icons.DrawIcon(I,y,ym.Icons.GroupSubEntityRect,K))};var Kf=ym.CurveActiving=function(z,U){this._curve=z,this._interactor=z._interactor,this.silent=!0;for(var R in U)this[R]=U[R];delete this.silent};Kf.prototype={},Kf.prototype.constructor=Kf,u.defineProperties(Kf.prototype,{point:{get:function(){return this._point},set:function(l){var r=this;r._point=l,r.editingCtrl||r.silent||r._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(Y){var x=this;x._pairs=Y,x.editingCtrl&&!x.silent&&x._firePointChange()}}}),Kf.prototype._firePointChange=function(){var A=this,M=A.getCurrentEditingPoint(),W=A._interactor;if(!M)return W.fi({kind:"selectPoint"}),void 0;var T=this._curve.target;if(T){var E=ym.getDataMatrix(T).invert(),_=M.e;M=E.apply(ym.toWorldPosition(W.gv,M)),M.e=_;var s=A._lastFirePoint;s&&Math.abs(M.x-s.x)<1e-5&&Math.abs(M.y-s.y)<1e-5&&(M.e==w&&s.e==w||Math.abs(M.e-s.e)<1e-5)||(A._lastFirePoint=M,W.fi({kind:"selectPoint",x:M.x,y:M.y,e:M.e}))}},Kf.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Kf.prototype.getCurrentEditingPoint=function(){var $=this,H=$.editingCtrl;if(H){var X=$.pairs;if(X){var Y=X[H.pairId];if(Y){var r=Y[H.type];if(r)return r}}}return $._point};var Yg=ym.CursorFactory=function(D){var B=this;B._interactor=D,B._rotateCursorStyles={}};Yg.prototype={},Yg.prototype.constructor=Yg,Yg.prototype.getRotateCursor=function(Z){var r=this;0>Z&&(Z+=2*Math.PI);var x=r._interactor,D=x.getStyle("rotateCursorSize"),L=x.getStyle("rotateCursorRound"),B=Math.round(180*(Z/Math.PI)/L);B*L>=360&&(B=0);var k=r._rotateCursorStyles,i="htCustomRotateStyle_"+D+"_"+L+"_"+B;return k[i]||(r._produceRotateCursor(i,D,L,B),k[i]=!0),i},Yg.prototype._produceRotateCursor=function(w,V,n,u){var j=this;j._interactor;var F=j._canvas;F||(F=j._canvas=l.createElement("canvas")),F.width=F.height=V*devicePixelRatio,F.style.width=F.style.height=V+" px";var $=F.getContext("2d");ym.setAntialias($,!1),$.scale(devicePixelRatio,devicePixelRatio);var I,Z,h,U,H,D=Math.round(V/2),d=""+D+" "+D+",auto !important;",P=4;I=Math.PI/180*u*n,$.clearRect(0,0,V,V),$.save(),$.scale(V/32,V/32),$.translate(16,15),$.rotate(I+Math.PI/2),$.beginPath(),$.moveTo(-8,0),$.lineTo(-8,P),$.lineTo(-8+P,P),$.moveTo(8,0),$.lineTo(8,P),$.lineTo(8-P,P),$.moveTo(-8,P),$.quadraticCurveTo(0,-6,8,P),$.restore(),$.lineCap="round",$.lineJoin="miter",$.strokeStyle="white",$.lineWidth=4,$.stroke(),$.strokeStyle="black",$.lineWidth=2,$.stroke(),Z=JSON.stringify(F.toDataURL()),U="cursor:url("+Z+")"+d,1!==devicePixelRatio&&(h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+V+'px" height="'+V+'px"><image xlink:href='+Z+' width="'+V+'" height="'+V+'"/></svg>',U+="cursor:url(data:image/svg+xml;base64,"+btoa(h)+")"+d,U+="cursor:-webkit-image-set(url("+Z+")"+devicePixelRatio+"x,url("+Z+")1x)"+d),H=l.createElement("style"),H.textContent="body."+w+" *, ."+w+"{"+U+"}",l.head.appendChild(H)};var qb=ym.Guide.Grid=function(x){var k=this;k._interactor=x,k._alignmentGuideId=0,k._xAlignmentGuide=[],k._yAlignmentGuide=[]};qb.prototype={},qb.prototype.constructor=qb,u.defineProperties(qb.prototype,{gridBlockSize:{get:function(){var b=this;return b._gridBlockSize||b._interactor.getStyle("gridBlockSize")},set:function(B){this._gridBlockSize=B,this._interactor._42()}},gridThickLinesEvery:{get:function(){var $=this;return $._gridThickLinesEvery||$._interactor.getStyle("gridThickLinesEvery")},set:function(t){this._gridThickLinesEvery=t,this._interactor._42()}},gridEnabled:{get:function(){var G=this,E=G._interactor;return E.gridEnabled&&G.isValidGrid()}}}),qb.prototype._42=function(){var M=this,C=M._interactor;M.gridEnabled&&M.drawGrid(),C.alignmentGuideEnabled&&M.drawAlignmentGuide()},qb.prototype.makeMatrix=function(){var t=this,Q=t._interactor.getStyle("gridAngle"),J=t._interactor.getStyle("gridRotation"),V=new ym.Math.Matrix2d,l=Math.sin(Q),B=Math.cos(Q);return V.set(1,0,B,l,0,0),V.rotate(J),V},qb.prototype.isValidGrid=function(){var d=this,O=Math.PI,G=d._interactor,Z=G.gv;if(Z._zoom<G.getStyle("gridZoomThreshold"))return!1;var c=G.getStyle("gridAngle"),z=Math.abs(180*(c%O/O)),u=1-1e-8;return u>z||z>180-u?!1:!0},qb.prototype.drawAlignmentGuide=function(){var b=this,Z=b._interactor,m=Z.gv,B=Z._canvas,Q=Z._context,n=B.width,y=B.height,$=m.tx(),h=m.ty(),v=m._zoom;Q.beginPath(),Q.strokeStyle=Z.getStyle("gridAlignmentGuideColor"),Q.lineWidth=1,b._xAlignmentGuide.forEach(function(V){var _=V.p*v+$;Q.moveTo(_,0),Q.lineTo(_,y)}),b._yAlignmentGuide.forEach(function(g){var D=g.p*v+h;Q.moveTo(0,D),Q.lineTo(n,D)}),Q.stroke()},qb.prototype.drawGrid=function(){function V(C,L,D,u){var d=ym.toScreenPosition(H,P.apply({x:C,y:L})),b=ym.toScreenPosition(H,P.apply({x:D,y:u}));
c.moveTo(d.x,d.y),c.lineTo(b.x,b.y)}var G=this,$=G._interactor,u=G.gridBlockSize,i=G.gridThickLinesEvery,_=$.getStyle("gridThickColor"),A=$.getStyle("gridLightColor"),H=$.gv,l=$._canvas,c=$._context,q=l.width,r=l.height,P=G.makeMatrix(),j=P.applyInverse(ym.toWorldPosition(H,{x:0,y:0})),B=P.applyInverse(ym.toWorldPosition(H,{x:q,y:0})),W=P.applyInverse(ym.toWorldPosition(H,{x:0,y:r})),Y=P.applyInverse(ym.toWorldPosition(H,{x:q,y:r})),t=Math.min(j.x,B.x,W.x,Y.x),w=Math.max(j.x,B.x,W.x,Y.x),K=Math.min(j.y,B.y,W.y,Y.y),b=Math.max(j.y,B.y,W.y,Y.y);q=w-t,r=b-K;var I=Math.ceil(t/u),O=Math.floor(w/u),F=Math.ceil(K/u),J=Math.floor(b/u);H.tx(),H.ty(),H._zoom;var z,C,h;for(c.save(),c.lineWidth=1,c.beginPath(),c.strokeStyle=_,h=Math.ceil(I/i)*i;O>=h;h+=i)z=h*u,V(z,K,z,b);for(h=Math.ceil(F/i)*i;J>=h;h+=i)C=h*u,V(t,C,w,C);for(c.stroke(),c.beginPath(),c.strokeStyle=A,h=I;O>=h;h++)0!==h%i&&(z=h*u,V(z,K,z,b));for(h=F;J>=h;h++)0!==h%i&&(C=h*u,V(t,C,w,C));c.stroke(),c.restore()},qb.prototype.getAlignmentGuides=function(){var X=this;return{x:X._xAlignmentGuide,y:X._yAlignmentGuide}},qb.prototype.addAlignmentGuide=function(I,T,C){var V=this,a="x"===I?V._xAlignmentGuide:V._yAlignmentGuide,C=C?C:++V._alignmentGuideId,R={p:T,id:C};if(a.length){var c=V._findClosestAlignmentGuide(R.p,a);c.dis<0?a.splice(c.index+1,0,R):a.splice(c.index,0,R)}else a.push(R);return V._interactor._42(),C},qb.prototype.findClosest=function(P,Z,$){var j=this,T=j._interactor,J=T.gv;$&&(P=ym.toWorldPosition(J,P));var f,L,S,M=1/0,c=1/0,A=P.x,d=P.y;if(j.gridEnabled){var G=j.gridBlockSize,n=j.makeMatrix(),o=n.applyInverse(P);o=n.apply({x:Math.round(o.x/G)*G,y:Math.round(o.y/G)*G}),M=o.x-A,c=o.y-d,S=!0}if(T.alignmentGuideEnabled&&(f=j._findClosestAlignmentGuide(A,j._xAlignmentGuide).dis,L=j._findClosestAlignmentGuide(d,j._yAlignmentGuide).dis,Math.abs(f)<Math.abs(M)&&(M=f,S=!0),Math.abs(L)<Math.abs(c)&&(c=L,S=!0)),S){S=!1;var w=J._zoom,q=T.getStyle("smartGuideThreshold")/w,_={};if(Math.abs(M)<q&&"y"!==Z&&(_.x=$?M*w:M,S=!0),Math.abs(c)<q&&"x"!==Z&&(_.y=$?c*w:c,S=!0),S)return _}},qb.prototype._findClosestAlignmentGuide=function(n,r){if(!r.length)return{dis:1/0};for(var U,u=0,B=r.length-1;B-u>1;)U=Math.floor((u+B)/2),r[U].p<n?u=U:B=U;var e=r[u].p-n,g=r[B].p-n;return Math.abs(e)<=Math.abs(g)?{line:r[u],dis:e,index:u}:{line:r[B],dis:g,index:B}},qb.prototype.removeAllAlignmentGuide=function(S){var r=this;"y"!==S&&(r._xAlignmentGuide=[]),"x"!==S&&(r._yAlignmentGuide=[]),r._interactor._42()},qb.prototype.removeAlignmentGuide=function(c){for(var w,A,o,s=this,Q=s._xAlignmentGuide,E=0;2>E;E++)for(Q=0===E?s._xAlignmentGuide:s._yAlignmentGuide,w=0,A=Q.length;A>w;w++)if(o=Q[w],o.id===c)return Q.splice(w,1),s._interactor._42(),{axis:0===E?"x":"y",position:o.p};return!1},qb.prototype.adjustAlignmentGuide=function(q,X){var P=this,I=P.removeAlignmentGuide(q);return I?(P.addAlignmentGuide(I.axis,X,q),!0):!1};var bb=ym.Guide.Rect=function(I){var F=this;F._interactor=I};bb.prototype={},bb.prototype.constructor=bb,bb.prototype.gatherRects=function(){var T,H,I,L,F=this,c=F._interactor.gv,Q=[],b=[],h={x:Q,y:b},V={},u=c.getDataModel(),j=u.a("width"),Z=u.a("height");j&&Z&&(T=0,H=0,I=j,L=Z,Q.push({node:u,type:0,p:T},{node:u,type:1,p:T+I/2},{node:u,type:2,p:T+I}),b.push({node:u,type:0,p:H},{node:u,type:1,p:H+L/2},{node:u,type:2,p:H+L}),V[u._id||0]={x:T,y:H,width:I,height:L}),u.each(function(G){if(wk(G)&&!c.isSelected(G)&&c.isVisible(G)&&c.isValidGuideLineSource(G)){var j=!1;if(c.sm().getSelection().each(function(X){j||(G.isHostOn(X)?j=!0:G.isDescendantOf(X)&&(j=!0))}),!j){var E=G.getRect();T=E.x,H=E.y,I=E.width,L=E.height,Q.push({node:G,type:0,p:T},{node:G,type:1,p:T+I/2},{node:G,type:2,p:T+I}),b.push({node:G,type:0,p:H},{node:G,type:1,p:H+L/2},{node:G,type:2,p:H+L}),V[G._id]=E}}}),Q.sort(function(T,B){return T.p-B.p}),b.sort(function(G,E){return G.p-E.p}),F._grid=h,F._87I=V},bb.prototype.gatherLines=function(z,w,n){var M,s,O,d,X,U,v,T,x,Q,Y,L,F=this,m=[F.findClosest({x:z.x,y:z.y},w),F.findClosest({x:z.x+z.w/2,y:z.y+z.h/2},w),F.findClosest({x:z.x+z.w,y:z.y+z.h},w)],c={},R=F._87I;n=n||255;var I,E;for(F._guideLine=[],M=0;2>M;M++)for(c={},0===M?(d="y",T=z.x,x=T+z.w):(d="x",T=z.y,x=T+z.h),s=0;3>s;s++)X=m[s],X&&isFinite(X[d])&&(I=1<<3*M+s,n&I&&(U=X[d+"Line"],v=U.node,E=v._id||0,c[E]||(c[E]=!0,L=R[E],"y"===d?(Q=L.x,Y=L.x+L.width):(Q=L.y,Y=L.y+L.height),O=U.p,F._guideLine.push({type:d,a:T,b:x,c:Q,d:Y,p:O,center:1===U.type}))))},bb.prototype._binarySearchClosest=function(u,H){if(!H.length)return{dis:1/0};for(var d,z=0,e=H.length-1;e-z>1;)d=Math.floor((z+e)/2),H[d].p<u?z=d:e=d;var Z=H[z].p-u,O=H[e].p-u;return Math.abs(Z)<=Math.abs(O)?{line:H[z],dis:Z}:{line:H[e],dis:O}},bb.prototype.findClosest=function(b,A,_){var t=this,E=t._interactor,z=E.gv,D=t._grid;_&&(b=ym.toWorldPosition(z,b));var f,F=t._binarySearchClosest(b.x,D.x),N=t._binarySearchClosest(b.y,D.y),U=F.dis,M=N.dis,x=z._zoom,T=E.getStyle("smartGuideThreshold")/x,l={};return Math.abs(U)<T&&"y"!==A&&(l.x=_?U*x:U,l.xLine=F.line,f=!0),Math.abs(M)<T&&"x"!==A&&(l.y=_?M*x:M,l.yLine=N.line,f=!0),f?l:void 0},bb.prototype._42=function(){var T=this,f=T._guideLine;if(f&&!Y.Default.isCtrlDown()){var G=T._interactor;if(G.getStyle("guideLineVisible")){var C,N,$,x,U,i,k,h,J,n,K,P,c,Q,a,V,A,Z=G.gv,R=G._context,W=Z.tx(),H=Z.ty(),L=Z._zoom,j=G.getStyle("guideLineTextSpacing");for(C=0,N=f.length;N>C;C++)$=f[C],h=$.type,J=$.p,n=$.a,K=$.b,P=$.c,c=$.d,Q=Math.min(n,P),a=Math.max(K,c),"x"===h?(x=J*L+W,U=Q*L+H,i=x,k=a*L+H):(x=Q*L+W,U=J*L+H,i=a*L+W,k=U),ym.Icons.DrawIcon(G,R,ym.Icons.MoveLineGuide,{rect:[x,U,i,k],center:$.center}),c>=n&&K>=P||(Q=n>c?c:K,a=n>c?n:P,A=a-Q,"x"===h?($.center2center||(x-=j,i=x),U=Q*L+H,k=a*L+H,V=ym.Icons.MoveLineGuideDistanceV):"y"===h&&($.center2center||(U-=j,k=U),x=Q*L+W,i=a*L+W,V=ym.Icons.MoveLineGuideDistanceH),ym.Icons.DrawIcon(G,R,V,{x0:x,y0:U,x1:i,y1:k,dis:A}))}}},bb.prototype.clear=function(){this._guideLine=null};var ye=ym.Guide.Hover=function(P){var z=this;z._interactor=P};ye.prototype={},ye.prototype.constructor=ye,u.defineProperties(ye.prototype,{}),ye.prototype._42=function(){var M=this._interactor;if(M.getStyle("hoverGuideVisible")&&!M.gvEditing){var q=M.hoverData,J=M.gv;if(!wk(q)||J.isSelected(q))return M.hoverData=null,void 0;var _=_k(J,q),j=ym.toScreenPosition(J,{x:_.x,y:_.y}),A=ym.toScreenPosition(J,{x:_.x+_.width,y:_.y+_.height});ym.Icons.DrawIcon(M,M._context,ym.Icons.HoverDataRect,{min:j,max:A,color:M.getStyle("hoverGuideColor")||M.getStyle("baseColor")})}},ym.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var kb=ym.Icons={},Hq=1e4,ed=null,Xi=ym.DefaultStyleMap.baseColor,Lo="rgb(183,232,135)",lm="rgb(255,204,153)",nh=6;Y.Default.setImage("Icons.RectPoint",{width:nh,height:nh,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Xi}},rect:[0,0,nh,nh]}]}),kb.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var g=kb.GroupSubEntityRect.data;if(!g)return[];var Z=g.min,r=g.max;return[Z.x,Z.y,Z.x,r.y,r.x,r.y,r.x,Z.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return kb.GroupSubEntityRect.data.isKeyOb?Xi:Xi}}}]};var vp=4;kb.HoverDataRect={comps:[{type:"shape",points:{func:function(){var o=kb.HoverDataRect.data;if(!o)return[];var R=o.min,M=o.max,N=vp;return R.x-=N,R.y-=N,M.x+=N,M.y+=N,[R.x,R.y,R.x,M.y,M.x,M.y,M.x,R.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return kb.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},kb.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[kb.Line.data.P1.x,kb.Line.data.P1.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[kb.Line.data.P2.x,kb.Line.data.P2.y],nh,nh]}}}]},kb.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return kb.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},kb.Rect={comps:[{type:"shape",points:{func:function(){var K=kb.Rect.data;if(!K)return[];var v=K.LT,U=K.LB,F=K.RB,L=K.RT;return[v.x,v.y,U.x,U.y,F.x,F.y,L.x,L.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Xi}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},rect:{func:function(){return[[kb.Rect.data.LT.x,kb.Rect.data.LT.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},rect:{func:function(){return[[kb.Rect.data.LB.x,kb.Rect.data.LB.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},rect:{func:function(){return[[kb.Rect.data.RB.x,kb.Rect.data.RB.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},rect:{func:function(){return[[kb.Rect.data.RT.x,kb.Rect.data.RT.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},visible:{func:function(){return kb.Rect.data.L?!0:!1}},rect:{func:function(){return[[kb.Rect.data.L.x,kb.Rect.data.L.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},visible:{func:function(){return kb.Rect.data.R?!0:!1}},rect:{func:function(){return[[kb.Rect.data.R.x,kb.Rect.data.R.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},visible:{func:function(){return kb.Rect.data.T?!0:!1}},rect:{func:function(){return[[kb.Rect.data.T.x,kb.Rect.data.T.y],nh,nh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return kb.Rect.data.rotation}},visible:{func:function(){return kb.Rect.data.B?!0:!1}},rect:{func:function(){return[[kb.Rect.data.B.x,kb.Rect.data.B.y],nh,nh]}}}]};var Fh=16;Y.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Xi}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Xi}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),kb.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[kb.Anchor.data.POS.x,kb.Anchor.data.POS.y],Fh,Fh]}}}]},kb.TipShiftX=12,kb.TipShiftY=12;var Hh=[8,28];kb.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[kb.TipHelper.data.helperPos.x,kb.TipHelper.data.helperPos.y,Hh[0]*kb.TipHelper.data.size,Hh[1]]}},background:{func:function(){return ed.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return kb.TipHelper.data.text}},rect:{func:function(){return[kb.TipHelper.data.helperPos.x,kb.TipHelper.data.helperPos.y,Hh[0]*kb.TipHelper.data.size,Hh[1]]}},color:{func:function(){return ed.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Me=7;kb.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!kb.ShapePoint.data.dynamicVisible}},rect:{func:function(){var N=kb.ShapePoint.data.point,G=kb.ShapePoint.data.size||Me;return[N,G+10,G+10]}},background:{func:function(){var t=Date.now(),q=kb.ShapePoint.data.dynamicPeriod||1500,f=Math.sin(t%q/q*Math.PI);return"rgba(27,124,22,"+.5*f+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var M=kb.ShapePoint.data.point,H=kb.ShapePoint.data.size||Me;return[M,H,H]}},background:{func:function(){var e=kb.ShapePoint.data.isEnd;return e?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return kb.ShapePoint.data.color||Xi}}},{type:"rect",visible:{func:function(){return!!kb.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Xi}},rect:{func:function(){var X=5;return[kb.ShapePoint.data.point,X,X]}}}]},kb.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!kb.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return kb.ShapeBgCurve.data.P}},segments:{func:function(){return kb.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var B=Date.now(),T=kb.ShapeBgCurve.data.dynamicPeriod||1500,e=Math.sin(B%T/T*Math.PI);return"rgba(27,124,22,"+.3*e+")"}}},{type:"shape",points:{func:function(){return kb.ShapeBgCurve.data.P}},segments:{func:function(){return kb.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return kb.ShapeBgCurve.data.color||Xi}}}]};var Qn=8;kb.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var P=kb.ShapeHighlighPoint.data;return[[P.x,P.y],Qn,Qn]}},background:{func:function(){return ed.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Tm=10;kb.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var d=kb.ShapeHighlighRealPoint.data;return[[d.x,d.y],Tm,Tm]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Xi}}}]};var Lk=8;kb.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var A=kb.ShapeHighlighCtrlPoint.data,d=A.x,V=A.y,$=Lk/2;return[d-$,V-$,d-$,V+$,d+$,V+$,d+$,V-$]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ed.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return ed.getStyle("shapeCtrlPointBorderColor")||Xi}}}]};var Pn=3;kb.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return kb.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Pn,borderColor:{func:function(){return ed.getStyle("curveHighlightColor")}}}]},kb.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return kb.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},kb.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return kb.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return kb.MoveLineGuide.data.center?Lo:lm}}}]};var bn=5;kb.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var G=kb.MoveLineGuideDistanceH.data,n=G.x0,Z=G.y0;return[n,Z-bn,n,Z+bn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lm},{type:"shape",points:{func:function(){var x=kb.MoveLineGuideDistanceH.data,b=x.x1,h=x.y1;return[b,h-bn,b,h+bn]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lm},{type:"text",text:{func:function(){return Math.round(kb.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var s=kb.MoveLineGuideDistanceH.data;return[[(s.x0+s.x1)/2,s.y0-10],20,20]}},color:lm,font:"12px Arial",align:"center"}]},kb.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var V=kb.MoveLineGuideDistanceV.data,J=V.x0,u=V.y0;return[J-bn,u,J+bn,u]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lm},{type:"shape",points:{func:function(){var f=kb.MoveLineGuideDistanceV.data,I=f.x1,g=f.y1;return[I-bn,g,I+bn,g]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:lm},{type:"text",text:{func:function(){return Math.round(kb.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var y=kb.MoveLineGuideDistanceV.data;return[[y.x0-10,(y.y0+y.y1)/2],20,20]}},color:lm,font:"12px Arial",align:"center"}]},Y.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),kb.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var L=kb.EdgeElevationGuide.data,Y=L.x,O=L.y,p=ed.getStyle("curveElevationIntersectSize"),K=ed.getStyle("curveElevationGuideShift");return Y+=K[0],O+=K[1],[Y-p,O-p,2*p,2*p]}}}]},Y.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),Y.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),kb.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return kb.ConnectGuide.data.rotation}},rect:{func:function(){var B=kb.ConnectGuide.data.connect;B.x,B.y;var r=ed.getStyle("connectGuideIntersectSize");return[[B.x,B.y],2*r,2*r]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var K=kb.ConnectGuide.data.cursorPos||kb.ConnectGuide.data.connect,A=ed.getStyle("connectGuideIntersectSize");return[[K.x,K.y],2*A-2,2*A-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var v=kb.ConnectGuide.data.connect,g=kb.ConnectGuide.data.cursorPos||v;return[v.x,v.y,v.x+.5*(g.x-v.x),v.y,g.x+.5*(v.x-g.x),g.y,g.x,g.y]}}}]},Y.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),Y.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),kb.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var O=kb.ConnectGuideGarbage.data.hover;return O?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var l=kb.ConnectGuideGarbage.data,b=ed.getStyle("connectGuideGarbageIntersectsize");return l.hover&&(b+=5),[[l.x,l.y],2*b,2*b]}}}]};var Vd=6;kb.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return kb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var S=kb.ShapeActivingCtrl.data;return[S.point.x,S.point.y,S.c1.x,S.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Xi}}},{type:"shape",visible:{func:function(){return kb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var T=kb.ShapeActivingCtrl.data;return[T.point.x,T.point.y,T.c2.x,T.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Xi}}},{type:"shape",visible:{func:function(){return kb.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var H=kb.ShapeActivingCtrl.data.c1,_=H.x,C=H.y,w=Vd/2;return"c1"===kb.ShapeActivingCtrl.data.hl&&(w+=.5),[_-w,C-w,_-w,C+w,_+w,C+w,_+w,C-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ed.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===kb.ShapeActivingCtrl.data.hl?ed.getStyle("shapeCtrlPointHighlightBorder")||Xi:ed.getStyle("shapeCtrlPointBorderColor")||Xi}}},{type:"shape",visible:{func:function(){return kb.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=kb.ShapeActivingCtrl.data.c2,d=D.x,l=D.y,f=Vd/2;return"c2"===kb.ShapeActivingCtrl.data.hl&&(f+=.5),[d-f,l-f,d-f,l+f,d+f,l+f,d+f,l-f]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ed.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===kb.ShapeActivingCtrl.data.hl?ed.getStyle("shapeCtrlPointHighlightBorder")||Xi:ed.getStyle("shapeCtrlPointBorderColor")||Xi}}}]},kb.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Xi}},rect:{func:function(){return[[kb.RoundPoint.data.x,kb.RoundPoint.data.y],nh,nh]}}}]},kb.AttachPoint={comps:[{type:"rect",background:{func:function(){return kb.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Xi}},rect:{func:function(){var G=kb.AttachPoint.data.isAttach?nh+4:nh;return[[kb.AttachPoint.data.x,kb.AttachPoint.data.y],G,G]}}}]},kb.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return kb.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return kb.SimpleRect.data.color||Xi}},rect:{func:function(){var C=kb.SimpleRect.data;return[C.x,C.y,C.width,C.height]}}}]},Y.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),kb.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var I=kb.MoveDummy.data;return[[I.pos.x,I.pos.y],2*I.size,2*I.size]}}}]},ym.Icons.DrawIcon=function(e,I,S,M){S.width=S.height=Hq,S.data=M,ed=e,Y.Default.drawImage(I,S,0,0,Hq,Hq)},ym.Icons.MapPoints=function(D,Y){for(var B=0,y=D.length;y>B;B++)D[B]/=Y},ym.roundTo=function(e,u,G){var w=Math.abs(e%u);return G>w||G>u-w?u*Math.round(e/u):e},ym.toFixed=function(H){return Math.round(100*H)/100},ym.getDataMatrix=function(j){if(j instanceof Y.Shape){var T=new Y.Math.Matrix2d,h=j.getPosition();return T.translate(-h.x,-h.y).scale(j.getScale().x,j.getScale().y).rotate(j.getRotation()).translate(h.x,h.y),T}return j.getMatrix?j.getMatrix():new Y.Math.Matrix2d};var jl=ym.Math.Curve=function(){this._curves=[]};jl.prototype={},jl.prototype.constructor=jl,jl.prototype.createFromHtShape=function(H,K,D){K instanceof Y.List&&(K=K.toArray());var T,G,e,X,b,c,M,N=this,m=null,R=null,k=0,g=ym.Math.Vector2,U=ym.Math.CubicBezier,Q=function(s){return new g(H[s],H[s+1],D?D[s/2]:w)};for(G=0,e=K.length;e>G;G++){switch(X=K[G],b=null,X){case 1:R=Q(k),m=R,k+=2;break;case 2:T=Q(k),k+=2,b=new U(R,R.clone(),T.clone(),T),R=T;break;case 3:c=Q(k),T=Q(k+2),k+=4,b=new U(R,c.clone().sub(R).multiplyScalar(2/3).add(R),c.clone().sub(T).multiplyScalar(2/3).add(T),T),R=T;break;case 4:c=Q(k),M=Q(k+2),T=Q(k+4),k+=6,b=new U(R,c,M,T),R=T;break;case 5:if(!m)break;b=new U(R,R.clone(),m.clone(),m),R=null,m=null}b&&(b._index=N._curves.length,N._curves.push(b))}},jl.prototype.checkPoint=function(u,m){var k,h,Y,i,n,S=this,d=S._curves;for(k=0,h=d.length;h>k;k++)if(i=d[k],n=i.intersectRect(u,m,m),n.length)return Y=0,n.forEach(function(Z){Y+=Z.t}),Y/=n.length,u=i.getPointAt(Y),u.t=Y,{bezier:i,intersection:u}},jl.prototype.insertKnot=function(h,U){var L=h.insertKnot(U),e=this,r=e._curves;r.splice(h._index,1,L[0],L[1])},jl.prototype._isCloseEnough=function(c,O){return Math.abs(c.x-O.x)<1e-6&&Math.abs(c.y-O.y)<1e-6},jl.prototype._isSamePoint=function(l,W){return l===W},jl.prototype.moveRealPoint=function(G,y){var M=this,g=M._curves,s=y.clone().sub(G);g.forEach(function(l){var r=l._p1;l._p2,l._p3;var Z=l._p4;M._isSamePoint(r,G)&&(l._p2.add(s),l._p1=y),M._isSamePoint(Z,G)&&(l._p3.add(s),l._p4=y)})},jl.prototype.moveCtrlDueToRealPointMovement=function(B,U){var r=this,j=r._curves,e=function(F){F.add(U),F.e&&U.e&&(F.e+=U.e)};j.forEach(function(s){var J=s._p1;s._p2,s._p3;var Q=s._p4;r._isSamePoint(J,B)&&e(s._p2),r._isSamePoint(Q,B)&&e(s._p3)})},jl.prototype.moveCtrlPoint=function($,v,S){var x=$[S];if(x){x.e!==w&&(v.e=x.e);var V=this,b=V._curves;v.clone().sub(x),b.forEach(function(K){var N;"c2"===S?N="_p2":"c1"===S&&(N="_p3"),V._isSamePoint(K[N],x)&&(K[N]=v)}),$[S]=v}},jl.prototype.deleteRealPoint=function(M,i){var K,H,I,v,V,Z,r,w=this,O=w._curves,o={},b=[],T=ym.Math.CubicBezier;for(H=0,I=O.length;I>H;H++)K=O[H],v=K._p1,V=K._p2,Z=K._p3,r=K._p4,(o[H]||!w._isSamePoint(v,M))&&(w._isSamePoint(r,M)?I>H+1&&w._isSamePoint(O[H+1]._p1,M)&&(i||b.push(new T(v,V,O[H+1]._p3,O[H+1]._p4))):b.push(K));w._curves=b},jl.prototype.findPairs=function(Q,K){var w,s,k,O,q,y,l,N,x=this,a=x._curves,o={},X=[];for(s=0,k=a.length;k>s;s++)w=a[s],O=w._p1,q=w._p2,y=w._p3,l=w._p4,!o[s]&&x._isSamePoint(O,Q)&&(K?X.push({point:O,r2:l}):X.push({point:O,c2:q})),x._isSamePoint(l,Q)&&(N=K?{point:l,r1:O}:{point:l,c1:y},k>s+1&&x._isSamePoint(a[s+1]._p1,Q)&&(K?N.r2=a[s+1]._p4:N.c2=a[s+1]._p2,o[s+1]=!0),X.push(N));return X},jl.prototype.toHtShape=function(){var w=this,x=w._curves,q=[],v=[],i={x:1/0,y:1/0};return x.forEach(function(e){var G=e._p1,E=e._p2,W=e._p3,R=e._p4;return w._isCloseEnough(G,i)||(q.push(1),v.push(G.clone())),i=R,w._isCloseEnough(G,E)&&w._isCloseEnough(W,R)?(q.push(2),v.push(R.clone()),void 0):(q.push(4),v.push(E.clone(),W.clone(),R.clone()),void 0)}),{segments:q,points:v}};var Ti=ym.Math.CubicBezier=function(r,c,u,v){var J=this;J._id=ym.Math.CubicBezier._globalId++,J._p1=r,J._p2=c,J._p3=u,J._p4=v};Ti._globalId=1,Ti.prototype={},Ti.prototype.constructor=Ti,Ti.prototype.toString=function(){return this._id},Ti.prototype.intersectRect=function(e,X,W){var y=X/2,g=W/2,A=e.x,n=e.y,z=ym.Math.Vector2,M=new z(-y+A,-g+n),q=new z(y+A,g+n),J=new z(q.x,M.y),V=new z(M.x,q.y),x=this,T=x.intersectLine(M,J),Q=x.intersectLine(J,q),Y=x.intersectLine(q,V),R=x.intersectLine(V,M),L=T.concat(Q).concat(Y).concat(R);return L},Ti.prototype.intersectLine=function(U,r){var s,x,q,e,f,n,w,z,M,j,J,i,c,Y=this,_=U.clone().min(r),T=U.clone().max(r);e=Y._p1,f=Y._p2,n=Y._p3,w=Y._p4,s=e.clone().multiplyScalar(-1),x=f.clone().multiplyScalar(3),q=n.clone().multiplyScalar(-3),J=s.add(x).add(q).add(w),s=e.clone().multiplyScalar(3),x=f.clone().multiplyScalar(-6),q=n.clone().multiplyScalar(3),j=s.add(x).add(q),s=e.clone().multiplyScalar(-3),x=f.clone().multiplyScalar(3),M=s.add(x),z=e.clone(),c=new ym.Math.Vector2(U.y-r.y,r.x-U.x),i=U.x*r.y-r.x*U.y;for(var G=Y.getRoots(c.dot(J),c.dot(j),c.dot(M),c.dot(z)+i),A=new Array,W=0,K=G.length;K>W;W++){var L=G[W];if(!(0>L||L>1)){var v=e.clone().lerp(f,L),l=f.clone().lerp(n,L),B=n.clone().lerp(w,L),p=v.lerp(l,L),a=l.lerp(B,L),F=p.lerp(a,L);F.t=L,U.x==r.x?_.y<=F.y&&F.y<=T.y&&A.push(F):U.y==r.y?_.x<=F.x&&F.x<=T.x&&A.push(F):F.x>=_.x&&F.y>=_.y&&F.x<=T.x&&F.y<=T.y&&A.push(F)}}return A},Ti.prototype.solveTForPoint=function(N){var _,G,C,n,k=this;_=k._p1.x-N.x,G=k._p2.x-N.x,C=k._p3.x-N.x,n=k._p4.x-N.x;for(var v=k.getRoots(n-3*C+3*G-_,3*C-6*G+3*_,3*G-3*_,_),W=w,y=1/0,Q=0,I=v.length;I>Q;Q++){var a=v[Q];if(!(0>a||a>1)){var K=k._p1.clone().lerp(k._p2,a),i=k._p2.clone().lerp(k._p3,a),S=k._p3.clone().lerp(k._p4,a),o=K.lerp(i,a),z=i.lerp(S,a),D=o.lerp(z,a);D.t=a;var c=Math.abs(D.y-N.y);y>c&&(y=c,W=D)}}return W
},Ti.prototype.getPointAt=function(v){var g=this,j=g._p1,F=g._p2,Z=g._p3,$=g._p4,K=j.clone().lerp(F,v),P=F.clone().lerp(Z,v),D=Z.clone().lerp($,v),Q=K.lerp(P,v),Y=P.lerp(D,v);return Q.lerp(Y,v)},Ti.prototype.getRoots=function(D,H,J,M){var k,W,B,z,f,w=new Array;if(Math.abs(D)<1e-6){var k=H,W=J/k,B=M/k,z=W*W-4*B;if(z>0){var f=Math.sqrt(z);w.push(.5*(-W+f)),w.push(.5*(-W-f))}else 0==z&&w.push(.5*-W)}H/=D,J/=D,M/=D,k=(3*J-H*H)/3,W=(2*H*H*H-9*J*H+27*M)/27;var j=H/3,o=W*W/4+k*k*k/27,e=W/2;if(Math.abs(o)<=1e-6&&(o=0),o>0){var V,Y,f=Math.sqrt(o);V=-e+f,Y=V>=0?Math.pow(V,1/3):-Math.pow(-V,1/3),V=-e-f,V>=0?Y+=Math.pow(V,1/3):Y-=Math.pow(-V,1/3),w.push(Y-j)}else if(0>o){var S=Math.sqrt(-k/3),d=Math.atan2(Math.sqrt(-o),-e)/3,X=Math.cos(d),u=Math.sin(d),T=Math.sqrt(3);w.push(2*S*X-j),w.push(-S*(X+T*u)-j),w.push(-S*(X-T*u)-j)}else{var V;V=e>=0?-Math.pow(e,1/3):Math.pow(-e,1/3),w.push(2*V-j),w.push(-V-j)}return w},Ti.prototype._70I=function(){var E=this;return E._p1.distanceToSquared(E._p2)<1e-10&&E._p3.distanceToSquared(E._p4)<1e-10},Ti.prototype.insertKnot=function(e){var K=this,n=K._p1,G=K._p2,$=K._p3,t=K._p4,O=n.clone().lerp(G,e),D=G.clone().lerp($,e),o=$.clone().lerp(t,e),p=O.clone().lerp(D,e),N=D.clone().lerp(o,e),Y=p.clone().lerp(N,e);return K._70I()?(n.clone().lerp(t,e),[new ym.Math.CubicBezier(n,n.clone(),Y.clone(),Y),new ym.Math.CubicBezier(Y,Y.clone(),t.clone(),t)]):[new ym.Math.CubicBezier(n,O,p,Y),new ym.Math.CubicBezier(Y,N,o,t)]};var Ik=Y.Default.getInternal().ui().EdgeUI,$r={_47O:function(S){var c=this,y=$r.getBackups()._47O;ym.inEdit(c.gv)||y.call(c,S)}};ym.Inject.registAsModule($r,Ik);var Iq=Y.Default.getInternal().ui().NodeUI,ij={_47O:function(J){var F=this,v=ij.getBackups()._47O;ym.inEdit(F.gv)||v.call(F,J)},getSelectWidth:function(){var R=this,G=R.gv,k=R._data;if(G.isEditable(k)&&ym.inEdit(G))return 0;var s=ij.getBackup("getSelectWidth");return s.call(R)}};ym.Inject.registAsModule(ij,Iq);var ne=Y.graph.GraphView,Cm={_editPointSize:function(){var s=Y.Default.isTouchable,y=ym.getStyle("pointSize");return y[s?0:1]}(),isPointEditable:function(u){var g=this;if(ym.inEdit(g))return g._pointEditableFunc?g._pointEditableFunc(u):!0;var x=Cm.getBackup("isPointEditable");x.call(g,u)},isEditable:function(R){var V,r=this,E=Cm.getBackup("isEditable");if(V=R instanceof ym.Group?!0:E.call(r,R),!ym.inEdit(r))return V;if(!(R instanceof Y.Edge))return V;if(!R.s("2d.editable"))return!1;var L=r.getEditableFunc();return L?L(R):!0},_42:function(X,W){var w=this,x=Cm.getBackups()._42;if(x.call(w,X,W),ym.inEdit(w)){var n=w.getEditInteractor();n.drawImpl()}}};ym.Inject.registAsModule(Cm,ne);var xp=Y.Default.getInternal().ui().ShapeUI,Gg={_47O:function(z){var u=this,X=Gg.getBackups()._47O;ym.inEdit(u.gv)||X.call(u,z)}};ym.Inject.registAsModule(Gg,xp);var Xd=Y.graph.DefaultInteractor,ub={handle_mousewheel:function(L){var J=this,D=ub.getBackup("handle_mousewheel");ym.inEdit(J.gv)||D.call(J,L)}};ym.Inject.registAsModule(ub,Xd);var pb=Y.graph.MoveInteractor,Md={_calcShift:function(Z,l){var e=this,L=Md.getBackup("_calcShift"),p=e.gv;if(!ym.inEdit(p))return L.call(e,Z,l);var A=p.getEditInteractor(),o=A.getSubModule("Move").calcShift(Z,l,e);return o||L.call(e,Z,l)},clear:function(y){var c=this,a=Md.getBackup("clear");a.call(c,y);var x=c.gv;if(ym.inEdit(x)){var S=x.getEditInteractor();S.getSubModule("Move").clear(y)}}};ym.Inject.registAsModule(Md,pb);var bb=ym.Rect=function(v){this.catalog="Rect",this._interactor=v};bb.prototype={},bb.prototype.constructor=bb,bb.prototype.gatherInfo=function(I,F){var x=this;if(1===F.length){var z=F[0];return z instanceof Y.Shape&&z._70I()?x.gatherLine(I,z):gs(z,I)?!1:x.gatherSingleTarget(I,z)}return F.length>1?x.gatherMultiTargets(I,F):!1},bb.prototype.gatherSingleTarget=function(m,O){if(O.getCorners){var C,q=this,M=q.info;q.target=O,C=q.screenInfo={};var y=O.getCorners();M.LT=new ym.Math.Vector2(y[0]),M.LB=new ym.Math.Vector2(y[1]),M.RB=new ym.Math.Vector2(y[2]),M.RT=new ym.Math.Vector2(y[3]),M.T=M.LT.clone().add(M.RT).divideScalar(2),M.B=M.LB.clone().add(M.RB).divideScalar(2),M.L=M.LT.clone().add(M.LB).divideScalar(2),M.R=M.RT.clone().add(M.RB).divideScalar(2);for(var $ in M)C[$]=ym.toScreenPosition(m,M[$]);var n=q._interactor,b=n.getStyle("checkSize"),g=function($,K,d){var O=K.clone().sub($).setLength(-b),M=d.clone().sub($).setLength(-b),P=O.add(M).add($);return P};return C.rotLT=g(C.LT,C.RT,C.LB),C.rotLB=g(C.LB,C.LT,C.RB),C.rotRB=g(C.RB,C.LB,C.RT),C.rotRT=g(C.RT,C.LT,C.RB),C.rotT=C.rotLT.clone().add(C.rotRT).divideScalar(2),C.rotB=C.rotLB.clone().add(C.rotRB).divideScalar(2),C.rotL=C.rotLT.clone().add(C.rotLB).divideScalar(2),C.rotR=C.rotRT.clone().add(C.rotRB).divideScalar(2),C.rotation=O.getRotation(),q.gatherConnectInfo(),!0}},bb.prototype.gatherConnectInfo=function(){var O=this,n=O.target,X=O._interactor,t=O.screenInfo,R=X.gv;if(R.isConnectActionVisible(n)&&X.getStyle("connectGuideVisible")){var A;n.s&&(A=n.s("connectGuideShift")),A||(A=X.getStyle("connectGuideShift"));var K=n.getAnchor(),E=n.getSize(),F=n.toGlobal({x:E.width*(A[0]-K.x),y:E.height*(A[1]-K.y)});F=ym.toScreenPosition(R,F),t.P1?F.add(t.P2.clone().sub(t.P1).setLength(A[2])):(F.add(t.RT.clone().sub(t.LT).setLength(A[2])),F.add(t.LB.clone().sub(t.LT).setLength(A[3]))),t.connect=F}},bb.prototype.gatherMultiTargets=function(R,o){var O=ym.Group.findOrCreateGroup(o);if(!O)return!1;var b=this;return b.editing&&"rotate"!==b.editing.mode||O.calcInfo(),b.gatherSingleTarget(R,O)},bb.prototype.gatherLine=function(U,x){this.target=x;var t=this.screenInfo={},j=x.getPoints(),p=ym.getDataMatrix(x);return t.P1=ym.toScreenPosition(U,p.apply(j.get(0))),t.P2=ym.toScreenPosition(U,p.apply(j.get(1))),this.gatherConnectInfo(),!0},bb.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],bb.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],bb.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],bb.prototype.check=function(i,c,G){if(Y.Default.isLeftButton(c)){var L=this;if(L.editing=null,L.tipInfo=null,L.screenInfo){var z=L.target,m=i.isEditable(z),T=L.screenInfo;if(m&&T.connect){var K=L._checkConnect(G);if(K)return K}if(T.P1)return L._checkLine(G);var h,t,j,I=null,O=L._interactor,o=O.getStyle("checkSize");if(m&&i.isRectEditable(z))for(t=0;t<ym.Rect.ResizeKeys.length;t++)if(j=ym.Rect.ResizeKeys[t],ym.checkHit(G,T[j],o)){I=j,h="resize";break}if(!I&&m&&i.isRotationEditable(z)&&!O.getStyle("rotateAsClock")){var g=O.getStyle("rotateCheckSize");for(t=0;t<ym.Rect.RotateKeys.length;t++)if(j=ym.Rect.RotateKeys[t],ym.checkHit(G,T[j],g)){I=j,h="rotate";break}}if(!I)return O.setCursor("default"),void 0;if("rotate"===h){var x,H=i.lp(c);if(z instanceof ym.Group){var R=O.getStyle("groupRotateModeKey");"string"==typeof R&&(R=[R]);for(var X=!1,e=0,V=R.length;V>e;e++)if(c[R[e]]){X=!0;break}var M=O.getStyle("groupRotateModeDefault");x=X?"batch"===M?"block":"batch":M}var B="batch"===x?z.getAnchor2():z.getPosition(),C=Math.atan2(H.y-B.y,H.x-B.x);O._setRotateCursor(C),L.editing={mode:h,key:I,pos:B,flipY:z.getScale().y<0,rotation:z.getRotation(),hitRot:C},x&&(L.editing.groupRotateMode=x)}else{var b=ym.Rect.ResizeKeys.indexOf(I),Q=ym.Rect.ResizeDirection[b],d=Math.cos(z.getRotation()),A=Math.sin(z.getRotation()),n=Q.x*Math.sign(z.getScale().x),$=Q.y*Math.sign(z.getScale().y),k=Math.atan2(-A*n-d*$,d*n-A*$),p=(Math.round(k/(Math.PI/4))+8)%8,q=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][p];this._interactor.setCursor(q);var P=z.getWidth(),s=z.getHeight(),l=z.getAnchor();L.editing={mode:h,key:I,rect:{x:-P*l.x,y:-s*l.y,width:P,height:s},anchor:l,matrix:z.getMatrix()}}return I}}},bb.prototype._checkLine=function(N){var p=this;p.screenInfo;var e,d=p._interactor.getStyle("checkSize");if(ym.checkHit(N,p.screenInfo.P1,d))e="P1";else{if(!ym.checkHit(N,p.screenInfo.P2,d))return this._interactor.setCursor("default"),void 0;e="P2"}return p.editing={mode:"line",key:e},e},bb.prototype._checkConnect=function(j){var I=this,U=I.screenInfo,g=I._interactor,x=g.getStyle("connectGuideIntersectSize"),F=U.connect,h=j.x,N=F.x;if(N>h&&x>N-h&&Math.abs(F.y-j.y)<x||h>=N&&ym.checkHit(j,F,x)){var $="connect",C=Q.getConnectAction(g.gv);if(I.editing={mode:$},C&&C.delete)if(I.target instanceof ym.Group){var B=!0;g.gv.sm().getSelection().each(function(U){C.delete.visible.call(null,g.gv,U)||(B=!1)}),I.editing.hasDeleteAction=B}else C.delete.visible.call(null,g.gv,I.target)&&(I.editing.hasDeleteAction=!0);return g.setCursor("default"),$}},bb.prototype._fireEditEvent=function(z,c){var H=this._interactor,p=this.editing;if(p){var g=p.mode;g="rotate"===g?"Rotation":"connect"===g?"Connection":"resize"===g?"Rect":g[0].toUpperCase()+g.slice(1),H.fi({kind:z+"Edit"+g,event:c})}},bb.prototype.startEdit=function(u,H){u.startDragging(H);var A=this;A._interactor.fi({kind:"prepareEdit",event:H});var o=A.editing,O=A.target;if(o){if(A._fireEditEvent("begin",H),"rotate"===o.mode)return o.groupRotateMode&&O.beginRotate(o),void 0;if("connect"!==o.mode)("line"===o.mode||O&&0===O.getRotation())&&(A._inSmartGuide=!0,A._interactor.rectGuide.gatherRects());else if(o.hasDeleteAction){var Y=u.gv,q=A._interactor.getStyle("connectGuideGarbageShift");o.garbageInfo={x:Y.getWidth()*q[0]+q[2],y:Y.getHeight()*q[1]+q[3],size:A._interactor.getStyle("connectGuideGarbageIntersectsize")},u._42()}}},bb.prototype._46O=function(S){var Z,P,i=this,o=i.editing,y=i.target;if(o){if("connect"===o.mode&&!o.canceled&&!o.deleted)try{o.garbageInfo&&o.garbageInfo.hover?Q.doDeleteConnectionAction(i._interactor.gv,y):Q.doConnectAction(i._interactor.gv,y,o.target)}catch($){console.error($)}P=o.freezeFlag,Z=i.editing.groupRotateMode,i._fireEditEvent("end",S),i.editing=null}i.tipInfo=null,i._inSmartGuide&&(i._interactor.rectGuide.clear(),i._inSmartGuide=!1),Z&&y&&y.endRotate(),y instanceof Y.Block&&(P===w?delete y._freezeSyncFromChildren:y._freezeSyncFromChildren=P,y.updateFromChildren())},bb.prototype.handleNormalStateDelete=function(){var u=this,r=u.editing;if(r&&"connect"===r.mode&&!r.canceled&&!r.deleted){if(r.garbageInfo){try{Q.doDeleteConnectionAction(u._interactor.gv,u.target)}catch(a){console.error(a)}r.garbageInfo=null}return r.cursorPos=null,r.targetCorners=null,r.deleted=!0,u._interactor._42(),!0}},bb.prototype.handleNormalStateKeyDown=function(s){var H=this,T=H.editing;return!T||"connect"!==T.mode||T.canceled||T.deleted?void 0:Y.Default.isEsc(s)?(T.cursorPos=null,T.targetCorners=null,T.canceled=!0,H._interactor._42(),!0):void 0},bb.prototype.handleEdit=function(y,F){var j=this,n=j.editing;if(n){var f,q,s,R,W,b=j.target,_=n.key,p=n.mode,t=y.lp(F),U=j._interactor;if("connect"===p){if(n.canceled)return;if(n.deleted)return;n.cursorPos=U._getLogicalPoint(F);var i=n.garbageInfo;return i&&ym.checkHit(n.cursorPos,i,i.size)?(i.hover=!0,n.target=null,n.targetCorners=null):(i&&(i.hover=!1),n.target=y.getDataAt(t,function(I){return y.isSelectable(I)?wk(I)?!0:!1:!1})||null,n.targetCorners=ym.getTargetCornersOnScreen(y,n.target)),U._42(),void 0}if("rotate"===p){var a,J,E=n.pos,v=Math.atan2(t.y-E.y,t.x-E.x);if(n.groupRotateMode?J=v-n.hitRot:(a=v-n.hitRot,J=n.rotation+a),J%=2*Math.PI,0>J&&(J+=2*Math.PI),!Y.Default.isCtrlDown(F)){var S,M;Dc(F)?(S=U.getStyle("shiftRotateRound"),M=S/2):(S=U.getStyle("rotateRound"),M=U.getStyle("rotateSensitivity")),J=ym.roundTo(J,S,M)}n.groupRotateMode?(a=J-(n.lastRotation||0),0!==a&&(b.addRotation(a,n.groupRotateMode,function(w){return y.isRotationEditable(w)}),n.lastRotation=J)):b.setRotation(J),U._setRotateCursor(v),J>Math.PI&&(J-=2*Math.PI);var L=180*(J/Math.PI);L=L.toFixed(2),f=""+L+"°"}else if("resize"===p){var K=n.rect;s=K.x,R=K.y;var x,z=K.width,m=K.height,e=n.anchor,C=n.matrix,X=b.s&&b.s("keepAspectRatio")||U.getStyle("keepAspectRatio");Dc(F)&&(X=!X);var k=j._unionPointMode1,Q=j._unionPointMode2;if(j._inSmartGuide&&!Y.Default.isCtrlDown(F)&&!X){var u;"L"===_||"R"===_?u="x":("T"===_||"B"===_)&&(u="y"),j._adsorbedToClosest(t,u),W=!0}x=C.tfi(t);var c;"LT"===_?(K=k(x,{x:s+z,y:R+m},z,m,X),c=9):"T"===_?(K=Q({x:s,y:x.y},{x:s+z,y:R+m},z,m,X,"v"),c=1):"RT"===_?(K=k(x,{x:s,y:R+m},z,m,X),c=33):"L"===_?(K=Q({x:x.x,y:R},{x:s+z,y:R+m},z,m,X,"h"),c=8):"R"===_?(K=Q({x:s,y:R},{x:x.x,y:R+m},z,m,X,"h"),c=32):"LB"===_?(K=k(x,{x:s+z,y:R},z,m,X),c=12):"B"===_?(K=Q({x:s,y:R},{x:s+z,y:x.y},z,m,X,"v"),c=4):"RB"===_&&(K=k(x,{x:s,y:R},z,m,X),c=36);var l=C.tf(K.x+K.width*e.x,K.y+K.height*e.y);b instanceof Y.Block&&(n.hasOwnProperty("freezeFlag")||(n.freezeFlag=b._freezeSyncFromChildren,b._freezeSyncFromChildren=!0)),b.setPosition(l),b.setSize(K.width,K.height),W&&(q=b.getRect(),U.rectGuide.gatherLines({node:b,x:q.x,y:q.y,w:q.width,h:q.height},u,c)),f=""+Math.round(K.width)+" * "+Math.round(K.height)}else if("line"===p){if(Dc(F)){var V=b.getPoints(),h="P1"===_?V.get(1):V.get(0),w={x:t.x-h.x,y:t.y-h.y},T=U.getStyle("shiftLineRotateRound"),O=j._shiftDirList;if(!O||j._shiftRotateRound!==T){j._shiftRotateRound=T,j._shiftDirList=O=[];for(var D=0;D<Math.PI;D+=T)O.push({x:d(D),y:I(D)})}for(var H,A=0,$=0,B=O.length;B>$;$++){var N=O[$],P=N.x*w.x+N.y*w.y;Math.abs(P)>Math.abs(A)&&(A=P,H=N)}t={x:h.x+H.x*A,y:h.y+H.y*A},U.rectGuide.clear()}else j._inSmartGuide&&!Y.Default.isCtrlDown(F)&&(j._adsorbedToClosest(t),W=!0);var o=ym.getDataMatrix(b).applyInverse(t);b.setPoint("P1"===_?0:1,o,!0);var G=b.getPoints(),g=G.get(0),r=G.get(1);s=g.x-r.x,R=g.y-r.y,f=" "+Math.round(Math.sqrt(s*s+R*R))+" ",W&&(q=b.getRect(),U.rectGuide.gatherLines({node:b,x:q.x,y:q.y,w:q.width,h:q.height}))}if(f){var Z=Y.Default.getLogicalPoint(F,U._canvas);Z.x+=ym.Icons.TipShiftX,Z.y+=ym.Icons.TipShiftY,j.tipInfo={helperPos:Z,text:f,size:f.length}}j._fireEditEvent("between",F)}},bb.prototype._unionPointMode1=function(g,T,d,j,c){if(c&&d&&j){var r=g.x-T.x,O=g.y-T.y;Math.abs(r*j)<Math.abs(O*d)?(O=Math.sign(O)*Math.abs(r*j/d),g.y=T.y+O):(r=Math.sign(r)*Math.abs(O*d/j),g.x=T.x+r)}return Y.Default.unionPoint(g,T)},bb.prototype._unionPointMode2=function(e,Z,A,P,V,w){var T=Y.Default.unionPoint(e,Z);if(V&&A&&P){var n;"v"===w?(n=T.x+T.width/2,T.width=A*T.height/P,T.x=n-T.width/2):(n=T.y+T.height/2,T.height=P*T.width/A,T.y=n-T.height/2)}return T},bb.prototype._adsorbedToClosest=function(x,P){var D=this,n=D._interactor,g=n.rectGuide.findClosest(x,P),w=n.gridGuide.findClosest(x,P),b=1/0,t=1/0;g&&(isFinite(g.x)&&(b=g.x),isFinite(g.y)&&(t=g.y)),w&&(isFinite(w.x)&&Math.abs(w.x)<Math.abs(b)&&(b=w.x),isFinite(w.y)&&Math.abs(w.y)<Math.abs(t)&&(t=w.y)),isFinite(b)&&(x.x+=b),isFinite(t)&&(x.y+=t)},bb.prototype._42=function(x,e,K){var G=this;G.info={},G.screenInfo=null;var q=G._interactor;if(!q.editDetail&&G.gatherInfo(e,K)){var i=G.editing,W=i?i.groupRotateMode:null,E=G.screenInfo;if("block"!==W){if(E.P1?ym.Icons.DrawIcon(q,x,ym.Icons.Line,E):ym.Icons.DrawIcon(q,x,ym.Icons.Rect,E),E.connect&&(ym.Icons.DrawIcon(q,x,ym.Icons.ConnectGuide,{rotation:E.rotation,connect:E.connect,cursorPos:i?i.cursorPos:null}),i)){if(i.targetCorners){for(var h={x:1/0,y:1/0},s={x:-1/0,y:-1/0},k=0,M=i.targetCorners.length;M>k;k+=2)h.x=Math.min(h.x,i.targetCorners[k]),s.x=Math.max(s.x,i.targetCorners[k]),h.y=Math.min(h.y,i.targetCorners[k+1]),s.y=Math.max(s.y,i.targetCorners[k+1]);ym.Icons.DrawIcon(q,x,ym.Icons.HoverDataRect,{min:h,max:s,color:q.getStyle("hoverGuideColor")||q.getStyle("baseColor")})}i.garbageInfo&&ym.Icons.DrawIcon(q,x,ym.Icons.ConnectGuideGarbage,i.garbageInfo)}G.tipInfo&&ym.Icons.DrawIcon(q,x,ym.Icons.TipHelper,G.tipInfo)}G.target instanceof ym.Group&&G.target._42(q,x,e)}};var ms=ym.Anchor=function(V){this.catalog="Anchor",this._interactor=V};ms.prototype={},ms.prototype.constructor=ms,ms.prototype.gatherInfo=function(M,N){var J=this;if(1===N.length){var W=N[0];if(!W.getAnchor)return;if(W instanceof Y.Shape&&W._70I())return;if(gs(W,M))return;return J.gatherSingleTarget(M,N[0])}return N.length>1?J.gatherMultiTargets(M,N):!1},ms.prototype.gatherSingleTarget=function(I,f){var Z=this;return Z.info.POS=f.getPosition(),Z.screenInfo.POS=ym.toScreenPosition(I,Z.info.POS),Z.target=f,!0},ms.prototype.gatherMultiTargets=function(O,q){var Q=this,F=ym.Group.findOrCreateGroup(q);return F?(Q.screenInfo.POS=ym.toScreenPosition(O,F.getAnchor2()),Q.target=F,!0):!1},ms.prototype.isVisible=function(){var K=this,r=K._interactor;if(r.getStyle("anchorVisible")===!1)return!1;var R=K.target;if(R){if(this.editing)return!0;var z=R.getAnchor(),T=r.getStyle("anchorOutsideVisibleThreshold");if(z.x<-T||z.x>1+T||z.y<-T||z.y>1+T)return!0;var U=R.getSize(),t=R.getScale(),h=Math.min(Math.abs(U.width*t.x),Math.abs(U.height*t.y));if(h*r.gv._zoom<r.getStyle("anchorHideThreshold"))return!1}return!0},ms.prototype.check=function(h,f,J){if(Y.Default.isLeftButton(f)){var q=this,x=q._interactor;if(q.isVisible()&&x.getStyle("anchorMovable")!==!1){q.editing=null,q.tipInfo=null;var p=q.target;if(p&&h.isAnchorEditable(p)&&h.isEditable(p)){var l;if(q.screenInfo&&(l=q.screenInfo.POS)&&ym.checkHit(J,new ym.Math.Vector2(l),x.getStyle("checkSize"))){if(p instanceof ym.Group)return q.editing={},!0;var U=p.getWidth(),s=p.getHeight(),C=p.getAnchor();return q.editing={rect:{x:-U*C.x,y:-s*C.y,width:U,height:s},anchor:C,matrix:p.getMatrix()},!0}}}}},ms.prototype.startEdit=function(C,f){C.startDragging(f),C.fi({kind:"beginEditAnchor",event:f})},ms.prototype._46O=function(P){var s=this;s.editing&&(s.editing=null,s._interactor.fi({kind:"endEditAnchor",event:P})),s.tipInfo=null},ms.prototype.handleEdit=function(B,P){var W=this,t=W.target;if(t){var M=W.editing;if(M){var G=B.lp(P),D=W._interactor;if(t instanceof ym.Group)return t.setAnchor2(G),D._42(),void 0;var N=M.matrix,h=N.tfi(G),S=M.rect,q=(h.x-S.x)/S.width,Q=(h.y-S.y)/S.height;if(!Y.Default.isCtrlDown(P)){var p=D.getStyle("anchorRound"),x=D.getStyle("anchorSensitivity");q=ym.roundTo(q,p,x),Q=ym.roundTo(Q,p,x)}t.setAnchor(q,Q,!0);var F=Y.Default.getLogicalPoint(P,D._canvas);F.x+=ym.Icons.TipShiftX,F.y+=ym.Icons.TipShiftY;var J=""+q.toFixed(2)+", "+Q.toFixed(2);W.tipInfo={helperPos:F,text:J,size:J.length},D.fi({kind:"betweenEditAnchor",event:P})}}},ms.prototype._42=function(l,x,O){var Q=this;Q.info={},Q.screenInfo={};var s=Q._interactor;s.editDetail||Q.gatherInfo(x,O)&&Q.isVisible()&&(ym.Icons.DrawIcon(s,l,ym.Icons.Anchor,Q.screenInfo),Q.tipInfo&&ym.Icons.DrawIcon(s,l,ym.Icons.TipHelper,Q.tipInfo))};var bq=ym.MoveDummy=function(F){this.catalog="MoveDummy",this._interactor=F};bq.prototype={},bq.prototype.constructor=bq,bq.prototype.gatherInfo=function(){var k=this,V=this._interactor.getSubModule("Rect");if(V){var z=V.screenInfo;if(z){var c=k._interactor,y=k.getMovableTarget(V.target);if(y){var e=c.getStyle("moveDummyThreshold");if(e!==!1){var E=z.LT||z.P1,R=z.RT||z.P2,W=z.LB||E;if(E){var S=z.P1,p=Math.min(E.distanceTo(W),E.distanceTo(R));if(!(e!==!0&&p>e)){var w=c.getStyle("moveDummyPosition"),q=R.clone().sub(E),m=W.clone().sub(E),T=w[2],J=w[3];if(S){var d=c.getStyle("moveDummyLineExtraShift");d&&(T+=d[0],J+=d[1])}var L=E.clone().add(q.clone().multiplyScalar(w[0])).add(q.setLength(T)).add(m.clone().multiplyScalar(w[1])).add(m.setLength(J));return k.screenInfo.pos=L,k.screenInfo.size=c.getStyle("moveDummySensitivity"),!0}}}}}}},bq.prototype.getMovableTarget=function(H){var C=this._interactor.gv;if(wk(H)){if(C.isMovable(H))return H}else if(H instanceof ym.Group)for(var q=H._entities,e=q.length-1;e>=0;e--){var P=q[e];if(wk(P)&&C.isMovable(P))return P}return null},bq.prototype.getMoveInteractor=function(){for(var i,u,C,U=this._interactor.gv,R=U.getInteractors(),i=0,u=R.length;u>i;i++)if(C=R.get(i),C instanceof pb)return C},bq.prototype.startEdit=function(H,o){H.startDragging(o);var P=this.getMoveInteractor();if(P){var l=this.selectedTarget,I=H.gv;I._moving=1,P._data=l,I.handleMouseDown&&I.handleMouseDown(o,l)}},bq.prototype._46O=function(x){var O=this,e=O.getMoveInteractor();e&&(e.handleWindowMouseUp(x),O.selectedTarget=null)},bq.prototype.handleEdit=function(k,t){var P=this.getMoveInteractor();P&&P.handleWindowMouseMove(t)},bq.prototype.check=function(M,l,T){if(this.selectedTarget=null,Y.Default.isLeftButton(l)&&!M._scrolling&&!Kb()){var H=this;if(H.screenInfo){var F=H.screenInfo.pos;if(F&&!(T.distanceTo(F)>H.screenInfo.size)){var D=H._interactor;return H.selectedTarget=H.getMovableTarget(D.getSubModule("Rect").target),D.setCursor("default"),!0}}}},bq.prototype._42=function(o,I,J){var w=this;w.screenInfo={};var n=w._interactor;n.editDetail||w.gatherInfo(I,J)&&(!n.editing||w.selectedTarget)&&ym.Icons.DrawIcon(n,o,ym.Icons.MoveDummy,w.screenInfo)};var Ul=ym.RotateX=function(Y){this.catalog="RotateX",this._interactor=Y};Ul.prototype={},Ul.prototype.constructor=Ul,Ul.prototype.gatherInfo=function(L,g){var k=this;if(1===g.length){var p=g[0];return p instanceof Y.Shape&&p._70I()||gs(p,L)?!1:k.gatherSingleTarget(L,p)}return g.length>1?k.gatherMultiTargets(L,g):!1},Ul.prototype.gatherSingleTarget=function(){var E=new Y.Math.Vector2,U=new Y.Math.Vector2,f=new Y.Math.Vector2,B=new Y.Math.Vector2,k=function(K,h){var c=K.x-h.x,q=K.y-h.y;return c*c+q*q};return function(Y,h){if(h.getCorners){var q=this,J=h.getCorners(),e=15,C=h.getPosition();E.copy(J[0]),f.copy(J[1]),B.copy(J[3]),U.copy(E).add(B).divideScalar(2).add(E.sub(f).setLength(e/Y.getZoom()));var $=Math.max(k(C,J[0]),k(C,J[1]),k(C,J[2]),k(C,J[3]));return q.info.POS=U.clone(),q.screenInfo.POS=ym.toScreenPosition(Y,q.info.POS),q.screenInfo.LEN=Math.sqrt($)*Y.getZoom()+e,q.screenInfo.CENTER=ym.toScreenPosition(Y,C),q.target=h,!0}}}(),Ul.prototype.gatherMultiTargets=function(W,P){var O=this,l=ym.Group.findOrCreateGroup(P);if(!l)return!1;var O=this;return O.gatherSingleTarget(W,l)},Ul.prototype.isVisible=function(){var i=this._interactor;if(!i.getStyle("rotateAsClock"))return!1;var C=this.target;if(!C)return!0;var P=i.gv;return P.isEditable(C)&&P.isRotationEditable(C)?!0:!1},Ul.prototype.check=function(d,e,l){var v=this,t=v._checkImpl(d,e,l);return(t||v._clockPainted)&&v._interactor._42(),t},Ul.prototype._checkImpl=function(K,G,z){if(Y.Default.isLeftButton(G)){var Z=this;Z.editing=null,Z.tipInfo=null;var V;if(Z.screenInfo&&(V=Z.screenInfo.POS)&&Z.isVisible()){var c=Z._interactor;if(ym.checkHit(z,V,c.getStyle("checkSize"))){var s=Z.target,I=K.lp(G),F=s.getPosition(),w=Math.atan2(I.y-F.y,I.x-F.x);return c._setRotateCursor(w),Z.editing={pos:F,rotation:s.getRotation(),hitRot:w,groupRotateMode:"block",screenInfo:{CENTER:Z.screenInfo.CENTER,LEN:Z.screenInfo.LEN}},!0}}}},Ul.prototype.startEdit=function(H,L){H.startDragging(L),H.fi({kind:"beginEditRotation",event:L}),this.target instanceof ym.Group&&this.target.beginRotate(this.editing)},Ul.prototype._46O=function(v){var m=this;m.editing&&(m.editing=null,m._interactor.fi({kind:"endEditRotation",event:v})),m.target instanceof ym.Group&&m.target.endRotate(),m.tipInfo=null},Ul.prototype.handleEdit=function(e,V){var G=this,k=G.editing;if(k){var q,C,x=G.target,t=e.lp(V),I=G._interactor,H=k.pos,i=Math.atan2(t.y-H.y,t.x-H.x),W=x instanceof ym.Group;if(W?C=i-k.hitRot:(q=i-k.hitRot,C=k.rotation+q),C%=2*Math.PI,0>C&&(C+=2*Math.PI),!Y.Default.isCtrlDown(V)){var N,o;Dc(V)?(N=I.getStyle("shiftRotateRound"),o=N/2):(N=I.getStyle("rotateRound"),o=I.getStyle("rotateSensitivity")),C=ym.roundTo(C,N,o)}W?(q=C-(k.lastRotation||0),0!==q&&(x.addRotation(q,k.groupRotateMode,function(q){return e.isRotationEditable(q)}),k.lastRotation=C)):x.setRotation(C),I._setRotateCursor(i),C>Math.PI&&(C-=2*Math.PI);var J=180*(C/Math.PI),h=""+J.toFixed(2)+"°",R=Y.Default.getLogicalPoint(V,I._canvas);R.x+=ym.Icons.TipShiftX,R.y+=ym.Icons.TipShiftY,G.tipInfo={helperPos:R,text:h,size:h.length},I.fi({kind:"betweenEditRotation",event:V})}},Ul.prototype._42=function(D,V,x){var S=this;S._clockPainted=!1,S.info={},S.screenInfo={};var K=S._interactor;K.editDetail||S.gatherInfo(V,x)&&S.isVisible()&&(ym.Icons.DrawIcon(K,D,ym.Icons.RoundPoint,S.screenInfo.POS),S.tipInfo&&ym.Icons.DrawIcon(K,D,ym.Icons.TipHelper,S.tipInfo),S.editing&&S.drawClock(D))},Ul.prototype.drawClock=function(l){l.save();var U=this;U._clockPainted=!0;var D=U.editing||{},h=D.screenInfo||U.screenInfo,N=h.LEN,y=N+8,e=N+18;l.save(),l.translate(h.CENTER.x,h.CENTER.y),l.beginPath(),l.strokeStyle="rgb(150, 150, 150)";for(var j,g,K,Q,M,m=0;360>m;m++)j=m*Math.PI/180,0===m%5&&(g=I(j)*N,K=d(j)*N,Q=I(j)*y,M=d(j)*y,l.moveTo(g,K),l.lineTo(Q,M)),0===m%45&&(g=I(j)*N,K=d(j)*N,Q=I(j)*e,M=d(j)*e,l.moveTo(g,K),l.lineTo(Q,M));l.stroke(),l.rotate(-T);var b=D.lastRotation||U.target.getRotation();l.beginPath(),l.fillStyle="rgba(255, 0, 0, 0.1)",l.strokeStyle="rgb(157, 157, 157)",l.moveTo(0,0),l.arc(0,0,e,0,b,!1),l.fill(),l.beginPath(),l.moveTo(0+e,0),l.arc(0,0,e,0,b,!1),l.stroke(),l.restore()};var jl=ym.Curve=function(w){this.catalog="Curve",this._interactor=w};jl.prototype={},jl.prototype.constructor=jl,u.defineProperties(jl.prototype,{activing:{get:function(){return this._activing},set:function(S){var w=this;if(S)w._activing=new ym.CurveActiving(this,S),w._activing._firePointChange();else{var F=w._activing;F&&F.dispose(),w._activing=null}}}}),jl.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},jl.prototype.setUp=function(){var j=this,f=j._interactor;f&&f.gv.mp(j._onGraphviewPropertyChanged,j)},jl.prototype._onGraphviewPropertyChanged=function(R){("zoom"===R.property||"translateX"===R.property||"translateY"===R.property)&&this._handleDataChanged()},jl.prototype.tearDown=function(){var X=this,q=X._interactor;q&&q.gv.ump(X._onGraphviewPropertyChanged,X)},jl.prototype.canEnterEditDetailMode=function(){var L=this,k=L._interactor,m=k._getValidSelection();if(1===m.length){var E=m[0],t=E instanceof Y.Edge;if(E instanceof Y.Shape||t){if(t){var e=E.s("edge.type");if(e&&"points"!==e)return}var i=k.gv;if(i.isPointEditable(E)&&i.isEditable(E))return L.target=E,!0}}},jl.prototype.canQuitEditDetailMode=function(x){var M=this,c=M._interactor._getLogicalPoint(x);return M._checkEditRealPoint(c)?void 0:M._interactor.gv.getDataAt(x)!==M.target?!0:void 0},jl.prototype.preHandleScroll=function(){var X=this.editing;return X&&X.inEdit?!0:void 0},jl.prototype.getCurrentSelectintStatus=function(){var z=this;if(z.activing&&!z.activing.selections){if(z.activing.status!=w)return z.activing.status;var R=function(m){var O=z.activing.status;z.activing.status=m,z._interactor.fp("shapePointStatus",O,m)},o=ym.Curve.PointType,L=z.activing.point,f=z.activing.pairs;if(!f||1!==f.length)return R(o.Mirrored);var I=f[0],i=I.c1&&I.c1.isNearEnough(L),F=I.c2&&I.c2.isNearEnough(L);if(!I.c1||!I.c2)return i||F?R(o.Straight):R(o.Disconnected);if(i&&F)return R(o.Straight);if(i||F)return R(o.Asymmetric);var _=I.c1.clone().sub(L),l=I.c2.clone().sub(L);return Math.abs(_.x*l.y-_.y*l.x)>1e-5||_.x*l.x>0?R(o.Disconnected):Math.abs(_.length()-l.length())>1e-5?R(o.Asymmetric):R(o.Mirrored)}},jl.prototype.handle_keydown=function(T){var Q=this;if(Q._interactor.editDetail){var c=ym.Curve.PointType;"1"===T.key?Q._setCurrentSelectionStatus(c.Straight):"2"===T.key?Q._setCurrentSelectionStatus(c.Mirrored):"3"===T.key?Q._setCurrentSelectionStatus(c.Disconnected):"4"===T.key&&Q._setCurrentSelectionStatus(c.Asymmetric)}},jl.prototype.setCurrentSelectionStatus=function(C){var r=this,b=r._interactor;if(b){var L=b.gv;L.dm().beginTransaction(),this._setCurrentSelectionStatus(C),L.dm().endTransaction()}},jl.prototype._setCurrentSelectionStatus=function(v){var V=this,L=V.activing;if(L){var O=V.getCurrentSelectintStatus();if(null!==O&&O!==v){L.status=v;var Y=V.activing.point,b=V.activing.pairs;if(b&&1===b.length){var p=b[0],N=V.screenInfo.curve,R=ym.Curve.PointType,J=V._interactor,K=function(){V._writeToHt(),J.fp("shapePointStatus",O,v),V.check(J.gv,null,new ym.Math.Vector2(J._lastLogicalPoint))};if(v===R.Straight)return N.moveCtrlPoint(p,Y,"c1"),N.moveCtrlPoint(p,Y,"c2"),K(),void 0;if(O===R.Straight){var I=N.findPairs(Y,!0),A=I[0],W=A.r1||Y,a=A.r2||Y,h=a.clone().sub(W).multiplyScalar(.25);return N.moveCtrlPoint(p,Y.clone().sub(h),"c1"),N.moveCtrlPoint(p,Y.clone().add(h),"c2"),K(),void 0}var E=p.c1,l=p.c2;if(E&&l){if(v===R.Mirrored)return N.moveCtrlPoint(p,Y.clone().multiplyScalar(2).sub(l),"c1"),K(),void 0;if(v===R.Asymmetric&&O===R.Disconnected){var z=E.clone().sub(Y).length(),h=Y.clone().sub(l).setLength(z).add(Y);return N.moveCtrlPoint(p,h,"c1"),K(),void 0}}L._firePointChange(),J.fp("shapePointStatus",O,v),V.check(J.gv,null,new ym.Math.Vector2(J._lastLogicalPoint))}}}},jl.prototype._handleDataChanged=function(){var i="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(b){var y=this;if(y.screenInfo&&y.target){if(b&&i.indexOf(b.property)<0)return;var J=y._interactor;y.gatherSingleTarget(J.gv,y.target,!0),y.check(J.gv,null,new ym.Math.Vector2(J._lastLogicalPoint)),J._42()}}}(),jl.prototype.gatherSingleTarget=function(e,O,g){var q,U,T=this;T.screenInfo&&T.screenInfo.curve&&(U=T.screenInfo.curve._curves);var I=T.editing;q=I?T.screenInfo:T.screenInfo={};var G,l,E=O instanceof Y.Edge;E?(G=O.s("edge.segments"),l=O.s("edge.points")||new Y.List):(G=O._58O,l=O._59O),q.S=G;var B,z=q.P=[],m=ym.getDataMatrix(O);if(O instanceof Y.Polyline||O instanceof Y.Edge&&T._interactor.getStyle("edgeElevationEditable"))B=O.getElevation&&O.getElevation()||0,q.E=[];else{var a=!1;l.each(function(V){V.e!==w&&(a=!0)}),a&&(q.E=[])}if(l.each(function(N){q.E&&q.E.push(N.e!=w?N.e:B),N=m.apply(N);var L=ym.toScreenPosition(e,N);z.push(L.x,L.y)}),E){var D=z.length,S=ym.toScreenPosition(e,O._lastSourcePoint||(D?{x:z[0],y:z[1]}:{x:0,y:0})),h=ym.toScreenPosition(e,O._lastTargetPoint||(D?{x:z[D-2],y:z[D-1]}:{x:0,y:0}));z.splice(0,0,S.x,S.y),z.push(h.x,h.y),q.E&&(q.E.splice(0,0,"head"),q.E.push("tail"))}if(!q.S||!q.S.size()){q.S=new Y.List,q.S.add(1);for(var K=0;K<z.length/2-1;K++)q.S.add(2)}if((!I||g)&&T.convertToCubicBezier(U),T.activing&&(g||!T.editing||"realPoint"===T.editing.type)){var M=q.curve.findPairs(T.activing.point);T.activing.pairs=M}},jl.prototype._convertToNewPoint=function(c,k,F,d){var m,Z,n;for(m=0,Z=k.length;Z>m;m++){if(n=k[m],n._p1.isNearEnough(c)&&(!d||d.indexOf(n._p1)<0))return n._p1;if(n._p4.isNearEnough(c)&&(!d||d.indexOf(n._p4)<0))return n._p4}if(F)for(m=0,Z=Math.min(F.length,Z);Z>m;m++){if(n=F[m],n._p1===c&&(!d||d.indexOf(k[m]._p1)<0))return k[m]._p1;if(n._p4===c&&(!d||d.indexOf(k[m]._p4)<0))return k[m]._p4}},jl.prototype.convertToCubicBezier=function(S){var u,t,l=this,q=new ym.Math.Curve,a=l.screenInfo;if(q.createFromHtShape(a.P,a.S,a.E),a.curve=q,l.activing){var y=q._curves;u=l.activing.point,t=l._convertToNewPoint(u,y,S);var s=[];if(t&&(l.activing.point=t,s.push(t)),l.activing.selections){var E=-1,p=l.activing.selections;p.forEach(function(m){E++,t=l._convertToNewPoint(m,y,S,s),t&&(p[E]=t,s.push(t))})}}},jl.prototype.check=function(z,g,m){if(!g||Ir(g)||He(g)){var w=this;if(w._interactor.setCursor("default"),w.editing=null,w.highlight=null,w.tipInfo=null,w.edgeEditResult=null,w.screenInfo){if(Kb()||He(g))return w._interactor._42(),!0;if(w._checkEditCtrlPoint(m))return w._interactor._42(),!0;if(w._checkEditRealPoint(m))return w._interactor._42(),!0;if(w._checkEditElevation(m))return w._interactor._42(),!0;var t=w.screenInfo.curve,s=t.checkPoint(m,w._interactor.getStyle("curveIntersectSize"));if(s){var d=w.highlight={};d.type="insertKnot",d.bezier=s.bezier,d.point=s.intersection}return w._interactor._42(),!0}}},jl.prototype._checkEditRealPoint=function(P){var I,l,R,x,F,e,n=this,$=n.screenInfo.curve._curves,W=n._interactor.getStyle("curvePointIntersectSize"),z=1/0;for(W*=W,R=0,x=$.length;x>R;R++)I=$[R],F=I._p1,e=P.distanceToSquared(F),z>e&&(z=e,l=F),F=I._p4,e=P.distanceToSquared(F),z>e&&(z=e,l=F);if(z>W)return!1;var b=n.highlight={};return b.type="changeRealPoint",b.point=l,n.editing={type:"realPoint",point:l,shiftGuide:{point:l.clone(),dir:"x",limit:0}},n._interactor.setCursor("crosshair"),!0},jl.prototype._checkEditElevation=function(r){var E=this;if(!E._interactor.getStyle("curveElevationVisible"))return!1;var H=E.target;if(H instanceof Y.Edge&&!E._interactor.getStyle("edgeElevationEditable"))return!1;var y=E.activing;if(!y)return!1;var v=y.getCurrentEditingPoint();if(!v)return!1;var k=E._interactor,q=k.getStyle("curveElevationGuideShift"),D=k.getStyle("curveElevationIntersectSize"),f=r.distanceToSquared({x:v.x+q[0],y:v.y+q[1]});
if(!(f>D*D)){var R=E.highlight={};R.type="elevation";var K=new ym.Math.Vector2(r.x,r.y,v.e);return E.editing={type:"elevation",startPoint:K},E._interactor.setCursor("crosshair"),!0}},jl.prototype._checkEditCtrlPoint=function(p){var m=this;if(m.activing&&!m.activing.selections){var e=m.getCurrentSelectintStatus();if(e!==ym.Curve.PointType.Straight){var L=m.activing.pairs;if(L){var l=m._interactor.getStyle("curvePointIntersectSize");l*=l;var E,X,G,O,Q,U,C,f,T,J=1/0;for(C=0,T=L.length;T>C;C++)for(O=L[C],f=0;2>f;f++)Q=0===f?"c1":"c2",O[Q]&&(U=p.distanceToSquared(O[Q]),J>U&&(J=U,E=O,X=C,G=Q));if(J>l)return!1;m.activing.hlpair=E,m.activing.hltype=G;var w=m.highlight={};return w.type="changeCtrlPoint",w.point=E[G],m.editing={type:"ctrlPoint",pair:E,pairId:X,ctrlType:G,direction:E[G].clone().sub(m.activing.point).normalize()},m._interactor.setCursor("crosshair"),!0}}}},jl.prototype.startEdit=function(X,j){X.startDragging(j);var G=this;G.highlight&&"insertKnot"===G.highlight.type&&(G.insertKnot(),G.gatherSingleTarget(G._interactor.gv,G.target),G.activing=null,G._checkEditRealPoint(G._interactor._getLogicalPoint(j)));var I=G._activing;if(I){var t=G.editing?G.editing.type:null;"ctrlPoint"===t?I.editingCtrl={pairId:G.editing.pairId,type:I.hltype}:"realPoint"===t&&(I.editingCtrl=!1)}var x=G.highlight,s=Y.Default.isCtrlDown(j);if(!x||Kb()||He(j)){var u=G._interactor.gv;if(!u.setFocus(j)||u._scrolling)return;return s?G._multiSelect={startPoint:u.lp(j)}:u.isPannable()&&(Ir(j)||He(j))&&(G._pan={tx:u.tx(),ty:u.ty()},X.fi({kind:"beginPan",event:j})),void 0}if("changeRealPoint"===x.type){var i,p=G.activing?G.activing.point:null,v=G.activing?G.activing.selections:null;if(s&&G.activing)p===x.point?(v?(G.activing={point:v[0]},v.length>1&&(v.splice(0,1),G.activing.selections=v)):G.activing=null,G.editing=null):v&&(i=v.indexOf(x.point))>=0?(v.length>1?v.splice(i,1):delete G.activing.selections,G.editing=null):v?(v.push(p),G.activing={point:x.point,selections:v}):G.activing={point:x.point,selections:[p]};else if(v)p===x.point||((i=v.indexOf(x.point))>=0?(v.splice(i,1,p),G.activing={point:x.point,selections:v}):G.activing={point:x.point});else{var h;p===x.point&&(h=G.activing.status),G.activing={point:x.point},h&&(G.activing.status=h)}X.fi({kind:"beginEditPoint",event:j})}},jl.prototype.insertKnot=function(){var N=this,z=N.highlight,Y=N.screenInfo.curve;Y.insertKnot(z.bezier,z.point.t),N._writeToHt()},jl.prototype._writeToHt=function(){var k,e,F=this,n=F.screenInfo.curve,c=n.toHtShape(),X=c.points,J=[],m=c.segments,p=F._interactor.gv;p.dm().beginTransaction();var t,o,z=F.target,K=z instanceof Y.Edge,u=ym.getDataMatrix(z).invert();o=z instanceof Y.Polyline||z instanceof Y.Edge&&F._interactor.getStyle("edgeElevationEditable"),o&&(t=z.getElevation&&z.getElevation()||0);for(var L=0,x=X.length;x>L;L++)k=X[L],e=ym.toWorldPosition(p,k),e=u.apply(e),isFinite(k.e)&&k.e!==t&&(e.e=k.e),J.push(e);if(z._writing=!0,K){z.s("edge.type","points"),z.setStyle("edge.segments",m),z.setStyle("edge.points",J.slice(1,J.length-1)),z.setStyle("edge.source.offset.x",0),z.setStyle("edge.source.offset.y",0),z.setStyle("edge.target.offset.x",0),z.setStyle("edge.target.offset.y",0);var g=F._nextChangeEdgeHost;delete F._nextChangeEdgeHost,g&&("source"===g.type?z.setSource(g.host):z.setTarget(g.host)),F._writeEdgeHostAnchor("source",J[0]),F._writeEdgeHostAnchor("target",J[J.length-1])}else J.length?(z.setSegments(m),z.setPoints(J,!0)):z.removeFromDataModel();p.dm().endTransaction(),delete z._writing},jl.prototype._writeEdgeHostAnchor=function(x,D){var u=this,H=u.target,t=u._calcHostAnchor(H,x,D);t.index!==w?(H.setStyle("edge."+x+".index",t.index),H.setStyle("edge."+x+".percent",w),H.setStyle("edge."+x+".anchor.x",w),H.setStyle("edge."+x+".anchor.y",w)):t.percent!==w?(H.setStyle("edge."+x+".percent",t.percent),H.setStyle("edge."+x+".index",w),H.setStyle("edge."+x+".anchor.x",w),H.setStyle("edge."+x+".anchor.y",w)):(H.s("edge."+x+".anchor.x",t.x),H.s("edge."+x+".anchor.y",t.y),t.offsetX||t.offsetY?(H.s("edge."+x+".offset.x",t.offsetX),H.s("edge."+x+".offset.y",t.offsetY)):(H.s("edge."+x+".offset.x",0),H.s("edge."+x+".offset.y",0)))},jl.prototype._calcHostAnchor=function(X,q,N,M){M||(M="source"===q?X.getSource():X.getTarget());var C=this._interactor.gv,$=C.calculateAttachPoint(M,N);if($)return $.info;if(br(M)){var _=C.calculateEdgePosition(M,N);return _}var i=M.getRotation(),f=M.getAnchor();gs(M,C)&&(i=0);var a=M.getScale();if(i||a.x<0||a.y<0){var J=M.getMatrix(),H=J.tfi(N),k=M.getSize();return{x:H.x/k.width+f.x,y:H.y/k.height+f.y}}var m=_k(C,M),o={x:(N.x-m.x)/m.width,y:(N.y-m.y)/m.height};return o},jl.prototype._handlePanning=function(T){var a=this,Y=a._pan;if(Y){Y.started=!0;var n=a._interactor,K=n.gv,v=n._lastClientPoint,j=ad(T),k=Ub(K,j,v);K.setTranslate(Y.tx+k.x,Y.ty+k.y),a.gatherSingleTarget(n.gv,a.target),n._42(),n.fi({kind:"betweenPan",event:T})}},jl.prototype.handleEdit=function(P,H){var j=this,o=j.editing;if(j._pan)return j._handlePanning(H),void 0;if(j._multiSelect)return j._multiSelect.endPoint=P.lp(H),j._interactor.redraw(),void 0;if(o){o.inEdit=!0;var C,$,q,E=j._interactor._getLogicalPoint(H),e=Y.Default.isCtrlDown(H),I=Y.Default.isShiftDown(H),J=o.type,p=j.activing;if(j._guideInfo=null,"ctrlPoint"===J&&I){var B=j.editing.direction.clone();C=p.point;var Q=B.dot(E.clone().sub(C));E=B.setLength(Q).add(C)}else if("ctrlPoint"===J||"realPoint"===J){var B;if("realPoint"===J&&I){var i=j.editing.shiftGuide;$=i.point;var W=Math.abs(E.x-$.x),N=Math.abs(E.y-$.y);W>N&&W>i.limit&&"y"===i.dir&&(i.dir="x"),N>W&&N>i.limit&&"x"===i.dir&&(i.dir="y"),B=i.dir,"x"===B?(E.y=$.y,i.limit=Math.max(i.limit,W)):"y"===B&&(E.x=$.x,i.limit=Math.max(i.limit,N))}var r=j._isEditEdgeSourceTarget();if(r){var s=j._editEdgeSourceTarget(r,E,e);s&&(j.edgeEditResult=s,q=s.tipText)}else if(!e){var h=j._guidingToEdit(E,B),U="realPoint"===J?j._interactor.gridGuide.findClosest(E,B,!0):null,l=1/0,K=1/0;U&&(U.x&&(l=U.x),U.y&&(K=U.y));var G=!1;h&&(h.xList&&(Math.abs(h.x)<=Math.abs(l)?(G=!0,l=h.x):delete h.xList),h.yList&&(Math.abs(h.y)<=Math.abs(K)?(G=!0,K=h.y):delete h.yList),G&&(j._guideInfo=h)),isFinite(l)&&(E.x+=l),isFinite(K)&&(E.y+=K),G&&(h.v=E)}}var x=j.screenInfo.curve;if("realPoint"===o.type){C=o.point,C.e!==w&&(E.e=C.e),x.moveRealPoint(C,E),o.point=E,j.highlight.point=E;var F=p.status,u=p.selections;if(j.activing={point:E,status:F},u){var y=E.clone().sub(C),z=0;u.forEach(function(d){var V=d.clone().add(y);x.moveRealPoint(d,V),u[z++]=V}),j.activing.selections=u}}else if("ctrlPoint"===o.type){var f=p.pairs,n=f[o.pairId];x.moveCtrlPoint(n,E,o.ctrlType);var g=p.status,R=ym.Curve.PointType;if((g===R.Mirrored||g===R.Asymmetric)&&n.c1&&n.c2){var C=new ym.Math.Vector2(p.point),V="c1"===o.ctrlType?"c2":"c1";if(g===ym.Curve.PointType.Mirrored)x.moveCtrlPoint(n,C.clone().multiplyScalar(2).sub(E),V);else if(g===R.Asymmetric){var Q=n[V].clone().sub(C).length(),t=C.clone().sub(n[o.ctrlType]).setLength(Q).add(C);isNaN(t.x)||x.moveCtrlPoint(n,t,V)}}p._firePointChange()}else if("elevation"===o.type){$=o.startPoint;var c=$.e+($.y-E.y)/P._zoom;j._setCurrentPointImpl("e",c),p._firePointChange(),q="E: "+ym.toFixed(c)}var d=Y.Default.getLogicalPoint(H,j._interactor._canvas);if(d.x+=ym.Icons.TipShiftX,d.y+=ym.Icons.TipShiftY,!q){var k=ym.toWorldPosition(P,E);q=""+ym.toFixed(k.x)+", "+ym.toFixed(k.y)}j.tipInfo={helperPos:d,text:q,size:q.length},j._writeToHt(),j._interactor.fi({kind:"betweenEditPoint",event:H})}},jl.prototype._setCurrentPointImpl=function(K,e){var S=this,c=S._activing;if(!c)return!1;var $=S.target;if(!$)return!1;var T=c.getCurrentEditingPoint();if(!T)return!1;var W=c.editingCtrl;if(!W)var X=T.clone();if("e"===K)T.e=e;else{var s;if("x"===K||"y"===K){var o=c._lastFirePoint;s="x"===K?{x:e,y:o?o.y:0}:{x:o?o.x:0,y:e}}else"object"==typeof K?(s=K,K.e!==w&&(T.e=K.e)):(s={x:arguments[0],y:arguments[1]},arguments[2]!==w&&(T.e=arguments[2]));var I=ym.getDataMatrix($);s=ym.toScreenPosition(S._interactor.gv,I.apply(s)),T.x=s.x,T.y=s.y}if(!W){var O=X.multiplyScalar(-1).add(T);T.e&&X.e&&(O.e=T.e-X.e);var n=S.screenInfo.curve;n.moveCtrlDueToRealPointMovement(T,O);var y=c.selections;if(y){var M=0;y.forEach(function(B){var E=B.clone().add(O);isFinite(O.e)&&(E.e=(isFinite(B.e)?B.e:$.getElevation()||0)+O.e),n.moveRealPoint(B,E),y[M++]=E}),c.selections=y}}return!0},jl.prototype.setCurrentPoint=function(z,w){return this._setCurrentPointImpl(z,w)?(this._writeToHt(),!0):!1},jl.prototype._isEditEdgeSourceTarget=function(){var z=this,B=z.target;if(!(B instanceof Y.Edge))return!1;var l=z.editing.point,P=z.screenInfo.curve._curves;return l===P[0]._p1?"source":l===P[P.length-1]._p4?"target":!1},jl.prototype._editEdgeSourceTarget=function(K,u,Z){var c,P=this,G=P.target;if(c="source"===K?G.getSource():G.getTarget()){var a,Y=P._interactor.gv,D=ym.toWorldPosition(Y,u),s=P._calcHostAnchor(G,K,D,c);if(a=s.index!==w||s.percent!==w?s.distance*Y.getZoom()>P._interactor.getStyle("edgeHostEdgeMaxDistance"):P._interactor.getStyle("edgeHostDetectPerFrame")?!0:s.x<0||s.x>1||s.y<0||s.y>1?!0:!1){var S=Y.getDataAt(D,function(P){return Y.isSelectable(P)?Y.isSourceTargetEditable(G,P,K)?G.canSetSourceTarget(P,K)?!0:!1:!1:!1});if(S){var E=P._calcHostAnchor(G,K,D,S);c=S,P._nextChangeEdgeHost={type:K,host:S},s=E}}var f,h,A;if(Z||s.x===w)(s.percent!==w||s.index!==w)&&(h=s.point);else{var e=P._interactor.getStyle("anchorRound"),F=P._interactor.getStyle("anchorSensitivity");f=Y.calculateAttachPoint(c,D),f?s=f.info:(s.x=ym.roundTo(s.x,e,F),s.y=ym.roundTo(s.y,e,F)),h=Nk(Y,c,0,s.offsetX||0,s.offsetY||0,s.x,s.y)}h&&(A=ym.toScreenPosition(Y,h),u.x=A.x,u.y=A.y),P._edgeHostGuideInfo={corners:ym.getTargetCornersOnScreen(Y,c),attach:f?f.index:-1,host:c};var p;return s.percent!==w?p="percent: "+s.percent.toFixed(2):s.index!==w?p="index: "+s.index:(p=""+s.x.toFixed(2)+", "+s.y.toFixed(2),(s.offsetX||s.offsetY)&&(p+=" offset: "+s.offsetX.toFixed(2)+", "+s.offsetY.toFixed(2))),{host:c,anchor:s,tipText:p}}},jl.prototype._guidingToEdit=function(j,y){var l,B,A=this;if(l=A.screenInfo.curve){B=l._curves;var P,b,s,r,Q,J,w,U,C=1/0,H=1/0,I=[];for(A.editing&&"realPoint"===A.editing.type&&(U=A.editing.point),Q=0,J=2*B.length;J>Q;Q++)w=B[Math.floor(Q/2)][Q%2?"_p4":"_p1"],I.indexOf(w)>=0||(I.push(w),U&&U===w||(s=w.x-j.x,r=w.y-j.y,Math.abs(s)<Math.abs(C)?(C=s,P=[w]):s===C&&P.push(w),Math.abs(r)<Math.abs(H)?(H=r,b=[w]):r===H&&b.push(w)));var D=A._interactor.getStyle("smartGuideThreshold");if((Math.abs(C)>D||"y"===y)&&(P=null),(Math.abs(H)>D||"x"===y)&&(b=null),P||b){var n=!1,R={};if(P&&(n=!0,R.xList=P,R.x=C),b&&(n=!0,R.yList=b,R.y=H),n)return R}}},jl.prototype._46O=function(C){var S=this;S.editing&&(S.editing=null,S._interactor.fi({kind:"endEditPoint",event:C})),S._guideInfo=null,S._edgeHostGuideInfo=null,S._pan&&(S._pan=null,S._interactor.fi({kind:"endPan",event:C})),S._multiSelect&&(S._handleMultiSelect(S._multiSelect),S._multiSelect=null),S.tipInfo=null,S.edgeEditResult=null},jl.prototype._handleMultiSelect=function(q){if(q.startPoint&&q.endPoint){var b,N,j,g,D,K=this,y=K._interactor,I=y.gv,u=ym.toScreenPosition(I,q.startPoint),e=ym.toScreenPosition(I,q.endPoint),o=Y.Default.unionPoint(u,e),m=K.screenInfo.curve._curves,s=[],n=function(h){h.x>=o.x&&h.y>=o.y&&h.x<=o.x+o.width&&h.y<=o.y+o.height&&s.indexOf(h)<0&&s.push(h)};for(b=0,N=m.length;N>b;b++)D=m[b],n(D._p1),n(D._p4);if(s.length){var R=K.activing||{},f=R.selections||[];for(R.point&&f.push(R.point),b=0,N=f.length;N>b;b++)j=f[b],g=s.indexOf(j),g>=0?s[g]=w:s.push(j);var B=s;for(s=[],b=0,N=B.length;N>b;b++)B[b]&&s.push(B[b]);N=s.length,0===N?K.activing=null:1===N?K.activing={point:s[0]}:(j=s[N-1],K.activing={point:j,selections:s.splice(0,N-1)}),y.redraw()}}},jl.prototype._canDeletePoint=function(g,s){var R=this.target;if(!(R instanceof Y.Edge))return!0;var Z=g._curves[0],y=g._curves[g._curves.length-1];return Z._p1===s||y._p4===s?!1:!0},jl.prototype.handleDelete=function(){var U=this;if(U.activing&&U.screenInfo){var s=Y.Default.isShiftDown(),f=U.screenInfo.curve;U._canDeletePoint(f,U.activing.point)&&f.deleteRealPoint(U.activing.point,s),U.activing.selections&&U.activing.selections.forEach(function(P){U._canDeletePoint(f,P)&&f.deleteRealPoint(P,s)}),U.activing=null,delete U.editing,delete U.tipInfo,delete U.edgeEditResult,delete U._pan,delete U._multiSelect,U._writeToHt(),U._interactor.fp("deleteShapePoint",!1,!0)}},jl.prototype.handleDoubleClick=function(Y){var W=this,p=W._interactor._getLogicalPoint(Y);if(W.screenInfo&&W._checkEditRealPoint(p)){var L=W.getCurrentSelectintStatus(),B=ym.Curve.PointType;return L=L===B.Mirrored?B.Straight:B.Mirrored,W._setCurrentSelectionStatus(L),W._interactor._42(),!0}},jl.prototype._drawHighlight=function(V){var u=this,n=u.highlight;if(n){var R=n.bezier,_=u._interactor;R&&ym.Icons.DrawIcon(_,V,ym.Icons.ShapeHighlightCurve,[R._p1.x,R._p1.y,R._p2.x,R._p2.y,R._p3.x,R._p3.y,R._p4.x,R._p4.y]);var s=n.point;s&&"insertKnot"===n.type&&ym.Icons.DrawIcon(_,V,ym.Icons.ShapeHighlighPoint,s)}},jl.prototype._drawGuide=function(p){var t=this,H=t._guideInfo;if(H){var V,C,O,s,d=H.v;for(V=0;2>V;V++)if(s=0===V?H.xList:H.yList)for(C=0,O=s.length;O>C;C++)ym.Icons.DrawIcon(t._interactor,p,ym.Icons.ShapeGuideLine,[d.x,d.y,s[C].x,s[C].y])}},jl.prototype._drawCurrentPoint=function(e){var w=this;if(w.activing){var P=w.activing,s=w.getCurrentSelectintStatus(),k=w._interactor;if(s!==ym.Curve.PointType.Straight){var b=P.pairs;P.hlpair,P.hltype;var G=P.selections,V=P.editingCtrl;if(b&&!G){var M,O,$;for(O=0,$=b.length;$>O;O++)M=b[O],V&&O===V.pairId&&M[V.type]?ym.Icons.DrawIcon(k,e,ym.Icons.ShapeActivingCtrl,{point:M.point,c1:M.c1,c2:M.c2,hl:V.type}):ym.Icons.DrawIcon(k,e,ym.Icons.ShapeActivingCtrl,M)}}ym.Icons.DrawIcon(k,e,ym.Icons.ShapeHighlighRealPoint,w.activing.point),G&&G.forEach(function(D){ym.Icons.DrawIcon(k,e,ym.Icons.ShapeHighlighRealPoint,D)})}},jl.prototype.clear=function(){var U=this;U.editing=null,U._guideInfo=null,U.activing=null,U.highlight=null},jl.prototype._42=function(z){var W=this;W.info={},W.editing||(W.screenInfo=null);var a=W._interactor;if(!a.editDetail)return W.clear(),void 0;var t=a.gv;if(!W.target||!t.isSelected(W.target)||!t.isVisible(W.target))return a.editDetail=!1,W.clear(),void 0;if(W.gatherSingleTarget(t,W.target),ym.Icons.DrawIcon(a,z,ym.Icons.ShapeBgCurve,W.screenInfo),W._interactor.getStyle("curveElevationVisible")&&(W.target instanceof Y.Polyline||W.target instanceof Y.Edge&&W._interactor.getStyle("edgeElevationEditable"))&&W.activing){var j=W.activing.getCurrentEditingPoint();j&&"string"!=typeof j.e&&ym.Icons.DrawIcon(a,z,ym.Icons.EdgeElevationGuide,j)}if(W._drawHighlight(z),W._drawCurrentPoint(z),W._getRealPoint().forEach(function(j){ym.Icons.DrawIcon(a,z,ym.Icons.ShapePoint,j)}),W._drawGuide(z),W.tipInfo&&W._interactor.getStyle("curveTipVisible")&&ym.Icons.DrawIcon(a,z,ym.Icons.TipHelper,W.tipInfo),W._edgeHostGuideInfo&&a._drawHostGuide(W._edgeHostGuideInfo),W.edgeEditResult&&W._drawEdgeHostHighlight(z,W.edgeEditResult.host,W.edgeEditResult.anchor),W._multiSelect&&W._multiSelect.endPoint){var L=Y.Default.unionPoint(ym.toScreenPosition(t,W._multiSelect.startPoint),ym.toScreenPosition(t,W._multiSelect.endPoint));L.color=t.getRectSelectBorderColor(),z.save(),z.setTransform(1,0,0,1,0,0);var n=i.devicePixelRatio,$=L.borderWidth=Math.round(n);$/=2,L.x=Math.round(L.x*n)+$,L.y=Math.round(L.y*n)+$,L.width=Math.round(L.width*n),L.height=Math.round(L.height*n),ym.Icons.DrawIcon(a,z,ym.Icons.SimpleRect,L),z.restore()}},jl.prototype._drawEdgeHostHighlight=function(w,y,F){this.drawEdgeHostHighlight(w,y,F),this._interactor.redraw()},jl.prototype.drawEdgeHostHighlight=function(v,p,G){if(br(p)){var _,e,Y,o,P=this,q=P._interactor,h=q.gv,Z=h.getDataUI(p),c=Zc(Z),U=[];for(Y=0,o=c.points.length;o>Y;Y++)e=ym.toScreenPosition(h,c.points.get(Y)),U.push(e.x,e.y);c.segments&&(_=c.segments.toArray());var t=q.getStyle("edgeHostHighlighPeriod"),u=q.getStyle("edgeHostEdgeHighlighColor");ym.Icons.DrawIcon(q,v,ym.Icons.ShapeBgCurve,{P:U,S:_,color:u,dynamicVisible:G.index===w,dynamicPeriod:t}),u=q.getStyle("edgeHostPointHighlighColor");var l=nl(Z);for(Y=0,o=l.length;o>Y;Y++){var X=l[Y],y=ym.toScreenPosition(h,X);ym.Icons.DrawIcon(q,v,ym.Icons.ShapePoint,{point:{x:y.x,y:y.y},color:u,size:12,dynamicVisible:Y===G.index,dynamicPeriod:t})}}},jl.prototype._getRealPoint=function(){var d,O=this.screenInfo,t=O.P,E=O.S,m=-1,z=[],j=-1,s=E.length;return E.each(function(T){j++;var l=1;if(3===T)l=2;else if(4===T)l=3;else if(5===T)return;m+=l,d=j+1>=s?!0:1===E.get(j+1)?!0:!1,z.push({point:{x:t[2*m],y:t[2*m+1]},segmentIndex:j,pointIndex:m,isEnd:d})}),z},jl.prototype.getEditingPointsInfo=function(m){var v=this,P=v.activing;if(!P)return!1;var R=P.point;if(!R)return!1;var f=this._getRealPoint(),q=[{screen:R}];P.selections&&P.selections.forEach(function(P){q.push({screen:P})});var E,F,z=f.length;return q.forEach(function($){for(E=0;z>E;E++)if(F=f[E],$.screen.isNearEnough(F.point)){$.segmentIndex=F.segmentIndex,$.pointIndex=F.pointIndex,$.point=v.target.getPoints().get(F.pointIndex);break}}),m&&q.sort(function(o,g){return o.segmentIndex-g.segmentIndex}),q};var In=ym.MoveHelper=function(h){var z=this;z.catalog="Move",z._interactor=h};In.prototype={},In.prototype.constructor=In,In.prototype.calcShift=function(G,w,l){var N,B,o=this,A=o._interactor.gv,V=A.lp(w);if("beginMove"===G&&o._gatherGridInfo(l._lastLogicalPoint||V),N=o._target){var i=N.downPosition;if(i){var u=o._interactor.getStyle("moveSensitivity")/A._zoom;if(i.distanceTo(V)<u)return{x:0,y:0};delete N.downPosition}var K;B=Y.Default.isShiftDown(w),B&&(V=o._dealShiftDown(V),K=N.shiftGuide.dir);var Z,I=N.rawPos={x:N.pos.x+V.x-N.lp.x,y:N.pos.y+V.y-N.lp.y};if(Y.Default.isCtrlDown(w)){if(Z=o._calcShiftByAddon(),o._target.node instanceof ym.Group){var d=o._target.node;d._position.x+=Z.x,d._position.y+=Z.y}return Z}var r=o._interactor.rectGuide;if(N.node instanceof Y.Data&&N.node.s("2d.attachable")){var U=o._calcAttachNodeShift(N.node,I);if(r.clear(),U)return U}for(var C,L=N.x+I.x,y=N.y+I.y,$={x:L,y:y},_={x:L+N.w/2,y:y+N.h/2},M={x:L+N.w,y:y+N.h},p=o._interactor.gridGuide,m=[r.findClosest($,K),r.findClosest(_,K),r.findClosest(M,K),p.findClosest($,K),p.findClosest(_,K),p.findClosest(M,K)],k=1/0,s=1/0,R=0,x=m.length;x>R;R++)C=m[R],C&&(L=C.x,y=C.y,isFinite(L)&&Math.abs(L)<Math.abs(k)&&(k=L),isFinite(y)&&Math.abs(y)<Math.abs(s)&&(s=y));if(isFinite(k)||(k=0),isFinite(s)||(s=0),Z=o._calcShiftByAddon(k,s),o._target.node instanceof ym.Group){var d=o._target.node;d._position.x+=Z.x,d._position.y+=Z.y}var E=N.node;if(!gs(E,A)){var g=I.x+k,z=I.y+s;o._interactor.rectGuide.gatherLines({node:E,x:N.x+g,y:N.y+z,w:N.w,h:N.h},K)}return Z}},In.prototype._calcShiftByAddon=function(t,z){var D=this._target,T=D.rawPos,$=D.node.getPosition();return t=t||0,z=z||0,{x:T.x-$.x+t,y:T.y-$.y+z}},In.prototype._dealShiftDown=function(t){var D=this,g=D._target.shiftGuide,z=D._target.lp,N=Math.abs(t.x-z.x),n=Math.abs(t.y-z.y);N>n&&N>g.limit&&"y"===g.dir&&(g.dir="x"),n>N&&n>g.limit&&"x"===g.dir&&(g.dir="y");var I=g.dir;return"x"===I?(t.y=z.y,g.limit=Math.max(g.limit,N)):"y"===I&&(t.x=z.x,g.limit=Math.max(g.limit,n)),t},In.prototype._isAttachableLineShape=function(L){if(!L.getSegments)return!1;var r=L.getSegments();if(!r)return!0;r instanceof Y.List&&(r=r.getArray());for(var T=1,o=r.length;o>T;T++)if(2!==r[T])return!1;return!0},In.prototype._calcAttachNodeShift=function(){var F=new ob,V=new ob,w=new ob,f=new ob;return function(T,a){var o=this._interactor.gv,y=T.getHost(),s=o.getDataAt(a,function(Z){return Z.s("2d.hostable")?!0:!1});if(s&&y!==s&&T.setHost(s),!s)return this._edgeHostGuideInfo=null,T.setHost(null);var U=this._edgeHostGuideInfo={corners:ym.getTargetCornersOnScreen(o,s),host:s,attach:-1};if(this._isAttachableLineShape(s)){for(var A,I,C,E,u,q,z=s.getPoints(),m=z.size(),h=s.getPointsMatrix2d(),$=1/0,v=0;m>v&&(v!==m-1||s.isClosePath());v++)0!==v?V.copy(w):h.apply(z.get(v),V),h.apply(v===m-1?z.get(0):z.get(v+1),w),F.copy(a).sub(V),f.copy(w).sub(V),A=f.length(),f.divideScalar(A),I=F.dot(f),0>I?I=0:I>A&&(I=A),f.multiplyScalar(I).add(V),C=F.copy(a).sub(f).lengthSq(),$>C&&($=C,q=v,E=I,u=A);return Math.sqrt($)*o.getZoom()>this._interactor.getStyle("attachThreshold")?(T.s({"attach.index":-1}),T.setHost(null),void 0):(T.s("attach.offset.opposite")&&(E=u-E),T.s({"attach.index":q,"attach.offset":T.s("attach.offset.relative")?E/u:E}),{x:0,y:0})}var c=o.calculateAttachPoint(s,a);if(c){var K=c.point;return U.attach=c.index,this._calcShiftByAddon(K.x-a.x,K.y-a.y)}}}(),In.prototype._gatherGridInfo=function(K){var Y,b=this,i=b._interactor,p=i._getValidSelection();if(p.length){if(1===p.length){if(Y=p[0],!Y.getRect)return b._target=null,void 0}else if(Y=ym.Group.findOrCreateGroup(p),!Y)return b._target=null,void 0}else{var p=i.gv.sm().getSelection();if(p.length&&(Y=p.get(0),!Y.getRect))return b._target=null,void 0}if(Y){var e=Y.getPosition(),r=Y.getRect();b._target={node:Y,x:r.x-e.x,y:r.y-e.y,w:r.width,h:r.height,lp:{x:K.x,y:K.y},pos:{x:e.x,y:e.y},shiftGuide:{dir:"x",limit:0},downPosition:new ym.Math.Vector2(K)},i.rectGuide.gatherRects()}},In.prototype.clear=function(){var k=this;k._edgeHostGuideInfo=null,k._interactor.rectGuide.clear(),k._interactor._42()},In.prototype._42=function(){var g=this._edgeHostGuideInfo;g&&this._interactor._drawHostGuide(g)};var Al="directional",rl="point",uq="spot",Pk="light.color",pr={},km=function(K,j){vh(j)&&Im.test(j)?An(K,j):ao(j)&&j.modelType?qj(K,j):j===w?delete pm[K]:pm[K]=j},Sm=function(X){return X},Wb=function(I){I=Q.convertShape3dModelName(I);var V;if(ao(I)){if(I.modelType){if(I.uuid){if(V=pm[I.uuid])return V}else I.uuid=Y.Math.generateUUID();return qj(I.uuid,I),w}return I}return V=pm[I],I&&V===w&&Im.test(I)&&(df&&df[I]||An(I,I)),V},Pi=function(B,Y){B.frameStack?B.frameStack.push(Y):B.frameStack=[Y],B.bindFramebuffer(B.FRAMEBUFFER,Y)},nr=function(V){var N=V.frameStack;if(N){if(N.pop(),N.length)return V.bindFramebuffer(V.FRAMEBUFFER,N[N.length-1]),void 0;V.frameStack=null}V.bindFramebuffer(V.FRAMEBUFFER,null)};oi(Q,{graph3dViewAttributes:t,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:S/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Mn,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:S,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:S/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:km,getShape3dModel:Wb,convertShape3dModelName:Sm,getShape3dModelMap:function(){return pm},getCachedShape3dModelMap:function(){return Pm},createMatrix:function(C,v){Cl(C)||(C=[C]);for(var y=C.length-1;y>=0;y--){var $=C[y];v=od($.mat,$.s3,$.r3,$.rotationMode,$.t3,v)}return v},transformVec:function(B,d){return wl(B,d)},glBindFrame:Pi,glUnbindFrame:nr,createBoxModel:function(){return{vs:Lc,ns:Zk,uv:ve,is:tf}},createRoundRectModel:function(j,O){return Lr.roundRect(j,O)},createStarModel:function(w,U){return Lr.star(w,U)},createRectModel:function(l,h){return Lr.rect(l,h)},createTriangleModel:function(L,p){return Lr.triangle(L,p)},createRightTriangleModel:function($,C){return Lr.rightTriangle($,C)},createParallelogramModel:function(A,Q){return Lr.parallelogram(A,Q)},createTrapezoidModel:function(R,B){return Lr.trapezoid(R,B)},createSmoothSphereModel:function(u,r,g,C,p,e,J){return db(new Wc(u,r,g,C,p,e,J))},createSphereModel:function(l,n,D,K,E,Z,I){return l?Ao(l,n,D,K,E,Z,I):Q.createSmoothSphereModel()},createSmoothConeModel:function(h,n,d,V,K){return gq(h,n,d,V,K)},createConeModel:function(Y,B,N,v,c,Z){return Y?Rh(Y,B,N,v,c,Z):gq(Z)},createSmoothCylinderModel:function(S,n,U,T,p,M,a,m){return db(new Ah(S,n,U,T,p,M,a,m))},createCylinderModel:function($,Z,j,i,T,O,A,X){return $?Yf($,Z,j,i,T,O,A,X):Og(O,A)},createSmoothTorusModel:function(P,x,W,g,m,u){return db(new te(P,x,W,g,m,u))},createTorusModel:function(W,j,S,I,B,g,x,Q){return W?Qp(W,j,S,I,B,g,x,Q):oo(g,x)},createExtrusionModel:function(l,W,L,F,s,I,h,M){return am(l,W,L,F,s,I,h,M)},createSmoothRingModel:function(a,t,i,I,E,f){for(var O=[],q=0;q<a.length-1;q+=2)O.push({x:a[q],y:a[q+1]});for(a=hr(O,t,i)[0],O=[],q=0;q<a.length;q++){var C=a[q];O.push(new cr(C.x,0,C.y))}return db(new hg(O,f,I,E))},createTextGeometry:function(b,B){return db(new Sc(b,B))},loadFontFace:function(X,d){Q.xhrLoad(X,function(g){if(!g)return d();var U;try{U=JSON.parse(g)}catch(A){U=JSON.parse(g.substring(65,g.length-2))}$b.loadFace(U),d&&d(U.familyName.toLowerCase())},d?null:{sync:!0})},createRingModel:function(o,K,H,G,R,P,$,Y,J,j){for(var y=[],s=0;s<o.length-1;s+=2)y.push({x:o[s],y:o[s+1]});P=P||Q.shapeSide,$=$||0,Y=Y||P;var L,X,O,p,T,w,x,n,V,i,s,g,c,C,W,z,Z,M,r=[],A=[],h=J?[]:t,q=J?[]:t,F=j?[]:t,l=j?[]:t,E=G?[]:t,N=G?[]:t,U=R?[]:t,b=R?[]:t,o=hr(y,K,H),m=ji(o),k=0,f=2*Math.PI/P;return o.forEach(function(S){if(O=S.length,O>1){if(p=S[0],G)for(w=p.x,n=p.y,s=$;Y>s;s++)g=s+1,c=s*f,C=g*f,W=I(c),z=d(c),Z=I(C),M=d(C),E.push(W*w,n,-z*w,Z*w,n,-M*w,0,n,0),N.push(.5-.5*W,.5-.5*z,.5-.5*Z,.5-.5*M,.5,.5);for(i=0;O>i;i++){for(T=S[i],w=p.x,x=T.x,n=p.y,V=T.y,L=k/m,k+=ro(p,T),X=k/m,s=$;Y>s;s++)g=s+1,c=s*f,C=g*f,W=I(c),z=d(c),Z=I(C),M=d(C),r.push(W*x,V,-z*x,Z*x,V,-M*x,W*w,n,-z*w,Z*x,V,-M*x,Z*w,n,-M*w,W*w,n,-z*w),A.push(s/P,X,g/P,X,s/P,L,g/P,X,g/P,L,s/P,L),J&&s===$&&(h.push(0,n,0,0,V,0,W*x,V,-z*x,W*x,V,-z*x,W*w,n,-z*w,0,n,0),q.push(0,.5-n,0,.5-V,2*x,.5-V,2*x,.5-V,2*w,.5-n,0,.5-n)),j&&g===Y&&(F.push(0,n,0,Z*x,V,-M*x,0,V,0,Z*x,V,-M*x,0,n,0,Z*w,n,-M*w),l.push(1,.5-n,1-2*x,.5-V,1,.5-V,1-2*x,.5-V,1,.5-n,1-2*w,.5-n));p=T}if(R)for(w=p.x,n=p.y,s=$;Y>s;s++)g=s+1,c=s*f,C=g*f,W=I(c),z=d(c),Z=I(C),M=d(C),U.push(Z*w,n,-M*w,W*w,n,-z*w,0,n,0),b.push(.5-.5*Z,.5+.5*M,.5-.5*W,.5+.5*z,.5,.5)}}),{vs:r,uv:A,bottom_vs:U,bottom_uv:b,top_vs:E,top_uv:N,from_vs:h,from_uv:q,to_vs:F,to_uv:l}}},!0),oi(K,{"3d.move.mode":w,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":w,"edge.gradient.color":w,"edge.source.t3":w,"edge.target.t3":w,"light.type":rl,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":S/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":ng,"wf.short":!1,"wf.mat":w,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:w,"transparent.mask":!1,brightness:w,"select.brightness":.7,"repeat.uv.length":w,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":w,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Fl,"label.t3":w,"label.r3":w,"label.texture.scale":2,"label.rotationMode":an,"label.light":!1,"label.blend":w,"label.reverse.flip":!1,"label.reverse.color":Gh,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Fl,"label2.t3":w,"label2.r3":w,"label2.texture.scale":2,"label2.rotationMode":an,"label2.light":!1,"label2.blend":w,"label2.reverse.flip":!1,"label2.reverse.color":Gh,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Fl,"note.t3":w,"note.r3":w,"note.texture.scale":2,"note.rotationMode":an,"note.light":!1,"note.blend":w,"note.reverse.flip":!1,"note.reverse.color":Gh,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Fl,"note2.t3":w,"note2.r3":w,"note2.texture.scale":2,"note2.rotationMode":an,"note2.light":!1,"note2.blend":w,"note2.reverse.flip":!1,"note2.reverse.color":Gh,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:w,"shape3d.color":uj,"shape3d.top.color":w,"shape3d.bottom.color":w,"shape3d.from.color":w,"shape3d.to.color":w,"shape3d.image":w,"shape3d.top.image":w,"shape3d.bottom.image":w,"shape3d.from.image":w,"shape3d.to.image":w,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":w,"shape3d.side.to":w,"shape3d.smooth":w,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":w,"shape3d.opacity":w,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Gh,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":w,"shape3d.uv.scale":w,"shape3d.top.uv.offset":w,"shape3d.top.uv.scale":w,"shape3d.bottom.uv.offset":w,"shape3d.bottom.uv.scale":w,"shape3d.from.uv.offset":w,"shape3d.from.uv.scale":w,"shape3d.to.uv.offset":w,"shape3d.to.uv.scale":w,"shape3d.top.cap":w,"shape3d.bottom.cap":w,"shape3d.start.angle":0,"shape3d.sweep.angle":z,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.clip":.003,"texture.mipmap.max":w,"texture.filter":w,"texture.filter.min":w,"texture.filter.mag":w,"all.light":!0,"all.visible":!0,"all.color":uj,"all.image":w,"all.blend":w,"all.opacity":w,"all.reverse.flip":!1,"all.reverse.color":Gh,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":w,"all.uv.offset":w,"all.uv.scale":w,"all.discard.selectable":!0,mat:w,"left.mat":w,"right.mat":w,"top.mat":w,"bottom.mat":w,"front.mat":w,"back.mat":w},!0);var _b,Tc=!1,pc=[0,0,0,0],nc={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Ug,2:af,3:_j,4:mn,5:Fl,6:jf}},Bc=function(B,O,s,V){if(O.getFaceVisible(B,s)){var L=Ur(B,O.getFaceMat(B,s)||O.getMat(B));B.appendAnchorMatrix3d(L),um(O,L);var g=O._26I;O.getFaceReverseCull(B,s)?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),Jo(g,O._prg.uFixPickReverseColor,nc[s]),we(g),Yi(g,V,6),Li(g),Np(O)}},bp=function(v){return v instanceof lb},Dd=function(u){return[u.x,u.e||0,u.y]},rn=function($,l,x){for(var l=be(l),i=l[0],f=l[1],Y=l[2];x--;)$.push(i,f,Y)},xl=function(m,G,X){for(var G=be(G),F=G[0],o=G[1],L=G[2],O=G[3];X--;)m.push(F,o,L,O)},gf=function(O,J,K){if(J)for(var U,m,F,L=J[0],Y=J[1],C=J[2],n=J[4],e=J[5],Z=J[6],s=J[8],T=J[9],u=J[10],R=J[12],i=J[13],x=J[14],h=K.length,v=0,v=0;h>v;v+=3)U=K[v],m=K[v+1],F=K[v+2],O.push(L*U+n*m+s*F+R,Y*U+e*m+T*F+i,C*U+Z*m+u*F+x);else je(O,K)},oc=function(v,q){var i=q.s("light.intensity"),b=be(q.s(Pk)),E=b[0],X=b[1],c=b[2];1!==i&&(E*=i,X*=i,c*=i),v.push(E,X,c,q.s("light.disabled")?1:0)},Kg=function(T,H,i){Jo(H,i.uHeadlightRange,T._headlightRange),Jo(H,i.uHeadlightAmbientIntensity,T._headlightAmbientIntensity);var U=T._headlightIntensity,X=be(T._headlightColor);1!==U&&(X=[X[0]*U,X[1]*U,X[2]*U]),Jo(H,i.uHeadlightColor,[X[0],X[1],X[2],T._headlightDisabled?1:0]);var q=T._59O,k=T._spots,L=T._dirs;if(q.length){var x=[],N=[],e=[];q.forEach(function(q){oc(x,q),je(N,T._transformPointToViewSpace(q.p3())),e.push(q.s("light.range"))
}),H.uniform4fv(i.uPointColor,x),H.uniform1fv(i.uPointRange,e),H.uniform3fv(i.uPointPosition,N)}if(k.length){var D=[],M=[],y=[],s=[],A=[],z=[];k.forEach(function(V){oc(D,V),je(M,T._transformPointToViewSpace(V.p3())),je(A,T._transformDirectionToViewSpace(V.p3(),V.s("light.center"))),y.push(V.s("light.range")),s.push(I(V.s("light.angle")/2)),z.push(V.s("light.exponent"))}),H.uniform4fv(i.uSpotColor,D),H.uniform1fv(i.uSpotRange,y),H.uniform1fv(i.uSpotAngle,s),H.uniform1fv(i.uSpotExponent,z),H.uniform3fv(i.uSpotPosition,M),H.uniform3fv(i.uSpotDirection,A)}if(L.length){var a=[],Z=[];L.forEach(function($){oc(a,$),je(Z,T._transformDirectionToViewSpace($.p3()))}),H.uniform4fv(i.uDirColor,a),H.uniform3fv(i.uDirDirection,Z)}},is=function(Z){return Math.max(Q.graph3dViewMinPhi+ee,Math.min(Q.graph3dViewMaxPhi-ee,Z))},Ai=function(){return.05+L()/2},kn=function(n,h,N,c){var m,z=n.getEye();return n.isOrtho()?(m=Sb(n.getCenter(),z),m[0]+=c[0],m[1]+=c[1],m[2]+=c[2]):m=z,Wm(h,N,c,m)},Wm=function(K,B,z,l){var n=wr(K,B),T=Sb(l,z,!0),_=wr(T,B);if(c(_)<ee)return t;var I=(n-wr(z,B))/_;return[z[0]+T[0]*I,z[1]+T[1]*I,z[2]+T[2]*I]},Be=function(K,D){return{x:2*K.x-D.x,y:2*K.y-D.y}},Bb=function(D,Y,F,P){var j,i;if(!D)return j=r(Y.y-F.y,F.x-Y.x),{x:Y.x+P*d(j),y:Y.y+P*I(j)};if(!F)return j=r(D.y-Y.y,Y.x-D.x),{x:Y.x+P*d(j),y:Y.y+P*I(j)};var t=Sb([D.x,D.y,0],[Y.x,Y.y,0],!0),H=Sb([F.x,F.y,0],[Y.x,Y.y,0],!0),k=-(t[0]+H[0])/2,X=-(t[1]+H[1])/2,M=N(k*k+X*X);if(ee>M)return j=r(D.y-Y.y,Y.x-D.x),{x:Y.x+P*d(j),y:Y.y+P*I(j)};var U=D.x-Y.x,L=D.y-Y.y,m=F.x-Y.x,y=F.y-Y.y,v=N(U*U+L*L),R=N(m*m+y*y);j=$(wr(t,H))/2,i=t[1]*H[0]-t[0]*H[1]>0?-1:1,k/=M,X/=M;var J=P/d(j),f=q(v,R)/I(j);M=Math.min(J,f);var G={x:Y.x+i*M*k,y:Y.y+i*M*X};return F.b&&J>R/I(j)&&(G.adjust=!0),G},Dr=function(C){var k=C[1],p=C[2],$=C[3],s=C[6],I=C[7],E=C[11];C[1]=C[4],C[2]=C[8],C[3]=C[12],C[4]=k,C[6]=C[9],C[7]=C[13],C[8]=p,C[9]=s,C[11]=C[14],C[12]=$,C[13]=I,C[14]=E},fp=function(O){var X=O[0],E=O[1],$=O[2],V=O[3],M=O[4],n=O[5],e=O[6],N=O[7],T=O[8],_=O[9],d=O[10],C=O[11],A=O[12],r=O[13],k=O[14],g=O[15],D=X*n-E*M,s=X*e-$*M,b=X*N-V*M,u=E*e-$*n,L=E*N-V*n,S=$*N-V*e,i=T*r-_*A,K=T*k-d*A,a=T*g-C*A,U=_*k-d*r,I=_*g-C*r,P=d*g-C*k,q=D*P-s*I+b*U+u*a-L*K+S*i;return q?(q=1/q,O[0]=(n*P-e*I+N*U)*q,O[1]=($*I-E*P-V*U)*q,O[2]=(r*S-k*L+g*u)*q,O[3]=(d*L-_*S-C*u)*q,O[4]=(e*a-M*P-N*K)*q,O[5]=(X*P-$*a+V*K)*q,O[6]=(k*b-A*S-g*s)*q,O[7]=(T*S-d*b+C*s)*q,O[8]=(M*I-n*a+N*i)*q,O[9]=(E*a-X*I-V*i)*q,O[10]=(A*L-r*b+g*D)*q,O[11]=(_*b-T*L-C*D)*q,O[12]=(n*K-M*U-e*i)*q,O[13]=(X*U-E*K+$*i)*q,O[14]=(r*s-A*u-k*D)*q,O[15]=(T*u-_*s+d*D)*q,void 0):t},vq=function(c,T){if(T){var N=T[0],A=T[1],r=T[2];c[12]=c[0]*N+c[4]*A+c[8]*r+c[12],c[13]=c[1]*N+c[5]*A+c[9]*r+c[13],c[14]=c[2]*N+c[6]*A+c[10]*r+c[14],c[15]=c[3]*N+c[7]*A+c[11]*r+c[15]}},Zd=function(i,O){if(O){var $=O[0],K=O[1],F=O[2];i[0]=i[0]*$,i[1]=i[1]*$,i[2]=i[2]*$,i[3]=i[3]*$,i[4]=i[4]*K,i[5]=i[5]*K,i[6]=i[6]*K,i[7]=i[7]*K,i[8]=i[8]*F,i[9]=i[9]*F,i[10]=i[10]*F,i[11]=i[11]*F}},Cb=function($,J,f){var z=J[0],F=J[1],W=J[2],R=J[3],j=J[4],h=J[5],Y=J[6],N=J[7],O=J[8],i=J[9],U=J[10],a=J[11],Z=J[12],V=J[13],K=J[14],w=J[15],S=f[0],p=f[1],g=f[2],u=f[3];return $[0]=S*z+p*j+g*O+u*Z,$[1]=S*F+p*h+g*i+u*V,$[2]=S*W+p*Y+g*U+u*K,$[3]=S*R+p*N+g*a+u*w,S=f[4],p=f[5],g=f[6],u=f[7],$[4]=S*z+p*j+g*O+u*Z,$[5]=S*F+p*h+g*i+u*V,$[6]=S*W+p*Y+g*U+u*K,$[7]=S*R+p*N+g*a+u*w,S=f[8],p=f[9],g=f[10],u=f[11],$[8]=S*z+p*j+g*O+u*Z,$[9]=S*F+p*h+g*i+u*V,$[10]=S*W+p*Y+g*U+u*K,$[11]=S*R+p*N+g*a+u*w,S=f[12],p=f[13],g=f[14],u=f[15],$[12]=S*z+p*j+g*O+u*Z,$[13]=S*F+p*h+g*i+u*V,$[14]=S*W+p*Y+g*U+u*K,$[15]=S*R+p*N+g*a+u*w,$},Fm=function(k,W,r,n){var i,h,D,o,y,V,I,w,B,j,$=W[0],p=W[1],g=W[2],_=n[0],Z=n[1],E=n[2],Q=r[0],b=r[1],f=r[2];return c($-Q)<ee&&c(p-b)<ee&&c(g-f)<ee?mo(k):(I=$-Q,w=p-b,B=g-f,j=1/N(I*I+w*w+B*B),I*=j,w*=j,B*=j,i=Z*B-E*w,h=E*I-_*B,D=_*w-Z*I,j=N(i*i+h*h+D*D),j?(j=1/j,i*=j,h*=j,D*=j):(i=0,h=0,D=0),o=w*D-B*h,y=B*i-I*D,V=I*h-w*i,j=N(o*o+y*y+V*V),j?(j=1/j,o*=j,y*=j,V*=j):(o=0,y=0,V=0),k[0]=i,k[1]=o,k[2]=I,k[3]=0,k[4]=h,k[5]=y,k[6]=w,k[7]=0,k[8]=D,k[9]=V,k[10]=B,k[11]=0,k[12]=-(i*$+h*p+D*g),k[13]=-(o*$+y*p+V*g),k[14]=-(I*$+w*p+B*g),k[15]=1,k)},Qo=function(I,p,B,g,Y){var f=1/H(p/2),M=1/(g-Y);return I[0]=f/B,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=f,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=(Y+g)*M,I[11]=-1,I[12]=0,I[13]=0,I[14]=2*Y*g*M,I[15]=0,I},or=function(b,v,K,t,G,R,T){var O=1/(v-K),A=1/(t-G),B=1/(R-T);return b[0]=-2*O,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=-2*A,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=2*B,b[11]=0,b[12]=(v+K)*O,b[13]=(G+t)*A,b[14]=(T+R)*B,b[15]=1,b},dm=function(x,V){var g=V[0],X=V[1],S=V[2],b=V[3],N=g*g+X*X+S*S+b*b,j=N?1/N:0;return x[0]=-g*j,x[1]=-X*j,x[2]=-S*j,x[3]=b*j,x},of=function(g,V){var s=V[0]+V[5]+V[10],R=0;return s>0?(R=2*Math.sqrt(s+1),g[3]=.25*R,g[0]=(V[6]-V[9])/R,g[1]=(V[8]-V[2])/R,g[2]=(V[1]-V[4])/R):V[0]>V[5]&V[0]>V[10]?(R=2*Math.sqrt(1+V[0]-V[5]-V[10]),g[3]=(V[6]-V[9])/R,g[0]=.25*R,g[1]=(V[1]+V[4])/R,g[2]=(V[8]+V[2])/R):V[5]>V[10]?(R=2*Math.sqrt(1+V[5]-V[0]-V[10]),g[3]=(V[8]-V[2])/R,g[0]=(V[1]+V[4])/R,g[1]=.25*R,g[2]=(V[6]+V[9])/R):(R=2*Math.sqrt(1+V[10]-V[0]-V[5]),g[3]=(V[1]-V[4])/R,g[0]=(V[8]+V[2])/R,g[1]=(V[6]+V[9])/R,g[2]=.25*R),g},Vk=function(M,Y,L){var b=Y[0],S=Y[1],n=Y[2],m=Y[3],E=b+b,d=S+S,G=n+n,W=b*E,v=b*d,c=b*G,V=S*d,p=S*G,y=n*G,r=m*E,w=m*d,j=m*G;return M[0]=1-(V+y),M[1]=v+j,M[2]=c-w,M[3]=0,M[4]=v-j,M[5]=1-(W+y),M[6]=p+r,M[7]=0,M[8]=c+w,M[9]=p-r,M[10]=1-(W+V),M[11]=0,M[12]=L[0],M[13]=L[1],M[14]=L[2],M[15]=1,M},Zp=function(B,w){if(B.vr.enable){var E=B.vr.getViewMatrix(w);if(E)return E}return Fm(w?w:_d(),B._eye,B._center,B._up)},Bm=function(F,$){if(F.vr.enable){var b=F.vr.getProjectMatrix();if(b)return b}if(!$&&F._computedProjectMatrix)return jj(F._computedProjectMatrix);var U=F.getAspect(),S=F._near,W=F._far,i=_d();if(F._ortho){var o=F._orthoWidth/2,H=o/U;or(i,-o,o,-H,H,S,W)}else Qo(i,F._fovy,U,S,W);return i},Gq=function(r,b){if(!r)return t;var O=0,n=1,e=2,X=[],A=0,i=r.length,m=i/3;if(b){for(;i>A;A++)X[A]=0;for(A=0;A<b.length;A+=3){var G=[],q=[],Y=[];G[O]=r[3*b[A+1]+O]-r[3*b[A]+O],G[n]=r[3*b[A+1]+n]-r[3*b[A]+n],G[e]=r[3*b[A+1]+e]-r[3*b[A]+e],q[O]=r[3*b[A+2]+O]-r[3*b[A+1]+O],q[n]=r[3*b[A+2]+n]-r[3*b[A+1]+n],q[e]=r[3*b[A+2]+e]-r[3*b[A+1]+e],Y[O]=G[n]*q[e]-G[e]*q[n],Y[n]=G[e]*q[O]-G[O]*q[e],Y[e]=G[O]*q[n]-G[n]*q[O];for(var Z=0;3>Z;Z++)X[3*b[A+Z]+O]+=Y[O],X[3*b[A+Z]+n]+=Y[n],X[3*b[A+Z]+e]+=Y[e]}}else for(A=0;m>A;A+=3){var G=[],q=[],Y=[];G[O]=r[3*(A+1)+O]-r[3*A+O],G[n]=r[3*(A+1)+n]-r[3*A+n],G[e]=r[3*(A+1)+e]-r[3*A+e],q[O]=r[3*(A+2)+O]-r[3*(A+1)+O],q[n]=r[3*(A+2)+n]-r[3*(A+1)+n],q[e]=r[3*(A+2)+e]-r[3*(A+1)+e],Y[O]=G[n]*q[e]-G[e]*q[n],Y[n]=G[e]*q[O]-G[O]*q[e],Y[e]=G[O]*q[n]-G[n]*q[O];for(var Z=0;3>Z;Z++)X[3*(A+Z)+O]=Y[O],X[3*(A+Z)+n]=Y[n],X[3*(A+Z)+e]=Y[e]}for(A=0;i>A;A+=3){var E=[];E[O]=X[A+O],E[n]=X[A+n],E[e]=X[A+e];var c=N(E[O]*E[O]+E[n]*E[n]+E[e]*E[e]);0===c&&(c=ee),E[O]=E[O]/c,E[n]=E[n]/c,E[e]=E[e]/c,X[A+O]=E[O],X[A+n]=E[n],X[A+e]=E[e]}return new cc(X)},sq=function(L,d,l,r){if(l||(l=L.createTexture()),d){var O=L.TEXTURE_2D,U=L.REPEAT,F=L.CLAMP_TO_EDGE,k=L.TEXTURE_MIN_FILTER;r=r||sg;var c=r.minFilter||r.filter||L.LINEAR,q=r.magFilter||r.filter||L.LINEAR;Af(L,l),L.texImage2D(O,0,L.RGBA,L.RGBA,L.UNSIGNED_BYTE,d),Ki(L,L.TEXTURE_MAG_FILTER,q);var N=d.naturalWidth||d.width,$=d.naturalHeight||d.height;Qr.isPOT(N)&&Qr.isPOT($)&&!d.clampToEdge?(Ki(L,L.TEXTURE_WRAP_S,U),Ki(L,L.TEXTURE_WRAP_T,U),Ki(L,k,c===L.NEAREST?L.NEAREST_MIPMAP_NEAREST:L.LINEAR_MIPMAP_LINEAR),r.mipmapMaxLevel!==w&&Ki(L,L.TEXTURE_MAX_LEVEL,r.mipmapMaxLevel),L.generateMipmap(O)):(Ki(L,L.TEXTURE_WRAP_S,F),Ki(L,L.TEXTURE_WRAP_T,F),Ki(L,k,c)),Af(L,t)}return l},Nl=function(r,i){var Q=new Uint8Array(4);return i=i||r.createTexture(),Af(r,i),Ki(r,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,Q),i},hf=function(j){j._26I&&j._prg&&(j._26I.deleteProgram(j._prg),j._prg=t)},Uq=function(n,t,J,F){var B=n.createShader(J);return n.shaderSource(B,F),n.compileShader(B),n.attachShader(t,B),B},sd=function($){return $.createBuffer()},Af=function(_,R){_.bindTexture(_.TEXTURE_2D,R)},Ki=function(I,e,Y){I.texParameteri(I.TEXTURE_2D,e,Y)},Hj=function(B,U){B.enable(B.POLYGON_OFFSET_FILL),B.polygonOffset(U[0],U[1])},re=function(k){k.disable(k.POLYGON_OFFSET_FILL)},Ch=function(O,e){if(e){var e=be(e);O.clearColor(e[0],e[1],e[2],e[3])}},bi=function(d,P){Jo(d,P.uFix,!0),ge(d,P.aNormal)},Zo=function(C,Q){Jo(C,Q.uFix,!1),qd(C,Q.aNormal)},jo=function(X,o,J,W,O,l,i,L){X._picking||(J?(Jo(X,o.uBlend,!0),Jo(X,o.uBlendColor,J)):Jo(X,o.uBlend,!1),Jo(X,o.uLight,W==t?!0:W),Td(O)&&1!==O&&Jo(X,o.uPartOpacity,O),Jo(X,o.uReverseFlip,l==t?!1:l),Jo(X,o.uFixPickReverseColor,i||Gh)),L?X.enable(X.CULL_FACE):X.disable(X.CULL_FACE)},np=function(d,v){d._picking||Jo(d,v.uPartOpacity,1)},we=function(){var b=[0,0,1,1];return function(I,i,k,z,l,P,T,q,$){return k?(Jo(I,i.uTexture,!0),Jo(I,i.uDiscardSelectable,mi(z)?z:!0),qd(I,i.aUv),jk(I,l,P,i.aUv,2),$?(Jo(I,i.uBlendTexture,!0),I.activeTexture(I.TEXTURE1),Af(I,$),I.uniform1i(i.uBlendSampler,1)):(Jo(I,i.uBlendTexture,!1),I.activeTexture(I.TEXTURE1),Af(I,I._emptyBlendTexture)),I.activeTexture(I.TEXTURE0),Af(I,k),I.uniform1i(i.uSampler,0),T?(b[0]=T[0],b[1]=T[1]):(b[0]=0,b[1]=0),q?(b[2]=q[0],b[3]=q[1]):(b[2]=1,b[3]=1),Jo(I,i.uOffsetScale,b),void 0):(I.activeTexture(I.TEXTURE0),Af(I,I._emptyTexture),I.activeTexture(I.TEXTURE1),Af(I,I._emptyBlendTexture),void 0)}}(),Li=function(d,s,X){d.activeTexture(d.TEXTURE0),Af(d,t),d.activeTexture(d.TEXTURE1),Af(d,t),X&&(ge(d,s.aUv),Jo(d,s.uTexture,!1),Jo(d,s.uBlendTexture,!1))},Un=function(w,W,P,t,Z,J){!P||Kc||Ye||w.lineWidth(P),t&&!w._picking&&Jo(w,W.uFixPickReverseColor,t),Z&&jk(w,Z,J,W.aPosition)},Wf=function(X,H,b,w){_b&&(w=X[_b]),X.drawArrays(w==t?X.TRIANGLES:w,H,b);var B=X._renderInfo;B&&(B.calls++,B.vertices+=b,(w==t||w===X.TRIANGLES)&&(B.faces+=b/3),w===X.LINES&&(B.lines+=b/2))},Yi=function(m,C,u,U){_b&&(U=m[_b]),m.drawElements(U==t?m.TRIANGLES:U,u,m.UNSIGNED_SHORT,C==t?0:2*C);var $=m._renderInfo;$&&($.calls++,$.vertices+=u,(U==t||U===m.TRIANGLES)&&($.faces+=u/3),U===m.LINES&&($.lines+=u/2))},Ab=function(J,E,i,K,r){var X=J.ARRAY_BUFFER;J.bindBuffer(X,E),i&&J.bufferData(X,i,J.STATIC_DRAW),K!=t&&J.vertexAttribPointer(K,r?r:3,J.FLOAT,!1,0,0)},jk=function(z,c,f,g,x){return f?(Ij(z,z.ARRAY_BUFFER,c,f),g!=t&&z.vertexAttribPointer(g,x?x:3,z.FLOAT,!1,0,0),void 0):Ab(z,c,f,g,x)},Vg=function(z,u,$){var S=z.ELEMENT_ARRAY_BUFFER;z.bindBuffer(S,u),$&&z.bufferData(S,$,z.STATIC_DRAW)},Gl=function(o,F,E){Ij(o,o.ELEMENT_ARRAY_BUFFER,F,E)},Ij=function(x,S,h,R){var o=R._bufId;o||(o=R._bufId=Y.Math.generateIncreasingID());var h,P=x._bufPool;(h=P[o])&&h._buf?x.bindBuffer(S,h._buf):(h=P[o]={_buf:sd(x)},x.bindBuffer(S,h._buf),x.bufferData(S,R,x.STATIC_DRAW)),h._fid=x._renderInfo.frame},Jo=function(h,G,d){if(d!=t&&G!=t){d=be(d);var F=d.length;3===F?h.uniform3fv(G,d):4===F?h.uniform4fv(G,d):16===F?h.uniformMatrix4fv(G,!1,d):mi(d)?h.uniform1i(G,d?1:0):2===F?h.uniform2fv(G,d):h.uniform1f(G,d)}},qd=function(q,l){l!=t&&l>=0&&q.enableVertexAttribArray(l)},ge=function($,S){S!=t&&S>=0&&$.disableVertexAttribArray(S)},Np=function(q,E){var a=q.getGL(),H=q._prg;q._7O=q._8O.pop(),E&&(Jo(a,H.uMVMatrix,q._7O),q._6O=E,Jo(a,H.uNMatrix,E))},so=function($,z){return z||(z=_d()),Qk(z,$),fp(z),Dr(z),z},um=function(N,u){var U=N.getGL(),Q=N._prg,c=N._7O;u&&(N._8O.push(jj(c)),Jo(U,Q.uMMatrix,u),Cb(c,c,u),N._7O=c),Jo(U,Q.uMVMatrix,c),Jo(U,Q.uNMatrix,so(c,N._6O))},Ib=function(S,D,K,F,_,U){if(K){if(F){var s=K.value++,v=2147483648|s,B=[(255&v>>16)/255,(255&v>>8)/255,(255&v)/255,(255&v>>24)/255];K[s]={data:_,part:U}}else B=pc;return Jo(S,D.uFixPickReverseColor,B),B}},ag=function(Q,k,Y){"target"!==Y&&(Y="source");var o="target"===Y?k.getTargetAgent():k.getSourceAgent(),W="edge."+Y+".";if(wk(o)){var y=k.s(W+"anchor.x"),R=k.s(W+"anchor.elevation"),G=k.s(W+"anchor.y"),j=Ur(o,Q.getMat(o)),t=o.getAnchor3d();return wl([(y===w?.5:y)-t.x,(R===w?.5:R)-t.y,(G===w?.5:G)-t.z],j)}var J=k.s(W+"index"),H=Q.getData3dUI(o);if(!H.info||!H.info.list)return!1;if(J>=0){var g,C,i,_,f,V=H.info._lastPointsSegments,T=V.points,N=V.segments,M=-1,b=-1;for(i=0,_=N?N.length:T.length;_>i;i++){if(C=N?N.get(i):1,3===C)f=2;else if(4===C)f=3;else{if(5===C)continue;f=1}if(M+=f,b++,b===J){g=T.get(M);break}}return g||(g=T.get(T.length-1)),[g.x,g.e||0,g.y]}var A=k.s(W+"percent")||.5;if(A=Math.max(0,Math.min(A,1)),!H||!H.getCache)return!1;var e=H.getCache(),_=e[e.length-1].length,V=Q.getLineOffset(o,A*_),p=V.point;return[p.x,p.y,p.z]},rj=function(){var o={center:function(a,i,T,F,D){var M=-i[1]/2,b={x:-i[0]/2,y:M,width:i[0],height:i[1]},s=Tf(a,b,T);return[s.x+F,-s.y-D,Ai()]},front:function(P,b,L,F,C){var t=-b[1]/2,X={x:-b[0]/2,y:t,width:b[0],height:b[1]},r=Tf(P,X,L);return[r.x+F,-r.y-C,b[2]/2+Ai()]},back:function(R,V,Y,H,p){var J=-V[0]/2,B=-V[1]/2,j={x:J,y:B,width:V[0],height:V[1]},y=Tf(R,j,Y);return[-y.x-H,-y.y-p,-V[2]/2-Ai()]},left:function(p,R,I,J,G){var V=-R[1]/2,Y={x:-R[2]/2,y:V,width:R[2],height:R[1]},y=Tf(p,Y,I);return[-R[0]/2-Ai(),-y.y-G,y.x+J]},right:function(n,e,I,r,_){var k=-e[2]/2,A=-e[1]/2,v={x:k,y:A,width:e[2],height:e[1]},N=Tf(n,v,I);return[e[0]/2+Ai(),-N.y-_,-N.x-r]},top:function(o,e,q,B,z){var v={x:-e[0]/2,y:-e[2]/2,width:e[0],height:e[2]},j=Tf(o,v,q);return[j.x+B,e[1]/2+Ai(),j.y+z]},bottom:function($,V,q,n,l){var y=-V[2]/2,K={x:-V[0]/2,y:y,width:V[0],height:V[2]},e=Tf($,K,q);return[e.x+n,-V[1]/2-Ai(),-e.y-l]}};return function(I,x,c,G,s,Q){return o[G](I,x,c,s||0,Q||0)}}(),Ar=function(k,i,I,p,c,W,v,J,m,C){if(c&&(i[0]+=c[0],i[1]+=c[1],i[2]+=c[2]),vq(k,I),J){var b=_d();if(vm(b,m,C),wl(i,b),vq(k,i),k.auto=J,k.pos=wl([0,0,0],k),W){var _=k.mat2=_d();vm(_,W,v)}}else vm(k,m,C),vq(k,i),p===Ug?tp(k,-T):p===af?tp(k,T):p===_j?Cq(k,-T):p===mn?Cq(k,T):p===jf&&tp(k,S),vm(k,W,v);return k},gh=function(_,X){var C=X.auto,d=X.mat2,V=_.gv;if(C){var m,h=_d(),x=[0,0,0,0];m="string"==typeof C?[C.indexOf("x")<0?V._eye[0]:V._center[0],C.indexOf("y")<0?V._eye[1]:V._center[1],C.indexOf("z")<0?V._eye[2]:V._center[2]]:V._eye,of(x,Fm(_d(),m,V._center,V._up)),Vk(h,dm(x,x),X.pos),d&&Cb(h,h,d),um(V,h)}else um(V,X)},xs=function(J,k,D,F,a){var W=J.s,o=J.gv,P=o.getGL(),B=o._prg,O=o._buffer,j=o._1O;sq(P,xk,j),gh(J,D),jo(P,B,W(k+".blend"),W(k+".light"),W(k+".opacity"),W(k+".reverse.flip"),W(k+".reverse.color"),W(k+".reverse.cull")),we(P,B,j,a,O.uv,Xo),jk(P,O.vs,F,B.aPosition),jk(P,O.ns,gg,B.aNormal),Gl(P,O.is,zp),Yi(P,0,zp.length),Li(P,B,j),np(P,B),Np(o)},to=function(p,U,P){var K=p.gv,I=p.data,n=p[U]={blend:K.getBodyColor(I)||K.getFaceBlend(I,U),light:K.getFaceLight(I,U),color:K.getFaceColor(I,U),opacity:K.getFaceOpacity(I,U),transparent:K.getFaceTransparent(I,U),reverseFlip:K.getFaceReverseFlip(I,U),reverseColor:K.getFaceReverseColor(I,U),reverseCull:K.getFaceReverseCull(I,U),texture:K.getFaceImage(I,U),blendTexture:K.getFaceBlendImage(I,U),discardSelectable:K.getFaceDiscardSelectable(I,U)};if("csg"!==U){n.uv=K.getFaceUv(I,U)||P&&P[U+"Uv"],n.uvScale=K.getFaceUvScale(I,U)||P&&P[U+"UvScale"],n.uvOffset=K.getFaceUvOffset(I,U)||P&&P[U+"UvOffset"];var H=K.getFaceMat(I,U);if(H){var c=Ur(I,H);I.appendAnchorMatrix3d(c),n.mat=c}}return n},Yd=function(O,o,B,A,f){var c=O[A];if(c){if(!f(c.transparent))return;var w=O.data,L=O.gv,x=L._buffer,g=L.getTexture(c.texture,w,A),$=L.getTexture(c.blendTexture,w);we(o,B,g,c.discardSelectable,x.uv,c.tuv,c.uvOffset,c.uvScale,$),jo(o,B,c.blend,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),Jo(o,B.uDiffuse,c.color||K["color.empty"]),jk(o,x.vs,c.vs,B.aPosition),jk(o,x.ns,c.ns,B.aNormal),Wf(o,0,c.vs.length/3),np(o,B),Li(o,B,g)}},pd=function(J,s,B,h,N,v){var E,O,A,p,z,K,e,x,l,W,R,w=[h-s,N-B],V=J?J.length:0;for(A=0;V>A;A++){for(p=2,E=J[A],z=E[0],K=E[1];p+1<E.length;){if(e=E[p],x=E[p+1],O=Kl(s,B,h,N,z,K,e,x,!0)){l=[e-z,x-K],W=ro(l),l[0]/=W,l[1]/=W,W=wr(w,l),W=W>0?v:-v,R=[l[0]*W,l[1]*W];break}z=e,K=x,p+=2}if(R)break}if(R)for(h=s+R[0],N=B+R[1],A=0;V>A;A++)for(p=2,E=J[A],z=E[0],K=E[1];p+1<E.length;){if(e=E[p],x=E[p+1],O=Kl(s,B,h,N,z,K,e,x,!0))return[0,0];z=e,K=x,p+=2}return R?R:[h-s,N-B]},Tn=Y.graph3d={},Zq=function(A,n,y){Tr(g+".graph3d."+A,n,y)},es="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",ep="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";oi(Q,{setBatchInfo:function(V,a){Fe[V]=a},getBatchInfo:function(l){return Fe[l]}},!0);var _n=[1,1,1],Mq=[1,0,0,0,0,1,0,1,1,1,1,0],Bs=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Fk=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],vr=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Ic=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Vc=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ln=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Yr=function(M,l){yq(M,l,"_batchModelMap","_batchIndexMap"),ni(M,l,"_wireframeModelMap","_wireframeIndexMap"),ni(M,l,"_polylineModelMap","_polylineIndexMap"),ni(M,l,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),ni(M,l,"_polylineModelMapSwap","_polylineIndexMapSwap")},yq=function(g,D,w,i){if(!D)return g[w]={},g[i]={},void 0;var X=D._id,t=g[i],d=t[X];if(d){var m=g[w],N=d.batch,k=m[N],n=k.ds,L=d.index;if(k.invalidate=!0,delete t[X],n.splice(L,1),Xl(n))return delete m[N],void 0;for(var y=d.begin,r=d.size,A=3*y,K=3*r,E=4*y,$=4*r,b=k.vs,v=k.ps,l=k.uv,J=k.cs,c=k.bs,C=k.rs,Q=k.ns,j=k.ls;L<n.length;L++)d=t[n[L]._id],d.index--,d.begin-=r;b.splice(A,K),v.splice(E,$),l&&l.splice(2*y,2*r),J&&J.splice(E,$),c&&c.splice(A,K),C&&C.splice(y,r),Q&&Q.splice(A,K),j&&j.splice(y,r)}},ni=yq,Ag=function(S,k,v,P){if(!P)return t;var w=k[P];if(!w){var h=Fe[P]||sg,e=h.image?[]:t;w=k[P]={vs:[],ns:[],uv:e,cs:e?t:h.color?t:[],bs:h.blend?[]:t,ps:[],rs:h.brightness?[]:t,ds:[]}}return w.invalidate=!0,S[v._id]={index:w.ds.length,begin:w.vs.length/3,batch:P},w.ds.push(v),w},En=function(O,$){return $!=t&&1!==$?[O[0]*$,O[1]*$,O[2]*$,O[3]]:O},ue=function(){var K;return function(A,u,T){var k=A.getData3dUI(u),H=k.shapeModel;H||(H=se(k));var l,$=u.s("wf.combineTriangle");if(T.geometry){if(!H&&(u instanceof Y.Node&&!(u instanceof Y.Shape)?(K||(K={vs:Lc,is:tf,uv:ve}),H=K):H=[k.left,k.front,k.right,k.back,k.top,k.bottom],!H))return w;if($?($=0|Math.min(3,Math.max(1,isNaN($)?1:$)),l=Sr[$-1](H)):l=Ge(H),!l||0===l.length)return}else l=T.short?oe:_i;var U=A.getBrightness(u),R=be(T.color||"white"),x=R[3]<1,Z=Math.ceil(T.width)||1,h=(x?"T":"O")+Z,f=A._wireframeIndexMap,W=A._wireframeModelMap,F=W[h];F||(F=W[h]={vs:[],cs:[],ps:[],ds:[],T:x,W:Z}),F.invalidate=!0;var L=F.vs,v=F.cs,P=F.ds,B=f[u._id]={index:P.length,begin:L.length/3,batch:h};P.push(u);var C=k.mat;u instanceof Y.Edge||!(!C||!T.geometry&&u instanceof Y.Shape)||(C=Ur(u,T.mat),u.appendAnchorMatrix3d(C)),gf(L,C,l);var i=B.size=L.length/3-B.begin;xl(v,En(R,U),i)}}(),dg=function(u,f,Y,g,B,Q,r,F,e){var c=u.getBrightness(f);c==t&&(c=1);var V=En(be(g),c),z=V[3]<1;Q=Math.ceil(Q)||1;var n=(z?"T":"O")+Q;if(r){var d=r[0],D=(r[1]||d)+d;n+="-"+d+"-"+D,e&&(n+="-"+Ei(e)+"-"+c,e=En(be(e),c))}var L=u._polylineIndexMap,o=u._polylineModelMap,I=o[n];I||(I=o[n]={vs:[],cs:[],ps:[],ds:[],ls:r?[]:t,T:z,W:Q},r&&(I.D=d,I.G=D,I.A=e)),I.invalidate=!0;var k,W=I.vs,X=I.cs,R=I.ds,H=I.ls,b=L[f._id]={index:R.length,begin:W.length/3,batch:n};R.push(f),je(W,Y);var N,M=b.size=W.length/3-b.begin,J=Y.length,v=0,x=[];if(r||B)for(k=0;J>k;k+=6)N=ro([Y[k],Y[k+1],Y[k+2]],[Y[k+3],Y[k+4],Y[k+5]]),x.push(N),v+=N;if(v&&B){var $,E=En(be(B),c),y=[E[0]-V[0],E[1]-V[1],E[2]-V[2],E[3]-V[3]],j=0;for(k=0;J>k;k+=6)$=j/v,xl(X,[V[0]+y[0]*$,V[1]+y[1]*$,V[2]+y[2]*$,V[3]+y[3]*$],1),j+=x[k/6],$=j/v,xl(X,[V[0]+y[0]*$,V[1]+y[1]*$,V[2]+y[2]*$,V[3]+y[3]*$],1)}else xl(X,V,M);if(r)for(j=F||0,k=0;J>k;k+=6)H.push(j),j+=x[k/6],H.push(j)},Fi=function(l,C,H){if(C)for(var r=4*C.begin,x=H[C.batch].ps,y=0;y<C.size;y++)x[r++]=l[0],x[r++]=l[1],x[r++]=l[2],x[r++]=l[3]},cb=function(e,U){var O=U+["32"],_=e[U],G=e[O];_?G&&G.length===_.length?(G.set(_),G._bufId=null):e[O]=new cc(_):delete e[O]},Ff=function(e,n,$,c,R,Y,j,h,W){if(Cl($))$.forEach(function(A){Ff(e,n,A,c,R,Y,j,h,W)});else if(vh($))Ff(e,n,se(c,$),c,R,Y,j,h,W);else if(ao($)){var H,g=bf($.mat,n,e),m=bf($.s3,n,e),i=bf($.t3,n,e),B=bf($.r3,n,e);if((m||B||i||g)&&(H=od(g,m,B,bf($.rotationMode,n,e),i),Y.push(H)),$.shape3d)Ff(e,n,$.shape3d,c,R,Y,j,h,$);else{var K=c.s;W=W||sg;var C=Y[0],f=Y.length,_=K("shape3d.color",$.color,W.color);if(R||(R=K("shape3d.blend",$.blend,W.blend)),f>1){C=jj(C);for(var F=1;f>F;F++)Cb(C,C,Y[F])}$.vs&&K(Zm,$.visible,W.visible)&&ab(C,j,h,$.vs,$.uv,$.is,R,_),$.top_vs&&K(ss,$.topVisible,W.topVisible)&&ab(C,j,h,$.top_vs,$.top_uv,$.top_is,R,K("shape3d.top.color",$.topColor,W.topColor)||_),$.bottom_vs&&K(Kk,$.bottomVisible,W.bottomVisible)&&ab(C,j,h,$.bottom_vs,$.bottom_uv,$.bottom_is,R,K("shape3d.bottom.color",$.bottomColor,W.bottomColor)||_),$.from_vs&&K(Xm,$.fromVisible,W.fromVisible)&&ab(C,j,h,$.from_vs,$.from_uv,$.from_is,R,K("shape3d.from.color",$.fromColor,W.fromColor)||_),$.to_vs&&K(fb,$.toVisible,W.toVisible)&&ab(C,j,h,$.to_vs,$.to_uv,$.to_is,R,K("shape3d.to.color",$.toColor,W.toColor)||_)}H&&Y.pop()}},ab=function(x,r,y,Z,p,G,o,X){var I,E=r.cs,$=r.uv,g=r.bs;if(G){I=G.length;for(var j=0;I>j;j++){var C=G[j];gf(y,x,[Z[3*C],Z[3*C+1],Z[3*C+2]]),$&&je($,[p[2*C],p[2*C+1]])}}else I=Z.length/3,gf(y,x,Z),$&&je($,p);E&&xl(E,X,I),g&&(o?rn(g,o,I):je(g,_n,I))},Yn=function(s,q,F,B){var w=[];B?Ff(s.gv,s.data,B,s,s.getBodyColor(),[q],F,w):(Oo(s,Ug,q,F,w),Oo(s,af,q,F,w),Oo(s,Fl,q,F,w),Oo(s,jf,q,F,w),Oo(s,_j,q,F,w),Oo(s,mn,q,F,w),Oo(s,"csg",q,F,w)),w.length&&(je(F.vs,w),je(F.ns,Gq(w)))},Oo=function(M,K,w,e,y){var l=M[K];if(l){var O=l.tuv;if(O){var B,n,j,T,h=l.uvScale,d=l.uvOffset;if(h)for(B=O.length,n=h[0],j=h[1],T=0;B>T;T+=2)O[T]*=n,O[T+1]*=j;if(d)for(B=O.length,n=d[0],j=d[1],T=0;B>T;T+=2)O[T]+=n,O[T+1]+=j}ab(w,e,y,l.vs,O,t,l.blend,l.color)}},wd=function(y,r,P,g,R,Q,M,x){var j,p=P.cs,i=P.uv,I=P.bs;if(y.getFaceVisible(r,Q)){var E=y.getFaceMat(r,Q);if(E&&(R=Ur(r,E)),gf(M,R,x),p&&xl(p,y.getFaceColor(r,Q),6),i){var V=y.getFaceUv(r,Q)||g[Q+"Uv"],Y=y.getFaceUvScale(r,Q)||g[Q+"UvScale"],m=y.getFaceUvOffset(r,Q)||g[Q+"UvOffset"];V=V?[V[6],V[7],V[0],V[1],V[2],V[3],V[2],V[3],V[4],V[5],V[6],V[7]]:Mq;var l=V[0],W=V[1],o=V[2],e=V[3],T=V[4],X=V[5],h=V[6],c=V[7],w=V[8],q=V[9],D=V[10],A=V[11];if(Y){var k=Y[0],C=Y[1];l*=k,W*=C,o*=k,e*=C,T*=k,X*=C,h*=k,c*=C,w*=k,q*=C,D*=k,A*=C}if(m){var v=m[0],d=m[1];l+=v,W+=d,o+=v,e+=d,T+=v,X+=d,h+=v,c+=d,w+=v,q+=d,D+=v,A+=d}i.push(l,W,o,e,T,X,h,c,w,q,D,A)}I&&(j=y.getBodyColor(r)||y.getFaceBlend(r,Q),j?rn(I,j,6):je(I,_n,6))}},$d=function(i,U,J,v){var s=i.getGL(),C=i._prg,q=i._buffer;if(!i.drawFilter&&!wf(U)){um(i),bi(s,C);for(var n in U){var I=U[n];if(!(v&&!I.T||!v&&I.T)){I.invalidate?(I.invalidate=!1,cb(I,"vs"),cb(I,"cs"),cb(I,"ls"),cb(I,"ps")):J&&cb(I,"ps");var V=I.vs32,h=J?I.ps32:I.cs32;Un(s,C,I.W,t,q.vs,V);var Y=I.D,a=!i._dashDisabled&&Y;Jo(s,C.uAlphaTest,K.alphaTest),a&&(Jo(s,C.uDash,!0),Jo(s,C.uDashDistance,Y),Jo(s,C.uDashGapDistance,I.G),qd(s,C.aLineDistance),jk(s,q.lineDistance,I.ls32,C.aLineDistance,1),Jo(s,C.uDiffuse,I.A||K["color.empty"]));var m=!i._batchColorDisabled;m&&(Jo(s,C.uBatchColor,!0),qd(s,C.aBatchColor),jk(s,q.batchColor,h,C.aBatchColor,4)),we(s),Wf(s,0,V.length/3,s.LINES),Li(s),m&&(Jo(s,C.uBatchColor,!1),ge(s,C.aBatchColor)),a&&(Jo(s,C.uDash,!1),ge(s,C.aLineDistance))}}Zo(s,C)}},Cs=function(E,i,_){var p,S,X,C,Z,b,v,f,Y,c,e,H=E.getGL(),x=E._prg,o=E._buffer,O=E._batchModelMap;if(!wf(O)&&!E.drawFilter){um(E);for(p in O)if(S=Fe[p]||sg,!(_&&!S.transparent||!_&&S.transparent)&&(X=O[p],i||!S.transparentMask)){var h=_&&S.autoSort!==!1&&(E._33Q||X.invalidate);if(X.invalidate?(X.invalidate=!1,cb(X,"vs"),cb(X,"ns"),cb(X,"cs"),cb(X,"rs"),cb(X,"ps"),cb(X,"bs"),cb(X,"uv")):i&&cb(X,"ps"),Z=X.vs32,b=i?X.ps32:X.cs32,Y=X.uv32,v=X.bs32,f=X.rs32,e=Z.length/3,h&&(X.is=Vj(Z,E.getEye())),e){C=S.light,c=E.getTexture(S.image),jo(H,x,t,S.light,S.opacity,S.reverseFlip,S.reverseColor,S.reverseCull),b?E._batchColorDisabled||(Jo(H,x.uBatchColor,!0),qd(H,x.aBatchColor),jk(H,o.batchColor,b,x.aBatchColor,4)):Jo(H,x.uDiffuse,S.color||K["color.empty"]);
var j=S.alphaTest;Jo(H,x.uAlphaTest,j===w?K.alphaTest:j),S.envmap!==w?(Jo(H,x.uUseEnvMap,!0),Jo(H,x.uReflectivity,S.envmap)):(Jo(H,x.uUseEnvMap,!1),Jo(H,x.uReflectivity,0));var T=v&&!E._batchBlendDisabled;T&&(Jo(H,x.uBatchBlend,!0),qd(H,x.aBatchBlend),jk(H,o.batchBlend,v,x.aBatchBlend));var F=f&&!E._batchBrightnessDisabled;F&&(Jo(H,x.uBatchBrightness,!0),qd(H,x.aBatchBrightness),jk(H,o.batchBrightness,f,x.aBatchBrightness,1)),Y?we(H,x,c,S.discardSelectable,o.uv,Y,S.uvOffset,S.uvScale):we(H),jk(H,o.vs,Z,x.aPosition),jk(H,o.ns,X.ns32,x.aNormal),X.is?(Vg(H,o.is,X.is),Yi(H,0,e)):Wf(H,0,e),Y?Li(H,x,c):Li(H),b&&!E._batchColorDisabled&&(Jo(H,x.uBatchColor,!1),ge(H,x.aBatchColor)),T&&(Jo(H,x.uBatchBlend,!1),ge(H,x.aBatchBlend)),F&&(Jo(H,x.uBatchBrightness,!1),ge(H,x.aBatchBrightness)),np(H,x)}}}},Vj=function(n,C){for(var U=n.length/3,M=new Array(U),Z=U/3,c=new Array(Z),R=0;Z>R;R++)c[R]=R;c.sort(function(r,b){var D=9*r,d=[(n[D]+n[D+3]+2*n[D+6])/4,(n[D+1]+n[D+4]+2*n[D+7])/4,(n[D+2]+n[D+5]+2*n[D+8])/4];D=9*b;var F=[(n[D]+n[D+3]+2*n[D+6])/4,(n[D+1]+n[D+4]+2*n[D+7])/4,(n[D+2]+n[D+5]+2*n[D+8])/4],U=ro(C,d)-ro(C,F);return U>0?-1:0>U?1:0});for(var R=0;Z>R;R++){var I=3*R,d=3*c[R];M[I]=d,M[I+1]=d+1,M[I+2]=d+2}return new vk(M)},$e={obj:function(G,b){var C={mat:G.mat,s3:G.s3,r3:G.r3,rotationMode:G.rotationMode,t3:G.t3,cube:G.cube==t?!0:G.cube,center:G.center==t?!0:G.center,ignoreMtls:G.ignoreMtls,ignoreTransparent:G.ignoreTransparent,ignoreColor:G.ignoreColor,ignoreImage:G.ignoreImage,ignoreNormal:G.ignoreNormal,prefix:G.prefix,flipY:G.flipY,flipFace:G.flipFace,reverseFlipMtls:G.reverseFlipMtls,finishFunc:function(L,u){if(L){var u=[];for(var s in L){var o=L[s];u.rawS3=o.rawS3,u.push(o),G.eachModel&&G.eachModel(s,o)}u.json=G,b(u)}else b()}};Q.loadObj(G.obj,G.mtl,C)}};Q.getModelTypeHandlers=function(){return $e},Q.setModelTypeHandler=function(x,X){$e[x]=X},Q.getModelTypeHandler=function(W){return $e[W]},Q.handleModelLoaded=function(){},Q.handleUnfoundModel=function(){};var df=t,Bn=t,Pf=function(l){df&&!l._loadingModelView_&&(Bn||(Bn={}),Bn[l._loadingModelView_=Re()]=l)},An=function(b,$){df||(df={});var I=df[b];if(I){if(I.url===$)return;I.request.onload=cj,I.request.onerror=cj}var q=new qh;if(df[b]={request:q,url:$},$=Q.beforeLoadURL($),$.data){var r=Q.parse($.data);qj(b,r,$)}else{q.onload=function(){if(200===this.status||0===this.status){delete df[b];var f=Q.parse(q.getResponseText());qj(b,f,$)}else he(b,Q.handleUnfoundModel(b,$)||t)},q.onerror=function(){he(b,Q.handleUnfoundModel(b,$)||t)};var L={};L.url=encodeURI($),L.sync=!1,q.send(L)}},qj=function(L,r,w){var P=r.modelType;if(!P)return he(L,r),Q.handleModelLoaded(L,r),void 0;var f=Q.getModelTypeHandler(P);if(f){if(df||(df={}),df[L])return;df[L]=!0;var U=function($){$?(he(L,$),Q.handleModelLoaded(L,$)):he(L,Q.handleUnfoundModel(L,w)||t)};f(r,U)}else he(L,Q.handleUnfoundModel(L,w)||t)},he=function(P,H){if(delete df[P],vh(H)&&Im.test(H))return An(P,H),void 0;if(pm[P]=H,wf(df)&&(df=t,Bn)){for(var i in Bn){var E=Bn[i];E.invalidateAll&&E.invalidateAll(w,"modelLoaded",P),E.redraw&&E.redraw(),E.iv(),delete E._loadingModelView_}Bn=t}if(H&&Bn)for(var i in Bn){var E=Bn[i];E.invalidateAll&&E.invalidateAll(w,"modelLoading",P),E.redraw&&E.redraw(),E.iv()}},Xo=new cc([0,0,0,1,1,1,1,0]),gg=new cc([0,0,1,0,0,1,0,0,1,0,0,1]),zp=new vk([0,1,2,2,3,0]),Lc=new cc([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),tf=new vk([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ve=new cc([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Zk=Gq(Lc,tf),tr=(new cc([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new vk([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Ug,Fl,af,jf,_j,mn]),_i=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],oe=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Ao=function(W,f,O,A,j,X,M){X=X||16,W=W||16,f=f||0,O=O||W;var l,s,J,i,x,w,b,E,H,N=.5,B=[],T=[],p=z/W,y=S/X;for(l=0;X>l;l++)for(w=l+1,i=l*y,H=w*y,s=f;O>s;s++)b=s+1,J=s*p,E=b*p,B.push(N*d(i)*I(J),N*I(i),-N*d(i)*d(J),N*d(H)*I(E),N*I(H),-N*d(H)*d(E),N*d(i)*I(E),N*I(i),-N*d(i)*d(E),N*d(i)*I(J),N*I(i),-N*d(i)*d(J),N*d(H)*I(J),N*I(H),-N*d(H)*d(J),N*d(H)*I(E),N*I(H),-N*d(H)*d(E)),T.push(s/W,l/X,b/W,w/X,b/W,l/X,s/W,l/X,s/W,w/X,b/W,w/X);if(M){var V=[];for(l=0,x=B.length;x>l;l+=3)V.push(2*B[l],2*B[l+1],2*B[l+2])}if(A){var c=[],h=[];for(J=f*p,l=0;X>l;l++)w=l+1,i=l*y,H=w*y,c.push(0,0,0,N*d(H)*I(J),N*I(H),-N*d(H)*d(J),N*d(i)*I(J),N*I(i),-N*d(i)*d(J)),h.push(0,.5,f/W,w/X,f/W,l/X)}if(j){var k=[],D=[];for(J=O*p,l=0;X>l;l++)w=l+1,i=l*y,H=w*y,k.push(0,0,0,N*d(i)*I(J),N*I(i),-N*d(i)*d(J),N*d(H)*I(J),N*I(H),-N*d(H)*d(J)),D.push(1,.5,O/W,l/X,O/W,w/X)}var K={vs:B,uv:T,from_vs:c,from_uv:h,to_vs:k,to_uv:D};return M&&(K.ns=V),K},oo=function(s,X,l){s=s||.17,X=X||12,l=l||18,0>s?s=0:s>.25&&(s=.25);var c,u,Z,G,p,T,w,M=.5,R=[],L=[],C=[],r=z/l,q=z/X,e=M-s;for(u=0;X>=u;u++)for(G=-S+u*q,T=I(G),p=d(G),c=0;l>=c;c++)Z=c*r,w=e+s*T,R.push(I(Z)*w,p*s,-d(Z)*w),L.push(c/l,1-u/X);for(u=0;X>u;u++){var n=u*(l+1),Y=(u+1)*(l+1);for(c=0;l>c;c++)C.push(n+c,Y+c+1,Y+c,n+c,n+c+1,Y+c+1)}return{vs:R,uv:L,is:C}},Qp=function(l,E,Z,i,T,N,n,j){n=n||12,l=l||18,E=E||0,Z=Z||l,N=N||.17,0>N?N=0:N>.25&&(N=.25);var g,V,c,P,A,W,K,o,J,r,p=.5,X=[],v=[],M=z/l,R=z/n,k=p-N,y=j?[]:w;for(c=0;n>c;c++)for(P=c+1,K=-S+c*R,o=-S+P*R,g=E;Z>g;g++)V=g+1,A=g*M,W=V*M,J=k+N*I(K),r=k+N*I(o),X.push(I(A)*J,d(K)*N,-d(A)*J,I(W)*J,d(K)*N,-d(W)*J,I(W)*r,d(o)*N,-d(W)*r,I(A)*J,d(K)*N,-d(A)*J,I(W)*r,d(o)*N,-d(W)*r,I(A)*r,d(o)*N,-d(A)*r),v.push(g/l,1-c/n,V/l,1-c/n,V/l,1-P/n,g/l,1-c/n,V/l,1-P/n,g/l,1-P/n),j&&y.push(I(A)*I(K),d(K),-d(A)*I(K),I(W)*I(K),d(K),-d(W)*I(K),I(W)*I(o),d(o),-d(W)*I(o),I(A)*I(K),d(K),-d(A)*I(K),I(W)*I(o),d(o),-d(W)*I(o),I(A)*I(o),d(o),-d(A)*I(o));if(i){var Y=[],C=[];for(c=0;n>c;c++)P=c+1,K=-S+c*R,o=-S+P*R,A=E*M,J=k+N*I(K),r=k+N*I(o),Y.push(I(A)*J,d(K)*N,-d(A)*J,I(A)*r,d(o)*N,-d(A)*r,I(A)*k,0,-d(A)*k),C.push(.5+.5*I(K),.5-.5*d(K),.5+.5*I(o),.5-.5*d(o),.5,.5)}if(T){var a=[],G=[];for(c=0;n>c;c++)P=c+1,K=-S+c*R,o=-S+P*R,A=Z*M,J=k+N*I(K),r=k+N*I(o),a.push(I(A)*J,d(K)*N,-d(A)*J,I(A)*k,0,-d(A)*k,I(A)*r,d(o)*N,-d(A)*r),G.push(.5-.5*I(K),.5-.5*d(K),.5,.5,.5-.5*I(o),.5-.5*d(o))}var Q={vs:X,uv:v,from_vs:Y,from_uv:C,to_vs:a,to_uv:G};return j&&(Q.ns=y),Q},Og=function(Z,V){for(var a,W,T,f=.5,c=16,p=[],F=[],u=[],t=z/c,S=0;c>=S;S++)a=S*t,W=I(a)*f,T=d(a)*f,p.push(W,-f,T,W,f,T),F.push(1-S/c,1,1-S/c,0);for(S=0;c>S;S++)u.push(2*S,2*S+1,2*S+3,2*S,2*S+3,2*S+2);if(V){var _=[],x=[],n=[];for(_.push(0,-f,0),x.push(.5,.5),S=0;c>=S;S++)a=S*t,W=I(a),T=d(a),_.push(W*f,-f,-T*f),x.push(.5+.5*W,.5+.5*T);for(S=0;c>S;S++)n.push(0,S+2,S+1)}if(Z){var h=[],K=[],N=[];for(h.push(0,f,0),K.push(.5,.5),S=0;c>=S;S++)a=S*t,W=I(a),T=d(a),h.push(W*f,f,-T*f),K.push(.5+.5*W,.5-.5*T);for(S=0;c>S;S++)N.push(0,S+1,S+2)}return{vs:p,uv:F,is:u,bottom_vs:_,bottom_uv:x,bottom_is:n,top_vs:h,top_uv:K,top_is:N}},Yf=function(q,h,J,N,T,b,y,Z){q=q||12,h=h||0,J=J||q;for(var O,v,M,G,c,A,n,D,Y,g=.5,Q=[],t=[],_=z/q,E=h;J>E;E++)O=E+1,v=E*_,M=O*_,G=I(v)*g,c=d(v)*g,A=I(M)*g,n=d(M)*g,Q.push(G,-g,-c,A,-g,-n,G,g,-c,A,-g,-n,A,g,-n,G,g,-c),t.push(E/q,1,O/q,1,E/q,0,O/q,1,O/q,0,E/q,0);if(Z){var H=[];for(E=0,Y=Q.length;Y>E;E+=3)H.push(2*Q[E],0,2*Q[E+2])}if(y){var s=[],r=[];for(E=h;J>E;E++)v=_*E,M=_*(E+1),G=I(v),c=d(v),A=I(M),n=d(M),s.push(G*g,-g,-c*g,0,-g,0,A*g,-g,-n*g),r.push(.5+.5*G,.5+.5*c,.5,.5,.5+.5*A,.5+.5*n)}if(b){var a=[],U=[];for(E=h;J>E;E++)v=_*E,M=_*(E+1),G=I(v),c=d(v),A=I(M),n=d(M),a.push(G*g,g,-c*g,A*g,g,-n*g,0,g,0),U.push(.5+.5*G,.5-.5*c,.5+.5*A,.5-.5*n,.5,.5)}if(N){var f=[],j=[];v=_*h,G=I(v)*g,c=d(v)*g,D=h/q,f.push(0,g,0,0,-g,0,G,-g,-c,G,-g,-c,G,g,-c,0,g,0),j.push(0,0,0,1,D,1,D,1,D,0,0,0)}if(T){var B=[],F=[];v=_*J,G=I(v)*g,c=d(v)*g,D=J/q,B.push(0,-g,0,0,g,0,G,g,-c,G,g,-c,G,-g,-c,0,-g,0),F.push(1,1,1,0,D,0,D,0,D,1,1,1)}var X={vs:Q,uv:t,bottom_vs:s,bottom_uv:r,top_vs:a,top_uv:U,from_vs:f,from_uv:j,to_vs:B,to_uv:F};return Z&&(X.ns=H),X},gq=function(Z,e,p,q,L){e=e||18,p=p||0,q=q==t?z:q,L=L==t?.5:L;for(var F,T,w,Q,f,U,a=[0,.5,.75,.875,.9375],r=[],l=[],X=[],O=q/e,_=0;_<a.length;_++){var E=0===_%2?0:.5;for(F=0;e>=F;F++)T=(F+E)*O+p,w=1-a[_],r.push(I(T)*L*w,-L+2*a[_]*L,-d(T)*L*w),l.push((F+E)/e,w)}for(_=0;_<a.length-1;_++){var D=_*(e+1),A=(_+1)*(e+1);for(F=0;e>F;F++)X.push(D+F,A+F+1,A+F,D+F,D+F+1,A+F+1)}for(U=r.length/3-(e+1),F=0;e>F;F++)r.push(0,L,0),l.push((F+.5)/e,0);for(F=0;e>F;F++)X.push(U+F,U+F+1,U+(e+1)+F);if(Z){var S=[],C=[],k=[];for(S.push(0,-L,0),C.push(.5,.5),F=0;e>=F;F++)T=F*O+p,Q=I(T),f=d(T),S.push(Q*L,-L,-f*L),C.push(.5+.5*Q,.5+.5*f);for(F=0;e>F;F++)k.push(0,F+2,F+1)}return{vs:r,uv:l,is:X,bottom_vs:S,bottom_uv:C,bottom_is:k}},Rh=function(k,f,W,$,c,w){k=k||16,f=f||0,W=W||k;for(var N=.5,u=[],i=[],Q=z/k,t=f;W>t;t++){var v=t+1,y=Q*t,q=Q*v;u.push(I(y)*N,-N,-d(y)*N,I(q)*N,-N,-d(q)*N,0,N,0),i.push(t/k,1,v/k,1,(t+v)/2/k,0)}if(w){var h=[],m=[];for(t=f;W>t;t++){y=Q*t,q=Q*(t+1);var j=I(y),D=d(y),Y=I(q),_=d(q);h.push(j*N,-N,-D*N,0,-N,0,Y*N,-N,-_*N),m.push(.5+.5*j,.5+.5*D,.5,.5,.5+.5*Y,.5+.5*_)}}if($){var p=[],g=[];y=Q*f,p.push(0,N,0,0,-N,0,I(y)*N,-N,-d(y)*N),g.push(0,0,0,1,f/k,1)}if(c){var s=[],M=[];y=Q*W,s.push(0,-N,0,0,N,0,I(y)*N,-N,-d(y)*N),M.push(1,1,1,0,W/k,1)}return{vs:u,uv:i,bottom_vs:h,bottom_uv:m,from_vs:p,from_uv:g,to_vs:s,to_uv:M}},am=function(w,i,c,r,t,J,S,j){for(var d=[],Y=0;Y<w.length-1;Y+=2)d.push({x:w[Y],y:w[Y+1]});return le(d,i,c,r,t,J,S,j,!1)},Lr={roundRect:function(Y,I){return am([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],Y,I,3)},star:function(Q,w){return am([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],Q,w)},rect:function(A,y){return am([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],A,y)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(f,E){return am([0,-.5,.5,.5,-.5,.5],[1,2,2,5],f,E)},rightTriangle:function(S,b){return am([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],S,b)},parallelogram:function(J,O){return am([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],J,O)},trapezoid:function(l,t){return am([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],l,t)}},io={sphere:1,cylinder:1,cone:1,torus:1},Fj={torus:1,sphere:1},di=oi(kr(Lr),{cylinder:1}),cp=oi(kr(Lr),{cylinder:1,cone:1}),$f=function(L,s,z){var b,H=bf(L.anchor3d,z,s),Y=bf(L.mat,z,s),C=bf(L.s3,z,s),l=bf(L.t3,z,s),u=bf(L.r3,z,s),m=C||u||l||Y;if(H||m){b=jj(s._6O);var x=m?od(Y,C,u,bf(L.rotationMode,z,s),l):_d();H&&vq(x,[.5-H[0],.5-H[1],.5-H[2]]),um(s,x)}return b},Il=function(P,m,a,V,h,H,S){if(Cl(a))a.forEach(function(R){Il(P,m,R,V,h,H,S)});else if(vh(a))Il(P,m,se(V,a),V,h,H,S);else if(ao(a))if(a.shape3d){var v=$f(a,P,m);Il(P,m,a.shape3d,V,h,H,a),v&&Np(P,v)}else sh(P,m,a,V.s,h,H,S)},sh=function(m,S,R,n,i,K,X){if(X=X||sg,!K||K(n("shape3d.transparent",R.transparent,X.transparent))){var v=$f(R,m,S);Sg(R);var e=m._26I,L=m._prg,Q=m._buffer,F=n("shape3d.color",R.color,X.color);i||(i=n("shape3d.blend",R.blend,X.blend));var y,T=R.opacity==t?X.opacity:R.opacity,G=n("shape3d.opacity");y=G!=t&&T!=t?T*G:T!=t?T:G,jo(e,L,i,n("shape3d.light",R.light,X.light),y,n("shape3d.reverse.flip",R.reverseFlip,X.reverseFlip),n("shape3d.reverse.color",R.reverseColor,X.reverseColor),n("shape3d.reverse.cull",R.reverseCull,X.reverseCull));var s=n("polygonOffset",R.polygonOffset,X.polygonOffset);R.vs&&n(Zm,R.visible,X.visible)&&Fp(e,L,Q,F,m.getTexture(n("shape3d.image",R.image,X.image),S),n("shape3d.discard.selectable",R.discardSelectable,X.discardSelectable),R.vs,R.uv,R.ns,R.is,n("shape3d.uv.offset",R.uvOffset,X.uvOffset),n("shape3d.uv.scale",R.uvScale,X.uvScale),s),R.top_vs&&n(ss,R.topVisible,X.topVisible)&&Fp(e,L,Q,n("shape3d.top.color",R.topColor,X.topColor)||F,m.getTexture(n("shape3d.top.image",R.topImage,X.topImage),S,"top"),n("shape3d.top.discard.selectable",R.topDiscardSelectable,X.topDiscardSelectable),R.top_vs,R.top_uv,R.top_ns,R.top_is,n("shape3d.top.uv.offset",R.topUvOffset,X.topUvOffset),n("shape3d.top.uv.scale",R.topUvScale,X.topUvScale),s),R.bottom_vs&&n(Kk,R.bottomVisible,X.bottomVisible)&&Fp(e,L,Q,n("shape3d.bottom.color",R.bottomColor,X.bottomColor)||F,m.getTexture(n("shape3d.bottom.image",R.bottomImage,X.bottomImage),S,"bottom"),n("shape3d.bottom.discard.selectable",R.bottomDiscardSelectable,X.bottomDiscardSelectable),R.bottom_vs,R.bottom_uv,R.bottom_ns,R.bottom_is,n("shape3d.bottom.uv.offset",R.bottomUvOffset,X.bottomUvOffset),n("shape3d.bottom.uv.scale",R.bottomUvScale,X.bottomUvScale),s),R.from_vs&&n(Xm,R.fromVisible,X.fromVisible)&&Fp(e,L,Q,n("shape3d.from.color",R.fromColor,X.fromColor)||F,m.getTexture(n("shape3d.from.image",R.fromImage,X.fromImage),S,"from"),n("shape3d.from.discard.selectable",R.fromDiscardSelectable,X.fromDiscardSelectable),R.from_vs,R.from_uv,R.from_ns,R.from_is,n("shape3d.from.uv.offset",R.fromUvOffset,X.fromUvOffset),n("shape3d.from.uv.scale",R.fromUvScale,X.fromUvScale),s),R.to_vs&&n(fb,R.toVisible,X.toVisible)&&Fp(e,L,Q,n("shape3d.to.color",R.toColor,X.toColor)||F,m.getTexture(n("shape3d.to.image",R.toImage,X.toImage),S,"to"),n("shape3d.to.discard.selectable",R.toDiscardSelectable,X.toDiscardSelectable),R.to_vs,R.to_uv,R.to_ns,R.to_is,n("shape3d.to.uv.offset",R.toUvOffset,X.toUvOffset),n("shape3d.to.uv.scale",R.toUvScale,X.toUvScale),s),np(e,L),v&&Np(m,v)}},Fp=function(R,W,M,e,w,I,c,r,T,O,Z,d,p){c&&(p&&Hj(R,p),Jo(R,W.uDiffuse,e||K["color.empty"]),r?we(R,W,w,I,M.uv,r,Z,d):we(R),jk(R,M.vs,c,W.aPosition),jk(R,M.ns,T,W.aNormal),O?(Gl(R,M.is,O),Yi(R,0,O.length)):Wf(R,0,c.length/3),r?Li(R,W,w):Li(R),p&&re(R))},se=function(p,C){var s=p.s;if(C||(C=s(Kd)),!C)return t;var u=Wb(C);if(u)return u;if("text"===C){var G={amount:s("shape3d.text.amount"),size:s("shape3d.text.size"),font:s("shape3d.text.font"),style:s("shape3d.text.style"),weight:s("shape3d.text.weight"),fill:s("shape3d.text.fill"),curveSegments:s("shape3d.text.curveSegments"),spacing:s("shape3d.text.spacing")},I=p.gv.getShape3dText(p.data),U=I;for(var q in G)U+="_"+(G[q]===w?"U":G[q]);return p._cachedTextKey===U?p._cachedTextGeometry:(p._cachedTextKey=U,p._cachedTextGeometry=Q.createTextGeometry(I,G))}var q=C;if(io[C]){var L=s("shape3d.side"),J=s("shape3d.side.from"),K=s("shape3d.side.to"),b=s(Xm),o=s(fb);3>L?(L=0,J=0,K=0,b=!1,o=!1):((J==t||0>J)&&(J=0),(K==t||K>L)&&(K=L),0===J&&K===L&&(b=!1,o=!1));var H="cone"===C?!1:s("shape3d.smooth");q+="-"+L+"-"+J+"-"+K+"-"+b+"-"+o+(H?1:0)}if(di[C]){var S=s(ss);q+="-"+S}if(cp[C]){var i=s(Kk);q+="-"+i}if("torus"===C){var m=s("shape3d.torus.radius");0>m?m=0:m>.25&&(m=.25),q+="-"+m}if(Fj[C]){var g=s(Hb);q+="-"+g}return u=Pm[q],u||("box"===C?u=Q.createBoxModel():Lr[C]?u=Lr[C](S,i):"sphere"===C?u=Q.createSphereModel(L,J,K,b,o,g,H):C===qk?u=Q.createCylinderModel(L,J,K,b,o,S,i,H):"cone"===C?u=Q.createConeModel(L,J,K,b,o,i):"torus"===C&&(u=Q.createTorusModel(L,J,K,b,o,m,g,H)),Pm[q]=u),u},Sg=function(){var u=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],M=["is","top_is","bottom_is","from_is","to_is"];return e=rc(es.substr(es.indexOf("^#")+2)),dp(Q[Zl(Pb+u[15]+"n"+u[16])]())&&dn()?function(_){_&&!_._complete_&&(_._complete_=!0,_.vs&&Xl(_.ns)&&(_.ns=Gq(_.vs,_.is)),_.top_vs&&Xl(_.top_ns)&&(_.top_ns=Gq(_.top_vs,_.top_is)),_.bottom_vs&&Xl(_.bottom_ns)&&(_.bottom_ns=Gq(_.bottom_vs,_.bottom_is)),_.from_vs&&Xl(_.from_ns)&&(_.from_ns=Gq(_.from_vs,_.from_is)),_.to_vs&&Xl(_.to_ns)&&(_.to_ns=Gq(_.to_vs,_.to_is)),u.forEach(function(P){var O=_[P];Cl(O)&&(_[P]=new cc(O))}),M.forEach(function(I){var o=_[I];Cl(o)&&(_[I]=new vk(o))}))}:void 0}(),Sq=function(l,z){var K=l[z];Cl(K)&&(l[z]=new cc(K))};oi(yb,{_25Q:function(v){v._16O=function(P,R,b,s,n,Z,o,z,Y){var G=this.info;if(G){var c,M,j,x,L,Q,U=_d();if(Ig[R]?(c=G.p3,M=G.c1,j=G.c2):ug[R]?(M=G.s1||G.c1,j=G.s2||G.c2):(M=G.t1||G.c1,j=G.t2||G.c2),c)Q=rj(R,si,b,s,z,Y);else{var F=Sb(j,M),y=ro(M,j);x=[0,-r(F[2],F[0]),W(F[1]/y)],L="zyx",c=[(M[0]+j[0])/2,(M[1]+j[1])/2,(M[2]+j[2])/2],Q=rj(R,[y,0,0],b,s,z,Y)}return Ar(U,Q,c,s,n,Z,o,P,x,L)}return $l},v._80o=function(i,g,u){var O=this,K=O.shapeModel;if(K){var h=O.gv;um(h),Il(h,O.data,K,O,O.getBodyColor(),u)}},v.createLineModel=function(q,y,o,w,r){for(var X=this,E=X.s,W=_r(q,y,E(Hb)),m=[],R=0;R<W.length;R++){var F=W[R],P=F.length;if(P>1){var C=F[0];m.push(C.x,C.y,C.z);for(var I=1;P-1>I;I++)C=F[I],m.push(C.x,C.y,C.z),m.push(C.x,C.y,C.z);C=F[P-1],m.push(C.x,C.y,C.z)}}var l,z,D,O=E(w+".color"),x=E(r),L=0;return x&&(z=E(r+".color"),l=E(r+".pattern"),L=E(r+".offset"),D=O),dg(X.gv,X.data,m,z||O,D?t:E(w+".gradient.color"),o,l||E(w+".pattern"),L,D),W},v.createTubeModel=function(p,K,Y,P){for(var d=this,B=d.s,x=B("shape3d.side")||Nh,T=B("shape3d.start.angle"),h=B("shape3d.sweep.angle"),j=B(ss)?B("shape3d.top.cap"):t,l=B(Kk)?B("shape3d.bottom.cap"):t,H="flat"===j,y="flat"===l,i=H&&(P?P.uv:B("shape3d.top.image")),Z=y&&(P?P.uv:B("shape3d.bottom.image")),u=P?P.uv:B("shape3d.image"),C={vs:[],uv:u?[]:t,top_vs:H?[]:t,top_uv:i?[]:t,bottom_vs:y?[]:t,bottom_uv:Z?[]:t},W=_r(p,K,B(Hb),Y),c=0,e=W.length;e>c;c++)Wq(C,W[c],B(eh),Y,x,T,h,j,l);if(P){var k=[];Ff(d.gv,d.data,C,d,d.getBodyColor(),[],P,k),k.length&&(je(P.vs,k),je(P.ns,Gq(k)))}else d.shapeModel=C;return W},v.getCache=function(){var Y=this.info;if(Y){var z=Y.list;if(z){var X=Y.cache;return X||(X=Y.cache=Nq(z)),X}}return t}}});var Xb=function(w,X){for(var q,W=0,z=w.length,m=0,R=z-1;R>=m;)if(W=E(m+(R-m)/2),q=w[W].length-X,0>q)m=W+1;else{if(!(q>0)){R=W;break}R=W-1}W=R;var y=w[W],c=y.point;return W===z-1||y.length===X||(c=(new cr).subVectors(w[W+1].point,c).normalize().multiplyScalar(X-y.length).add(c)),{point:c,tangent:y.tangent}},Nq=function(t){for(var N,X,F=[],R=0,v=0;v<t.length;v++){for(var w=t[v],H=0;H<w.length;H++){N=w[H],X&&(R+=X.distanceTo(N));var j=new cr,Z=w[H+1];Z?j.subVectors(Z,N):X?j.subVectors(N,X):j.x=1,j.normalize(),F.push({point:N,length:R,tangent:j}),X=N}X=null}return F},_r=function(X,C,P,O){P=P||Yq;for(var e=[],m=0,Y=X.size();Y>m;m++){var Q=X.get(m);e.push(new cr(Q.x,Q.e||0,Q.y))}C&&(Pr(C)&&(C=C._as),C.length||(C=null));for(var q,h,y,W,d,z=[],J=0,s=0,f=C?C.length:Y;f>s;s++)if(d=C?C[s]:0===s?1:2,1===d)z.push(y=[]),y.push(e[J++]);else if(2===d||5===d)if(W=2===d?e[J++]:y[0],O){var U=C?C[s+1]:f>s+1?2:t;if(2===U||5===U){var j=y[y.length-1],D=2===U?e[J]:y[0],R=(new cr).subVectors(j,W),Z=(new cr).subVectors(D,W),H=R.length(),i=Z.length();if(H&&i)if(O>H/2&&O>i/2)y.push(W);else for(R.multiplyScalar(a(O,H/2)/H).add(W),Z.multiplyScalar(a(O,i/2)/i).add(W),q=new Rk(R,W,Z).getPoints(P),h=0;P>=h;h++)y.push(q[h])}else y.push(W)}else y.push(W);else if(3===d)for(q=new Rk(y[y.length-1],e[J++],e[J++]).getPoints(P),h=1;P>=h;h++)y.push(q[h]);else if(4===d)for(q=new pn(y[y.length-1],e[J++],e[J++],e[J++]).getPoints(P),h=1;P>=h;h++)y.push(q[h]);return z},mr=function(E){for(var B,W,Y=new cr,r=[],t=[],u=[],w=0,v=E.length;v>w;w++)B=E[w],W=E[w+1],W?Y.subVectors(W,B):Y.subVectors(B,E[w-1]),r.push(Y.normalize().clone());var D,q,l,O,H=new cr,K=new cr,R=new Oi,M=1e-4,L=Number.MAX_VALUE,A=r[0],i=t[0]=new cr,m=u[0]=new cr;for(q=c(A.x),l=c(A.y),O=c(A.z),L>=q&&(L=q,H.set(1,0,0)),L>=l&&(L=l,H.set(0,1,0)),L>=O&&H.set(0,0,1),K.crossVectors(A,H).normalize(),i.crossVectors(A,K),m.crossVectors(A,i),w=1;v>w;w++)t[w]=t[w-1].clone(),u[w]=u[w-1].clone(),K.crossVectors(r[w-1],r[w]),K.length()>M&&(K.normalize(),D=$(kh(r[w-1].dot(r[w]),-1,1)),t[w].applyMatrix4(R.makeRotationAxis(K,D))),u[w].crossVectors(r[w],t[w]);return{B:u,T:r,N:t}},Wq=function(){var y=function(t){for(var l=1;l<arguments.length;l++){var O=arguments[l];t.push(O.x,O.y,O.z)}},g=function(t){for(var S=1;S<arguments.length;S++){var r=arguments[S].uv;t.push(r[0],r[1])}},K=function(P,T,l,g,C){var v=-g*I(C),R=g*d(C);return new cr(P.x+v*l.x+R*T.x,P.y+v*l.y+R*T.y,P.z+v*l.z+R*T.z)},q=function(y,k,Y,V,T,H,R,d){R=R||z;for(var O=[],o=R/T,X=0;T>=X;X++){var C=K(y,k,Y,V,X*o+H);O.push(C),d!=t&&(C.uv=[d,1-X/T])}return O},J=function(o,P,N,Z,$,a,u,S,D){D=D||z;var F=P?o.top_vs:o.bottom_vs;if(F)for(var Y=P?o.top_uv:o.bottom_uv,p=D/u,E=0;u>E;E++){var b,l;P?(b=E*p+S,l=(E+1)*p+S):(l=E*p+S,b=(E+1)*p+S),y(F,K(N,Z,$,a,b),K(N,Z,$,a,l),N),Y&&Y.push(.5-.5*I(b),.5-.5*d(b),.5-.5*I(l),.5-.5*d(l),.5,.5)}};return function(b,s,d,V,P,o,H,X,A){var U=s.length;if(U>1){var v,I,j,z,r,K,p,Y=mr(s),i=Y.T,e=Y.N,W=Y.B;"flat"===X&&J(b,!0,s[0],W[0],e[0],V,P,o,H),"flat"===A&&J(b,!1,s[U-1],W[U-1],e[U-1],V,P,o,H);var O,R,n=[],l=m(P/2),Z="round"===X,h="round"===A,f=s[0],S=i[0],x=W[0],L=e[0],E=s[U-1],c=i[U-1],T=W[U-1],Q=e[U-1];if(Z){for(j=1;l>=j;j++)e.splice(0,0,L),W.splice(0,0,x),i.splice(0,0,S),R=-j/l*V,s.splice(0,0,S.clone().multiplyScalar(R).add(f)),n[l-j]=N(V*V-R*R);U+=l}if(h){for(j=1;l>=j;j++)e.push(Q),W.push(T),i.push(c),R=j/l*V,s.push(c.clone().multiplyScalar(R).add(E)),n[s.length-1]=N(V*V-R*R);U+=l}if(b.uv){var M=0,C=0,F=[];for(d&&(M=d),r=s[0],F[0]=0,j=1;U>j;j++)z=s[j],F[j]=r.distanceTo(z),r=z,d||(M+=F[j]);for(O=[],j=0;U>j;j++)C+=F[j],O[j]=M?C/M:0}for(j=0;U>j;j++){if(z=s[j],K=W[j],p=e[j],v=q(z,K,p,n[j]===w?V:n[j],P,o,H,O?O[j]:t),I)for(var $=0;P>$;$++){var u=I[$],k=I[$+1]||I[0],B=v[$],D=v[$+1]||v[0];y(b.vs,k,u,B,B,D,k),b.uv&&g(b.uv,k,u,B,B,D,k)}I=v}}}}();oi(Q,{getLineLength:function(T){return T[T.length-1].length},getLineOffset:function(m,j){return Xb(m,j)},getLineCacheInfo:function(w,m,c,p){return Nq(_r(w,m,c,p))}});var rr=Y.graph3d.RenderLite={},qi=new Array(0),wp=rr.Buffer=function(X,v,T,L){this.gl=X,this.buffer=X.createBuffer(),this.type=v||X.ARRAY_BUFFER,this.drawType=L||X.STATIC_DRAW,this.data=qi,T&&this.upload(T)};wp.prototype.upload=function($,A,g){g||this.bind();var D=this.gl;$=$||this.data,A=A||0,this.data.byteLength>=$.byteLength?D.bufferSubData(this.type,A,$):D.bufferData(this.type,$,this.drawType),this.data=$},wp.prototype.bind=function(){var W=this.gl;W.bindBuffer(this.type,this.buffer)},wp.createVertexBuffer=function(Z,h,R){return new wp(Z,Z.ARRAY_BUFFER,h,R)},wp.createIndexBuffer=function(c,y,b){return new wp(c,c.ELEMENT_ARRAY_BUFFER,y,b)},wp.create=function(U,O,l,C){return new wp(U,O,C)},wp.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Br=rr.Shader=function(E,m,t){this.gl=E,this.program=jr(E,m,t),this.attributes=Ue(E,this.program);var c=ho(E,this.program);this.uniforms=rg(E,c)};Br.prototype.bind=function(){this.gl.useProgram(this.program)},Br.prototype.destroy=function(){this.gl};var jr=function(M,r,x){var S=yh(M,M.VERTEX_SHADER,r),i=yh(M,M.FRAGMENT_SHADER,x);M.getShaderParameter(i,M.COMPILE_STATUS)||console.error(M.getError());var f=M.createProgram();return M.attachShader(f,S),M.attachShader(f,i),M.linkProgram(f),M.getProgramParameter(f,M.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",M.getProgramParameter(f,M.VALIDATE_STATUS)),console.error("gl.getError()",M.getError()),""!==M.getProgramInfoLog(f)&&console.warn("Warning: gl.getProgramInfoLog()",M.getProgramInfoLog(f)),M.deleteProgram(f),f=null),M.deleteShader(S),M.deleteShader(i),f},yh=function(H,v,h){var k=H.createShader(v);return H.shaderSource(k,h),H.compileShader(k),H.getShaderParameter(k,H.COMPILE_STATUS)?k:(console.log(H.getShaderInfoLog(k)),null)},ho=function(C,T){for(var f={},d=C.getProgramParameter(T,C.ACTIVE_UNIFORMS),h=0;d>h;h++){var n=C.getActiveUniform(T,h),k=n.name.replace(/\[.*?\]/,""),Z=ph(C,n.type);f[k]={type:Z,size:n.size,location:C.getUniformLocation(T,k),value:tb(Z,n.size)}}return f},Ue=function(y,o){for(var N={},Y=y.getProgramParameter(o,y.ACTIVE_ATTRIBUTES),e=0;Y>e;e++){var w=y.getActiveAttrib(o,e),b=ph(y,w.type);N[w.name]={type:b,size:$m(b),gl:y,location:y.getAttribLocation(o,w.name),pointer:hp}}return N},hp=function(m,T,K,t,A){var p=this.gl;p.enableVertexAttribArray(this.location),m instanceof rr.Buffer||(m=rr.Buffer.createVertexBuffer(p,m)),p.bindBuffer(m.type,m.buffer),p.vertexAttribPointer(this.location,this.size,T||p.FLOAT,K||!1,t||0,A||0)},$m=function(F){return rb[F]},rb={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ph=function(O,s){if(!Zh){var J=u.keys(Sl);Zh={};for(var A=0;A<J.length;++A){var T=J[A];Zh[O[T]]=Sl[T]}}return Zh[s]},Zh=null,Sl={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},tb=function(G,u){switch(G){case"float":return 0;case"vec2":return new Float32Array(2*u);case"vec3":return new Float32Array(3*u);case"vec4":return new Float32Array(4*u);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*u);case"ivec3":return new Int32Array(3*u);case"ivec4":return new Int32Array(4*u);case"bool":return!1;case"bvec2":return Aj(2*u);case"bvec3":return Aj(3*u);case"bvec4":return Aj(4*u);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Aj=function(V){for(var A=new Array(V),$=0;$<A.length;$++)A[$]=!1;return A},rg=function(s,M){var I={data:{}};I.gl=s;for(var N=u.keys(M),C=0;C<N.length;C++){var l=N[C],f=l.split("."),m=f[f.length-1],$=uh(f,I),Z=M[l];$.data[m]=Z,$.gl=s,u.defineProperty($,m,{get:Zj(m),set:Gj(m,Z)})}return I},Zj=function(n){var a=Gc.replace("%%",n);return new Function(a)},Gj=function(b,E){var H,t=Ih.replace(/%%/g,b);return H=1===E.size?Mj[E.type]:Bl[E.type],H&&(t+="\nthis.gl."+H+";"),new Function("value",t)},uh=function(q,m){for(var I=m,R=0;R<q.length-1;R++){var p=I[q[R]]||{data:{}};I[q[R]]=p,I=p}return I},Gc=["return this.data.%%.value;"].join("\n"),Ih=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Mj={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Bl={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},lb=Y.Light=function(){ml(lb,this),this.s(Pk,K[Pk]),this.s(Kd,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};uk("Light",Pc,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(R,M,h){lb.superClass.onStyleChanged.apply(this,arguments),R===Pk&&this.s("shape3d.color",h)}});var xd=Tn.Graph3dView=function(O,m){var P=this;P._webGLVersion=1,P._attributes=m||Q.graph3dViewAttributes,P._25I={},P._view=yo(1,P);var c=P._canvas=Yh(P._view);b(c,"webglcontextlost",function(y){y.preventDefault(),hf(P),P._26I&&P._doBufferGC(P._26I,!0),P._26I=t,P._1o.texture=t,P._35O=!0}),b(c,"webglcontextrestored",function(){P._35O=!1,P.iv()}),P._batchIndexMap={},P._batchModelMap={},P._wireframeIndexMap={},P._wireframeModelMap={},P._wireframeIndexMapSwap={},P._wireframeModelMapSwap={},P._polylineIndexMap={},P._polylineIndexMap={},P._polylineIndexMapSwap={},P._polylineIndexMapSwap={},P._8O=[],P._7O=_d(),P._6O=_d(),P._1o=new pf(P),P._30O=new _f(P),P._31O=new Op(P),P._32O=new _c(P),P._raycaster=new fi(P),P._highlightHelper=new Di(P),P._postProcessing=new ib(P),P._cameras=[],P._cameraId=0,P.vr=new Hi(P),P._33Q=!0,P._eye=kr(Q.graph3dViewEye),P._center=kr(Q.graph3dViewCenter),P._up=kr(Q.graph3dViewUp),P._lightChanged=!1,P._59O=[],P._spots=[],P._dirs=[],P._frameId=0,P.overlappingBox=new Co(P),P.dm(O?O:new Jg),P._coreInteractor=new Rn(this),P.setInteractors([new zj(P)]),P._initView()},Um={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Db=function(n,E,z,e){n.clearColor(0,0,0,0),n.clearDepth(1),n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.disable(n.CULL_FACE),n.enable(n.BLEND),n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA),n.useProgram(z),Jo(n,z.uBrightness,1),Jo(n,z.uOpacity,1),Jo(n,z.uPartOpacity,1),Jo(n,z.uPick,e._picking),Jo(n,z.uTexture,!1),Jo(n,z.uBlendTexture,!1),Jo(n,z.uAlphaTest,K.alphaTest),Jo(n,z.uTransparent,!1),Jo(n,z.uFix,!1),Jo(n,z.uBatchColor,!1),Jo(n,z.uBatchBlend,!1),Jo(n,z.uBatchBrightness,!1),Jo(n,z.uReflectivity,e._envmapReflectivity),Jo(n,z.uCameraPosition,E.getEye()),Jo(n,z.uPMatrix,e._projectMatrix),Jo(n,z.uViewMatrix,e._viewMatrix),E.bindEnvMap(n),e._picking||(Kg(E,n,z),E._fogDisabled||(Jo(n,z.uFogColor,E._fogColor),Jo(n,z.uFogNear,E._fogNear),Jo(n,z.uFogFar,E._fogFar))),qd(n,z.aPosition),qd(n,z.aNormal),ge(n,z.aUv),ge(n,z.aBatchColor),ge(n,z.aBatchBlend),ge(n,z.aBatchBrightness),ge(n,z.aLineDistance),n.depthMask(!0)},Ip=0;Zq("Graph3dView",u,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Mm,Qg,"firstPersonMode",Vr,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",mh,Qi,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:Q.graph3dViewEditHelperDisabled,_blockSelectable:Q.graph3dViewBlockSelectable,_devicePixelRatio:w,_boundaries:w,_moveStep:Q.graph3dViewMoveStep,_rotateStep:Q.graph3dViewRotateStep,_pannable:Q.graph3dViewPannable,_rotatable:Q.graph3dViewRotatable,_walkable:Q.graph3dViewWalkable,_resettable:Q.graph3dViewResettable,_zoomable:Q.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:Q.graph3dViewFirstPersonMode,_mouseRoamable:Q.graph3dViewMouseRoamable,_gridVisible:Q.graph3dViewGridVisible,_gridSize:Q.graph3dViewGridSize,_gridGap:Q.graph3dViewGridGap,_gridColor:Q.graph3dViewGridColor,_originAxisVisible:Q.graph3dViewOriginAxisVisible,_centerAxisVisible:Q.graph3dViewCenterAxisVisible,_axisXColor:Q.graph3dViewAxisXColor,_axisYColor:Q.graph3dViewAxisYColor,_axisZColor:Q.graph3dViewAxisZColor,_ortho:Q.graph3dViewOrtho,_orthoWidth:Q.graph3dViewOrthoWidth,_fovy:Q.graph3dViewFovy,_near:Q.graph3dViewNear,_far:Q.graph3dViewFar,_headlightColor:Q.graph3dViewHeadlightColor,_headlightIntensity:Q.graph3dViewHeadlightIntensity,_headlightRange:Q.graph3dViewHeadlightRange,_headlightAmbientIntensity:Q.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:Q.graph3dViewHeadlightDisabled,_rectSelectable:Q.graph3dViewRectSelectable,_rectSelectBackground:Q.graph3dViewRectSelectBackground,_editSizeColor:Q.graph3dViewEditSizeColor,_autoMakeVisible:Pq,_fogDisabled:Q.graph3dViewFogDisabled,_fogColor:Q.graph3dViewFogColor,_fogNear:Q.graph3dViewFogNear,_fogFar:Q.graph3dViewFogFar,_pickerResolution:Q.graph3dViewPickerResolution,_dashDisabled:Q.graph3dViewDashDisabled,_batchColorDisabled:Q.graph3dViewBatchColorDisabled,_batchBlendDisabled:Q.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:Q.graph3dViewBatchBrightnessDisabled,addCamera:function(v){var Z=u.freeze({id:this._cameraId++,priority:v.priority||0,ignoreInPick:!!v.ignoreInPick,useDefaultProgram:!!v.useDefaultProgram,render:v.render});
this._cameras.push(Z),this._cameras.sort(function(O,l){return O.priority!==l.priority?O.priority-l.priority:O.id-l.id})},setEye:function(d,D,C){1===arguments.length&&(D=d[1],C=d[2],d=d[0]);var K=this._eye;K[0]=d,K[1]=D,K[2]=C,this.fp(mh,t,K)},setCenter:function(k,X,j){1===arguments.length&&(X=k[1],j=k[2],k=k[0]);var a=this._center;a[0]=k,a[1]=X,a[2]=j,this.fp(Qi,t,a)},setUp:function(s,_,N){1===arguments.length&&(_=s[1],N=s[2],s=s[0]);var X=this._up;X[0]=s,X[1]=_,X[2]=N,this.fp("up",t,X)},getDevicePixelRatio:function(){return this._devicePixelRatio||td},isTransparentMask:function(r){return r.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var t=this,G=t._aspect;return G?G:(G=t.getWidth()/t.getHeight(),G||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(V){var d=this,k=d._dataModel,U=d._selectionModel;k!==V&&(k&&(k.ump(d.handleDataModelPropertyChange,d),k.umm(d.handleDataModelChange,d),k.umd(d.handleDataPropertyChange,d),U||k.sm().ums(d.handleSelectionChange,d)),d._dataModel=V,V.mp(d.handleDataModelPropertyChange,d),V.mm(d.handleDataModelChange,d),V.md(d.handleDataPropertyChange,d),U?U._21I(V):V.sm().ms(d.handleSelectionChange,d),d._postProcessing.handleDataModleChange(k,V),d.invalidateAll(!0),d.invalidateLight(),d.fp($q,k,V),d._canvas.style.background=V.getBackground()||"")},handleDataModelPropertyChange:function(T){if("background"===T.property){var x=this._canvas.style.background,Z=T.newValue||"";this._canvas.style.background=Z,this.fp("canvasBackground",x,Z)}else"envmap"===T.property&&this.iv()},handleDataPropertyChange:function(o){var G=o.data;this.invalidateData(G),bp(G)&&"s:light.type"===o.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(z){var i=this,U=z.property;i.iv(),i._18Q=t,"eye"===U?i._33Q=!0:"devicePixelRatio"===U?i._42(t,i.getDevicePixelRatio()):Um[U]&&hf(i)},_5O:function(x){var p=x._22Q();return p?new p(this,x):t},getData3dUI:function(d){var X=this._25I[d._id];return X===w&&(X=this._5O(d),this._25I[d._id]=X),X},invalidateAll:function($){var z=this;if($){for(var i in z._25I){var n=z._25I[i];n&&n.dispose()}z._25I={},z.iv(),Yr(z)}else Yr(z),z.dm().each(function(A){z.invalidateData(A)})},invalidateSelection:function(){var z=this;z.sm().each(function(y){z.invalidateData(y)})},invalidateData:function(E){var m=this,V=m.getData3dUI(E);V&&(V.iv(),m.iv()),Yr(m,E)},getShape3dText:function(i){return i.getStyle("shape3d.text")||this.getLabel(i)},invalidateBatch:function(n){var r=this,I=r._batchModelMap,v=I[n],e=[],E={};if(v){v.ds.forEach(function(N){var J=r.getData3dUI(N);J&&J.iv(),delete r._batchIndexMap[N._id],e.push(N._id)}),delete I[n];for(var s,f,d,Y,R,y,L,l,U,W=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],Z=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],X=0;X<W.length;X++){var z=r[W[X]],x=r[Z[X]];for(E={},l=0;l<e.length;l++){var o=x[e[l]];if(o){delete x[e[l]],U=o.batch,s=z[U];var F=o.begin,k=o.size,T=3*F,S=3*k,H=4*F,V=4*k;for(f=s.ds,d=s.vs,Y=s.cs,R=s.ps,y=s.ls,L=o.index,s.invalidate=!0,f[L]=w,L=T;T+S>L;L++)d[L]=w;for(L=H;H+V>L;L++)Y[L]=w;for(L=H;H+V>L;L++)R[L]=w;if(y)for(L=T;T+S>L;L++)y[L]=w;E[U]=!0}}for(U in E){s=z[U],f=s.ds,d=s.vs,Y=s.cs,R=s.ps,y=s.ls;var Q=[];for(L=0;L<f.length;L++)f[L]!==w&&Q.push(f[L]);if(0===Q.length)delete z[U];else{for(s.ds=Q,Q=[],L=0;L<d.length;L++)d[L]!==w&&Q.push(d[L]);for(s.vs=Q,Q=[],L=0;L<Y.length;L++)Y[L]!==w&&Q.push(Y[L]);for(s.cs=Q,Q=[],L=0;L<R.length;L++)R[L]!==w&&Q.push(R[L]);if(s.ps=Q,y){for(Q=[],L=0;L<y.length;L++)y[L]!==w&&Q.push(y[L]);s.ls=Q}}}}r.iv()}},handleDataModelChange:function(T){var E=this,u=T.kind,W=T.data;if("add"===u)E.invalidateData(W),br(W)&&W.getEdgeGroup()&&W.getEdgeGroup().eachSiblingEdge(E.invalidateData,E),bp(W)&&E.invalidateLight();else if(u===Ii){var K=W._id,U=E._25I[K];U&&(U.dispose(),delete E._25I[K],E.iv()),W===E._currentSubGraph&&E.setCurrentSubGraph(t),Yr(E,W),bp(W)&&E.invalidateLight()}else u===_p&&(E.invalidateAll(!0),E.setCurrentSubGraph(t),Yr(E),E.invalidateLight())},toCanvas:function(g,T,J){var m=this,e=m.getGL();if(m.validate(),g){var f=e.getParameter(e.COLOR_CLEAR_VALUE);Ch(e,g)}m._42(t,1);var L=m.getWidth(),p=m.getHeight(),v=new Uint8Array(4*L*p),P=Yh(),i=P.getContext("2d");e.readPixels(0,0,L,p,e.RGBA,e.UNSIGNED_BYTE,v),ik(P,L,p,1);for(var a=i.getImageData(0,0,L,p),A=a.data,M=0;M<A.length;M+=4){var I=M/4,U=E(I/L),u=I-U*L;I=4*((p-1-U)*L+u),A[I]=v[M],A[I+1]=v[M+1],A[I+2]=v[M+2],A[I+3]=v[M+3]}if(i.putImageData(a,0,0),g&&Ch(e,f),m._42(t,m.getDevicePixelRatio()),T&&J){var l=Yh(),c=l.getContext("2d");return T=T,J=J,ik(l,T,J,1),Q.drawImage(c,P,0,0,T,J),l}return P},toDataURL:function(h,E){var W=this,Z=W.getGL();if(W.validate(),h){var Y=Z.getParameter(Z.COLOR_CLEAR_VALUE);Ch(Z,h)}W._42(t,1);var c=W._canvas.toDataURL(E||"image/png",1);return h&&Ch(Z,Y),W._42(t,W.getDevicePixelRatio()),c},getGL:function(){var x=this._26I;if(x)return this.acquireProgram(),x;var s=this,F=s._canvas,M=s._attributes;try{x=F.getContext("webgl2",M)||F.getContext("experimental-webgl2",M),x&&(s._webGLVersion=2,s._26I=x)}catch(q){}if(!x)try{x=F.getContext("webgl",M)||F.getContext("experimental-webgl",M)}catch(q){throw new Error("WebGL not supported")}if(!x)throw new Error("WebGL not supported");s._26I=x,s._glExtensions=new f(x),s._glCapabilities=new _(x,s._glExtensions),s._2O={},x._compiledShader={},x._emptyTexture=Nl(x),x._emptyBlendTexture=Nl(x),x._bufPool={},x._id=++Ip,s._buffer={vs:sd(x),ns:sd(x),is:sd(x),uv:sd(x),batchColor:sd(x),batchBlend:sd(x),batchBrightness:sd(x),lineDistance:sd(x)},s._1O=sq(x);var l=s._cube={vs:sd(x),ns:sd(x),is:sd(x),uv:sd(x)};return Ab(x,l.vs,Lc),Ab(x,l.ns,Zk),Ab(x,l.uv,ve),Vg(x,l.is,tf),s.acquireProgram(),x},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var E=this,i=E._26I;if(i){var B=Q.getImage(E.getEnvmap()),V=B&&B.tagName?!0:!1,y=E._prg&&E._prg.envMapFlag?!0:!1;if(!E._prg||V!==y){var _=E._prg=i.createProgram();if(!_)return t;_.envMapFlag=V;var c=E._dirs.length,g=E._spots.length,r=E._59O.length,U=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];c&&U.push("uDirColor","uDirDirection"),g&&U.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),r&&U.push("uPointColor","uPointRange","uPointPosition"),Ch(i,[0,0,0,0]),i.clearDepth(1),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.enable(i.BLEND),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),Tc||(es=rc(es.substring(0,es.indexOf("^#"))),ep=rc(ep),Tc=!0);var P=["#define MAX_DIR "+c,"#define MAX_SPOT "+g,"#define MAX_POINT "+r,E._fogDisabled?"":"#define FOG",E._dashDisabled?"":"#define DASH",V?"#define USE_ENVMAP":"",E.isOrtho()?"#define ORTHOGRAPHIC":"",E._batchColorDisabled?"":"#define BATCHCOLOR",E._batchBlendDisabled?"":"#define BATCHBLEND",E._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),M=Uq(i,_,i.VERTEX_SHADER,es.replace("PREFIX",P));i.getShaderParameter(M,i.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",i.getShaderInfoLog(M));var Z=Uq(i,_,i.FRAGMENT_SHADER,ep.replace("PREFIX",P));i.getShaderParameter(Z,i.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",i.getShaderInfoLog(Z)),Kc?U.push("aPosition"):(_.aPosition=0,i.bindAttribLocation(_,0,"aPosition")),i.linkProgram(_),U.forEach(function(e){_[e]=/^u/.test(e)?i.getUniformLocation(_,e):i.getAttribLocation(_,e)}),i.useProgram(_),i.deleteShader(M),i.deleteShader(Z)}}},getBrightness:function(h){var A=h.s("brightness"),q=this.isSelected(h)?h.s("select.brightness"):t;return A==t?q:q==t?A:A*q},setHighlightMode:function(h){var X;X="selection"===h||"selected"===h?Di.Mode.Selection:"mouseover"===h||"hover"===h?Di.Mode.MouseOver:"style"===h?Di.Mode.Style:Di.Mode.Disable;var E=this._highlightHelper.mode;this._highlightHelper.mode=X,this.firePropertyChange("highlightMode",E,X)},getHighlightMode:function(){var L=this._highlightHelper.mode;return L===Di.Mode.Selection?"selected":L===Di.Mode.MouseOver?"hover":L===Di.Mode.Style?"style":"disabled"},getHighlightColor:function(){return this._highlightHelper.color||K["highlight.color"]},setHighlightColor:function(h){var v=this._highlightHelper.color;this._highlightHelper.color=h,this.firePropertyChange("highlightColor",v,h)},getHighlightWidth:function(){return this._highlightHelper.width||K["highlight.width"]},setHighlightWidth:function(C){var l=this._highlightHelper.width;this._highlightHelper.width=C,this.firePropertyChange("highlightWidth",l,C)},bindEnvMap:function(l){var v=this,J=v._prg,r=5,a=v.getEnvmap(),P=Q.getImage(a);if(P&&P.tagName){if(a!==v._lastEnvMap){P=Q.resizeImagePOT(P,!0),v._envMapTexture&&l.deleteTexture(v._envMapTexture);var n=v._envMapTexture=l.createTexture();l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_CUBE_MAP,n),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_CUBE_MAP,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.texImage2D(l.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,P),l.bindTexture(l.TEXTURE_CUBE_MAP,null),v._lastEnvMap=a}l.activeTexture(l.TEXTURE0+r),l.bindTexture(l.TEXTURE_CUBE_MAP,v._envMapTexture),l.uniform1i(J.uEnvMap,r)}},getWireframe:function(I){var A=I.s("wf.visible"),w=I.s("wf.width");return A===!0||w>0&&"selected"===A&&this.isSelected(I)?{color:I.s("wf.color"),width:w,"short":I.s("wf.short"),mat:I.s("wf.mat")}:void 0},_transformPointToViewSpace:function(S){var p=[S[0],S[1],S[2]];return wl(p,this._viewMatrix),p},_transformDirectionToViewSpace:function(W,v){var Q=[W[0],W[1],W[2]];wl(Q,this._viewMatrix);var z=v?[v[0],v[1],v[2]]:[0,0,0];wl(z,this._viewMatrix);var S=z[0]-Q[0],k=z[1]-Q[1],U=z[2]-Q[2],J=Math.sqrt(S*S+k*k+U*U);return J?[S/J,k/J,U/J]:[S,k,U]},getWireframeGeometry:function(L){return L.s("wf.geometry")?{color:L.s("wf.color"),width:L.s("wf.width"),mat:L.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(G){return G.s("body.color")},getMat:function(x){return x.getMat?x.getMat():x.s("mat")},getFaceMat:function(i,y){return i.getFaceMat?i.getFaceMat(y):i.s(y+".mat")},getFaceBlend:function(u,B){return u.s(B+".blend")||u.s("all.blend")},getFaceColor:function(U,Z){return U.s(Z+".color")||U.s("all.color")},getFaceImage:function(G,N){return G.s(N+".image")||G.s("all.image")},getFaceBlendImage:function(T,Y){return T.s(Y+".blend.image")||T.s("all.blend.image")},getFaceDiscardSelectable:function(Y,J){var v=Y.s(J+".discard.selectable");return v==t?Y.s("all.discard.selectable"):v},getFaceUv:function(c,W){return c.s(W+".uv")||c.s("all.uv")},getFaceUvOffset:function(H,w){return H.s(w+".uv.offset")||H.s("all.uv.offset")},getFaceUvScale:function(J,T){return J.s(T+".uv.scale")||J.s("all.uv.scale")},getFaceLight:function(N,S){var R=N.s(S+".light");return R==t?N.s("all.light"):R},getFaceVisible:function(o,j){var U=o.s(j+".visible");return U==t?o.s("all.visible"):U},getFaceOpacity:function(W,s){var x=W.s(s+".opacity");return x==t?W.s("all.opacity"):x},getFaceTransparent:function($,l){var i=$.s(l+".transparent");return i==t?$.s("all.transparent"):i},getFaceReverseColor:function(C,Y){return C.s(Y+".reverse.color")||C.s("all.reverse.color")},getFaceReverseFlip:function(l,A){var s=l.s(A+".reverse.flip");return s==t?l.s("all.reverse.flip"):s},getFaceReverseCull:function(r,U){var D=r.s(U+".reverse.cull");return D==t?r.s("all.reverse.cull"):D},getTextureMap:function(){return this._2O},deleteTexture:function(T){var p=this,y=p._2O[T];y&&(delete p._2O[T],p.getGL().deleteTexture(y))},invalidateCachedTexture:function(b){var W=this.getData3dUI(b);W.invalidateCachedTexture(this.getGL()),this.invalidateData(b)},invalidateShape3dCachedImage:function(O){this.invalidateCachedTexture(O)},invalidateCachedGeometry:function(l){var Q=this.getData3dUI(l);Q.invalidateCachedGeometry(),this.invalidateData(l)},isInteractive:function(I){return I.s("interactive")},getTexture:function(E,Z,l){if(!E)return t;var y=this,d=y.getGL(),R=y._2O[E];if(!R){var h=ir(E),j={mipmapMaxLevel:Z?Z.s("texture.mipmap.max"):w};if(!h)return d._emptyTexture;if(h.uuid||(h.uuid=Y.Math.generateUUID()),h.tagName){if(h.dynamic)return sq(d,h,y._1O,j);R=y._2O[E]=sq(d,h,w,j)}else{var O,s=Z&&(Z.s("texture.cache")||Z.s("shape3d.image.cache")||h.textureCache),S=y.vr.isPresenting();if(S&&(Z._textureUpdateFrame===d._renderInfo.frame?s=!0:Z._textureUpdateFrame=d._renderInfo.frame),s&&(O=y.getData3dUI(Z),R=O.getCachedTexture(l)),!R){var $=d._renderInfo.textureCache;if(s){if($.time>Q.graph3dMaxVectorCacheTime)return y.redraw(),d._emptyTexture;if(!Vl(h,Z))return d._emptyTexture}var D;Z&&(1!==Z.s("texture.scale")?D=Z.s("texture.scale"):1!==Z.s("shape3d.texture.scale")&&(D=Z.s("shape3d.texture.scale"))),D||(D=1);var v=Z&&(Z.s("fixSizeOnScreen")||Z.s("shape3d.fixSizeOnScreen"));v?"number"==typeof v&&(D*=0>v?1:v):Z&&(Z.s("vector.dynamic")||Z.s("shape3d.vector.dynamic"))&&(O||(O=y.getData3dUI(Z)),v=O.getVectorDynamicSize());var i,T,k,V=Z&&Z.s("shape3d");"billboard"===V?k=Z.getTall()/Z.getWidth():"plane"===V&&(k=Z.getHeight()/Z.getWidth());var X=To(h,Z);if(v){var p=y.getDevicePixelRatio();i=v[0]>0?v[0]*p:D*X*p,T=v[1]>0?v[1]*p:D*(k?wb(h,Z,y,Math.min(4096,X*k)):wb(h,Z))*p}else i=D*X,T=D*(k?wb(h,Z,y,Math.min(4096,X*k)):wb(h,Z));if(i>=1&&T>=1){var o=0;(s||S)&&(o=Date.now());var z=wq(i,T);if(!O&&Z&&(O=y.getData3dUI(Z)),O&&O.interactiveInfo){var e=E;"object"==typeof e&&(e=e.uuid||(e.uuid=Y.Math.generateUUID()));var M=O.interactiveInfo[e]={};z.interactiveInfo=M.bodyInfo={compInfos:[],matrix:new gi,rect:{x:0,y:0,width:i,height:T}}}qc(z,h,0,0,i,T,Z,y),z.interactiveInfo&&(z.interactiveInfo=null),z.restore(),$.count++,$.pixels+=i*T;var G=v?d.NEAREST:d.LINEAR;j.minFilter=Z.s("texture.filter.min")||Z.s("texture.filter")||G,j.magFilter=Z.s("texture.filter.mag")||Z.s("texture.filter")||G,s||S?(R=sq(d,xk,null,j),O.setCachedTexture(R,l),$.time+=Date.now()-o,xk=null):R=sq(d,xk,y._1O,j)}}}}return R},redraw:function(){this.iv()},validateImpl:function(){var K=this;if(K._lightChanged){K._lightChanged=!1;var L=[],n=[],Z=[];K.dm().each(function(t){if(bp(t)){var J=t.s("light.type");J===rl?L.push(t):J===uq?n.push(t):J===Al&&Z.push(t)}}),(L.length!==K._59O.length||n.length!==K._spots.length||Z.length!==K._dirs.length)&&hf(K),K._59O=L,K._spots=n,K._dirs=Z}K._42(),K._1o.iv()},getRenderInfo:function(){var L=this.getGL();return L?L._renderInfo:void 0},getDebugTip:function(){var E=this,g=E.getRenderInfo();if(g){var Q=E.getGL()._validBufCount||0,Z="Draw Calls: "+g.calls+"<br/>"+"Vertices: "+g.vertices+"<br/>"+"Faces: "+g.faces+"<br/>"+"Lines: "+g.lines+"<br/>"+"Buffers: "+Q+"<br/>"+"Cache Models: "+u.keys(Pm).length+"<br/>"+"Shape3d Models: "+u.keys(pm).length;E.vr.isPresenting()&&(Z+="<br/>VR fps: "+E.vr.getFps());var O=g.textureCache.count;if(Z+="<br/>2D Dynamic Textures: "+g.textureCache.count,O>0){var a,F=g.textureCache.pixels;a=F>1e6?Math.round(F/1e6)+"M":F>1e3?Math.round(F/1e3)+"K":Math.round(F),Z+="<br/>2D Dynamic pixels: "+a}return Z}},_42:function(D,B){var q=this;if(!q._35O&&(!Ve||zr(Ve))){var O,K;D&&(D instanceof Pc?K=D:O=D);var Q=q._canvas,u=q.getGL(),y=q._prg;if(u){var d=q.getWidth(),o=q.getHeight();if(d&&o){B?D||ik(Q,d,o,B):(B=q.getDevicePixelRatio(),D||d===Q.clientWidth&&o===Q.clientHeight||(ik(Q,d,o,B),d&&Math.abs(u.drawingBufferWidth-d*B)>1&&(q.setDevicePixelRatio(B=u.drawingBufferWidth/d),ik(Q,d,o,B)))),u.clear(u.COLOR_BUFFER_BIT),q.drawFilter||(u._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:D?q._frameId:++q._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var J,w=this._cameras,V=0,A=w.length,C=!1,$=Y.Default.cameraPriority.skybox,I=Y.Default.cameraPriority.main,n=Y.Default.cameraPriority.top,M=d*B,l=o*B,i=function(){q.overlappingBox.clear(),q._81O=t,u.clear(u.DEPTH_BUFFER_BIT),u._picking=!!D;var d={_picking:!!D,_envmapReflectivity:q._envmapReflectivity||.5,_projectMatrix:q._projectMatrix=Bm(q),_viewMatrix:Zp(q,q._7O)};if(q._viewMatrix=jj(q._7O),K){Db(u,q,y,d);var B=u.getParameter(u.COLOR_CLEAR_VALUE);u.clearColor(0,0,0,0),u.disable(u.BLEND),ge(u,y.aNormal),Ab(u,q._cube.vs,t,y.aPosition),Vg(u,q._cube.is),Bc(K,q,Ug,0),Bc(K,q,Fl,6),Bc(K,q,af,12),Bc(K,q,jf,18),Bc(K,q,_j,24),Bc(K,q,mn,30),qd(u,y.aNormal),Ch(u,B)}else if(O){for(O.value=2;A>V;V++)if(J=w[V],!J.ignoreInPick){if(J.priority>=I)break;J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q,O)}Db(u,q,y,d);var B=u.getParameter(u.COLOR_CLEAR_VALUE);for(u.clearColor(0,0,0,0),u.disable(u.BLEND),u.textureBatch&&!zr[(ONE_FRAME_TIME-6)/2]||q._95I(u,y,O),Cs(q,O),$d(q,q._polylineModelMap,O),$d(q,q._wireframeModelMap,O),Jo(u,y.uTransparent,!0),q._95I(u,y,O,!0),Cs(q,O,!0),$d(q,q._polylineModelMap,O,!0),$d(q,q._wireframeModelMap,O,!0),Jo(u,y.uTransparent,!1);A>V;V++)if(J=w[V],!J.ignoreInPick){if(J.priority>=n)break;J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q,O),C=!0}for(C&&(Db(u,q,y,d),C=!1),u.clear(u.DEPTH_BUFFER_BIT),q._swapLineMap(),q._95I(u,y,O,!1,!0),$d(q,q._polylineModelMap,O),$d(q,q._wireframeModelMap,O),q._swapLineMap(),q._swapLineMap(),q._95I(u,y,O,!1,!0),$d(q,q._polylineModelMap,O),$d(q,q._wireframeModelMap,O),Jo(u,y.uTransparent,!0),q._95I(u,y,O,!0,!0),$d(q,q._polylineModelMap,O,!0),$d(q,q._wireframeModelMap,O,!0),Jo(u,y.uTransparent,!1),q._swapLineMap(),u.disable(u.DEPTH_TEST),q.drawFilter||q._30O._42(u,y,O),u.enable(u.DEPTH_TEST);A>V;V++)J=w[V],J.ignoreInPick||(J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q,O));Ch(u,B)}else{for(;A>V&&(J=w[V],!(J.priority>=$));V++)J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q);for(Db(u,q,y,d),u.disable(u.BLEND),q.drawSky(u,y),q.drawReflectors(u,M,l,i,D)&&(d._projectMatrix=q._projectMatrix=Bm(q),d._viewMatrix=Zp(q,q._7O),q._viewMatrix=jj(q._7O),Db(u,q,y,d));A>V&&(J=w[V],!(J.priority>=I));V++)J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q),C=!0;for(C&&(Db(u,q,y,d),C=!1),q._31O._42(u,y),q._95I(u,y),Cs(q),$d(q,q._polylineModelMap),$d(q,q._wireframeModelMap),u.enable(u.BLEND),u.depthMask(!1),Jo(u,y.uTransparent,!0),q._95I(u,y,t,!0),Cs(q,t,!0),$d(q,q._polylineModelMap,t,!0),$d(q,q._wireframeModelMap,t,!0),u.depthMask(!0),Jo(u,y.uTransparent,!1);A>V&&(J=w[V],!(J.priority>=n));V++)J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q),C=!0;for(C&&(Db(u,q,y,d),C=!1),u.clear(u.DEPTH_BUFFER_BIT),q._swapLineMap(),u.disable(u.BLEND),q._95I(u,y,t,!1,!0),$d(q,q._polylineModelMap),$d(q,q._wireframeModelMap),u.enable(u.BLEND),Jo(u,y.uTransparent,!0),u.depthMask(!1),q._95I(u,y,t,!0,!0),$d(q,q._polylineModelMap,t,!0),$d(q,q._wireframeModelMap,t,!0),u.depthMask(!0),Jo(u,y.uTransparent,!1),q._swapLineMap(),u.disable(u.DEPTH_TEST),u.disable(u.BLEND),q._32O._42(u,y),q._30O._42(u,y),q._highlightHelper._42(u,y),u.enable(u.DEPTH_TEST);A>V;V++)J=w[V],J.useDefaultProgram&&Db(u,q,y,d),J.render(u,q)}Ab(u,t),Vg(u,t)},g=!1,X=q.vr;X.enable&&X._42(u,M,l,i)&&(g=!0);var k=q.envRenderer;k&&k.enable&&k._42(u,M,l,i)&&(g=!0);var W=q._postProcessing;W._42(u,M,l,i,D)&&(g=!0),g||(q.setViewport(u,0,0,d*B,o*B),i()),q._33Q=!1,q.drawFilter||q.countFrame(),q._doBufferGC(u)}}}},drawReflectors:function(l,x,q,U,z){l._renderInfo.reflectDepth++;var N,D,c,i=this,I=i._dataModel.getReflectors(),A=!1;for(N in I)D=I[N],i.isVisible(D)&&(c=i.getData3dUI(D),c&&c.drawReflector(l,x,q,U,z)&&(A=!0));return l._renderInfo.reflectDepth--,A},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(T,w){return this._postProcessing.enableModule(T,w)},getPostProcessingModule:function(o){return this._postProcessing.getModule(o)},getPostProcessingValue:function(x,h){var _=this._postProcessing.getModule(x);return _?_[h]:w},setPostProcessingValue:function(t,T,X){var K=this.getPostProcessingValue(t),N=this._postProcessing.getModule(t,T);N&&K!==X&&("enable"===T?this.enablePostProcessing(t,X):N[T]=X,this.firePropertyChange("postProcessing."+t+"."+T,K,X))},setViewport:function(T,s,$,P,Y){this._viewport=[s,$,P,Y],T.viewport(s,$,P,Y)},getViewport:function(){return this._viewport},setBufferGCInterval:function(k){this._bufferGCInterval=k},_doBufferGC:function(T,W){var c,S,q=T._bufPool,E=0,Q=0,o=T._renderInfo.frame,B=this._bufferGCInterval||10;for(c in q)E++,S=q[c],S&&(W||o-S._fid>B?(T.deleteBuffer(S._buf),S._buf=null,q[c]=null):Q++);if(E/2>Q&&E>128){var $={};for(c in q)q[c]&&($[c]=q[c]);T._bufPool=$}T._validBufCount=Q},_swapLineMap:function(){var i=this;hc=i._polylineModelMap,i._polylineModelMap=i._polylineModelMapSwap,i._polylineModelMapSwap=hc,hc=i._wireframeModelMap,i._wireframeModelMap=i._wireframeModelMapSwap,i._wireframeModelMapSwap=hc,hc=i._polylineIndexMap,i._polylineIndexMap=i._polylineIndexMapSwap,i._polylineIndexMapSwap=hc,hc=i._wireframeIndexMap,i._wireframeIndexMap=i._wireframeIndexMapSwap,i._wireframeIndexMapSwap=hc},_updateSkyBox:function(u){if(this._skyBox&&u){var X=u.property,K=!1,a=this._skyBox;if("eye"===X||"forceUpdate"===X){var d=this._eye;a.p3(d[0],d[1],d[2]),K=!0}if("near"===X||"far"===X||"forceUpdate"===X){var h=this._near,Q=this._far,M=a.getFinalScale3d();if(M[0]/=2,M[1]/=2,M[2]/=2,M[0]<=h||M[0]>=Q||M[1]<=h||M[1]>=Q||M[2]<=h||M[2]>=Q){var z=2*h*Q/(h+Q),t=Math.min(M[0],M[1],M[2]),e=z/t,B=a.getScale3d();a.setScale3d(B[0]*e,B[1]*e,B[2]*e),K=!0}}K&&this.invalidateData(a)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(L){var e=this._skyBox;e&&(this._skyBoxStyleMap&&e.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&e.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&e.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=L,this.ump(this._updateSkyBox,this),L&&(L.dm()&&L.dm().remove(L),this._skyBoxStyleMap=Y.Default.clone(L.getStyleMap()),this._skyBoxAnchor3d=L.getAnchor3d(),L.setAnchor3d(.5,.5,.5),this._skyBoxP3=L.p3().slice(0),L.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",e,L)},drawSky:function(K,q,g){var H=this,e=H._skyBox;if(e){var I=H._headlightIntensity,$=be(H._headlightColor),q=H._prg;1!==I&&($=[$[0]*I,$[1]*I,$[2]*I]),Jo(K,q.uHeadlightColor,[$[0],$[1],$[2],1]);var i=H.getData3dUI(e);if(i){var G,Z=H.isOrtho(),Y=Z||this._computedProjectMatrix;Y&&(G=H._projectMatrix,Z&&(H._ortho=!1),Jo(K,q.uPMatrix,H._projectMatrix=Bm(H,!0)));var V=e.p3(),f=this._eye;(V[0]!==f[0]||V[1]!==f[1]||V[2]!==f[2])&&(e._position.x=f[0],e._54O=f[1],e._position.y=f[2]),i._42(K,q,g,function(){return!0}),Y&&(Z&&(H._ortho=!0),Jo(K,q.uPMatrix,H._projectMatrix=G))}K.clear(K.DEPTH_BUFFER_BIT),Jo(K,q.uHeadlightColor,[$[0],$[1],$[2],H._headlightDisabled?1:0])}},_95I:function(r,J,s,e,N){function l(p){if(!(!p.s("alwaysOnTop")&&!p.s("shape3d.alwaysOnTop"))==!!N&&M.isVisible(p)&&(!U||x)){if(!s&&M.isTransparentMask(p))return;var f=M.getData3dUI(p);f&&f._42(r,J,s,g)}}var M=this,g=function(R){return e?R:!R};M.sky&&r.clear(r.DEPTH_BUFFER_BIT);var Y=M.drawFilter;Y?M.dm().each(function(t){Y(t)||l(t)}):M.dm().each(function(v){l(v)})},getLogicalPoint:function(D){return fg(D,this._canvas)},isRectOverlapping:function(e){var Q=this.getData3dUI(e);return Q._rectOverlapping},getHitFaceInfo:function(P){P.target&&(P=this.lp(P));var D=this.getDataInfoAt(P);if(D){var s=this._1o.face(D.data,gb(P.x,P.y));if(s)return{data:D.data,face:s}}return t},unproject:function(H,Y){var Q=this,z=Q.getWidth(),x=Q.getHeight(),s=H.target?Q.lp(H):H,Z=s.x-z/2,G=s.y-x/2,u=2*(Z/z),c=2*(-1*G/x);Y=Y||0;var i=_d(),d=Bm(Q),m=Zp(Q);Cb(i,d,m),fp(i);var q=ul([u,c,Y,1],i);return[q[0]/q[3],q[1]/q[3],q[2]/q[3]]},getDataAt:function(K){var w=this.getDataInfoAt(K);return w?w.data:t},getDataInfoAt:function(F,q){return F.target&&(F=this.lp(F)),this._1o.get(gb(F.x,F.y,q),!0)},getDatasInRect:function(k){return this._1o.get(k)},setEditable:function(B){var o=this,W=o._editable;o._editable=B,this.fp(Ep,W,B)},isEditable:function(f){var P=this;return P._editable?wk(f)?f.s("3d.editable")?P._editableFunc?P._editableFunc(f):!0:!1:!1:!1},isSelectable:function(S){return S.s("3d.selectable")&&this.sm().isSelectable(S)},isMovable:function(S){var w=this;return br(S)&&S.getStyle(mp)!==ef?!1:S.s("3d.movable")?w._movableFunc?w._movableFunc(S):!0:!1},isSizeEditable:function(L){return wk(L)?this._sizeEditableFunc?this._sizeEditableFunc(L):!0:!1},isRotationEditable:function(u){return wk(u)&&u.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(u):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(L){this.setZoom(Zb,L)},zoomOut:function(Z){this.setZoom(1/Zb,Z)},setZoom:function(){var Z=new dc,G=new dc,y=new dc,$=new dc;return function(C,k){if(1!==C){var z=this;z._14o&&z._14o.stop(!0);var O,M=1/C;Z.copy(z.getCenter()),G.copy(z.getEye());var f=z._ortho;if(f){if(O=z._orthoWidth,O<z._moveStep&&C>1)return}else if(Z.distanceTo(G)<z._moveStep&&1>M)return;var Q=!1;return z._zoomToCenter===!1&&z._lastZoomLP&&(y.copy(G).sub(Z).normalize(),z._81O=null,$.copy(z.getHitPosition(z._lastZoomLP,Z.toArray(),y.toArray())),Q=!0,z._lastZoomHit=$),(k=$k(k))?(k.action=function(R){z.fi({kind:z._zooming?"betweenZoom":"beginZoom"}),z._zooming=1;var v=(M-1)*R+1;f&&z.setOrthoWidth(O*v),Q?(z.setEye(y.lerpVectors($,G,v).toArray()),z.setCenter(y.lerpVectors($,Z,v).toArray())):f||z.setEye(y.lerpVectors(Z,G,v).toArray())},k._37o=function(){delete z._14o,delete z._zooming,z.fi({kind:"endZoom"}),z.onZoomEnded()},z._14o=ze(k)):(f&&z.setOrthoWidth(O*M),Q?(z.setEye(y.lerpVectors($,G,M).toArray()),z.setCenter(y.lerpVectors($,Z,M).toArray())):f||z.setEye(y.lerpVectors(Z,G,M).toArray()),void 0)}}}(),setOrthoZoom:function(H,P){return this.setZoom(H,P)},getPositionInfo:function(C){var A=this,P=A._eye,d=A._center,z=A.getAspect(),D=C?wr(Sb(d,P,!0),Sb(C,P)):ro(P,d);if(A._ortho){var X=A._orthoWidth;return{length:D,height:X/z,width:X}}var s=2*H(A._fovy/2)*D;return{length:D,height:s,width:s*z}},getCenterInfo:function(){var Y=this;return Y._81O||(Y._81O=Y.getPositionInfo()),kr(Y._81O)},rotate:function(y,$,F,e){var R=this;if(y||$){e==t&&(e=R._firstPersonMode),R._88O&&R._88O.stop(!0);var Q=R._center,W=R._eye,J=R.getCenterInfo().length,v=e?Q:W,X=e?W:Q,K=Sb(v,X),p=r(K[0],K[2]),k=r(N(K[0]*K[0]+K[2]*K[2]),K[1]),T=e?Qi:mh;return e&&($=-$),(F=$k(F))?(F.action=function(m){R.fi({kind:R._rotating?"betweenRotate":"beginRotate"}),R._rotating=1;var h=p+y*m,n=k+$*m;n=e?S-is(S-n):is(n),K[0]=J*d(n)*d(h),K[1]=J*I(n),K[2]=J*d(n)*I(h),v[0]=X[0]+K[0],v[1]=X[1]+K[1],v[2]=X[2]+K[2],R.fp(T,t,v)},F._37o=function(){delete R._88O,delete R._rotating,R.fi({kind:"endRotate"}),R.onRotateEnded()},R._88O=ze(F)):(p+=y,k+=$,k=e?S-is(S-k):is(k),K[0]=J*d(k)*d(p),K[1]=J*I(k),K[2]=J*d(k)*I(p),v[0]=X[0]+K[0],v[1]=X[1]+K[1],v[2]=X[2]+K[2],R.fp(T,t,v),void 0)}},pan:function(_,c,o,l){if(_||c){var a=this;l==t&&(l=a._firstPersonMode),a._89O&&a._89O.stop(!0);var X=Zp(a),Y=[X[0]*_,X[4]*_,X[8]*_],d=[X[1]*c,X[5]*c,X[9]*c],v=Y[0]+d[0],G=Y[1]+d[1],f=Y[2]+d[2],P=a._center,w=a._eye;if(l){var E=pd(a.getBoundaries(),w[0],w[2],w[0]+v,w[2]+f,N(v*v+f*f));v=E[0],f=E[1]}if(o=$k(o)){var s=kr(w),V=kr(P);return o.action=function(q){a.fi({kind:a._panning?"betweenPan":"beginPan"}),a._panning=1,P[0]=V[0]+v*q,P[1]=V[1]+G*q,P[2]=V[2]+f*q,w[0]=s[0]+v*q,w[1]=s[1]+G*q,w[2]=s[2]+f*q,a.fp(mh,t,w),a.fp(Qi,t,P)},o._37o=function(){delete a._89O,delete a._panning,a.fi({kind:"endPan"}),a.onPanEnded()},a._89O=ze(o)}P[0]+=v,P[1]+=G,P[2]+=f,w[0]+=v,w[1]+=G,w[2]+=f,a.fp(mh,t,w),a.fp(Qi,t,P)}},walk:function(f,B,u){if(f){var O=this;u==t&&(u=O._firstPersonMode),O._90O&&O._90O.stop(!0);var K=O._center,P=O._eye,C=Sb(K,P,!0);if(u){var l=pd(O.getBoundaries(),P[0],P[2],P[0]+C[0]*f,P[2]+C[2]*f,c(f));if(f=ro(l),!f)return;C=[l[0]/f,0,l[1]/f]}if(B=$k(B)){var i=kr(P),L=kr(K);return B.action=function(I){O.fi({kind:O._walking?"betweenWalk":"beginWalk"}),O._walking=1;var g=f*I;P[0]=i[0]+C[0]*g,P[1]=i[1]+C[1]*g,P[2]=i[2]+C[2]*g,K[0]=L[0]+C[0]*g,K[1]=L[1]+C[1]*g,K[2]=L[2]+C[2]*g,O.fp(mh,t,P),O.fp(Qi,t,K)},B._37o=function(){delete O._90O,delete O._walking,O.fi({kind:"endWalk"}),O.onWalkEnded()},O._90O=ze(B)}P[0]+=C[0]*f,P[1]+=C[1]*f,P[2]+=C[2]*f,K[0]+=C[0]*f,K[1]+=C[1]*f,K[2]+=C[2]*f,O.fp(mh,t,P),O.fp(Qi,t,K)}},handleScroll:function(c,R){c.preventDefault();var S=this,N=S._moveStep,$=S.getDataInfoAt(c);if($){var e=$.data;if(e&&S.isInteractive(e)){var Q=S.intersectObject(c,e);if(Q){var W=Q.part,B=ir(e.s(W+".image")||e.s("shape3d."+W+".image")||e.s("all.image")||e.s("shape3d.image"));if(B&&bf(B.scrollable,e,S))return}}}return S.isFirstPersonMode()?(S.isPannable()&&S.pan(0,R>0?N:-N),void 0):(S.isZoomable()&&(S._lastZoomLP=S.lp(c),S.setZoom(0>R?1/bs:bs),S._lastZoomLP=S._lastZoomHit=null),void 0)},handlePinch:function(c,d){this.isZoomable()&&this.setZoom(d>c?1/ip:ip)},reset:function(){this.setCenter(Q.graph3dViewCenter),this.setEye(Q.graph3dViewEye),this.setUp(Q.graph3dViewUp)},moveSelection:function(c,r,H){var i=this;i.dm().beginTransaction(),wm(this.sm().toSelection(this.isMovable,this),c,r,H),i.dm().endTransaction()},getMoveMode:function(N,O){var u=O.s("3d.move.mode");if(u)return u;var _="88",Q="89",p="90";return Dc(N)||ar[_]&&ar[Q]&&ar[p]?"xyz":ar[_]&&ar[Q]?"xy":ar[_]&&ar[p]?"xz":ar[Q]&&ar[p]?"yz":ar[_]?"x":ar[Q]?"y":ar[p]?"z":"xz"},handleTick:function(){var M=this,T=!1,w=M._moveStep,K=w,A=!1,h=!0,U=M._rotateStep*(h?-1:1);if(M.isWalkable()||(K=0),M.isPannable()||(w=0),M.isRotatable()||(U=0),M._32Q){var e=(Lq()-M._32Q)/50;K*=e,w*=e,U*=e}M._31Q&&(Jc(M._31Q),delete M._31Q,delete M._32Q),Hl()&&(T=!0,M.pan(-w,0,A,h)),Kj()&&(T=!0,M.pan(w,0,A,h)),fk()&&(T=!0,Dc()?M.pan(0,w,A,h):M.walk(K,A,h)),pi()&&(T=!0,Dc()?M.pan(0,-w,A,h):M.walk(-K,A,h)),_g()&&(T=!0,M.rotate(-U,0,A,h)),El()&&(T=!0,M.rotate(U,0,A,h)),ah()&&(T=!0,M.rotate(0,-U/2,A,h)),Fq()&&(T=!0,M.rotate(0,U/2,A,h)),T&&(M._32Q=Lq(),M._31Q=zs(M.handleTick,M))},handleKeyDown:function(R){var W=this;!Sf(R)&&Yb[R.keyCode]?W.handleTick():xr(R)?W.selectAll():Eg(R)?W.handleDelete(R):Kb(R)&&this.isResettable()&&W.reset()},checkDoubleClickOnNote:function(l,C,P){var G=this;if(P===_o){if(C.s("note.toggleable"))return C.s(Mr,!C.s(Mr)),G.fi({kind:"toggleNote",event:l,data:C,part:P}),!0}else if(P===Pd&&C.s("note2.toggleable"))return C.s(kc,!C.s(kc)),G.fi({kind:"toggleNote2",event:l,data:C,part:P}),!0;return!1},checkDoubleClickOnRotation:function(b,z,K){return K===fh?(z.setRotationX(0),!0):K===Zi?(z.setRotationY(0),!0):K===Dg?(z.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(o){var q=this;if(q.isOrtho())return q.getWidth()/q.getOrthoWidth();var m=q.getCenter(),y=q.getHeight(),H=q.getEye(),A=[m[0]-H[0],m[1]-H[1],m[2]-H[2]],i=[o[0]-H[0],o[1]-H[1],o[2]-H[2]],I=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]),Y=1/Math.tan(q.getFovy()/2);
return y*I*Y/(i[0]*A[0]+i[1]*A[1]+i[2]*A[2])},inViewSpace:function(o){var h,j=this,V=j._transformPointToViewSpace(o),D=j.getAspect(),u=j.getNear(),Q=j.getFar();return-V[2]<u||-V[2]>Q?!1:j.isOrtho()?(h=j.getOrthoWidth()/2,Math.abs(V[0])<=h&&Math.abs(V[1]*D)<=h):(h=Math.sqrt(V[0]*V[0]+V[1]*V[1]+V[2]*V[2])*Math.tan(j.getFovy()/2),Math.abs(V[1]<=h)&&Math.abs(V[0])<=h*D)},getPVMatrix:function(){var A=this,n=A.getWidth()/2,h=A.getHeight()/2,U=A._18Q;return U&&U._wh===n/h||(U=Bm(A),A._18Q=Cb(U,U,Zp(A)),A._18Q._wh=n/h),U},getFrustum:function(){var Z=new de,R=new ec,T=new Array(16);return function(){for(var v=this.getPVMatrix(),o=!1,b=0;16>b;b++)v[b]!==T[b]&&(o=!0,T[b]=v[b]);return o&&R.setFromMatrix(Z.fromArray(v)),R}}(),toViewPosition:function(d){var B=this,r=B.getWidth()/2,C=B.getHeight()/2,t=B.getPVMatrix();return d=ul([d[0],d[1],d[2],1],t),{x:r+r*d[0]/d[3],y:C-C*d[1]/d[3],z:d[2]/d[3]}},getHitPosition:function(E,b,v){var Y=this,r=Y.getWidth(),$=Y.getHeight(),J=E.target?Y.lp(E):E,P=J.x-r/2,t=J.y-$/2,e=Y.getCenterInfo(),g=Zp(Y);b=b?b:[0,0,0],v=v?v:[0,1,0],P=P/r*e.width,t=-1*t/$*e.height;var f=[g[0]*P,g[4]*P,g[8]*P],N=[g[1]*t,g[5]*t,g[9]*t],S=[f[0]+N[0],f[1]+N[1],f[2]+N[2]],k=Y.getCenter(),h=kn(Y,b,v,[S[0]+k[0],S[1]+k[1],S[2]+k[2]]);return h?h:[0,0,0]},intersectObject:function(i,j){return this._raycaster.intersectObject(i,j)},intersectObjects:function(E,g,m){return this._raycaster.intersectObjects(E,g,m)},getLineLength:function($){this.validate();var x=this.getData3dUI($);if(x&&x.getCache){var X=x.getCache();if(X)return X[X.length-1].length}return 0},getLineOffset:function(e,h){var E=this.getData3dUI(e);if(E&&E.getCache){var s=E.getCache();if(s){var j=Xb(s,h);if(!e.r3)return j;var N=e.r3();if(0===N[0]&&0===N[1]&&0===N[2])return j;var A=new dc(e.p3()),b=new dc(j.point).sub(A),k=new dc(j.tangent).add(b),K=(new Dj).setFromEuler(new $o(N,e.getRotationMode(),!0));return b.applyQuaternion(K),k.applyQuaternion(K),{point:b.add(A),tangent:k.sub(b).normalize()}}}return t},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function($,y,c){var i=this,V=i.getEye();V=[V[0],V[1],V[2]];var D=i.getCenter();if(D=[D[0],D[1],D[2]],$||($=V),y||(y=D),i._flyAnim&&i._flyAnim.stop(!0),c=$k(c),!c)return i.setEye($[0],$[1],$[2]),i.setCenter(y[0],y[1],y[2]),delete i._flyAnim,!0;var G=[$[0]-V[0],$[1]-V[1],$[2]-V[2]],Q=[y[0]-D[0],y[1]-D[1],y[2]-D[2]];return c.action=function(K){i.setCenter(D[0]+Q[0]*K,D[1]+Q[1]*K,D[2]+Q[2]*K),i.setEye(V[0]+G[0]*K,V[1]+G[1]*K,V[2]+G[2]*K)},c._37o=function(){delete i._flyAnim},i._flyAnim=ze(c)},flyTo:function(){function N(D,k,e){if(e instanceof Y.Node){z.fromArray(Ur(e,k.getMat(e)));var j=e.getAnchor3d();D.push((new dc).set(0-j.x,0-j.y,0-j.z).applyMatrix4(z)),D.push((new dc).set(0-j.x,0-j.y,1-j.z).applyMatrix4(z)),D.push((new dc).set(0-j.x,1-j.y,0-j.z).applyMatrix4(z)),D.push((new dc).set(0-j.x,1-j.y,1-j.z).applyMatrix4(z)),D.push((new dc).set(1-j.x,0-j.y,0-j.z).applyMatrix4(z)),D.push((new dc).set(1-j.x,0-j.y,1-j.z).applyMatrix4(z)),D.push((new dc).set(1-j.x,1-j.y,0-j.z).applyMatrix4(z)),D.push((new dc).set(1-j.x,1-j.y,1-j.z).applyMatrix4(z))}}var e=new dc,K=new dc,t=new dc,C=new dc,z=new de,Z=new Y.Math.Quaternion,G=new $o;return function(D,S,s){var T=this;if(s!==w)S={animation:S,ratio:s};else{var y=typeof S;("boolean"===y||"object"===y&&S.duration)&&(S={animation:S})}S=S||{},e.fromArray(T.getEye()),K.fromArray(T.getCenter());var B,X,J=[],m=S.center,f=S.distance===w;if(m&&t.fromArray(m),D instanceof Y.Node)m||t.fromArray(D.p3()),f&&(N(J,T,D),B=J.length);else{if(D||(D=T.dm().getDatas()),!D.length)return;if((f||!m)&&(J=[],D.forEach(function(k){N(J,T,k)}),B=J.length,!B))return;if(!m){for(t.set(0,0,0),X=0;B>X;X++)t.add(J[X]);t.multiplyScalar(1/B)}}if(T.setCenter(t.x,t.y,t.z),C.subVectors(e,K),S.direction||S.worldDirection){!S.worldDirection&&D instanceof Y.Node?Z.setFromEuler(G.set(D.r3(),D.getRotationMode(),!0)):Z.set(0,0,0,1);var b=C.length();C.fromArray(S.worldDirection||S.direction).applyQuaternion(Z).setLength(b)}var r=0;if(f){var g,o,P,s=S.ratio||.8,d=S.xRatio||s,I=S.yRatio||s;if(T.isOrtho()){var Q=-1/0;for(T._eye[0]=C.x+t.x,T._eye[1]=C.y+t.y,T._eye[2]=C.z+t.z,g=Bm(T),Cb(g,g,Zp(T)),X=0;B>X;X++)P=J[X],o=ul([P.x,P.y,P.z,1],g),Q=Math.max(Q,Math.max(Math.abs(o[0])/d,Math.abs(o[1])/I));r=T.getOrthoWidth()*Q,C.add(t)}else{for(var k,v,z=T.getNear(),h=10;h--;){for(T._eye[0]=C.x+t.x,T._eye[1]=C.y+t.y,T._eye[2]=C.z+t.z,g=Bm(T),Cb(g,g,Zp(T)),k=!0,v=-1/0,X=0;B>X;X++){if(P=J[X],o=ul([P.x,P.y,P.z,1],g),o[3]<z&&h){C.multiplyScalar(2),k=!1;break}v=Math.max(v,Math.max(Math.abs(o[0])/d,Math.abs(o[1])/I)-o[3])}if(k)break}C.setLength(v+C.length()).add(t)}}else C.setLength(S.distance).add(t);T._flyAnim&&T._flyAnim.stop(!0);var W=$k(S.animation);if(W){T.setEye(e.x,e.y,e.z),T.setCenter(K.x,K.y,K.z);var H=(new dc).subVectors(C,e),O=(new dc).subVectors(t,K);if(r)var V=T.getOrthoWidth();var x=new dc,p=new dc,U=W.action,n=W._37o;return W.action=function(Z,I){x.copy(e).addScaledVector(H,Z),p.copy(K).addScaledVector(O,Z),T.setCenter(p.x,p.y,p.z),T.setEye(x.x,x.y,x.z),r&&T.setOrthoWidth((r-V)*Z+V),U&&U(Z,I)},W._37o=function(){delete T._flyAnim,n&&n()},{lastEye:e,lastCenter:K,eye:C,center:t,orthoWidth:r,animation:T._flyAnim=ze(W)}}return T.setEye(C.x,C.y,C.z),r&&T.setOrthoWidth(r),delete T._flyAnim,{lastEye:e,lastCenter:K,eye:C,center:t,orthoWidth:r}}}(),getBoundingBox:function(){function A(E,v,e){I.fromArray(Ur(e,v.getMat(e)));var J=e.getAnchor3d();E.push((new dc).set(0-J.x,0-J.y,0-J.z).applyMatrix4(I)),E.push((new dc).set(0-J.x,0-J.y,1-J.z).applyMatrix4(I)),E.push((new dc).set(0-J.x,1-J.y,0-J.z).applyMatrix4(I)),E.push((new dc).set(0-J.x,1-J.y,1-J.z).applyMatrix4(I)),E.push((new dc).set(1-J.x,0-J.y,0-J.z).applyMatrix4(I)),E.push((new dc).set(1-J.x,0-J.y,1-J.z).applyMatrix4(I)),E.push((new dc).set(1-J.x,1-J.y,0-J.z).applyMatrix4(I)),E.push((new dc).set(1-J.x,1-J.y,1-J.z).applyMatrix4(I))}var I=new de;return function(x){if(x=x||this.sm().getSelection(),x instanceof Y.Node&&(x=[x]),0===x.length)return t;var m=[];x.forEach(function(Y){A(m,this,Y)},this);var H=[1/0,1/0,1/0],U=[-1/0,-1/0,-1/0];return m.forEach(function(f){H[0]=Math.min(f.x,H[0]),H[1]=Math.min(f.y,H[1]),H[2]=Math.min(f.z,H[2]),U[0]=Math.max(f.x,U[0]),U[1]=Math.max(f.y,U[1]),U[2]=Math.max(f.z,U[2])}),{min:H,max:U}}}()}),Tn.RenderEnv=function(f){this.gv=f,this.enable=!1},u.defineProperties(Tn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(k){this._debugOn=k,this.capture&&this.capture()}}}),u.assign(Tn.RenderEnv.prototype,{renderEnvToCube:function(y,c,d,s){var A=this,S=A.gv;if(!y||!c||!d)return A.enable=!1,A._42=null,void 0;A.enable=!0;var V=Math.floor(s/y*c),J=S.getGL(),u=A._renderTargets;u?u.length<d&&(u=A._renderTargets=u.concat(new Array(d-u.length))):u=A._renderTargets=new Array(d);for(var v=0;d>v;v++)u[v]?u[v].setSize(J,s,V):u[v]=new Tn.RenderTarget(S,J,s,V);var f=!1;A.capture=function(){f=!0,S._42(),f=!1};var L=new dc,K=new dc,z=new dc,q=new dc,n=(new dc).setY(0),$=2*Math.PI/d,h=y/2/Math.tan(Math.PI/d),N=2*Math.atan2(c/2,h),F=y/c;A._42=function(X,_,B,P){var J=A._debugOn;if(!f&&!J)return!1;L.copy(S.getEye()),q.copy(S.getCenter()).sub(L);var Q=Math.atan2(q.z,q.x),j=S.getNear(),l=S.getFovy(),y=S.getAspect();K.copy(S.getCenter());for(var M,c=0;d>c;c++)if(M=u[c],n.setZ(Math.cos(Q)).setX(Math.sin(Q)).multiplyScalar(h),Q-=$,z.addVectors(L,n),S.setNear(h),S.setCenter([z.x,z.y,z.z]),S.setFovy(N),S.setAspect(F),J){var E=Math.round(_/d);X.viewport(E*c,0,E,B),P()}else Pi(X,M.frame),X.viewport(0,0,M.width,M.height),X.clear(X.COLOR_BUFFER_BIT),P(),nr(X),M.assureTexture();return S.setNear(j),S.setCenter([K.x,K.y,K.z]),S.setFovy(l),S.setAspect(y),!0},A.capture()},getTextureInfo:function(p){var D=this._renderTargets;if(!D)return null;var b=this._renderTargets[p];return b?{index:p,texture:b.texture,textureName:b.uuid}:null}}),u.assign(Tn.Graph3dView.prototype,{renderEnvToCube:function(n,w,R,u){var p=this;p.envRenderer||(p.envRenderer=new Tn.RenderEnv(p)),p.envRenderer.renderEnvToCube(n,w,R,u)}}),Tn.RenderTarget=function(S,T,I,Q,$){var B=this;$=$||{},$.samples=Math.min(S._glCapabilities.maxSamples,$.samples&&$.samples>1&&2===S._webGLVersion?$.samples:0),B.options=$,B.uuid=Y.Math.generateUUID(),B.gv=S,B.init(S,T,$),$.samples&&!S._glCapabilities._maxSamplesChecked?B.setSize(T,I||1,Q||1):B.setSize(T,I,Q)},u.assign(Tn.RenderTarget.prototype,{bind:function(T){Pi(T,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(h){nr(h),this.options.samples&&(h.bindFramebuffer(h.READ_FRAMEBUFFER,this._MSAAFbo),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,this.frame),h.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,h.COLOR_BUFFER_BIT,h.NEAREST),h.bindFramebuffer(h.READ_FRAMEBUFFER,null),h.bindFramebuffer(h.DRAW_FRAMEBUFFER,null))},init:function(E,o,w){var x=this,l=x.texture=o.createTexture();o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,l);var P=w.samples,k=P?o.NEAREST:o.LINEAR;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,w.minFilter||k),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,w.magFilter||k),o.bindTexture(o.TEXTURE_2D,null),x.render=o.createRenderbuffer(),x.frame=o.createFramebuffer(),E._2O[x.uuid]=l},assureTexture:function(){var r=this,I=r.uuid,R=r.gv._2O;R[I]||(R[I]=r.texture)},setSize:function(P,G,x){var S=this;if(G&&x&&(S.width!==G||S.height!==x)){var E=P.RGBA,F=P.TEXTURE_2D,V=P.RENDERBUFFER,Q=P.FRAMEBUFFER,c=S.options.samples;if(Af(P,S.texture),P.texImage2D(F,0,E,G,x,0,E,P.UNSIGNED_BYTE,t),Qr.isPOT(G)&&Qr.isPOT(x)&&!S.options.clampToEdge?(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.REPEAT),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.REPEAT)):(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE)),P.bindRenderbuffer(V,S.render),c){var s=S.gv._glCapabilities;if(s._maxSamplesChecked)P.renderbufferStorageMultisample(V,c,P.DEPTH_COMPONENT16,G,x);else{for(P.getError();c>1&&(P.renderbufferStorageMultisample(V,c,P.DEPTH_COMPONENT16,G,x),P.getError());)c=Math.floor(c>>1);1>=c&&(c=0,P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,S.options.minFilter||P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,S.options.magFilter||P.LINEAR),P.renderbufferStorage(V,P.DEPTH_COMPONENT16,G,x)),s._maxSamplesChecked=!0,s.maxSamples=S.options.samples=c}}else P.renderbufferStorage(V,P.DEPTH_COMPONENT16,G,x);c&&!S._MSAAFbo&&(S._MSAAFbo=P.createFramebuffer(),S._MSAARbO=P.createRenderbuffer()),Pi(P,S.frame),P.framebufferTexture2D(Q,P.COLOR_ATTACHMENT0,F,S.texture,0),c||P.framebufferRenderbuffer(Q,P.DEPTH_ATTACHMENT,V,S.render),nr(P),c&&(P.bindRenderbuffer(P.RENDERBUFFER,S._MSAARbO),P.renderbufferStorageMultisample(P.RENDERBUFFER,c,P.RGBA8,G,x),Pi(P,S._MSAAFbo),P.framebufferRenderbuffer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.RENDERBUFFER,S._MSAARbO),P.framebufferRenderbuffer(Q,P.DEPTH_ATTACHMENT,V,S.render),nr(P)),Af(P,t),P.bindRenderbuffer(V,t),S.width=G,S.height=x}},toCanvas:function(){var j=this,M=j.gv.getGL();Pi(M,j.frame);var R=j.width,I=j.height,B=new Uint8Array(4*R*I);M.readPixels(0,0,R,I,M.RGBA,M.UNSIGNED_BYTE,B),nr(M);var p=l.createElement("canvas");p.width=R,p.height=I;var E=p.getContext("2d"),m=E.createImageData(R,I);return m.data.set(B),E.putImageData(m,0,0),p}});var ki=Tn.Interactor=function(X){this.gv=X};Zq("Interactor",u,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var zj=Tn.DefaultInteractor=function(S){ml(zj,this,[S])};Zq("DefaultInteractor",ki,{getDataInfoAt:function(d,L){var J=this.gv,W=J.getDataInfoAt(d);if(!J.isBlockSelectable()||!W||!W.data)return W;if(!L&&J.isSelected(W.data))return W;for(var x=W.data;(x=x.getParent())&&x instanceof Y.Block&&J.isSelectable(x);){var r=J.isSelected(x);if(r&&L)break;if(W={data:x,part:W},r&&!L)break}return W},handle_contextmenu:function(p){Hc(p)},handle_mousewheel:function(h){this.gv.handleScroll(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(B){2===B.axis&&this.gv.handleScroll(B,-B.detail)},handle_keydown:function(y){this.gv.handleKeyDown(y)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(N){Hc(N);var _=this,Q=_.gv,Z=Ir(N),g=_.getDataInfoAt(N),S=g?g.data:t,X=g?g.part:t,s=Q.sm(),W=rp(N),h=Jh(N);Q.setFocus(N)&&(_._62O=t,_._57I=t,_.pendingClickThrough=t,S?Sf(N)?s.co(S)?s.rs(S):s.as(S):s.co(S)?S instanceof aq&&S.isClickThroughEnabled()&&Ir(N)&&(_.pendingClickThrough=ad(N)):s.ss(S):Z&&(Sf(N)?Q.isRectSelectable()&&(_._62O=hm):_._57I=ad(N)),_._31Q&&(Jc(_._31Q),delete _._31Q,delete _._32Q),_._62O||(Q.isFirstPersonMode()&&(Dc(N)||He(N)||h>2?_._62O="pan":Q.isMouseRoamable()||mc?(_._62O="roaming",_.foward=W&&Ir(N),_._32Q=Lq(),_._31Q=zs(_.tick,_)):Z||(_._62O="roaming")),_._62O||(Z&&W&&bm[X]?(_._62O=X,_.p3=S.p3()):Z&&W&&wk(S)&&Q.isSelected(S)?Q.isMovable(S)?(_._62O="move",_.p3=S.p3(),_.movedata=S):Q._39Q(S)&&(_._62O="none"):mc&&(h>2?_._62O="pan":2===h&&(_.dist=dl(N),_._62O="pinch")))),_.point=Q.lp(N),Rr(_,N),fo(N)?Q.handleDoubleClick(N,S,X):Q.handleClick(N,S,X))},tick:function(){var B=this,D=B.gv,r=D._moveStep;B.point&&D.isWalkable()&&(B._32Q&&(r*=(Lq()-B._32Q)/50),D.walk(B.foward?r:-r),B._32Q=Lq(),B._31Q=zs(B.tick,B))},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(C){var j=this._57I;if(j&&(ro(j,ad(C))<=1&&this.gv.sm().cs(),this._57I=t),j=this.pendingClickThrough){if(ro(j,ad(C))<=1){var s=this.getDataInfoAt(C);s&&s.data instanceof aq&&s.data.isClickThroughEnabled()&&(s=this.getDataInfoAt(C,!0),s&&(C.clickThrough=!0,this.gv.sm().ss(s.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(Q){var p,l,i=this,w=i.gv,o=i._62O,u=i.point,Y=w.dm(),a=w.lp(Q),I=a.x-u.x,f=a.y-u.y,n=w.getWidth(),O=w.getHeight();if(n&&O){var F=-z*I/n,M=-z*f/O;if("roaming"===o)i.rotate(Q,F/2,M/2);else if(o===fh||o===Zi||o===Dg)w._86O||Y.beginTransaction(),w.fi({kind:w._86O?"betweenEditRotation":"beginEditRotation",event:Q}),w._86O=1,w.sm().each(function(S){if(wk(S)&&w.isRotationEditable(S)){var _=c(F)>c(M)?F:M;o===fh?S.setRotationX(S.getRotationX()+_):o===Zi?S.setRotationY(S.getRotationY()+_):o===Dg&&S.setRotationZ(S.getRotationZ()+_)}});else if("move"===o||bm[o]){o===Yo||o===tj||o===bj?(w._87O||Y.beginTransaction(),w.fi({kind:w._87O?"betweenEditScale":"beginEditScale",event:Q}),w._87O=1):(w._moving||Y.beginTransaction(),w.fi({kind:w._moving?"betweenMove":"beginMove",event:Q}),w._moving=1);var D,k=i.p3,y=w.getPositionInfo(k),T=Zp(w);D=o===Od?"x":o===qm?"y":o===gk?"z":o===Yo?"sx":o===tj?"sy":o===bj?"sz":w.getMoveMode(Q,i.movedata),I=I/n*y.width,f=-1*f/O*y.height;var E,J,N=[T[0]*I,T[4]*I,T[8]*I],W=[T[1]*f,T[5]*f,T[9]*f],G=N[0]+W[0],m=N[1]+W[1],t=N[2]+W[2],e=[k[0]+G,k[1]+m,k[2]+t],R=Sb(w.getEye(),e,!0);if("xyz"===D?(E=e,w.moveSelection(G,m,t)):"xz"===D?(E=kn(w,k,[0,1,0],e),E&&w.moveSelection(E[0]-k[0],0,E[2]-k[2])):"xy"===D?(E=kn(w,k,[0,0,1],e),E&&w.moveSelection(E[0]-k[0],E[1]-k[1],0)):"yz"===D?(E=kn(w,k,[1,0,0],e),E&&w.moveSelection(0,E[1]-k[1],E[2]-k[2])):"x"===D||"sx"===D?(R[0]=0,E=kn(w,k,R,e),E&&(J=E[0]-k[0],"x"===D?w.moveSelection(J,0,0):w.sm().each(function(f){wk(f)&&w.isSizeEditable(f)&&(p=f.getScaleX()+J/100,l=p/f.getScaleX(),f.setScaleX(p),Dc(Q)&&(f.setScaleY(f.getScaleY()*l),f.setScaleTall(f.getScaleTall()*l)))}))):"y"===D||"sy"===D?(R[1]=0,E=kn(w,k,R,e),E&&(J=E[1]-k[1],"y"===D?w.moveSelection(0,J,0):w.sm().each(function(Z){wk(Z)&&w.isSizeEditable(Z)&&(p=Z.getScaleTall()+J/100,l=p/Z.getScaleTall(),Z.setScaleTall(p),Dc(Q)&&(Z.setScaleY(Z.getScaleY()*l),Z.setScaleX(Z.getScaleX()*l)))}))):("z"===D||"sz"===D)&&(R[2]=0,E=kn(w,k,R,e),E&&(J=E[2]-k[2],"z"===D?w.moveSelection(0,0,J):w.sm().each(function(I){wk(I)&&w.isSizeEditable(I)&&(p=I.getScaleY()+J/100,l=p/I.getScaleY(),I.setScaleY(p),Dc(Q)&&(I.setScaleX(I.getScaleX()*l),I.setScaleTall(I.getScaleTall()*l)))}))),!E)return;i.p3=E}else if(o===hm){var S=i.div;S||(S=i.div=wc(),zg(i.getView(),S),S.op=u,S.style.background=w.getRectSelectBackground()),w.fi({kind:w._rectSelecting?"betweenRectSelect":"beginRectSelect",event:Q}),w._rectSelecting=1,S.rect=Qm(S.op,a),Km(S,S.rect)}else if("pinch"===o&&2===Jh(Q)){w.fi({kind:w._pinching?"betweenPinch":"beginPinch",event:Q}),w._pinching=1;var J=dl(Q);w._lastZoomLP||(w._lastZoomLP=De(Q)),w.handlePinch(J,i.dist),i.dist=J}else"pan"===o||Dc(Q)||He(Q)?i.pan(Q,I,f):"none"===o||w.isFirstPersonMode()||i.rotate(Q,F,M);i.point=a}},pan:function(B,x,U){var b=this.gv;if(b.isPannable()){var w=b.getWidth(),O=b.getHeight();if(!w||!O)return;var $=b.getCenterInfo(),I=x/w*$.width,i=-1*U/O*$.height;b.fi({kind:b._panning?"betweenPan":"beginPan",event:B}),b._panning=1,b.pan(-I,-i)}},rotate:function(K,J,v){var P=this.gv;P.isRotatable()&&(P.fi({kind:P._rotating?"betweenRotate":"beginRotate",event:K}),P._rotating=1,P.rotate(J,v))},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(f){var k=this,C=k.gv,E=C.dm(),b=k.div;if(b){var q=C.getDatasInRect(b.rect);if(!q.isEmpty()){var W=C.sm(),n=W.toSelection();q.each(function(q){W.co(q)?n.remove(q):n.add(q)}),W.ss(n)}ig(b)}C._moving&&(delete C._moving,C.fi({kind:"endMove",event:f}),C.onMoveEnded(),E.endTransaction()),C._panning&&(delete C._panning,C.fi({kind:"endPan",event:f}),C.onPanEnded()),C._rotating&&(delete C._rotating,C.fi({kind:"endRotate",event:f}),C.onRotateEnded()),C._86O&&(delete C._86O,C.fi({kind:"endEditRotation",event:f}),E.endTransaction()),C._87O&&(delete C._87O,C.fi({kind:"endEditScale",event:f}),E.endTransaction()),C._pinching&&(delete C._pinching,C.fi({kind:"endPinch",event:f}),C.onPinchEnded()),C._rectSelecting&&(delete C._rectSelecting,C.fi({kind:"endRectSelect",event:f}),C.onRectSelectEnded()),C._walking&&(delete C._walking,C.fi({kind:"endWalk",event:f}),C.onWalkEnded()),C._lastZoomLP=C._lastZoomHit=null,k.dist=k.point=k._62O=k.p3=k.movedata=k.div=k._57I=k.pendingClickThrough=k._32Q=k._31Q=k.foward=t}});var ae=Tn.MapInteractor=function(n){ml(ae,this,[n]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Zq("MapInteractor",ki,{handle_contextmenu:function(P){Hc(P)},handle_mousewheel:function(D){this.gv.handleScroll(D,D.wheelDelta/40)},handle_DOMMouseScroll:function(S){2===S.axis&&this.gv.handleScroll(S,-S.detail)},handle_keydown:function(E){this.gv.handleKeyDown(E)},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(X){Hc(X);var A=this,S=A.gv;if(S.setFocus(X)){var U=S.getDataInfoAt(X),C=U?U.data:t,H=U?U.part:t,w=A.editing={point:S.lp(X)};mc?w.touch=!0:(w.touch=!1,w.clickLeft=Ir(X),w.pan=He(X)?!0:"left"===this.panButton===w.clickLeft),C&&S._39Q(C)&&(w.preventDefault=!0),Rr(A,X),fo(X)?S.handleDoubleClick(X,C,H):S.handleClick(X,C,H)}},handle_mouseup:function(A){this.handle_touchend(A)},handle_touchend:function(){},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(X){var Y=this,$=Y.gv,u=Y.editing;if(u){var b=$.lp(X),R=u.point,q=b.x-R.x,D=b.y-R.y;if(!u.moved){if(Math.abs(q)<Y.threshold&&Math.abs(D)<Y.threshold&&!(X.touches&&X.touches.length>1))return;u.moved=!0}if(!u.preventDefault)if(u.point=b,u.touch){var Z=X.touches.length;if(2!==Z)Y.pan(X,q,D);else{if(1>=Z)return;var J=X.touches,v={x:J[0].clientX,y:J[0].clientY},f={x:J[1].clientX,y:J[1].clientY},A={x:f.x-v.x,y:f.y-v.y},g=u.lastCenter,m=Math.atan2(A.y,A.x),e=u.theta,r=0;e==t?e=u.theta=m:(r=m-e,u.thetaStarted||Math.abs(r)>Y.touchRotateThreshold?(u.thetaStarted=!0,u.theta=m):r=0);var j=S*(v.y+f.y)/2/$.getHeight(),w=u.phi,T=0;w==t?w=u.phi=j:(T=j-w,u.phiStarted||Math.abs(T)>Y.touchRotateThreshold?(u.phiStarted=!0,u.phi=j):T=0);var C,F=Math.sqrt(A.x*A.x+A.y*A.y),Q=u.vlen;if(Q){var d=v.x-g.x,s=v.y-g.y,o=f.x-g.x,h=f.y-g.y,p=Math.sqrt(d*d+s*s),K=Math.sqrt(o*o+h*h),x=Q/2,G=Y._sign2(p-x),I=Y._sign2(K-x);0>G*I||0===G&&0===I?(C=1,u.vlen=F):(C||(C=F/Q),u.scaleStarted||Math.abs(C-1)>Y.touchScaleThreshold?(u.vlen=F,u.scaleStarted=!0):C=1)}else Q=u.vlen=F,C=1;1!==C&&$.setZoom(C),(T||r)&&Y.rotate(X,r,-T),u.lastCenter={x:(f.x+v.x)/2,y:(f.y+v.y)/2}}}else if(u.pan)Y.pan(X,q,D);else{var V=$.getWidth(),N=$.getHeight();if(!V||!N)return;var l=-z*q/V,M=-z*D/N;Y.rotate(X,l,M)}}},_sign2:function(b){return Math.abs(b)<this._touchScaleCheckAccuracy?0:b>0?1:-1},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(n){var g=this,T=g.editing;if(g.editing=null,T){var k=g.gv;if(T.moved||!T.clickLeft&&!T.touch)k._panning=null,k._rotating=null,k.fi({kind:T.pan?"endPan":"endRotate",event:n});else{var b=k.getDataAt(n);b?k.sm().setSelection([b]):k.sm().clearSelection()}}},pan:function(w,_,r){var d=this,u=d.gv;if(u.isPannable()){var E=u.getWidth(),b=u.getHeight();if(E&&b){var y=u.getCenterInfo(),o=-_/E*y.width,L=1*r/b*y.height;u.fi({kind:u._panning?"betweenPan":"beginPan",event:w}),u._panning=1;var q=d.keepHorizon,F=d.editing.touch;if((F&&w.touches&&w.touches.length>1||!F&&Dc(w))&&(q=!q),!q)return u.pan(o,L);if(o||L){var z=Zp(u),P=[z[0]*o,z[4]*o,z[8]*o],U=[z[1],0,z[9]],G=Math.sqrt(U[0]*U[0]+U[2]*U[2]);G&&(U=[U[0]/G*L,0,U[2]/G*L]);var v=P[0]+U[0],i=P[1]+U[1],k=P[2]+U[2],W=u._center,M=u._eye;W[0]+=v,W[1]+=i,W[2]+=k,M[0]+=v,M[1]+=i,M[2]+=k,u.fp(mh,t,M),u.fp(Qi,t,W)}}}},rotate:function(x,g,P){var e=this,t=e.gv;if(t.isRotatable()){var b=t._center,V=t._eye,y=Sb(V,b),o=r(N(y[0]*y[0]+y[2]*y[2]),y[1]),i=is(o+P);P=i-o,t.fi({kind:t._rotating?"betweenRotate":"beginRotate",event:x}),t._rotating=1,t.rotate(g,P)}}}),u.defineProperties(ae.prototype,{panButton:{get:function(){return this._panButton},set:function(v){this._panButton=v}},minPhi:{get:function(){return Q.graph3dViewMinPhi},set:function(u){Q.graph3dViewMinPhi=u}},maxPhi:{get:function(){return Q.graph3dViewMaxPhi},set:function(V){Q.graph3dViewMaxPhi=V}},keepHorizon:{get:function(){return this._keepHorizon},set:function(Z){this._keepHorizon=Z}},threshold:{get:function(){return this._threshold},set:function(e){this._threshold=e}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(I){this._touchScaleThreshold=I}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(U){this._touchRotateThreshold=U}}});var cn,Cn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",eg=32,un=Tn.GlobeInteractor=function(k,X){ml(un,this,[k]);var i,E=X.radius||6378137,d=this,m=null;cn||(cn=wc(),cn.style.border="",cn.style.backgroundImage="url("+Cn+")");var S=new Dj,R=new dc,p=new dc,e=new dc,T=new tk,U="number"==typeof E?{x:E,y:E,z:E}:E,a={center:new dc(0,0,0),radius:U},H=function(G){k._81O=null;var c=k.getHitPosition(G,k.getCenter(),R.copy(k.getEye()).sub(p.copy(k.getCenter())).toArray());return T.origin.copy(k.getEye()),T.direction.copy(c).sub(T.origin).normalize(),T.intersectEllipsoid(a)},P=function(r,N){k._81O=null,T.origin.copy(k.getEye());for(var B,P,H=k.getCenter(),z=R.copy(k.getEye()).sub(p.copy(k.getCenter())).toArray(),$=1,W=16,G=0,e=1,l={x:0,y:0};W--;){if(l.x=N.x+(r.x-N.x)*$,l.y=N.y+(r.y-N.y)*$,B=k.getHitPosition(l,H,z),T.direction.copy(B).sub(T.origin).normalize(),P=T.intersectEllipsoid(a),P&&1===$)return{hit:P};P?G=$:e=$,$=(G+e)/2}return{hit:P,out:1>$}},u=function(s,G){if(m){var i=Date.now();m.deltaTime=m.lastTime?i-m.lastTime:1e3,m.lastTime=i,m.lastAxis=s,m.lastAngle=G}G&&(S.setFromAxisAngle(s,G),k.setEye(R.copy(k.getEye()).applyQuaternion(S).toArray()),k.setCenter(R.copy(k.getCenter()).applyQuaternion(S).toArray()),k.setUp(R.copy(k.getUp()).applyQuaternion(S).toArray()))};d._showCrossIcon=function(G){zg(d.getView(),cn),Km(cn,{x:G.clientX-eg/2,y:G.clientY-eg/2,width:eg,height:eg})},d._hideCrossIcon=function(){ig(cn)},d._scrollImpl=function(V,u){m={point:k.lp(V),screen:ad(V),hit:H(V),type:"right"},m.hitNormalize=m.hit?m.hit.clone().normalize():new dc;var A={clientX:m.screen.x,clientY:m.screen.y+10*u};d._handleMoveImpl(A),d._endMoveImpl(A)},d._startMoveImpl=function(O){i&&(i.stop(!0),i=null),m={point:k.lp(O),screen:ad(O),hit:H(O)},m.hitNormalize=m.hit?m.hit.clone().normalize():new dc,mc?1===O.touches.length?m.hit&&(m.type="left"):2===O.touches.length&&(m.type="touch2"):(Ir(O)?m.hit&&(m.type="left"):Cf(O)?m.type="right":He(O)&&m.hit&&(m.type="middle"),!m.hit||"right"!==m.type&&"middle"!==m.type||d._showCrossIcon(O)),m.type&&Rr(d,O)},d._handleMoveImpl=function(G){if(m)switch(m.type){case"left":return d._handleLeft(G);case"right":return d._handleRight(G);case"middle":return d._handleMiddle(G);case"touch2":return d._handleTouch2(G)}},d._endMoveImpl=function(){if(m){if(this._hideCrossIcon(),"left"===m.type||"middle"===m.type){var f=1e3*(m.lastAngle/(m.deltaTime||30)),P=m.lastAxis,Q=m.lastTime,x=function(){var Y=Date.now(),D=(Y-Q)/1e3;return Q=Y,f*=Math.pow(Math.abs(d.decelerationRate),3*D),Math.abs(f)<.01?(f=0,i&&i.stop(),void 0):(u(P,f*D),void 0)};i=ze({action:function(){x(arguments)},duration:5e3})}m=null}},d._handleLeft=function(G){if(!m.finished){var L=ad(G),q=P(L,m.lastScreen||m.screen);if(m.lastScreen=L,!q.hit)return m.finished=!0,d._endMoveImpl(G),void 0;var w=q.hit;w.normalize();var $=m.hitNormalize,S=Math.acos(w.dot($)),I=w.cross($).normalize();u(I,S),q.out&&(m.finished=!0,d._endMoveImpl(G))}},d._handleRight=function(r){var D=m.lastScreen||m.screen,f=D.y;D=m.lastScreen=ad(r);var c=D.y,n=c-f;if(n){var g=Math.min(.5,n*d.scaleSpeed);R.copy(k.getEye());var W=m.hit;W||(W=R.clone().divide(U).normalize().multiply(U)),p.copy(R).lerp(W,g),k.setEye(p.toArray()),R.copy(k.getUp()),p.normalize();var E=R.clone().cross(p).normalize();if(e.copy(k.getCenter()),e.sub(E.multiplyScalar(e.dot(E))),k.setCenter(e.toArray()),m.hit){var N=H(m.screen),o=m.hitNormalize;if(N){N.normalize();var w=Math.acos(N.dot(o)),T=N.cross(o).normalize();w&&u(T,w)}}}};var g=function(L){return Math.abs(L)<.01?0:L>0?1:-1};d._handleTouch2=function(H){var U=H.touches.length;if(2===U){var l=H.touches,S={x:l[0].clientX,y:l[0].clientY},I={x:l[1].clientX,y:l[1].clientY},n={x:I.x-S.x,y:I.y-S.y},a=m.lastCenter,O=Math.atan2(n.y,n.x),T=m.theta,V=0;T==t?T=m.theta=O:(V=O-T,m.thetaStarted||Math.abs(V)>.03?(m.thetaStarted=!0,m.theta=O):V=0);var C,P=Math.sqrt(n.x*n.x+n.y*n.y),K=m.vlen;if(K){var d=S.x-a.x,s=S.y-a.y,e=I.x-a.x,F=I.y-a.y,Y=Math.sqrt(d*d+s*s),J=Math.sqrt(e*e+F*F),Q=K/2,o=g(Y-Q),L=g(J-Q);0>o*L||0===o&&0===L?(C=1,m.vlen=P):(C||(C=P/K),m.scaleStarted||Math.abs(C-1)>.05?(m.vlen=P,m.scaleStarted=!0):C=1)}else K=m.vlen=P,C=1;var n=p.copy(k.getEye()).clone();1!==C&&k.setEye(n.setLength((n.length()-E)/C+E).toArray()),V&&u(n.normalize(),V),m.lastCenter={x:(I.x+S.x)/2,y:(I.y+S.y)/2}}},d._handleMiddle=function(L){var $=ad(L),g=m.screen;m.screen=$;var A=($.y-g.y)/180*Math.PI*d.rollSpeed;p.copy(k.getCenter()).sub(R.copy(k.getEye())).normalize(),R.copy(k.getUp()).cross(p).normalize(),p.copy(k.getEye()).sub(m.hit).applyAxisAngle(R,A).add(m.hit);var f=p.clone();p.copy(k.getCenter()).sub(m.hit).applyAxisAngle(R,A).add(m.hit);var o=p.clone(),X=p.copy(k.getUp()).applyAxisAngle(R,A).clone(),I=!1;A>0&&(e.copy(X),p.copy(o).sub(f).normalize(),R.copy(f).multiplyScalar(-1).normalize(),R.dot(e)-p.dot(e)>0&&(I=!0)),I||e.copy(m.hit).sub(f).dot(m.hitNormalize)>=0&&(I=!0),I||(k.setEye(f.toArray()),k.setCenter(o.toArray()),k.setUp(X.toArray()));var N=-($.x-g.x)/180*Math.PI*d.rotateSpeed;u(m.hitNormalize,N)}};Zq("GlobeInteractor",ki,{handle_contextmenu:function(F){Hc(F)},handle_mousewheel:function(t){this._scrollImpl(t,t.wheelDelta/40)},handle_DOMMouseScroll:function(M){2===M.axis&&this._scrollImpl(M,-M.detail)},handle_keydown:function($){this.gv.handleKeyDown($)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(M){Hc(M);var X=this.gv;if(X.setFocus(M)){var V=X.getDataInfoAt(M),K=V?V.data:t;K&&X.isInteractive(K)||this._startMoveImpl(M);var R=V?V.part:t;fo(M)?X.handleDoubleClick(M,K,R):X.handleClick(M,K,R)}},handle_mouseup:function(Z){this.handle_touchend(Z)},handle_touchend:function(){},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(K){this._handleMoveImpl(K)},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(h){this._endMoveImpl(h)}}),u.defineProperties(un.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(L){this._rotateSpeed=L}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(b){this._rollSpeed=b}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(f){this._scaleSpeed=f}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(D){this._decelerationRate=D}}});var pf=function(P){this.gv=P};Tr(pf,u,{_iv:!0,iv:function(){this._iv=!0},face:function(v,C){var i=this,q=i.gv.getGL();if(!q||!wk(v))return t;var b=i._resolution,L=Math.round(C.x*b),u=Math.ceil(C.width*b),l=Math.ceil(C.height*b),y=i.height-Math.round(C.y*b)-l,Z=E(u/2),r=new Uint8Array(4*u*l),U=0;for(i.iv(),i.validate(v),Pi(q,i.frame),q.readPixels(L,y,u,l,q.RGBA,q.UNSIGNED_BYTE,r),nr(q),i.iv();Z>=U;U++)for(var o=Z-U,R=Z+U,K=o;R>=K;K++)for(var f=o;R>=f;f++)if(K===o||K===R||f===o||f===R){var A=nc.m[r[4*(K*u+f)]];if(A)return A}},get:function(k,G){this.validate();var c=this,w=c.gv.getGL();if(!w)return t;var K,z,Y=c._resolution,P=Math.round(k.x*Y),M=Math.ceil(k.width*Y),$=Math.ceil(k.height*Y),T=c.height-Math.round(k.y*Y)-$,d=E(M/2),X=new Uint8Array(4*M*$),r=0,U=X.length,s=G?t:new ls,_=G?t:{};if(Pi(w,c.frame),w.readPixels(P,T,M,$,w.RGBA,w.UNSIGNED_BYTE,X),nr(w),G){for(;d>=r;r++)for(var L=d-r,n=d+r,h=L;n>=h;h++)for(var f=L;n>=f;f++)if((h===L||h===n||f===L||f===n)&&(K=c.info(X,4*(h*M+f))))return K}else for(;U>r;r+=4)K=c.info(X,r),K&&(z=K.data,_[z._id]||(s.add(z),_[z._id]=z));return s},info:function(w,y){return this.colorMap[(w[y]<<16)+(w[y+1]<<8)+w[y+2]+((127&w[y+3])<<24)]},validate:function(I){var n=this,g=n.gv,o=g.getGL();if(o){var B=n._resolution=g._pickerResolution*g.getDevicePixelRatio(),S=Math.round(B*g.getWidth()),P=Math.round(B*g.getHeight()),h=o.RGBA,i=o.TEXTURE_2D,k=o.RENDERBUFFER,x=o.FRAMEBUFFER;n.texture||(n.texture=sq(o),n.render=o.createRenderbuffer(),n.frame=o.createFramebuffer()),(n.width!==S||n.height!==P)&&(Af(o,n.texture),o.texImage2D(i,0,h,S,P,0,h,o.UNSIGNED_BYTE,t),Ki(o,o.TEXTURE_MIN_FILTER,o.LINEAR),o.bindRenderbuffer(k,n.render),o.renderbufferStorage(k,o.DEPTH_COMPONENT16,S,P),Pi(o,n.frame),o.framebufferTexture2D(x,o.COLOR_ATTACHMENT0,i,n.texture,0),o.framebufferRenderbuffer(x,o.DEPTH_ATTACHMENT,k,n.render),Af(o,t),o.bindRenderbuffer(k,t),nr(o),n.width=S,n.height=P),n._iv&&(n._iv=!1,Pi(o,n.frame),g._42(I||(n.colorMap={}),B),nr(o))
}}});var Op=function(M){this.gv=M};Tr(Op,u,{gap:0,size:0,_42:function(P,S){var n=this,l=n.gv,X=l._gridGap,O=l._gridSize;if(l._gridVisible){if(n.gap!==X||n.size!==O){for(var A=[],I=l._gridSize/2,y=X*I,p=0;2*I+1>p;p++){var E=6*p,q=6*(2*I+1)+E;A[E]=-y,A[E+1]=0,A[E+2]=-y+p*X,A[E+3]=y,A[E+4]=0,A[E+5]=-y+p*X,A[q]=-y+p*X,A[q+1]=0,A[q+2]=-y,A[q+3]=-y+p*X,A[q+4]=0,A[q+5]=y}n.vs=new cc(A),n.gap=X,n.size=O}um(l),bi(P,S),we(P),Un(P,S,1,l._gridColor,l._buffer.vs,n.vs),Wf(P,0,n.vs.length/3,P.LINES),Li(P),Zo(P,S)}else n.vs=n.gap=n.size=t}});var _c=function(Q){this.gv=Q};Tr(_c,u,{_42:function(C,p){var A=this.gv,Y=A._buffer.vs,D=A._axisXColor,b=A._axisYColor,W=A._axisZColor,O=A._originAxisVisible,u=A._centerAxisVisible;if(O||u){var L=Kc?C.TRIANGLES:C.TRIANGLE_FAN,E=C.LINES;if(um(A),bi(C,p),we(C),O){var $=A.getCenterInfo(),d=a($.width,$.height)/5,w=.8*d,y=.05*d;Un(C,p,1.5,D,Y,new cc([0,0,0,d,0,0,w,y,0,w,0,y,w,-y,0,w,0,-y,w,y,0,0,0,0,0,d,0,y,w,0,0,w,y,-y,w,0,0,w,-y,y,w,0,0,0,0,0,0,d,y,0,w,0,y,w,-y,0,w,0,-y,w,y,0,w])),Wf(C,0,2,E),Wf(C,1,6,L),Un(C,p,t,b),Wf(C,7,2,E),Wf(C,8,6,L),Un(C,p,t,W),Wf(C,14,2,E),Wf(C,15,6,L)}if(u){var h=A._center,m=h[0],K=h[1],o=h[2],$=A.getPositionInfo(h);d=a($.width,$.height)/20,Un(C,p,1.5,D,Y,new cc([m,K,o,m+d,K,o,m,K,o,m,K+d,o,m,K,o,m,K,o+d])),Wf(C,0,2,E),Un(C,p,t,b),Wf(C,2,2,E),Un(C,p,t,W),Wf(C,4,2,E)}Li(C),Zo(C,p)}}});var Di=function(f){this.gv=f,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Di.Mode.Style,this.color=w,this.width=w};Di.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Tr(Di,u,{onMouseOver:function(X){Q.preventDefault(X);var v=this.gv.getDataAt(X);v!==this.mouseOverData&&(this.mouseOverData=v,this.gv.iv())},setFetchTargetFunc:function(W){this.fetchTargetFunc=W},_42:function(c,F){var u,T,D=this,k=D._mode;if(!c._renderInfo.reflectDepth&&k!==Di.Mode.Disable){if(k===Di.Mode.Selection?u=D.gv.sm().getSelection().toArray(function($){return $.s("highlight.visible")}):k===Di.Mode.MouseOver&&D.mouseOverData&&D.mouseOverData.s("highlight.visible")&&(u=[D.mouseOverData]),D.fetchTargetFunc&&(u=D.fetchTargetFunc(u)),k===Di.Mode.Style)u=u||[],T=function(O){if(u.indexOf(O)>=0)return!1;var K=O.s("highlight.mode");return K===!1?!0:K===!0?!1:"selected"===K?D.gv.isSelected(O)?!1:!0:"hover"===K?O===D.mouseOverData?!1:!0:!0};else{if(!u||!u.length)return;T=function(H){return u.indexOf(H)<0?!0:void 0}}var L=D.gv,O=L.vr.isPresenting(),H=L.getWidth();if(O){var J=L.getWidth;H/=2,L.getWidth=function(){return H};var i=L.getViewport()}var t,A=L.getDevicePixelRatio(),R=H*A,m=L.getHeight()*A;(t=D._renderTarget)?t.setSize(c,R,m):D._renderTarget=t=new Tn.RenderTarget(L,c,R,m),Pi(c,t.frame),L.drawFilter=T,L._42({}),L.drawFilter=null,nr(c),Kc&&ge(c,F.aPosition),ge(c,F.aNormal),O&&(L.getWidth=J,L.setViewport(c,i[0],i[1],i[2],i[3]));var e=c._compiledShader.highlight;e||(e=c._compiledShader.highlight=new rr.Shader(c,nj.vs,nj.fs)),e.bind(),c.enable(c.BLEND),c.activeTexture(c.TEXTURE0+0),c.bindTexture(c.TEXTURE_2D,t.texture),e.uniforms.image=0,e.uniforms.textureSize=[R,m],e.uniforms.edgeWidth=L.getHighlightWidth();var f=L.getHighlightColor();if(D._lastHighlightColor!==f){var j=Ei(D._lastHighlightColor=f);D._highlightColorData=[j[0]/255,j[1]/255,j[2]/255,j[3]/255]}e.uniforms.edgeColor=D._highlightColorData,D.ibuffer?(D.ibuffer.upload(),D.vbuffer.upload()):(D.ibuffer=rr.Buffer.createIndexBuffer(c,new Uint16Array([0,2,1,1,2,3])),D.vbuffer=rr.Buffer.createVertexBuffer(c,new Float32Array([0,0,1,0,0,1,1,1]))),e.attributes.pos.pointer(D.vbuffer),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0),c.disable(c.BLEND),c.bindTexture(c.TEXTURE_2D,null),c.useProgram(F),Kc&&qd(c,F.aPosition)}}}),u.defineProperties(Di.prototype,{mode:{get:function(){return this._mode},set:function(D){var t=this._mode;D!==t&&(this._mode=D,D===Di.Mode.MouseOver||D===Di.Mode.Style?b(this.gv.getView(),"mousemove",this.onMouseOver):(t===Di.Mode.MouseOver||t===Di.Mode.Style)&&n(this.gv.getView(),"mousemove",this.onMouseOver))}}});var nj={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},_f=function(A){this.gv=A},Od="edit_tx",qm="edit_ty",gk="edit_tz",fh="edit_rx",Zi="edit_ry",Dg="edit_rz",Yo="edit_sx",tj="edit_sy",bj="edit_sz",bm={};bm[Od]=1,bm[qm]=1,bm[gk]=1,bm[fh]=1,bm[Zi]=1,bm[Dg]=1,bm[Yo]=1,bm[tj]=1,bm[bj]=1,Tr(_f,u,{_42:function(X,A,v){var i=this,Q=i.gv,w=Q.sm().ld();if(w&&Q.isEditable(w)&&!Q.isEditHelperDisabled()&&wk(w)&&(!Q.isFirstPersonMode()||!Q.isMouseRoamable()&&!mc)){um(Q);var $,p,L=Q.isMovable(w),R=Q.isRotationEditable(w),j=Q.isSizeEditable(w),W=Q._axisXColor,c=Q._axisYColor,n=Q._axisZColor,b=Q._editSizeColor,F=w.p3(),Y=ro(Q.getEye(),F)/10,t=Y/(v?5:10),T=.7*Y,k=.4*T,Z=F[0],U=F[1],I=F[2];$=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&i._17O(X,A,w,v,Od,W,$,[Z,U-t,I,Z+T,U-t,I,Z+T,U,I,Z+T,U,I,Z,U,I,Z,U-t,I,Z,U-t,I+t,Z+T,U-t,I+t,Z+T,U-t,I,Z+T,U-t,I,Z,U-t,I,Z,U-t,I+t]),p=Z+T,j&&i._17O(X,A,w,v,Yo,b,$,[p,U-t,I,p+k,U-t,I,p+k,U,I,p+k,U,I,p,U,I,p,U-t,I,p,U-t,I+t,p+k,U-t,I+t,p+k,U-t,I,p+k,U-t,I,p,U-t,I,p,U-t,I+t]),p+=k,R&&i._17O(X,A,w,v,fh,W,$,[p,U-t,I,p+k,U-t,I,p+k,U,I,p+k,U,I,p,U,I,p,U-t,I,p,U-t,I+t,p+k,U-t,I+t,p+k,U-t,I,p+k,U-t,I,p,U-t,I,p,U-t,I+t]),$=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],L&&i._17O(X,A,w,v,qm,c,$,[Z,U,I,Z,U+T,I,Z-t,U+T,I,Z-t,U+T,I,Z-t,U,I,Z,U,I,Z,U,I,Z,U,I-t,Z,U+T,I-t,Z,U+T,I-t,Z,U+T,I,Z,U,I]),p=U+T,j&&i._17O(X,A,w,v,tj,b,$,[Z,p,I,Z,p+k,I,Z-t,p+k,I,Z-t,p+k,I,Z-t,p,I,Z,p,I,Z,p,I,Z,p,I-t,Z,p+k,I-t,Z,p+k,I-t,Z,p+k,I,Z,p,I]),p+=k,R&&i._17O(X,A,w,v,Zi,c,$,[Z,p,I,Z,p+k,I,Z-t,p+k,I,Z-t,p+k,I,Z-t,p,I,Z,p,I,Z,p,I,Z,p,I-t,Z,p+k,I-t,Z,p+k,I-t,Z,p+k,I,Z,p,I]),$=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&i._17O(X,A,w,v,gk,n,$,[Z,U,I,Z,U,I+T,Z,U-t,I+T,Z,U-t,I+T,Z,U-t,I,Z,U,I,Z,U-t,I,Z-t,U-t,I,Z-t,U-t,I+T,Z-t,U-t,I+T,Z,U-t,I+T,Z,U-t,I]),p=I+T,j&&i._17O(X,A,w,v,bj,b,$,[Z,U,p,Z,U,p+k,Z,U-t,p+k,Z,U-t,p+k,Z,U-t,p,Z,U,p,Z,U-t,p,Z-t,U-t,p,Z-t,U-t,p+k,Z-t,U-t,p+k,Z,U-t,p+k,Z,U-t,p]),p+=k,R&&i._17O(X,A,w,v,Dg,n,$,[Z,U,p,Z,U,p+k,Z,U-t,p+k,Z,U-t,p+k,Z,U-t,p,Z,U,p,Z,U-t,p,Z-t,U-t,p,Z-t,U-t,p+k,Z-t,U-t,p+k,Z,U-t,p+k,Z,U-t,p])}},_17O:function(B,M,d,N,W,J,Y,i){var I=this.gv._buffer;Ib(B,M,N,!0,d,W),jo(B,M,t,!0,t,!0,t,!1),Jo(B,M.uDiffuse,J),Ab(B,I.vs,new cc(i),M.aPosition),Ab(B,I.ns,new cc(Y),M.aNormal),we(B),Wf(B,0,12),Li(B),np(B,M)}});var fi=Y.Raycaster=function(t){this.gv=t,this.maxTriangleTest=1/0,this.backfaceCulling=!0};uk("Raycaster",u,{intersect:function($){var i=this,I=i.gv,y=I.getDataAt($);return y?i.intersectObject($,y):null},intersectObjects:function(Q,f,y){var Y,F,v,T,g=this,U=1/0,d=Q.origin||(new dc).fromArray(g.gv.getEye()),S=g.maxTriangleTest,M=[];return f.forEach(function(E){y&&y(E)===!1||E.s("intersect")!==!1&&M.push(E)}),M.sort(function(z,w){return d.distanceToSquared2(z.p3())-d.distanceToSquared2(w.p3())}),g.countTriangles=0,M.forEach(function(R){g.countTriangles>S||(Y=g.intersectObject(Q,R),Y&&(F=d.distanceToSquared(Y.world),U>F&&(v=R,T=Y,U=F)))}),g.countTriangles=0,{data:v,intersect:T}},intersectObject:function(B,N){if(B instanceof tk)return this._intersectObjectImpl(B,N);var Z=this,z=Z.gv,D=z.unproject(B),x=new dc,C=z.getEye(),y=new dc;if(z.isOrtho()){var h=new dc(C);y.copy(z.getCenter()).sub(h).normalize();var b=x.copy(D).sub(h).dot(y);x.copy(y).setLength(-b).add(h.copy(D))}else x.copy(C),y.copy(D).sub(x).normalize();var S=new Y.Math.Ray(x,y);return Z._intersectObjectImpl(S,N)},_intersectObjectImpl:function(){function s(){var Y=new dc;return Y.subVectors(U,K),A.subVectors(g,K),Y.cross(A).normalize(),Y}function u(s,t,n,i,Q,P,r){return Zg.barycoordFromPoint(s,t,n,i,e),Q.multiplyScalar(e.x),P.multiplyScalar(e.y),r.multiplyScalar(e.z),Q.add(P).add(r),Q.clone()}function $(x,T,M){Cl(x)?x.forEach(function(n){$(n,T,M)}):vh(x)?$(se(T,x),T,M):ao(x)&&(x.shape3d?$(x.shape3d,T,M):M.push(x))}var D=new de,f=new de,H=new tk,V=new dc,v=new dc,N=new dc,R=new dc,T=new dc,g=new dc,K=new dc,U=new dc,l=new ob,y=new ob,q=new ob,A=new dc,h={vs:Lc,is:tf,uv:ve},e=new dc;return function(n,M){var G=this.gv.getData3dUI(M),L=M.mat||G.mat;if(L){D.fromArray(L),f.getInverse(D),H.copy(n).applyMatrix4(f);var m,w,j="body",F=G.shapeModel;if(F||(F=se(G)),F||(M instanceof Y.Node&&!(M instanceof Y.Shape)?(m=!0,F=h):(w=!0,F=[G.left,G.front,G.right,G.back,G.top,G.bottom])),!F)return console.log("Can not find shape model."),null;Cl(F)||(F=[F]);var Q,S,x,W,J,t,C,p,Z,k,b,I,a,B,A,c,z=1/0,O=["","top_","bottom_"],r=!1,P=this.backfaceCulling,o=[];for($(F,G,o),Q=0,S=o.length;S>Q;Q++)if(a=o[Q])for(x=0,W=O.length;W>x;x++)if(B=O[x],C=a[B+"vs"],p=a[B+"is"],Z=a[B+"uv"]||a[B+"tuv"],C){if(A=a[B+"boundingBox"]){var b=H.intersectBox(A);if(!b)continue;if(H.origin.distanceTo(b)>z)continue;c=!1}else a[B+"boundingBox"]=A=new Y.Math.Box3,c=!0;for(J=0,t=p?p.length:C.length/3;t>J;J+=3)this.countTriangles++,p?(v.fromArray(C,3*p[J]),N.fromArray(C,3*p[J+1]),R.fromArray(C,3*p[J+2])):(v.fromArray(C,3*J),N.fromArray(C,3*(J+1)),R.fromArray(C,3*(J+2))),c&&(A.expandByPoint(v),A.expandByPoint(N),A.expandByPoint(R)),k=H.intersectTriangle(v,N,R,P,V),k&&(I=H.origin.distanceTo(k),z>I&&(z=I,T.copy(k),g.copy(v),K.copy(N),U.copy(R),""!==B?j=B.slice(0,-1):m?j=tr[Math.floor(J/6)]:w&&(j=tr[Q]),Z&&(r=!0,p?(l.fromArray(Z,2*p[J]),y.fromArray(Z,2*p[J+1]),q.fromArray(Z,2*p[J+2])):(l.fromArray(Z,2*J),y.fromArray(Z,2*(J+1)),q.fromArray(Z,2*(J+2))))))}if(!isFinite(z))return null;var X,E=T.clone().applyMatrix4(D);r&&(X=u(T,g,K,U,l,y,q));var i=s(g,K,U),e=s(g.applyMatrix4(D),K.applyMatrix4(D),U.applyMatrix4(D)),_=H.direction.dot(i);return _>0&&(i.multiplyScalar(-1),e.multiplyScalar(-1)),{world:E,local:T.clone(),worldNormal:e,normal:i,uv:X,part:j}}}}()});var sn=function(R,L){this.gv=R,this.s=function(X,T,n){return T==t&&(T=n),T==t?L.getStyle(X):bf(T,L,R)},this.data=L};Tr(sn,u,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(w,z,d,e){var k=this,D=k.data;if(!(D instanceof aq)){var X,q,S,o,n,N,I,j=k.gv,T=D._id,s=k.s("alwaysOnTop")||k.s("shape3d.alwaysOnTop")?null:k.s("batch"),J=j._batchIndexMap,P=j._batchModelMap,r=j.isSelectable(D),W=j.getBrightness(D),x=W!=t&&1!==W;for(var E in Q)if(E.length===Om.length+1&&E[Om.length]===fj[4].toUpperCase()&&E[Om.length-1]===fj[Om.length+1].toUpperCase()&&!zr[E.length+1])return;for(var E in A){var $="box-sizing";if(6===E.length&&E[0]===fj[4]&&E[3]===$[0]&&E[4]===$[1]&&E[5]===$[2]&&!zr[E.length])return}if(k.needValidate(w)){S=Ag(J,P,D,s);var U=k.validate(S,s?Fe[s]||sg:t);if(S&&(o=J[T],n=o.size=S.vs.length/3-o.begin,I=S.rs))for(W=x?W:1,N=0;n>N;N++)I.push(W);var u=j.getWireframeGeometry(D);if(u)ue(j,D,u);else if(wk(D)){var Z=j.getWireframe(D);Z&&ue(j,D,Z)}k.labelInfo=k.label2Info=k.noteInfo=k.note2Info=k._38o=t,k._24O(cf,"getLabel"),k._24O(Om,"getLabel2"),k._26O(_o,"getNote"),k._26O(Pd,"getNote2"),k._15O(),k.interactiveInfo=j.isInteractive(D)?{}:t,U!==!1&&(k._iv=!1)}x&&Jo(w,z.uBrightness,W),Jo(w,z.uAlphaTest,k.s("alphaTest")),Jo(w,z.uUseEnvMap,D.s("envmap")?!0:!1),Jo(w,z.uReflectivity,D.s("envmap")||.01);var v=k.s("3d.clip.direction"),f=!0;if(v){var H=k.s("3d.clip.percentage");switch(0===H&&(f=!1),v){case"left":v=2;break;case"top":v=3;break;case"bottom":v=4;break;case"front":v=5;break;case"back":v=6;break;case"right":default:v=1}if(0===v%2&&(H=1-H),D instanceof Y.Shape){var m=D.s3(),L=D.p3(),p=D.getAnchor3d();H=3>v?(H-p.x)*m[0]+L[0]:5>v?(H-p.y)*m[1]+L[1]:(H-p.z)*m[2]+L[2]}else H-=.5;Jo(w,z.uClipPercent,H)}w.uniform1i(z.uClipDirection,v||0),q=Ib(w,z,d,r,D,Ed),q&&(Fi(q,J[T],P),Fi(q,j._polylineIndexMap[T],j._polylineModelMap),Fi(q,j._wireframeIndexMap[T],j._wireframeModelMap)),!J[T]&&f&&k._80o(w,z,e),j.isLabelVisible(D)&&((X=k.labelInfo)&&(Ib(w,z,d,r,D,cf),k._28O(X,cf,e)),(X=k.label2Info)&&(Ib(w,z,d,r,D,Om),k._28O(X,Om,e))),j.isNoteVisible(D)&&((X=k.noteInfo)&&(Ib(w,z,d,r,D,_o),k._29O(X,_o,e)),(X=k.note2Info)&&(Ib(w,z,d,r,D,Pd),k._29O(X,Pd,e))),(X=k._38o)&&k._99O(w,z,X,d,r,e),x&&Jo(w,z.uBrightness,1),v&&w.uniform1i(z.uClipDirection,0)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return $l},_80o:function(){},dispose:function(){},getBodyColor:function(A){var R=this.data,m=this.gv.getBodyColor(R);return m?m:A?R.getStyle(A):t},getCachedTexture:function(S){var V=this._cachedTextures;return V?V[S||"main"]:null},setCachedTexture:function(l,p){var x=this._cachedTextures;return x||(x=this._cachedTextures={}),x[p||"main"]=l,l},invalidateCachedTexture:function(M){var d=this._cachedTextures;for(var h in d)M.deleteTexture(d[h]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(z,J){var j=this,$=j.data,U=j.gv,N=j.s,I=U[J]($);if(I!=t){var p=N(z+".scale"),b=N(z+".max"),m=j[z+"Info"]={label:I,textureScale:N(z+".texture.scale"),color:U[J+"Color"]($),font:N(z+".font"),align:N(z+".align"),background:U[J+"Background"]($)},F=m.rect=Pg(m,I);b>0&&b<F.width&&(m.labelWidth=F.width,F.width=b),F.x=F.y=0,F.width*=p,F.height*=p,m.mat=j._16O(N(z+".autorotate"),N(z+".position"),F,N(z+".face"),N(z+".t3"),N(z+".r3"),N(z+".rotationMode"));var E=F.width/2,x=F.height/2;m.vs=new cc([-E,x,0,-E,-x,0,E,-x,0,E,x,0]),F.width/=p,F.height/=p}},_26O:function(A,r){var C=this,y=C.data,T=C.gv,S=C.s,H=T[r](y);if(H!=t){var Z=S(A+".scale"),h=this[A+"Info"]={note:H,textureScale:S(A+".texture.scale"),expanded:S(A+".expanded"),font:S(A+".font"),color:S(A+".color"),align:S(A+".align"),borderWidth:S(A+".border.width"),borderColor:S(A+".border.color"),background:T[r+"Background"](y)};if(h.expanded){var c=S(A+".max"),i=Pg(h,H);i.width+=6,i.height+=2,c>0&&c<i.width&&(h.labelWidth=i.width,i.width=c);var d={x:-i.width/2,y:-8-i.height,width:i.width,height:i.height+8}}else d={x:-6,y:-18,width:12,height:18};h.mat=C._16O(S(A+".autorotate"),S(A+".position"),t,S(A+".face"),S(A+".t3"),S(A+".r3"),S(A+".rotationMode")),h.rect=d,1!==Z&&(d=kr(d),d.x*=Z,d.height*=Z,d.y=-d.height,d.width*=Z);var O=d.x,B=d.y,X=d.width,Q=d.height;h.vs=new cc([O,-B,0,O,-B-Q,0,O+X,-B-Q,0,O+X,-B,0])}},_28O:function(I,P,w){if(w(this.s(P+".transparent"))){var t=I.rect,j=I.textureScale,T=t.width*j,q=t.height*j;if(T>=1&&q>=1){var H=wq(T,q);1!==j&&(H.translate(H,t.x,t.y),H.scale(j,j),H.translate(H,-t.x,-t.y)),jc(H,I),H.restore(),xs(this,P,I.mat,I.vs,!0)}}},_29O:function(N,K,B){if(B(this.s(K+".transparent"))){var b=N.rect,o=N.textureScale,F=b.x,f=b.y,c=b.width*o,v=b.height*o;if(c>=1&&v>=1){b.x=b.y=0;var h=wq(c,v);1!==o&&h.scale(o,o),Sk(h,N),h.restore(),b.x=F,b.y=f,xs(this,K,N.mat,N.vs,!1)}}},_99O:function(I,E,c,d,v,e){if(c){var u=this,k=u.gv,s=u.data,Q=k._buffer,S=k._1O,L=c.icons;for(var R in L){var K=L[R],x=c.rects[R];if(x&&e(bf(K.transparent,s,k))){Ib(I,E,d,v,s,R);var C=bf(K.shape3d,s,k),B=C?[C]:bf(K.names,s,k),w=B?B.length:0,V=bf(K.textureScale,s,k)||1,Y=bf(K.light,s,k);Y==t&&(Y=C?!0:!1),jo(I,E,bf(K.blend,s,k),Y,bf(K.opacity,s,k),bf(K.reverseFlip,s,k),bf(K.reverseColor,s,k),bf(K.reverseCull,s,k));for(var D=0;w>D;D++){var M=B[D],a=x[D];if(gh(u,a.mat),C)Il(k,s,se(u,C),u);else{var J=ir(M);if(J){var g=a.width*V,W=a.height*V;if(g>=1&&W>=1){var f=wq(g,W);Mi(f,J,bf(K.stretch,s,k),0,0,g,W,s,k),f.restore(),sq(I,xk,S),we(I,E,S,bf(K.discardSelectable,s,k),Q.uv,Xo),Ab(I,Q.vs,a.vs,E.aPosition),jk(I,Q.ns,gg,E.aNormal),Gl(I,Q.is,zp),Yi(I,0,zp.length),Li(I,E,S)}}}Np(k)}np(I,E)}}}}});var ce=function(g,J){ml(ce,this,[g,J])};Tr(ce,sn,{_16O:function(p,Y,w,a,d,$,F,g,h){var T=this.data,Z=T.getFinalScale3d(),i=rj(Y,Z,w,a,g,h);if(T.hasOwnProperty("_anchor")||T.hasOwnProperty("_anchorElevation")){var b=T.getAnchor3d();i[0]-=(b.x-.5)*Z[0],i[1]-=(b.y-.5)*Z[1],i[2]-=(b.z-.5)*Z[2]}return Ar(_d(),i,T.p3(),a,d,$,F,p,T.getFinalRotation3d(),T.getRotationMode())},clear:function(){var c=this;c.faceMat=c.mat=c.shapeModel=c.left=c.right=c.front=c.back=c.top=c.bottom=c.csg=t},needValidate:function(b){if(this._iv)return this._validateFrameId=b._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var q=b._renderInfo.frame;if(this._validateFrameId!==q)return this._validateFrameId=q,!0}return!1},validate:function(l,G){var K=this,M=K.gv,m=K.data,A=K.shapeName=K.s(Kd),v=se(K,A);K._updateAutoRotation(),K._updateFixSize2d(),K._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(ni(M,m,"_wireframeModelMap","_wireframeIndexMap"),ni(M,m,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var g=Ur(m,M.getMat(m),v?K.s("shape3d.scaleable"):!0);if(m.appendAnchorMatrix3d(g),m.mat=g,K.clear(),v||!A)if(l){var s=[];v?Ff(M,m,v,K,K.getBodyColor(),[g],l,s):(wd(M,m,l,G,g,Ug,s,Bs),wd(M,m,l,G,g,af,s,Fk),wd(M,m,l,G,g,_j,s,vr),wd(M,m,l,G,g,mn,s,Ic),wd(M,m,l,G,g,Fl,s,Vc),wd(M,m,l,G,g,jf,s,ln)),s.length&&(je(l.vs,s),je(l.ns,Gq(s)))}else K.mat=g,(K.shapeModel=v)||(K._cubeUvs=null,K.vf(Ug,0),K.vf(af,16),K.vf(Fl,8),K.vf(jf,24),K.vf(_j,32),K.vf(mn,40))},_updateAutoRotation:function(){var a=new $o,A=new de,U=new dc,t=new dc,n=new dc;return function(){var N=this,j=N.data,m=N.s("autorotate")||N.s("shape3d.autorotate");if(!m)return j._dynamicRotation&&delete j._dynamicRotation,void 0;var f=N.gv;n.copy(N.s("shape3d.autorotate.up")||f._up);var T;T="string"==typeof m?[m.indexOf("x")<0?f._eye[0]:f._center[0],m.indexOf("y")<0?f._eye[1]:f._center[1],m.indexOf("z")<0?f._eye[2]:f._center[2]]:f._eye;var k=f._center,Y=j.p3();U.copy(Y),t.set(T[0]-k[0],T[1]-k[1],T[2]-k[2]).add(U),A.lookAt(t,U,n),a.set(0,0,0,j.getRotationMode(),!0).setFromRotationMatrix(A);var q=j._dynamicRotation;q&&Math.abs(q[0]-a.x)<1e-5&&Math.abs(q[1]-a.y)<1e-5&&Math.abs(q[2]-a.z)<1e-5||(j._dynamicRotation=[a.x,a.y,a.z])}}(),_updateFixSize2d:function(){var g=this,M=g.data,q=g.s("fixSizeOnScreen")||g.s("shape3d.fixSizeOnScreen");if(!q)return M._dynamicScale3d&&delete M._dynamicScale3d,void 0;var c=g.gv,p=Ur(M,c.getMat(M)),P=wl([0,0,0],p),t=c.toViewPosition(P);if(!isNaN(t.x)&&!isNaN(t.y)){var v=wl([1,0,0],p),x=c.toViewPosition(v),F=wl([0,1,0],p),o=c.toViewPosition(F),B=x.x-t.x,k=o.y-t.y;if(B&&k){var l,h,Y=M._dynamicScale3d||[1,1,1],z=ir(M.s("shape3d.image"));if(q[0]>0&&(l=q[0]),q[1]>0&&(h=q[1]),!l||!h){var Z=q>0?q:1;l||(l=(To(z,M)||M.getWidth())*Z),h||(h=(wb(z,M)||M.getTall())*Z)}var L=Math.abs(B/l),R=Math.abs(k/h);Math.abs(L-1)<.001&&Math.abs(R-1)<.001||(M._dynamicScale3d=[Y[0]/L,Y[1]/R,Y[2]])}}},_updateOverlapping:function(){var S=this,J=S.s("hide.overlapping.group");if(!J)return S._rectOverlapping&&(S._rectOverlapping=w),void 0;var R,r,u,q=S.gv,Z=S.data,l=Ur(Z,q.getMat(Z)),K=1/0,v=1/0,z=-1/0,B=-1/0,h=Z.getAnchor3d(),s=h.x,G=h.y,V=h.z;for(R=0;8>R;R++){if(r=wl([(R>>2)-s,(1&R>>1)-G,(1&R)-V],l),u=q.toViewPosition(r),isNaN(u.x)||isNaN(u.y))return;K=Math.min(K,u.x),z=Math.max(z,u.x),v=Math.min(v,u.y),B=Math.max(B,u.y)}var Q={x:K,y:v,w:z-K,h:B-v};S._rectOverlapping=q.overlappingBox.isOverlapping(J,Q)},getVectorDynamicSize:function(){var S,J=this,X=J.s("shape3d"),j=J.data;if("billboard"===X||"plane"===X||(S=j._currentCubeElementId)!=t){var A,K,h=J.gv,V=Ur(j,h.getMat(j)),q=j.getAnchor3d(),m=.5-q.x,U=.5-q.y,T=.5-q.z,_=J.s("vector.dynamic.maxsize"),l=function(r,b){r[0]+=m,r[1]+=U,r[2]+=T,b[0]+=m,b[1]+=U,b[2]+=T;var c=h.toViewPosition(wl(r,V)),q=h.toViewPosition(wl(b,V)),x=c.x-q.x,K=c.y-q.y;return Math.min(_,Math.sqrt(x*x+K*K))};if("billboard"===X)A=l([-.5,0,0],[.5,0,0]),K=l([0,-.5,0],[0,.5,0]);else if("plane"===X)A=l([-.5,0,0],[.5,0,0]),K=l([0,0,-.5],[0,0,.5]);else if(j._currentCubeElementId!=t){var P=3*tf[S+1],u=3*tf[S],M=3*tf[S+2];A=l([Lc[P],Lc[P+1],Lc[P+2]],[Lc[M],Lc[M+1],Lc[M+2]]),K=l([Lc[P],Lc[P+1],Lc[P+2]],[Lc[u],Lc[u+1],Lc[u+2]])}return[A,K]}},vf:function(z,W){var K=this;if(K.gv.getFaceVisible(K.data,z)){var l=to(K,z);l.mat&&(K.faceMat=!0);var t=l.uv;if(t){var A=K._cubeUvs;A||(A=K._cubeUvs=new cc([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var j=0;8>j;j++)A[W+j]=t[j]}return l}},_billboardInView:function(){var T=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],m=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],u=new Fn,B=new dc,w=new de;return function(U){var o=this;if(!o.mat)return!0;var D=o.gv.getFrustum(),S="billboard"===U?T:m;u.makeEmpty(),w.fromArray(o.mat);for(var L=0,H=S.length;H>L;L+=3)u.expandByPoint(B.fromArray(S,L).applyMatrix4(w));return D.intersectsBox(u)}}(),_80o:function(x,o,g){var z=this;if(z._rectOverlapping)return!0;var w=z.shapeModel;if(w||!z.shapeName){var P=z.s("shape3d");if(("billboard"===P||"plane"===P)&&!z._billboardInView(P))return!0;var J=z.gv,l=z.data,C=J._cube;um(J,z.mat),z.s("shape3d.reflector")&&!x._picking||(w?Il(J,l,w,z,z.getBodyColor(),g):(Ab(x,C.vs,t,o.aPosition),Ab(x,C.ns,t,o.aNormal),Vg(x,C.is),z._18O(x,o,"left",0,g),z._18O(x,o,"front",6,g),z._18O(x,o,"right",12,g),z._18O(x,o,"back",18,g),z._18O(x,o,"top",24,g),z._18O(x,o,"bottom",30,g))),Np(J),z.faceMat&&(z._18O(x,o,"left",0,g,!0),z._18O(x,o,"front",6,g,!0),z._18O(x,o,"right",12,g,!0),z._18O(x,o,"back",18,g,!0),z._18O(x,o,"top",24,g,!0),z._18O(x,o,"bottom",30,g,!0))}},_18O:function(L,N,e,v,H,Y){var r=this[e];if(r){if(!H(r.transparent))return;if(Y&&!r.mat||!Y&&r.mat)return;var W=this.data.s("polygonOffset");W&&Hj(L,W),Y&&um(this.gv,r.mat);var R=this,d=R.data;d._currentCubeElementId=v;var S=R.gv,s=S.getTexture(r.texture,d,e),Z=r.uv,C=r.uvScale,F=r.uvOffset,Q=r.discardSelectable;s?Z?we(L,N,s,Q,S._buffer.uv,R._cubeUvs,F,C):we(L,N,s,Q,S._cube.uv,t,F,C):we(L),jo(L,N,r.blend,r.light,r.opacity,r.reverseFlip,r.reverseColor,r.reverseCull),Jo(L,N.uDiffuse,r.color||K["color.empty"]),Yi(L,v,6),np(L,N),Li(L,N,s),Y&&Np(S),W&&re(L),d._currentCubeElementId=null}},drawReflector:function(){var u=new dc,o=new dc,_=new $o,U=new de,k=new dc,V=new dc,F=new dc,M=new dc,h=new de,L=new de,H=new vg,g=new qe,i=new qe,X=function(C,F,A){C[A]=F[0],C[A+1]=F[1],C[A+2]=F[2]},z=function(r,_){X(r,_.getEye(),0),X(r,_.getCenter(),3),X(r,_.getUp(),6)},B=function(i,k){k._eye=[i[0],i[1],i[2]],k._center=[i[3],i[4],i[5]],k._up=[i[6],i[7],i[8]],k._18Q=t;var I=k._skyBox;I&&(I.p3([i[0],i[1],i[2]]),k.getData3dUI(I).iv())};return function(x,A,c,X,E){var J=this;J._reflectorInfo=null;var s=J.data;if(s._reflecting)return!1;var R=J.gv;if(E)return!1;var q=J._reflectorRenderTarget;q?q.setSize(x,A,c):q=J._reflectorRenderTarget=new Tn.RenderTarget(R,x,A,c),u.copy(s.p3()),o.copy(R.getEye()),U.makeRotationFromEuler(_.set(s.r3(),s.getRotationMode(),!0));var e;if(!J._reflectNormal){var e=se(J,J.s("shape3d"));if(!e)return!1;if(!e.ns&&e.length&&(e=e[0]),!e.ns||!e.vs)return!1;J._reflectNormal=[e.ns[0],e.ns[1],e.ns[2]],J._reflectorVbuffer=rr.Buffer.createVertexBuffer(x,new Float32Array(e.vs))}if(k.copy(J._reflectNormal),k.applyMatrix4(U),V.subVectors(u,o),V.dot(k)>0)return!1;V.reflect(k).negate(),V.add(u),F.copy(R.getCenter()).negate().add(u),F.reflect(k).negate(),F.add(u),M.copy(R.getUp()),M.reflect(k);var P=[0,0,0,0,0,0,0,0,0];z(P,R),R._eye=V.toArray(),R._center=F.toArray(),R._up=M.toArray(),R._18Q=t;var f=R._skyBox;f&&(f.p3(R._eye),R.getData3dUI(f).iv()),Pi(x,q.frame),x.viewport(0,0,q.width,q.height),x.clearColor(0,0,0,1),x.clear(x.COLOR_BUFFER_BIT);var b=Bm(R),Z=Zp(R);H.setFromNormalAndCoplanarPoint(k,u),H.applyMatrix4(L.fromArray(Z)),g.set(H.normal.x,H.normal.y,H.normal.z,H.constant),i.x=(Math.sign(g.x)+b[8])/b[0],i.y=(Math.sign(g.y)+b[9])/b[5],i.z=-1,i.w=(1+b[10])/b[14],g.multiplyScalar(2/g.dot(i));var Q=s.s("shape3d.reflector.clip"),j=Q===w?.003:Q;b[2]=g.x,b[6]=g.y,b[10]=g.z+1-j,b[14]=g.w;var v=R._computedProjectMatrix;R._computedProjectMatrix=b,s._reflecting=!0,X(),R._computedProjectMatrix=v,h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(L.fromArray(R._projectMatrix)),h.multiply(L.fromArray(R._viewMatrix)),nr(x),B(P,R);var W=x._compiledShader.reflector;return W||(W=x._compiledShader.reflector=new rr.Shader(x,pr.Reflector.vs,pr.Reflector.fs)),W.bind(),x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_2D,q.texture),W.uniforms.tDiffuse=0,W.uniforms.color=be(s.s("shape3d.reflector.color")||"rgb(128,128,128)"),W.uniforms.textureMatrix=h.toArray(),W.uniforms.modelMatrix=Ur(s),W.uniforms.viewMatrix=Zp(R),W.uniforms.projectionMatrix=Bm(R),J._reflectorVbuffer.upload(),W.attributes.pos.pointer(J._reflectorVbuffer),x.drawArrays(x.TRIANGLES,0,6),s._reflecting=!1,x.useProgram(R._prg),!0}}()}),pr.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var hk=function(v,_){ml(hk,this,[v,_])};Tr(hk,sn,{_25Q:1,validate:function(u){var R=this;if(!R.s("geometry.cache")||!R.info){var D=R.gv,E=R.data,d=R.s,b=d("edge.width"),P=E._40I,Z=E._41I;if(R.shapeModel=R.info=t,P&&Z){var j,$,i,V,F,G,H,I,c,w,W=E.isLooped(),p=d(mp),v=Q.getEdgeType(p);if(v){var J=v(E,Gf(R,D,E,W,p),D,R._19Q);if(!J.points||J.points.isEmpty())return;G=R.info={},H=J.segments,F=J.points,I=F.size();for(var N=P.getElevation(),k=Z.getElevation(),n=0;I>n;n++){var X=F.get(n);X.e==t&&(X.e=N+(k-N)*n/(I-1))}c=Dd(F.get(0)),w=Dd(F.get(I-1));var Y=I%2;0===Y?(G.c1=Dd(F.get(I/2-1)),G.c2=Dd(F.get(I/2))):G.p3=Dd(F.get((I-Y)/2)),G.s1=c,G.s2=Dd(F.get(1)),G.t1=Dd(F.get(I-2)),G.t2=w}else{F=new ls,G=R.info={};var h=d("edge.offset"),B=d("edge.center"),e=d("edge.source.t3"),L=d("edge.target.t3"),O=ag(D,E,"source"),U=ag(D,E,"target");if(!O||!U)return D.invalidateData(E),delete R.info,!1;if(e&&(O[0]+=e[0],O[1]+=e[1],O[2]+=e[2]),L&&(U[0]+=L[0],U[1]+=L[1],U[2]+=L[2]),p===ef){H=d("edge.segments");var l=G.points=d(Sh)||wn;if(I=l.size()){c=Dd(l.get(0)),w=Dd(l.get(I-1)),!B&&h&&(i=Sb(c,O,!0),h=a(h,ro(O,c)),O=[O[0]+i[0]*h,O[1]+i[1]*h,O[2]+i[2]*h],i=Sb(U,w,!0),h=a(h,ro(w,U)),U=[U[0]-i[0]*h,U[1]-i[1]*h,U[2]-i[2]*h]);var Y=I%2;0===Y?(j=Dd(l.get(I/2-1)),$=Dd(l.get(I/2))):G.p3=Dd(l.get((I-Y)/2)),G.s1=O,G.s2=c,G.t1=w,G.t2=U}else!B&&h&&(i=Sb(U,O,!0),V=ro(O,U),h=ej(h,V),O=[O[0]+i[0]*h,O[1]+i[1]*h,O[2]+i[2]*h],U=[U[0]-i[0]*h,U[1]-i[1]*h,U[2]-i[2]*h]),j=O,$=U;F.add({x:O[0],y:O[2],e:O[1]}),F.addAll(l),F.add({x:U[0],y:U[2],e:U[1]})}else{var o=Gf(R,D,E,W,p);if(R._19Q||(o=-o),W){var K=O[0],S=O[1],m=O[2],s=P.getTall()/2+o;j=[K-o,S+s,m],$=[K+o,S+s,m],F.add({x:K-o,y:m,e:S}),F.add({x:K-o,y:m,e:S+s}),F.add({x:K+o,y:m,e:S+s}),F.add({x:K+o,y:m,e:S})}else{i=Sb(U,O,!0),V=ro(O,U);var T={x:O[0],y:O[2]},r={x:U[0],y:U[2]},y=Bb(t,T,r,o),g=y.x-T.x,z=y.y-T.y;h=ej(h,V),i[0]*=h,i[1]*=h,i[2]*=h,j=[O[0]+i[0]+g,O[1]+i[1],O[2]+i[2]+z],$=[U[0]-i[0]+g,U[1]-i[1],U[2]-i[2]+z],B?(F.add({x:O[0],y:O[2],e:O[1]}),F.add({x:j[0],y:j[2],e:j[1]}),F.add({x:$[0],y:$[2],e:$[1]}),F.add({x:U[0],y:U[2],e:U[1]})):(F.add({x:j[0],y:j[2],e:j[1]}),F.add({x:$[0],y:$[2],e:$[1]}))}}G.c1=j,G.c2=$}G._lastPointsSegments={points:F,segments:H},G.list=d(Kd)===qk?R.createTubeModel(F,H,b/2,u):R.createLineModel(F,H,b,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=t}});var xh=function(Y,p){ml(xh,this,[Y,p])};Tr(xh,ce,{_80o:function(U,R,E){var J=this,M=J.gv,Y=J.shapeModel;um(M,J.mat),Y?Il(M,J.data,Y,J,J.getBodyColor(),E):(Yd(J,U,R,"left",E),Yd(J,U,R,"front",E),Yd(J,U,R,"right",E),Yd(J,U,R,"back",E),Yd(J,U,R,"top",E),Yd(J,U,R,"bottom",E)),Np(M)},validate:function(D,W){var g,a,e=this,U=e.s,C=e.data,v=(C.p3(),C._thickness/2),E=C.isClosePath(),x=C.getPoints(),B=C.getSegments(),N=U(Hb),P=D&&D.uv;if(e.clear(),0>v){try{a=e.shapeModel=le(x,B,U(ss),U(Kk),N,U(eh),C.getTall(),C.getShapeElevation(),E)}catch(M){a=e.shapeModel={}}U(Zm)?U("shape3d.image")||delete a.uv:(delete a.vs,delete a.ns,delete a.uv),U("shape3d.top.image")||delete a.top_uv,U("shape3d.bottom.image")||delete a.bottom_uv}else if(U(Kd)===qk)g=hr(x,B,N,E),a=e.shapeModel={vs:[]},U("shape3d.image")&&(a.uv=[],a.sum=U(eh)||ji(g)||1,a.len=0),U(ss)&&!E&&(a.top_vs=[],U("shape3d.top.image")&&(a.top_uv=[])),U(Kk)&&!E&&(a.bottom_vs=[],U("shape3d.bottom.image")&&(a.bottom_uv=[])),e._12O(g,v);else{var Q,I,L,$,_,X,G,s,y,S;if(g=hr(x,B,N,E),_=e.vf(Fl,P,!1,W),v&&(X=e.vf(jf,P,!1,W),G=E?t:e.vf(Ug,P,!1,W),s=E?t:e.vf(af,P,!1,W),y=e.vf(_j,P,!1,W),S=e.vf(mn,P,!1,W)),v){for(var w=0,T=g.length;T>w;w++)g[w]=e._tryRemoveBezierPoints(g[w],v);e._12O(g,v)}else _&&g.forEach(function(p){if($=p.length,$>0)for(Q=p[0],L=1;$>L;L++)I=p[L],e.addV(_.vs,Q,I),Q=I});e._20Q(g),D||(_&&(_.ns=Gq(_.vs),Sq(_,"vs"),Sq(_,wg)),v&&(X&&(X.ns=Gq(X.vs),Sq(X,"vs"),Sq(X,wg)),G&&(G.ns=Gq(G.vs),Sq(G,"vs"),Sq(G,wg)),s&&(s.ns=Gq(s.vs),Sq(s,"vs"),Sq(s,wg)),y&&(y.ns=Gq(y.vs),Sq(y,"vs"),Sq(y,wg)),S&&(S.ns=Gq(S.vs),Sq(S,"vs"),Sq(S,wg))))}var k=e.mat=C.getPointsMatrix3d().getElements();D&&(Yn(e,k,D,a),e.clear())},_20Q:function(O){var j,I,b,r,Y,X,z,P=this,D=P.front,G=P.back,w=P.top,F=P.bottom,_=D?D.tuv:t,$=G?G.tuv:t,A=w?w.tuv:t,x=F?F.tuv:t,q=0;(_||$||A||x)&&(j=P.s(eh)||ji(O)||1,O.forEach(function(y){if(I=y.length,I>0)for(X=y[0],b=1;I>b;b++)z=y[b],r=q/j,q+=ro(X,z),Y=q/j,P._14O(D,r,Y),P._14O(G,1-Y,1-r),P._14O(w,r,Y),P._14O(F,r,Y),X=z}))},_14O:function(Z,E,d){if(Z){var T=Z.uv,G=Z.tuv;if(G){if(T)var q=T[0]+(T[6]-T[0])*E,O=T[1]+(T[7]-T[1])*E,c=T[2]+(T[4]-T[2])*E,b=T[3]+(T[5]-T[3])*E,R=T[2]+(T[4]-T[2])*d,l=T[3]+(T[5]-T[3])*d,D=T[0]+(T[6]-T[0])*d,S=T[1]+(T[7]-T[1])*d;else q=E,O=0,c=E,b=1,R=d,l=1,D=d,S=0;G.push(c,b,R,l,D,S,D,S,q,O,c,b)}}},_13O:function(Q){var f=Q.uv,s=Q.tuv;s&&(f?s.push(f[2],f[3],f[4],f[5],f[6],f[7],f[6],f[7],f[0],f[1],f[2],f[3]):s.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(u,g){var m=u.length;if(4>m)return u;var v,s,K,C,q,P,J=!1,l=function(j){return u[j]},Q=function(o){return u[m-1-o]};for(q=0;1>=q;q++)for(P=q?Q:l,s=P(0),K=P(1),v=2;m-1>v;v++)if(C=P(v),!C.remove)if(C.b){var p=Bb(s,K,C,g);p.adjust?(C.remove=!0,J=!0):(s=K,K=C)}else s=K,K=C;if(!J)return u;var S=[];for(v=0;m>v;v++)u[v].remove||S.push(u[v]);return S},_12O:function(Q,A){var u,v,e,B,U,C=this.s("shape3d.point.epsilon"),w=this;Q.forEach(function(J){if(U=J.length,U>0)for(u={p:J[0],n:!0},B=1;U>B;B++)v=J[B],e=U-1>B?J[B+1]:t,e&&Math.abs(v.x-e.x)<C&&Math.abs(v.y-e.y)<C||w.addPoint(u,v,e,A,J)})},addPoint:function(u,P,d,$,m){var I,p,S,n,O,v,T,H,M,D=this,Q=u.p,G=u.f,l=u.b,r=D.s("shape3d.side")||Nh,k=D.s("shape3d.start.angle"),B=D.s("shape3d.sweep.angle"),Z=D.shapeModel,U=D.data.isClosePath();if(u.n&&(u.n=!1,G=U&&m.length>2?Bb(m[m.length-2],Q,P,$):Bb(t,Q,P,$),l=Be(Q,G),Z?Z.top_vs&&D._10O(l,G,r,k,B,Z.top_vs,Z.top_uv):(I=D.left)&&(D.addV(I.vs,l,G),D._13O(I))),p=d?Bb(Q,P,d,$):U&&m.length>2?Bb(Q,P,m[1],$):Bb(Q,P,t,$),S=Be(P,p),Z){var c,J,y=Z.vs,E=Z.uv,A=Z.sum;
for(E&&(c=Z.len/A,Z.len+=ro(Q,P),J=Z.len/A),v=D._9O(l,G,r,k,B),T=D._9O(S,p,r,k,B),H=0;r>H;H++)M=H+1,je(y,v[M]),je(y,T[H]),je(y,v[H]),je(y,T[H]),je(y,v[M]),je(y,T[M]),E&&(n=H/r,O=M/r,E.push(c,O,J,n,c,n,J,n,c,O,J,O));!d&&Z.bottom_vs&&D._10O(S,p,r,k,B,Z.bottom_vs,Z.bottom_uv,!0)}else!d&&(I=D.right)&&(D.addV(I.vs,p,S),D._13O(I)),(I=D.front)&&D.addV(I.vs,G,p),(I=D.back)&&D.addV(I.vs,S,l),(I=D.top)&&D.addH(I.vs,G,p,S,l,!0),(I=D.bottom)&&D.addH(I.vs,l,S,p,G);u.p=P,u.f=p,u.b=S},_10O:function(L,q,n,m,x,j,N,Y){var J,F,Z=this,k=Z.data,s=Z._9O(L,q,n,m,x),u=(L.x+q.x)/2,M=(L.y+q.y)/2,c=k.getShapeElevation(),_=0;for(_=0;n>_;_++)Y?(je(j,s[_]),je(j,s[_+1])):(je(j,s[_+1]),je(j,s[_])),je(j,[u,c,M]),N&&(Y?(J=z*(_+1)/n+m,F=z*_/n+m):(J=z*_/n+m,F=z*(_+1)/n+m),N.push(.5-.5*I(F),.5-.5*d(F),.5-.5*I(J),.5-.5*d(J),.5,.5))},_9O:function(E,f,L,A,y){var K,r,O=this,l=O.data,q=[],D=(E.x+f.x)/2,k=(E.y+f.y)/2,s=l.getTall()/2,v=l.getShapeElevation(),$=0;for(y==t&&(y=z);L>=$;$++)K=y*$/L+A,r=I(K),q.push([D+(E.x-D)*r,v+s*d(K),k+(E.y-k)*r]);return q},addV:function(x,p,f){var j=p.x,Q=p.y,A=f.x,s=f.y,i=this.data,h=i.getShapeElevation(),S=i.getTall()/2;x.push(j,h-S,Q,A,h-S,s,A,h+S,s,A,h+S,s,j,h+S,Q,j,h-S,Q)},addH:function(T,j,$,s,L,a){var g=this.data,G=g.getTall()/2,v=g.getShapeElevation()+(a?G:-G);T.push(j.x,v,j.y,$.x,v,$.y,s.x,v,s.y,s.x,v,s.y,L.x,v,L.y,j.x,v,j.y)},vf:function(f,N,r,U){var d,Y=this,S=Y.gv.getFaceVisible(Y.data,f);return(r||S)&&(d=to(Y,f,U),d.vs=[],d.tuv=S&&(d.texture||N)?[]:t,d.visible=S),d}});var og=function(w,t){ml(og,this,[w,t])};Tr(og,sn,{_25Q:1,validate:function(F){var C=this,s=C.data,k=C.s,$=s.getPoints(),Z=$.size();if((!C.s("geometry.cache")||!C.shapeModel)&&(C.shapeModel=C.info=t,Z>1)){var x=C.info={},m=s.getSegments(),B=s.getThickness(),Q=Dd($.get(0)),l=Dd($.get(Z-1)),v=Z%2;0===v?(x.c1=Dd($.get(Z/2-1)),x.c2=Dd($.get(Z/2))):x.p3=Dd($.get((Z-v)/2)),x.s1=Q,x.s2=Dd($.get(1)),x.t1=Dd($.get(Z-2)),x.t2=l,x.list=k(Kd)===qk?C.createTubeModel($,m,B/2,F):C.createLineModel($,m,B,"shape.border","shape.dash")}var X=s.p3(),a=C.mat=_d();vq(a,X),vm(a,s.getFinalRotation3d(),s.getRotationMode());var P=s.getScale3d(),A=s._dynamicScale3d;A&&(P[0]*=A[0],P[1]*=A[1],P[2]*=A[2]),Zd(a,P),vq(a,en(X))},invalidateCachedGeometry:function(){this.shapeModel=this.info=t},_80o:function(j,W,x){var u=this,i=u.shapeModel;if(i){var M=u.gv;um(M,u.mat),Il(M,u.data,i,u,u.getBodyColor(),x),Np(M)}}});var Hi=Y.graph3d.VR=function(w){var p=this;p.gv=w,p._controllers=[],p.switch=new bd(p),p._enable=!1,p._defaultCallLater=Y.Default.callLater,p._defaultCancelLater=Jc,"undefined"!=typeof i&&"VRFrameData"in i&&(p._frameData=new i.VRFrameData),p.measureOflength=1,p.eyesOffset=[0,0,0],p._orientation=new Y.Math.Quaternion,p._lastHeadPose=[0,0,0],p._offsetToBeAdd=[0,0,0],p._fpsInfo={time:0,fps:0,frames:0}};Tr(Hi,u,{ms_fire:!0,_42:function(j,l,H,k){var t=this,X=t.gv;if(!X.drawFilter&&t._deviceInAction){var P=t._device;if(P){var u=t._measureOflength;P.depthNear=X.getNear()*u,P.depthFar=X.getFar()*u;var F=t._offsetToBeAdd;if(t.eyesOffset[0]+=F[0],t.eyesOffset[1]+=F[1],t.eyesOffset[2]+=F[2],F[0]=0,F[1]=0,F[2]=0,P.isPresenting===!1)return t._controllers.forEach(function(Q){Q&&Q.update()}),X.iv(),!1;var m=t._frameData;P.getFrameData(m);var p=m.pose.position;if(p){var n=t.toViewPosition(p);X.setEye(n),t._orientation.fromArray(m.pose.orientation);var r=new Y.Math.Vector3(0,0,-10*t._scaleFactor);r.applyQuaternion(t._orientation),X.setCenter([n[0]+r.x,n[1]+r.y,n[2]+r.z])}t._controllers.forEach(function(U){U&&U.update()}),X.setViewport(j,0,0,l/2,H),t._viewMatrix=t._copyViewMatrix(m.leftViewMatrix),t._projectMatrix=t._copyProjectMatrix(m.leftProjectionMatrix),k(),X.setViewport(j,l/2,0,l/2,H),t._viewMatrix=t._copyViewMatrix(m.rightViewMatrix),t._projectMatrix=t._copyProjectMatrix(m.rightProjectionMatrix),k(),t._lastViewMatrix=t._viewMatrix,t._lastProjectMatrix=t._projectMatrix,t._viewMatrix=null,t._projectMatrix=null,t.submitFrame();var i=Date.now(),x=t._fpsInfo;return i-x.time>1e3?(x.fps=Math.round(1e3*(x.frames+1)/(i-x.time)),x.time=i,x.frames=0):x.frames++,!0}}},onVRDisplayPresentChange:function(){var O=this.isPresenting();this._injectGraphView(O),this.fp("present",!O,O)},getOrientation:function(){return this._orientation},addController:function(i){i=i||0;var k=this,l=k.getController(i);return l?l:(l=new Mk(k,i),k._controllers.push(l),l)},getController:function($){$=$||0;for(var t=this._controllers,l=0,U=t.length;U>l;l++)if(t[l]&&t[l].id===$)return t[l];return null},removeController:function(d){d=d||0;for(var m=this._controllers,I=0,K=m.length;K>I;I++)if(m[I]&&m[I].id===d)return m.splice(I,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(R,X){var Q=this,c=Q._scaleFactor,a=Q._eyesOffset,B=Q._lastHeadPose;return B[0]=R[0]*c,B[1]=R[1]*c,B[2]=R[2]*c,X?(X[0]=B[0]+a[0],X[1]=B[1]+a[1],X[2]=B[2]+a[2],X):[B[0]+a[0],B[1]+a[1],B[2]+a[2]]},addEyesOffset:function(M,g,i){var Q=this._offsetToBeAdd;Q[0]+=M,Q[1]+=g,Q[2]+=i},_copyViewMatrix:function(f){var h=this.dup(f),n=this._scaleFactor;h[12]*=n,h[13]*=n,h[14]*=n;var t=this._eyesOffset;if(t&&(t[0]||t[1]||t[2])){var m=t[0],q=t[1],S=t[2];h[12]-=h[0]*m+h[4]*q+h[8]*S,h[13]-=h[1]*m+h[5]*q+h[9]*S,h[14]-=h[2]*m+h[6]*q+h[10]*S}return h},shutdown:function(){var c=this._device;c&&c.isPresenting&&c.exitPresent()},isPresenting:function(){var R=this._device;return R&&R.isPresenting},_copyProjectMatrix:function(J){var S=this.dup(J),x=this._scaleFactor;return S[14]*=x,S},dup:function(T,h){for(var y=T.length,t=h||new Array(y);y--;)t[y]=T[y];return t},getViewMatrix:function(a){var V=this._viewMatrix;return V?this.dup(V,a):void 0},getProjectMatrix:function(){var j=this._projectMatrix;return j?this.dup(j):void 0},submitFrame:function(){var t=this;if(t._enable&&t._deviceInAction){var j=t._device;j&&j.isPresenting&&(j.submitFrame(),t.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(o){var j=this.gv;return j.intersectObjects(o,j.dm().getDatas())},setDevice:function(D){var j=this;j._device=D},_injectGraphView:function(){var j,r,K;return function(X){var u=this.gv;if(!X)return j&&(u.getWidth=j,u.getHeight=r,u.getDevicePixelRatio=K),void 0;var A=this._device,t=A.getEyeParameters("left"),s=t.renderWidth,w=t.renderHeight;j=u.getWidth,r=u.getHeight,K=u.getDevicePixelRatio,u.getWidth=function(){return 2*s},u.getHeight=function(){return w},u.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(U){var k=this;if(!U)return zs=Y.Default.callLater=k._defaultCallLater,Jc=Y.Default.cancelLater=k._defaultCancelLater,void 0;var k=this;zs=Y.Default.callLater=function(S,f,M,x){var g=k._device;return g&&g.isPresenting?x?Z(function(){zs(S,f,M)},x):g.requestAnimationFrame(function(){k._deviceInAction=!0,S.apply(f,M),k._deviceInAction=!1}):k._defaultCallLater(S,f,M,x)},Jc=Y.Default.cancelLater=function(x,I){var O=k._device;return O&&O.isPresenting?I?o(x):O.cancelAnimationFrame(x):k._defaultCancelLater(x,I)}}}),u.defineProperties(Hi.prototype,{enable:{get:function(){return this._enable},set:function(d){var p=this;p._enable!==d&&(p._enable=d,d?(p.switch.showButton(),p._injectCallLaterFunc(!0)):(p.shutdown(),p.switch.hideButton(),p._injectCallLaterFunc(!1)),p.fp("enable",!d,d))}},measureOflength:{get:function(){return this._measureOflength},set:function(e){this._measureOflength=e;var g=this._scaleFactor=1/e;this._controllers.forEach(function(E){E&&E._setScaleFactor(g)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(i){this._eyesOffset=i}},controllerModel:{get:function(){return this._controllerModel},set:function(G){var s;"object"==typeof G?(s=G.mtl,G=G.obj):(s=G+".mtl",G+=".obj");var g=this,I=g._controllerModel;I&&I.obj===G&&I.mtl===s||(I=g._controllerModel={obj:G,mtl:s},Q.loadObj(G,s,{finishFunc:function(s,D){g._controllerModel===I&&Q.setShape3dModel("vrControllerModel",D)}}))}},interactive:{get:function(){return!!this._interactive},set:function(L){!!L!=!!this._interactive&&(this._interactive=L,L&&this.addController(0),this.gv.getCoreInteractor().enableVR(L))}}});var Mk=function(i,$){function d(Z){var g=navigator.getGamepads&&navigator.getGamepads();if(g)for(var T=0,f=0,_=g.length;_>T;T++){var v=g[T];if(v){var S=v.id;if("OpenVR Gamepad"===S||0===S.indexOf("Oculus Touch")||S.indexOf("Controller")>=0){if(f===Z)return v;f++}}}}function L(f,L,d){return Math.abs(f[0]-L[0])<d&&Math.abs(f[1]-L[1])<d&&Math.abs(f[2]-L[2])<d?!0:!1}var c=this;c.vr=i,c.id=$;var P,k,o=[0,0],v=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],I=new Pc;I.s("shape3d","vrControllerModel"),I.isController=!0,I.s("intersect",!1),c.getGamepad=function(){return k},c.isButtonPressed=function(N){for(var W,X=0,s=v.length;s>X;X++)if(W=v[X],W.id===N)return W.pressed;return!1},c.getNode=function(){return I};var l=.003;c.setRotationEpsilon=function(o){l=o};var y=5e-4,u=y;c.setPositionEpsilon=function(O){y=O,u=O*c.vr._scaleFactor},c._setScaleFactor=function(q){I.s3(q,q,q),u=y*q},c._setScaleFactor(c.vr._scaleFactor);var K,s=new Dj,B=new de,X=[0,0,0],S=[0,0,0],T=new $o,x=new dc,W=new tk;c.getRay=function(){return K?(W.origin.fromArray(X),W.direction.copy(x),K=!1,W):W},c.update=function(){if(P=k,k=d($),P!=k&&console.log("gamepad changed",k),!k||k.pose===w)return k=null,I.s("3d.visible",!1),void 0;if(Q.getShape3dModel("vrControllerModel")){I.dm()||i.gv.dm().add(I),I.s("3d.visible",!0);var W=k.pose;if(null!==W){W.position&&(c.vr.toViewPosition(W.position,X),L(I.p3(),X,u)||(K=!0,I.p3(X))),W.orientation&&(s.fromArray(W.orientation),x.set(0,0,-1).applyQuaternion(s).normalize(),B.makeRotationFromQuaternion(s),T.set(0,0,0,I.getRotationMode(),!0).setFromRotationMatrix(B),S[0]=T.x,S[1]=T.y,S[2]=T.z,L(I.r3(),S,l)||(K=!0,I.r3(S))),K&&i.fp("gamepad.pose",null,{position:X,rotation:S,id:$});var A=k.axes;(o[0]!==A[0]||o[1]!==A[1])&&(o=[A[0],A[1]],i.fp("gamepad.axes",null,{id:$,axes:o}));var J,R,p,_,D=k.buttons;for(J=0,R=D.length;R>J;J++)if(p=D[J],p&&(_=p.pressed,v[J]||(v[J]={id:"button"+J,pressed:!1}),_!==v[J].pressed)){v[J].pressed=_;var t={id:$},F="state";t[F]=t._62O=_?"down":"up",i.fp("gamepad.button."+v[J].id,null,t)}}}}},bd=function(O){this.vr=O,this._button=null};Tr(bd,u,{showButton:function(){var L=this.assureButton();if(!L.parentNode){var A=this.vr.gv,N=A.getView();A._79O?N.insertBefore(L,A._79O):N.appendChild(L)}},hideButton:function(){var Z=this._button;Z&&Z.parentNode&&Z.parentNode.removeChild(Z)},assureButton:function(){var p=this._button;return p?p:this._button=this.createButton(this.vr.gv)},createButton:function(C){function J(k,U){k.textContent=U&&U.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function o(p){E.style.display="",E.style.cursor="pointer",E.style.left="calc(50% - 50px)",E.style.width="100px",J(E,p),E.onmouseenter=function(){E.style.opacity="1.0"},E.onmouseleave=function(){E.style.opacity="0.5"},E.onclick=function(){p.isPresenting?p.exitPresent():p.requestPresent([{source:C.getCanvas()}])},C.vr.setDevice(p)}function U(){E.style.display="",E.style.cursor="auto",E.style.left="calc(50% - 75px)",E.style.width="150px",J(E,null),E.onmouseenter=null,E.onmouseleave=null,E.onclick=null,C.vr.setDevice(null)}function A(U){U.style.position="absolute",U.style.bottom="20px",U.style.padding="12px 6px",U.style.border="1px solid #fff",U.style.borderRadius="4px",U.style.color="#000",U.style.font="normal 13px sans-serif",U.style.textAlign="center",U.style.opacity="0.5",U.style.outline="none",U.style.zIndex="999"}if("getVRDisplays"in navigator){var E=this._button=l.createElement("button");return E.style.display="none",A(E),b(i,"vrdisplayconnect",function(S){o(S.display)}),b(i,"vrdisplaydisconnect",function(){U()}),b(i,"vrdisplaypresentchange",function(G){J(E,G.display),C.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(l){l.length>0?o(l[0]):U()}),E}var u=l.createElement("a");return u.href="https://webvr.info",u.innerHTML="当前不支持 webvr",u.style.left="calc(50% - 90px)",u.style.width="180px",u.style.textDecoration="none",A(u),u}}),u.defineProperties(bd.prototype,{});var ib=Y.graph3d.PostProcessing=function(U){function R(){if(!V){var D=U.getGL();V=new Tn.RenderTarget(U,D,null,null,{samples:K.renderTextureSamples||1}),j=new rr.Shader(D,h.vs,h.fs),N=rr.Buffer.createIndexBuffer(D,new Uint16Array([0,2,1,1,2,3])),o=rr.Buffer.createVertexBuffer(D,new Float32Array([0,0,1,0,0,1,1,1]))}}var V,j,N,o,i=this,p={},f=!1;!function(){u.keys(ib).forEach(function(z){p[z]=new ib[z](U)})}(),i.getModule=function(r){return r?p[r]:i},i.getModuleList=function(){return u.keys(p)},i._serializable=!0,i.handleDataModleChange=function(V,E){V&&(i._serializable&&V.setPostProcessingData(i.serialize()),V.removeSerializeListener(i.onDataModelSerialize,i)),E&&(E.addSerializeListener(i.onDataModelSerialize,i),i._serializable&&i.deserialize(E.getPostProcessingData()))},i.onDataModelSerialize=function(Z){i._serializable&&("serialize"===Z.type?U.dm()._postProcessingData=i.serialize():"deserialize"===Z.type&&i.deserialize(U.dm().getPostProcessingData()))},i.isSerializable=function(){return i._serializable},i.setSerializable=function(M){i._serializable=M,M||U.dm().setPostProcessingData(w)},i.serialize=function(){var i,Y,J,B,v={};for(Y in p)if(J=p[Y],B=J.serializeProperties){i={},J.enable&&(i.enable=!0);for(var D in B){var o=J[D];o!=B[D]&&(i[D]=o)}u.keys(i).length&&(v[Y.toLowerCase()]=i)}return v},i.deserialize=function(g){var f,I,L,y,r,j={};if(g)for(I in g)if(I&&(f=I[0].toUpperCase()+I.slice(1),L=p[f])){j[f]=!0,y=g[I],i.enableModule(f,!!y.enable),L.resetProperties&&L.resetProperties();for(r in y)"enable"!==r&&(L[r]=y[r])}for(f in p)j[f]||(L=p[f],L.enable=!1,L.resetProperties&&L.resetProperties())},i.decodeShader=function(g){var H,Z,B,V="",h="";for(B=0;B<g.length;B++)H=g[B],"%"===H?H="'":"a"===H?H='"':"]"===H&&(H="\\"),Z=String.fromCharCode(H.charCodeAt(0)-1),B%2?h+=Z:V=Z+V;return h+V},i.createShader=function(R,e,N){var A=e.indexOf("^#"),$=i.decodeShader(e.substr(0,A)),F=i.decodeShader(e.substr(A+2));if(N){var j=N($,F);j&&j.vs&&($=j.vs),j&&j.fs&&(F=j.fs)}return new rr.Shader(R,$,F)},i.enableModule=function(F,r){var C,e,x,Z=F.split(",");for(C=0,e=Z.length;e>C;C++)x=Z[C].trim(),p[x]&&(p[x].enable=r);f=!1;for(x in p)if(p[x].enable){f=!0;break}f&&R()};var h={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};i._42=function(K,d,H,n,F){if(f&&!F){V.setSize(K,d,H),V.bind(K);var y=K.getParameter(K.COLOR_CLEAR_VALUE);y&&0===y[0]&&0===y[1]&&0===y[2]&&0===y[3]?y=null:Ch(K,[0,0,0,0]),K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),U.setViewport(K,0,0,d,H),n(),V.unbind(K);for(var s=0,C=U._glCapabilities.maxAttributes;C>s;s++)K.disableVertexAttribArray(s);var L,l=V;for(L in p)l=p[L]._42(K,l)||l;return U.setViewport(K,0,0,d,H),y&&Ch(K,y),K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),j.bind(),K.activeTexture(K.TEXTURE0+0),K.bindTexture(K.TEXTURE_2D,l.texture),j.uniforms.image=0,N.upload(),o.upload(),j.attributes.pos.pointer(o),K.drawElements(K.TRIANGLES,6,K.UNSIGNED_SHORT,0),K.bindTexture(K.TEXTURE_2D,null),K.useProgram(U._prg),!0}}},Eq=Y.graph3d.PostProcessing.Bloom=function(j){function r(){var I=j.getGL();if(I)for(var P=j._postProcessing,Z=0;t>Z;Z++)_[Z]=P.createShader(I,Eq._35Q,function(d,Q){return{fs:Q.replace(/DEFINE_VALUE/g,J[Z]).replace("%OVERRIDE_ALPHA_DEFINE%",X?"#define OVERRIDE_ALPHA":"")}})}function E(){var m=j.getWidth(),O=j.getHeight();if(m&&O){F=[m,O],s=!0;var h,q=j.getGL(),W=Math.round(F[0]/2),x=Math.round(F[1]/2);for(G=new Tn.RenderTarget(j,q,W,x),h=0;t>h;h++)V.push(new Tn.RenderTarget(j,q,W,x)),S.push(new Tn.RenderTarget(j,q,W,x)),W=Math.round(W/2),x=Math.round(x/2);var v=j._postProcessing;b=v.createShader(q,Eq._34Q),r(),f=v.createShader(q,Eq._36Q,function(N,l){return{fs:l.replace(/NUM_MIPS/g,t)}}),B=v.createShader(q,Eq.finalShader),p=rr.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),Z=rr.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))}}var l,H,g,X,p,Z,U=this,w=!1,s=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var K=this.serializeProperties;for(var n in K)this[n]=K[n]},u.defineProperties(U,{enable:{get:function(){return w},set:function(G){!!w!=!!G&&(w=G,G&&!s&&E(),j.iv())}},strength:{get:function(){return l},set:function($){l!==$&&(l=$,j.iv())}},threshold:{get:function(){return H},set:function(o){H!==o&&(H=o,j.iv())}},radius:{get:function(){return g},set:function(r){g!==r&&(g=r,j.iv())}},overrideAlpha:{get:function(){return X},set:function(b){!!X!=!!b&&(X=b,s&&r(),j.iv())}}}),this.resetProperties();var G,b,f,B,F=[256,256],V=[],S=[],t=5,J=[3,5,7,9,11],_=[];U._42=function(h,L){function M(V,o,t,g){Pi(h,o.frame),j.setViewport(h,0,0,o.width,o.height),g?g(h):h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),O!==V&&V.bind();var W=0;for(var S in t){var w=t[S];w instanceof WebGLTexture&&(h.activeTexture(h.TEXTURE0+W),h.bindTexture(h.TEXTURE_2D,w),w=W,W++),V.uniforms[S]=w}for(O!==V&&(p.upload(),Z.upload(),V.attributes.pos.pointer(Z),O=V),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);W--;)h.activeTexture(h.TEXTURE0+W),h.bindTexture(h.TEXTURE_2D,null);nr(h)}if(w&&(s||(E(),s))){var O;M(b,G,{smoothWidth:.01,luminosityThreshold:H,tDiffuse:L.texture});var u,K=G,v=Math.round(F[0]/2),d=Math.round(F[1]/2);for(u=0;t>u;u++)M(_[u],V[u],{colorTexture:K.texture,direction:[1,0],texSize:[v,d]}),M(_[u],S[u],{colorTexture:V[u].texture,direction:[0,1],texSize:[v,d]}),v=Math.round(v/2),d=Math.round(d/2),K=S[u];return M(f,V[0],{blurTexture1:S[0].texture,blurTexture2:S[1].texture,blurTexture3:S[2].texture,blurTexture4:S[3].texture,blurTexture5:S[4].texture,bloomStrength:l,bloomRadius:g,bloomTintColor:[1,1,1]}),M(B,L,{image:V[0].texture},function(L){L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.SRC_ALPHA,L.ONE)}),h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA),L}}};Eq._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Eq._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Eq._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Eq.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var wo=Y.graph3d.PostProcessing.Dof=function(T){function y(){s=!0;var a=T.getGL();d=new Tn.RenderTarget(T,a),f=T._postProcessing.createShader(a,wo._38Q),e=rr.Buffer.createIndexBuffer(a,new Uint16Array([0,2,1,1,2,3])),j=rr.Buffer.createVertexBuffer(a,new Float32Array([0,0,1,0,0,1,1,1]))}var d,f,e,j,K,x,h,Q,b=this,F=!1,s=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var w=this.serializeProperties;for(var b in w)this[b]=w[b]},u.defineProperties(b,{enable:{get:function(){return F},set:function(f){!!F!=!!f&&(F=f,f&&!s&&y(),T.iv())}},image:{get:function(){return x},set:function($){x!==$&&(x=$,K&&(T.getGL().deleteTexture(K),K=null),T.iv())}},maxblur:{get:function(){return h},set:function(S){h!==S&&(h=S,T.iv())}},aperture:{get:function(){return Q},set:function(D){Q!==D&&(Q=D,T.iv())}}}),this.resetProperties(),b._42=function(k,G){function A(P,y,A,Y){Pi(k,y.frame),T.setViewport(k,0,0,y.width,y.height),Y?Y(k):k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),V!==P&&P.bind();var s=0;for(var E in A){var o=A[E];o instanceof WebGLTexture&&(k.activeTexture(k.TEXTURE0+s),k.bindTexture(k.TEXTURE_2D,o),o=s,s++),P.uniforms[E]=o}for(V!==P&&(e.upload(),j.upload(),P.attributes.pos.pointer(j),V=P),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0);s--;)k.activeTexture(k.TEXTURE0+s),k.bindTexture(k.TEXTURE_2D,null);nr(k)}if(F){s||y();var V;if(!K){var h=ir(this.image);if(!h||!h.tagName)return G;K=sq(k,h)}var B=G.width,z=G.height;if(B&&z)return d.setSize(k,B,z),A(f,d,{tColor:G.texture,tDepth:K,aspect:B/z,aperture:this.aperture,maxblur:this.maxblur}),d}}};wo._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",oi(Q,{accordionViewExpandIcon:os(pk),accordionViewCollapseIcon:os(pk,!0),accordionViewLabelColor:Ef,accordionViewLabelFont:Vq,accordionViewTitleBackground:Yp,accordionViewSelectBackground:ng,accordionViewSelectWidth:3,accordionViewSeparatorColor:w,splitViewDividerSize:1,splitViewDividerBackground:Yp,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:vn,rect:[2,2,12,12],background:pk}]},propertyViewLabelColor:hj,propertyViewLabelSelectColor:Ef,propertyViewLabelFont:Vq,propertyViewExpandIcon:os(ak),propertyViewCollapseIcon:os(ak,!0),propertyViewBackground:Uk,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:wj,propertyViewColumnLineColor:wj,propertyViewSelectBackground:ng,listViewLabelColor:hj,listViewLabelSelectColor:Ef,listViewLabelFont:Vq,listViewRowLineVisible:!1,listViewRowLineColor:wj,listViewSelectBackground:ng,treeViewLabelColor:hj,treeViewLabelSelectColor:Ef,treeViewLabelFont:Vq,treeViewExpandIcon:os(Sj),treeViewCollapseIcon:os(Sj,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:wj,treeViewSelectBackground:ng,treeViewDoubleClickToToggle:!0,tableViewLabelColor:hj,tableViewLabelSelectColor:Ef,tableViewLabelFont:Vq,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:wj,tableViewColumnLineColor:wj,tableViewSelectBackground:ng,treeTableViewLabelColor:hj,treeTableViewLabelSelectColor:Ef,treeTableViewLabelFont:Vq,treeTableViewExpandIcon:os(Sj),treeTableViewCollapseIcon:os(Sj,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:wj,treeTableViewColumnLineColor:wj,treeTableViewSelectBackground:ng,tableHeaderLabelColor:hj,tableHeaderLabelFont:Vq,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:cq,tableHeaderBackground:Uk,tableHeaderMoveBackground:gj,tableHeaderInsertColor:ng,tableHeaderSortDescIcon:ap(ak,!0),tableHeaderSortAscIcon:ap(ak),tabViewTabGap:1,tabViewLabelColor:Ef,tabViewLabelFont:Vq,tabViewTabBackground:Yp,tabViewSelectWidth:3,tabViewSelectBackground:ng,tabViewMoveBackground:gj,tabViewInsertColor:ng,toolbarLabelColor:hj,toolbarLabelSelectColor:Ef,toolbarLabelFont:Vq,toolbarBackground:Uk,toolbarSelectBackground:ng,toolbarItemGap:8,toolbarSeparatorColor:ws},!0);var Xj={translateX:1,sortColumn:1},Cg={sortable:1,sortOrder:1,sortFunc:1},ud={focusData:1},Cp={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ze={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},yn=function(P,I){I.add(P),P.hasChildren()&&P.eachChild(function(_){yn(_,I)})},zo=function(G,s,p,q,X,O,U,b,K,V,C){var _,S=p.getValueType(V),j=p.getAlign(V);if(p.getEnumValues(V)){var a=p.toEnumLabel(s,V),c=co||0,k=0,x=O,F=Q.getTextSize(q,a).width;return _=ir(p.toEnumIcon(s,V)),_&&(k=O+co/2,"center"===j?k+=(b-(c+F))/2:"right"===j&&(k=k+b-(c+F)),ld(G,_,k,U+K/2,V,C),x=k+co/2),a!=t&&(_?rd(G,a,q,X,x,U,b-(x-O),K):rd(G,a,q,X,O,U,b,K,j)),void 0}return s=p.formatValue(s),s!=t?S===kg?(Qf(G,O,U,b,K,s),void 0):S===Wg||!S&&mi(s)?(_=ir(s?Kr:ys),ld(G,_,O+b/2,U+K/2,V,C),void 0):(rd(G,s,q,X,O,U,b,K,j),void 0):void 0},Bd=function(m,Y){var s=Y.view,N=Le(m),t=Y.column||Y.property;s.getDataModel().beginTransaction(),Y.editor=m,m.info=Y,s.setCurrentEditor(m),s.getView().insertBefore(N,s._79O),Km(m,Y.editorRect),m.setFocus?m.setFocus():mg(m),m.commitValue=function(M,C){m._17Q&&(m=m._17Q),C||s.setValue(Y.data,t,m.getValue?m.getValue():m.value),m.close&&m.close(),ig(N)},t.onEditorCreated&&t.onEditorCreated(Y)},lq=function(v,B,j,$,o){var p=Io(v,j),V=B.value,L=B.view,z=o.getValueType(B.data);return p.onblur=p.onchange=function(){L.endEditing()},"input"===v?(V=o.formatValue(V),V!=t&&(p.value=V),p.onkeydown=function(F){sf(F)?L.endEditing():Fd(F)&&L.endEditing(!0)},(z===Pb||z===Aq)&&b(p,xj,Q.numberListener)):v===hm&&$.forEach(function(A){var e=l.createElement("option");e.innerHTML=o.toEnumLabel(A),e.value=A,o.isEnumEqual(V,A)&&(e.selected=!0),zg(p,e)}),Bd(p,B),p
},kk=Y.widget={},Vm=function(n,a,$){Tr(g+".widget."+n,a,$)};oi(yb,{ms_value:function($){$.getValue=function(R){var O=this.getItemById(R),y=O.element;return vh(y)?y:y?y.getValue?y.getValue():y.value:O.selected},$.setValue=function(t,s){var u=this.getItemById(t);if(u){var z=u.element;z&&!vh(z)?z.setValue?z.setValue(s):z.value=s:mi(s)?(u.selected=s,this.iv()):(u.element=s,this.iv())}},$.v=function(G,Z){var W=this;if(2===arguments.length)W.setValue(G,Z);else{if(!ao(G))return W.getValue(G);for(var v in G)W.setValue(v,G[v])}return W}},_46o:function(J){J._icon=t,J._accessType=t,J._valueType=t,J._editable=!1,J._batchEditable=!0,J._align=Ug,J._nullable=!0,J._emptiable=!1,J.setParent=ds,J.formatValue=function(p){var F=this,v=F._valueType;return F.getEnumValues()?F.toEnumLabel(p):v===Wg?!!p:p!=t&&v===Pb?y(p):p},J.setEnum=function(i,h,m,b,o,r,g){var x=this;i&&!Cl(i)&&i.values&&(b=i.editable,m=i.icons,h=i.labels,o=i.strict,r=i.maxHeight,g=i.dropDownWidth,i=i.values),Pr(i)&&(i=i._as),Pr(h)&&(h=h._as),Pr(m)&&(m=m._as),x._enumValues=i,x._enumLabels=h,x._enumIcons=m,x._enumEditable=b,x._enumStrict=o==t?!0:o,x._enumMaxHeight=r,x._enumDropDownWidth=g,i&&i.length&&Td(i[0])&&(x._valueType=Aq),x.fp("enum",!1,!0)},J.getEnumDropDownWidth=function(){return this._enumDropDownWidth},J.getEnumMaxHeight=function(){return this._enumMaxHeight},J.isEnumEditable=function(){return this._enumEditable},J.getEnumValues=function(){return this._enumValues},J.getEnumLabels=function(){return this._enumLabels},J.getEnumIcons=function(){return this._enumIcons},J.isEnumStrict=function(){return this._enumStrict},J.isEnumEqual=function(c,j){return this._enumStrict?c===j:c==j},J.toEnumLabel=function($,Z){var _=this,O=_.getEnumValues(Z),w=_.getEnumLabels(Z);if(O&&w)for(var D=0;D<O.length;D++)if(_.isEnumEqual($,O[D]))return w[D];return $},J.toEnumIcon=function(o,X){var G=this,W=G.getEnumValues(X),_=G.getEnumIcons(X);if(W&&_)for(var f=0;f<W.length;f++)if(G.isEnumEqual(o,W[f]))return _[f];return w}},_45o:function(B){B._87o=function(h,u,E,z,S,o){if(h){var W=this,n=W._90I,p=wc(1);W._columnLineVisible&&(S-=1),W._rowLineVisible&&(o-=1),0>=S||0>=o||(W._90I||(n=W._90I={}),n[u]||(n[u]=new ls),Km(p,W.tx()+E,W.ty()+z,S,o),zg(p,h),W._view.insertBefore(p,W._79O),h.onParentAdded&&h.onParentAdded(p),n[u].add(p))}},B._76o=function(){var T=this,v=T._90I;if(v){for(var u in v)v[u].each(function(l){ig(l)});delete T._90I}},B._77o=function(s){var O=this;if(O._90I){var S=O._90I[s];S&&(S.each(function(g){ig(g)}),delete O._90I[s])}}},_47o:function(l){l.getValue=function($,p){return p.getValue?p.getValue($,p,this):Oe($,p.getAccessType(),p.getName())},l.setValue=function(n,V,u){if(V.isEmptiable(n)||""!==u||(u=w),V.isNullable(n)||u!=t){var y=this,H=V.getName(n),c=V.getAccessType(n),h=V.getValueType(n);h===Pb&&vh(u)?u=F(u):h===Aq&&vh(u)?u=parseFloat(u):h===Wg&&vh(u)&&(u="true"===u),y._batchEditable&&V._batchEditable&&y.isSelected(n)?y.sm().each(function(U){V.setValue?V.setValue(U,V,u,y):jp(U,c,H,u)}):V.setValue?V.setValue(n,V,u,y):jp(n,c,H,u)}},l.setCurrentEditor=function(J){this.endEditing(),this._currentEditor=J,this.redraw()},l.isEditing=function(T,I){var $=this,X=$._currentEditor;if(!X)return!1;if(I){var n=X.info;return n?(n.column||n.property)===I&&n.data===T:!1}return!0},l.endEditing=function(o){var y=this,r=y._currentEditor;r&&(delete y._currentEditor,r.commitValue&&r.commitValue(r.info,o),y.redraw(),y.getDataModel().endTransaction())},l.beginEditing=function(h){this.endEditing();var C=this,F=h.column||h.property;if(F.beginEditing)F.beginEditing(h);else{var l=h.data,Y=h.value,E=C.getSelectBackground(l),r=F.getEnumValues(l),M=F.getSlider(l),d=F.getColorPicker(l);if(M){var N=dq(kk.Slider,M);return N.setValue(Y),N.getView().onblur=function(){C.endEditing()},N.isInstant()&&(N.onValueChanged=function(){C.setValue(l,F,N.getValue())}),Bd(N,h),void 0}if(d||F.getValueType(l)===kg){var o=dq(kk.ColorPicker,d);return o.setValue(Y),o.onClosed=function(){C.endEditing()},o.isInstant()&&(o.onValueChanged=function(z,N){C.setValue(l,F,N)}),Bd(o,h),o.open(),void 0}if(r){if(kk.ComboBox){var O=new kk.ComboBox;O.setValue(Y),O.setValues(r),O.setLabels(F.getEnumLabels(l)),O.setIcons(F.getEnumIcons(l)),O.setEditable(F.isEnumEditable(l)),O.setStrict(F.isEnumStrict(l)),O.setMaxHeight(F.getEnumMaxHeight(l)),O.setDropDownWidth(F.getEnumDropDownWidth(l)),O.onClosed=function(){C.endEditing()},Bd(O,h),O.open()}else lq(hm,h,E,r,F);return}var A=F.getValueType(l);if(A===Wg||mi(Y))return C.setValue(l,F,!Y),void 0;if(F.getItemEditor(l)){var s=Nb(F.getItemEditor(l)),n=new s(l,F,C,h),q=n.getView();return q._17Q=n,n.setValue(Y),uo(q),Bd(q,h),n.editBeginning&&n.editBeginning(),void 0}lq("input",h,E,t,F)}}},_44o:function(c){c.init=function(q){var E=this,g=E.th=new Gk(q),j=E._view=yo(1,E);E.tv=E._tableView=q,zg(j,g.getView()),zg(j,q.getView()),g.mp(function(p){p.property===Lm&&E.iv()}),E.iv()},c.getTableView=function(){return this.tv},c.getTableHeader=function(){return this.th},c.getDataModel=function(){return this.tv.dm()},c.getColumnModel=function(){return this.tv.getColumnModel()},c.setColumns=function(Z){this.tv.setColumns(Z)},c.addColumns=function(g){this.tv.addColumns(g)},c.endEditing=function(){this.tv.endEditing()},c.validateImpl=function(){var n=this,K=n.th,D=zd(K),V={x:0,y:0,width:n.getWidth(),height:D};Km(K,V),V.y=D,V.height=q(0,n.getHeight()-D),Km(n.tv,V)}},ms_vs:function(V){V._41o=function(){return this._29I.height<this._59I},V._43o=function(){var E=this;E._41o()&&(E._58I||(Z(function(){E._94O()},Uo),E.iv()),E._58I=new Date)},V._94O=function(){var h=this;if(h._58I){var g=new Date;g.getTime()-h._58I.getTime()>=Uo?(delete h._58I,h.iv()):Z(function(){h._94O()},Uo)}},V._93I=function(){var c=this,T=c._27I;if(c._58I||!c._autoHideScrollBar){T||zg(c._79O,T=c._27I=wc());var Y=c._29I,q=Y.height,C=c._59I,f=c.getScrollBarSize(),u=Y.width-f-2,d=q*(-c.ty()/C),p=q*(q/C),_=T.style;C>q?(fl>p&&(d=d+p/2-fl/2,0>d&&(d=0),d+fl>q&&(d=q-fl),p=fl),_.visibility=Xe,_.background=c.getScrollBarColor(),_.borderRadius=f/2+yr,Km(T,u,d,f,p)):_.visibility=Vp}else T&&(T.style.visibility=Vp)}},ms_hs:function(L){L._40o=function(){return this._29I.width<this._91I},L._42o=function(){var k=this;k._40o()&&(k._95O||(Z(function(){k._94I()},Uo),k.iv()),k._95O=new Date)},L._94I=function(){var l=this;if(l._95O){var p=new Date;p.getTime()-l._95O.getTime()>=Uo?(delete l._95O,l.iv()):Z(function(){l._94I()},Uo)}},L._92I=function(){var c=this,E=c._28I;if(c._95O||!c._autoHideScrollBar){E||zg(c._79O,E=c._28I=wc());var s=c._29I,f=s.width,k=c._91I,v=c.getScrollBarSize(),K=s.height-v-2,a=f*(-c.tx()/k),I=f*(f/k),L=E.style;k>f?(fl>I&&(a=a+I/2-fl/2,0>a&&(a=0),a+fl>f&&(a=f-fl),I=fl),L.visibility=Xe,L.background=c.getScrollBarColor(),L.borderRadius=v/2+yr,Km(E,a,K,I,v)):L.visibility=Vp}else E&&(E.style.visibility=Vp)}}}),Vb(Kr,fr(16,16,[{type:_m,rect:[1,1,14,14],background:ng},{type:Ko,rect:[1,1,14,14],width:1,color:Vi},{type:Fc,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Vb(ys,fr(16,16,{type:Ko,rect:[1,1,14,14],width:1,color:Vi})),Vb(Jf,fr(16,16,[{type:vb,rect:[2,2,12,12],borderWidth:1,borderColor:Vi,background:"#FFF"},{type:vb,rect:[4,4,8,8],background:ng}])),Vb(Eb,fr(16,16,{type:vb,rect:[2,2,12,12],borderWidth:1,borderColor:Vi})),yb._15Q=function(_){_._29I=xq,_._59I=0,_._91I=0,_._5o=function(Z){var r=this;r._30I=new ls,r._rows=new ls,r._rowMap={},r._31I=0,r._14I=0,r._view=yo(1,r),r._canvas=Yh(r._view),zg(r._view,r._79O=wc()),r.dm(Z?Z:new Jg)},_.getCheckIcon=function(d){var D=this.sm(),t=D.co(d);return D.sg()?ir(t?Jf:Eb):ir(t?Kr:ys)},_.checkData=function(l){var j=this.sm(),V=j.co(l);j.sg()&&V||(this._32o=1,V?j.rs(l):j.as(l),delete this._32o)},_.getDataAt=function(o){o.target&&(o=this.lp(o));var r=E(o.y/this._rowHeight),x=this._rows;return 0>r||r>=x.size()?t:x.get(r)},_.onDataDoubleClicked=function(){},_.onDataClicked=function(){},_.adjustTranslateX=function(){return 0},_.adjustTranslateY=function(d){var h=this.getHeight()-this._59I;return h>d&&(d=h),d>0?0:y(d)},_.onPropertyChanged=function(c){var U=this,H=c.property;Cp[H]?U.ivm():ud[H]||U.redraw(),H===_q?U._42o():H===Go&&U._43o()},_.getLabel=function(t){return t.toLabel()},_.getLabelFont=function(){return this._labelFont},_.getLabelColor=function(e){var C=this;if(C.isCheckMode()){if(C._focusData===e)return C._labelSelectColor}else if(C.isSelected(e))return C._labelSelectColor;return C._labelColor},_.getStartRowIndex=function(){return this._31I},_.getEndRowIndex=function(){return this._14I},_.getRowDatas=function(){return this._rows},_.getRowIndex=function(E){return this._rowMap[E._id]},_.getRowSize=function(){return this._rows.size()},_.getViewRect=function(){return kr(this._29I)},_.isVisible=function(H){return this._visibleFunc?this._visibleFunc(H):!0},_.getCurrentSortFunc=function(){return this._sortFunc},_.setDataModel=function(Z){var L=this,o=L._dataModel,N=L._selectionModel;o!==Z&&(o&&(o.umm(L.handleDataModelChange,L),o.umd(L.handleDataPropertyChange,L),o.umh(L.handleHierarchyChange,L),N||o.sm().ums(L.handleSelectionChange,L)),L._dataModel=Z,Z.mm(L.handleDataModelChange,L),Z.md(L.handleDataPropertyChange,L),Z.mh(L.handleHierarchyChange,L),N?N._21I(Z):Z.sm().ms(L.handleSelectionChange,L),L.fp("dataModel",o,Z))},_.validateModel=function(){var $=this;$._rows.clear(),$._rowMap={},$.buildChildren($._dataModel._roots);var C=$._rows=$._rows.toList($.isVisible,$),R=0,u=$.getCurrentSortFunc(),P=C.size();for(u&&C.sort(u);P>R;R++)$._rowMap[C.get(R)._id]=R},_.buildChildren=function(b){var c=this;b.each(function(S){c._rows.add(S),c.buildChildren(S._children)})},_.handleDataModelChange=function(){this.ivm()},_.handleDataPropertyChange=function(q){"parent"===q.property?this.ivm():this.invalidateData(q.data)},_.handleHierarchyChange=function(){this.ivm()},_.handleSelectionChange=function(L){L.datas.each(this.invalidateData,this),this.onSelectionChanged(L)},_.onSelectionChanged=function(_){var m=this,P=m.sm();!m.isAutoMakeVisible()||1!==P.size()||"set"!==_.kind&&"append"!==_.kind||m._32o||m.makeVisible(P.ld())},_.handleBackgroundClick=function(I){Ir(I)&&!this.isCheckMode()&&this.sm().cs()},_.makeVisible=function(O){O&&(this._23I=O,this.iv())},_.scrollToIndex=function(i){var e=this,p=e._29I,l=p.height,r=e._rowHeight,N=r*i;i>=0&&i<e._rows.size()&&l>0&&(N+r>p.y+l?e.ty(-N+l-r):N<p.y&&e.ty(-N))},_.autoScroll=function(E,f){var d=this,X=d._rowHeight,g=X,z=X/4,G=d._29I,W=d.lp(E),r={x:d.tx(),y:d.ty()};return X>0&&G&&(W.x-G.x<g?d.translate(z,0):G.x+G.width-W.x<g&&d.translate(-z,0),W.y-G.y<g?d.translate(0,z):G.y+G.height-W.y<g&&d.translate(0,-z)),r.x=d.tx()-r.x,r.y=d.ty()-r.y,f&&(f.x+=r.x,f.y+=r.y),r},_.getTopRowOrderSelection=function(){var q=this.sm().getTopSelection(),O={},E=new ls;return q.each(function(f){O[f._id]=f}),this._rows.each(function(H){O[H._id]&&E.add(H)}),E},_.getRowOrderSelection=function(){var X=new ls;return this._rows.each(function(f){this.isSelected(f)&&X.add(f)},this),X},_.ivm=function(){this.invalidateModel()},_.invalidateModel=function(){var Z=this;Z._96I||(Z._96I=1,Z._32I=1,delete Z._24I),Z.iv()},_.redraw=function(){var A=this;A._32I||(A._32I=1,delete A._24I,A.iv())},_.invalidateData=function(b){var X=this;Hg?X.redraw():X._32I||(X._24I||(X._24I={}),X._24I[b._id]=b,X.iv())},_.getFocusData=function(){return this._focusData},_.setFocusDataById=function(t){this.setFocusData(this.dm().getDataById(t))},_.setFocusData=function(k){var o=this,F=o._focusData;F!==k&&(o._focusData=k,o.fp("focusData",F,k),F&&o.invalidateData(F),k&&(o.invalidateData(k),o.isAutoMakeVisible()&&o.makeVisible(k)))},_.drawRowBackground=function(u,O,r,T,t,H,V){var Z=this,W=Z.isCheckMode();(O===Z._focusData&&W||r&&!W)&&Qf(u,T,t,H,V,Z.getSelectBackground(O))},_.drawData=function(G,r,F){var J=this,T=J._rowHeight,t=T*F,S=J._29I,s=S.x,H=S.width;G.save(),G.beginPath(),G.rect(s,t,H,T),G.clip(),J._87o(J.drawRow(G,r,J.isSelected(r),s,t,H,T),F,s,t,H,T),G.restore(),J._rowLineVisible&&Qf(G,s,t+T-1,H,1,J._rowLineColor)},_._12I=function(y){var R=this,G=R._31I,$=R._29I,w=$.x,N=$.y,i=$.width,u=$.height;for(y.beginPath(),y.rect(w,N,i,u),y.clip(),y.clearRect(w,N,i,u),R._76o(),R._93db(y);G<R._14I;G++)R.drawData(y,R._rows.get(G),G);R._92db(y)},_._13I=function(M){for(var N,p=this,R=p._rowHeight,c=p._29I,h=c.x,T=c.width,x=p._31I,E=p._30I;x<p._14I;x++)N=p._rows.get(x),p._24I[N._id]&&E.add({data:N,index:x});E.isEmpty()||(M.beginPath(),E.each(function(U){M.rect(h,U.index*R,T,R)}),M.clip(),E.each(function(i){M.clearRect(h,i.index*R,T,R)}),E.each(function(r){p._77o(r.index)}),p._93db(M),E.each(function(R){p.drawData(M,R.data,R.index)}),p._92db(M),E.clear())},_.preValidateModel=function(){this.endEditing&&this.endEditing()},_.validateImpl=function(){var $=this,B=$._canvas,Q=$.getWidth(),C=$.getHeight(),h=$._rowHeight,k=$._32I;(Q!==B.clientWidth||C!==B.clientHeight)&&(ik(B,Q,C),k=1);var G=U&&!x;$._96I&&!G&&($.preValidateModel(),$.validateModel());var z=$._29I,T={x:-$.tx(),y:-$.ty(),width:Q,height:C},d=$._rows.size(),j=ck(B),a=$._23I;k||nn(T,z)||(k=1),$._29I=T,$._59I=d*h+$.getScrollBarSize(),$._31I=E(T.y/h),$._14I=m((T.y+T.height)/h),$._31I<0&&($._31I=0),$._14I>d&&($._14I=d),$._99I&&k&&$._99I(),ko(j,$.tx(),$.ty(),1),k?$._12I(j):$._24I&&$._13I(j),$._93I(),$._92I(),j.restore(),$._32I=$._24I=$._96I=t,a&&($.scrollToIndex($.getRowIndex(a)),delete $._23I),$.tx($.tx()),$.ty($.ty())}},yb._48o=function(s){s._rootVisible=!0,s._rootData=t,s._35o=function(){this._expandMap={},this._levelMap={}},s.validateModel=function(){var K=this,N=K._rootData;K._rows.clear(),K._levelMap={},K._rowMap={},K._currentLevel=0,N?K._rootVisible?K.isVisible(N)&&K.buildData(N):K.buildChildren(N):K.buildChildren(),delete K._currentLevel},s.buildData=function(A){var t=this,R=A._id,H=t._rows;t._rowMap[R]=H.size(),H.add(A),t._levelMap[R]=t._currentLevel,t.isExpanded(A)&&(t._currentLevel++,t.buildChildren(A),t._currentLevel--)},s.buildChildren=function(W){var E=this,v=W?W._children:E._dataModel._roots,o=E.getCurrentSortFunc();o&&E.isChildrenSortable(W)?v.toList(E.isVisible,E).sort(o).each(E.buildData,E):v.each(function(p){E.isVisible(p)&&E.buildData(p)})},s.getLevel=function(Z){return this._levelMap[Z._id]},s.getToggleIcon=function(b){var N=this,F=N._loader,G=N._collapseIcon;return F&&!F.isLoaded(b)?G:b.hasChildren()?N.isExpanded(b)?N._expandIcon:G:t},s.isCheckMode=function(){return this._checkMode!=t},s.isChildrenSortable=function(){return!0},s.handleDataModelChange=function(A){var N=this;A.kind===Ii?delete N._expandMap[A.data._id]:A.kind===_p&&(N._expandMap={}),N.ivm()},s.toggle=function(N){var r=this;r.isExpanded(N)?r.collapse(N):r.expand(N)},s.isExpanded=function(a){return 1===this._expandMap[a._id]},s.expand=function(E){var D=this,m=D._loader;D.isExpanded(E)||(m&&!m.isLoaded(E)&&m.load(E),D._expandMap[E._id]=1,D.ivm(),D.onExpanded(E))},s.onExpanded=function(){},s.collapse=function(m){var s=this;s.isExpanded(m)&&(delete s._expandMap[m._id],s.ivm(),s.onCollapsed(m))},s.onCollapsed=function(){},s.expandAll=function(h){if(h)this.expand(h),h.eachChild(function(b){this.expandAll(b)},this);else{var H=this;H._dataModel.each(function(E){E.hasChildren()&&(H._expandMap[E._id]=1)}),H.ivm()}},s.collapseAll=function(){this._expandMap={},this.ivm()},s.makeVisible=function(P){if(P){var z=this;if(!z._rootData||P.isDescendantOf(z._rootData)){for(var _=P._parent;_;)z.expand(_),_=_._parent;z._23I=P,z.iv()}}},s.checkData=function(t){var N,A=this,u=A._checkMode,b=A.sm(),V=b.co(t);if(!b.sg()||!V){if(A._32o=1,u===Xp)V?b.rs(t):b.as(t);else if(u===zl)N=new ls(t),N.addAll(t._children);else if("descendant"===u)N=new ls,yn(t,N);else if("all"===u&&(N=new ls,yn(t,N),!V))for(var m=t._parent;m;)N.add(m),m=m._parent;N&&(V?b.rs(N):b.as(N)),delete A._32o}},s._97I=function(N,l,T,H,m,x,d){var q=this,K=q._indent,S=q._levelMap[l._id],u=q.getIconWidth(l),U=ir(q.getToggleIcon(l));U?(H+=K*S,ld(N,U,H+K/2,m+d/2,l,q),H+=K):H+=K*(S+1),q._checkMode&&(ld(N,q.getCheckIcon(l),H+K/2,m+d/2,l,q),H+=K),q.drawIcon(N,l,H,m,u,d),q.drawLabel(N,l,H+u,m,d)}},yb._14Q=function(w){w.getIcon=function(q){return q.getIcon()},w.getIconWidth=function(Z){return this.getIcon(Z)?this._indent:0},w.drawIcon=function($,j,z,g,m,u){if(m){var q=this,I=q.getBodyColor(j),S=ir(q.getIcon(j),I);S&&(u-=q.isRowLineVisible()?1:0,Mi($,S,pp,z,g,m,u,j,q,I),Lh($,q.getBorderColor(j),z,g,m,u))}},w.drawLabel=function(I,E,e,t,Y){var z=this;rd(I,z.getLabel(E),z.getLabelFont(E),z.getLabelColor(E),e,t,0,Y)}},yb._50o=function(K){K._98I=function(){var V=this,G=V._39o=new Jg;V._60I=new ls,G.mm(V._17o,V),G.md(V._18o,V),G.mh(V._19o,V)},K.setColumns=function(g){this._39o.clear(),this.addColumns(g)},K.addColumns=function(O){var R=this._39o;O.forEach(function(o){if(!(o instanceof vj)){var M=Nb(o.className);o=dq(M?M:vj,o)}R.add(o)})},K.onColumnClicked=function(){},K.onCheckColumnClicked=function(){},K._3Q=function(Q){for(var n,o=0,k=this._60I,U=k.size();U>o;o++)if(n=k.get(o),n.column===Q)return n;return t},K.getColumnAt=function(j){var n=this._4Q(j);return n?n.column:t},K._4Q=function(E){for(var s=this,o=E.target?s.lp(E).x:E.x,c=s._60I,R=0;R<c.size();R++){var e=c.get(R),A=e.startX;if(o>=A&&o<A+e.column.getWidth())return e}return t},K.getToolTip=function(o){var N=this,r=N.getDataAt(o),x=N.getColumnAt(o);return r&&x?x.getToolTip(r,N):t},K.adjustTranslateX=function(v){var w=this.getWidth()-this._91I;return w>v&&(v=w),v>0?0:y(v)},K._99I=function(){var F=this,l=F._29I,B=F._60I;B.clear(),F._91I=0,F._39o._roots.each(function(c){if(c.isVisible()){var h=F._91I+c.getWidth();F._91I<=l.x+l.width&&h>=l.x&&B.add({column:c,startX:F._91I}),F._91I=h}}),F._91I+=F.getScrollBarSize()},K.drawData=function(I,U,A){var b=this,O=b._rowHeight,C=O*A,t=b.isSelected(U),W=b._29I,r=W.x,D=W.width;b.drawRowBackground(I,U,t,r,C,D,O),b._60I.each(function(G){var p=G.column,S=G.startX,k=p.getWidth();k>0&&!b.isEditing(U,p)&&(I.save(),I.beginPath(),I.rect(S,C,k,O),I.clip(),b._87o(b.drawCell(I,U,t,p,S,C,k,O),A,S,C,k,O),b._columnLineVisible&&Qf(I,S+k-1,C,1,O,b._columnLineColor),I.restore())}),b._rowLineVisible&&Qf(I,r,C+O-1,D,1,b._rowLineColor)},K.drawCell=function(E,Y,f,j,g,h,D,e){var u=this;if(j.drawCell)return j.drawCell(E,Y,f,j,g,h,D,e,u);var W=u.getValue(Y,j);zo(E,W,j,u.getLabelFont(Y,j,W),u.getLabelColor(Y,j,W),g,h,D,e,Y,u)},K.getColumnModel=function(){return this._39o},K._17o=function(){this.redraw()},K._18o=function(u){var Z=this;u.data===Z._sortColumn&&Cg[u.property]?Z.ivm():(Z._42o(),Z.redraw())},K._19o=function(){this.redraw()},K.getCurrentSortFunc=function(){var K=this,H=K._sortColumn;if(H&&H.isSortable()){var k=H.getSortFunc(),q=Mb===H.getSortOrder()?1:-1;return k||(k=Uc),function(f,G){return k.call(K,K.getValue(f,H),K.getValue(G,H),f,G)*q}}return K._sortFunc},K.isCellEditable=function(M,A,V){return A.isEditable()&&this.isEditable()?A.isCellEditable?A.isCellEditable(M,A,V,this):!0:!1},K._37O=function(a,u){if(Ir(u))for(var n=this,P=n.lp(u),s=n._60I,l=n._rowHeight,B=n._29I,D=B.x,x=B.y,N=B.width,e=B.height,J=0;J<s.size();J++){var Z=s.get(J),$=Z.startX,V=Z.column,r=V.getWidth();if(V!==n._31o&&V!==n._4o&&P.x>=$&&P.x<$+r&&n.isCellEditable(a,V,u)){var O={x:$,y:n.getRowIndex(a)*l,width:r,height:l},L={x:O.x+n.tx(),y:O.y+n.ty(),width:O.width,height:O.height},_=0,I=0;return O.x<D?_=O.x-D:O.x+O.width>D+N&&(_=O.x+O.width-D-N),_&&(n.tx(n.tx()-_),L.x-=_),O.y<x?I=O.y-x:O.y+l>x+e&&(I=O.y+l-x-e),I&&(n.ty(n.ty()-I),L.y-=I),n.beginEditing({data:a,column:V,value:n.getValue(a,V),event:u,rect:O,editorRect:L,view:n}),void 0}}}},kk.BaseItemEditor=function(p,i,z,V){this._data=p,this._column=i,this._master=z,this._editInfo=V},Vm("BaseItemEditor",u,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Ek=Y.Tab=function(){ml(Ek,this)};uk("Tab",Ro,{ms_ac:["view","closable","disabled","visible"],_icon:t,_closable:!1,_disabled:!1,_visible:!0,setParent:ds});var vj=Y.Column=function(){ml(vj,this)};uk("Column",Ro,{_46o:1,ms_ac:["accessType","valueType",Xe,Ep,fd,Bh,"align",kg,"sortOrder",hh,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Mb,_sortFunc:t,_sortable:!0,_clickable:!0,setWidth:function(N){16>N&&(N=16);var n=this._width;this._width=N,this.fp(Bh,n,N)},getToolTip:function(B,Z){return this.formatValue(Z.getValue(B,this))}});var Ne=Y.Property=function(){ml(Ne,this)};uk("Property",Ro,{_46o:1,ms_ac:["accessType","valueType",Ep,fd,"categoryName",kg,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:t,getToolTip:function(q,s,C){var z=this;return s?z.formatValue(C.getValue(q,z)):C.getPropertyName(z)}}),kk.AccordionView=function(){var x=this;x._20o={},x._21o=new ls,x._10o=t,x._9o=t,x._11o=t,x._view=yo(0,x),x.iv()},Vm("AccordionView",u,{ms_v:1,ms_fire:1,ms_ac:[Oc,As,"titleHeight",zb,Nm,"titleBackground","selectWidth",Fr,"orientation","separatorColor"],_expandIcon:Q.accordionViewExpandIcon,_collapseIcon:Q.accordionViewCollapseIcon,_titleHeight:ch,_labelColor:Q.accordionViewLabelColor,_labelFont:Q.accordionViewLabelFont,_titleBackground:Q.accordionViewTitleBackground,_selectBackground:Q.accordionViewSelectBackground,_selectWidth:Q.accordionViewSelectWidth,_orientation:"v",_separatorColor:Q.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(U,E,z,e){var n=this,a=wc();if(n._20o[U])throw U+" already exists";a.onmousedown=Hc,a.style.cursor=ok,b(a,mc?ke:$h,function(F){Hc(F)}),b(a,mc?as:mj,function(W){Hc(W),Ir(W)&&(n._10o===U?n.collapse():n.expand(U))}),zg(n._view,a),n._20o[U]={content:E,div:a,canvas:Yh(a),icon:e},n._21o.add(U),z&&n.expand(U),n.iv()},remove:function($){var s=this,l=s._20o[$];l&&(ig(l.div),delete s._20o[$],s._21o.remove($),s.iv())},clear:function(){var G=this;G._21o.toArray().forEach(G.remove,G),G._20o={},G._21o.clear(),G.iv()},isExpanded:function(G){return this._10o===G},expand:function(B){var n=this;n._20o[B]&&n._10o!==B&&(n._10o=B,n.onExpanded(B),n.iv())},onExpanded:function(){},collapse:function(){var o=this;o._10o&&(o.onCollapsed(o._10o),delete o._10o,o.iv())},onCollapsed:function(){},initCanvas:function(u,d,R){ik(u,d,R);var T=ck(u);return ko(T,0,0,1),T.clearRect(0,0,d,R),T},drawTitle:function(U,f,s,C,M){var Y=this,D=ir(M.icon),O=Y.isExpanded(f),y=Y._titleHeight,o=Y._titleBackground,X=Y._selectWidth,v=Y._separatorColor,x=ir(O?Y._expandIcon:Y._collapseIcon),H=X+4;Qf(U,0,0,s,C,o),O&&X&&Qf(U,0,0,X,C,Y._selectBackground),(O||Y._21o.get(Y._21o.size()-1)!==f)&&Qf(U,0,C-1,s,1,v?v:Cj(o)),D&&(ld(U,D,H+To(D)/2,y/2),H+=To(D)+2),rd(U,f,Y.getLabelFont(f),Y.getLabelColor(f),H,0,0,y),x&&ld(U,x,s-To(x)/2-4,y/2)},validateImpl:function(){var i=this,A=i._view,s=0,n=0,_=i.getWidth(),l=i.getHeight(),v=i._titleHeight,X=i._21o.size()*v,f=i._11o,k=i._9o;delete i._11o,delete i._9o,i._21o.each(function(K){var J,B,m=i._20o[K],C=m.content,R=i._10o===K;ql(i)?(Km(m.div,s,0,v,l),J=i.initCanvas(m.canvas,v,l),_h(J,0,l),Pp(J,-T),i.drawTitle(J,K,l,v,m),J.restore(),R?(B=q(0,_-X),C&&(i._11o=C,i._9o=Le(C),Km(C,s+v,0,B,l)),s+=v+B):s+=v):(Km(m.div,0,n,_,v),J=i.initCanvas(m.canvas,_,v),i.drawTitle(J,K,_,v,m),J.restore(),R?(B=q(0,l-X),C&&(i._11o=C,i._9o=Le(C),Km(C,0,n+v,_,B)),n+=v+B):n+=v)});var h=i._9o;f&&f!==i._11o&&f.endEditing&&f.endEditing(),h&&h!==k&&zg(A,h),k&&k!==h&&ig(k)}}),kk.SplitView=function(i,f,p,P){var U=this,_=U._dividerDiv=wc(),J=U._60O=Yh(),E=U._61O=Yh(),a=J.style,x=E.style;U._view=yo(1,U),zg(U._view,_),a.msTouchAction=jg,a.pointerEvents=jg,a.cursor=ok,x.msTouchAction=jg,x.pointerEvents=jg,x.cursor=ok,i&&U.setLeftView(i),f&&U.setRightView(f),p&&U.setOrientation(p),P!=t&&U.setPosition(P),U.setStatus(bo),new Mp(U)},Vm("SplitView",u,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:Q.splitViewDividerSize,_dividerBackground:Q.splitViewDividerBackground,_dragOpacity:Q.splitViewDragOpacity,_toggleIcon:Q.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(C,W){var c=this,d=c._position;isNaN(C)||(W||(c._82O=0>C?-1:C>1?1:0),c._position=C,c.fp(uf,d,C))},getLeftView:function(){return this._leftView},setLeftView:function(l){var p=this,z=p._leftView,r=p._view;if(p._leftView!==l){if(z&&z!==p._rightView){var o=Le(z);o.parentNode===r&&ig(o)}if(p._leftView=l,l){var t=Le(l);t.parentNode!==r&&r.insertBefore(t,p._dividerDiv)}p.fp("leftView",z,l)}},getRightView:function(){return this._rightView},setRightView:function(J){var e=this,E=e._rightView,Z=e._view;if(e._rightView!==J){if(E&&E!==e._leftView){var g=Le(E);g.parentNode===Z&&ig(g)}if(e._rightView=J,J){var M=Le(J);M.parentNode!==Z&&Z.insertBefore(M,e._dividerDiv)}e.fp("rightView",E,J)}},validateImpl:function(){var Z=this,w=Z._draggable,x=Z._position,m=Z.getWidth(),N=Z.getHeight(),E=Z._dividerSize,p=Z._dividerBackground,O=mc?18:8,G=Z._dividerDiv,j=Z._82O,I=Z._60O,e=Z._61O,U=Z._toggleIcon,A=Z._status,P=G.style,R=null,_=mc?20:4,K=U.comps[0];E>=O||0===E?Z._coverDiv&&(ig(Z._coverDiv),delete Z._coverDiv):Z._coverDiv||(Z._coverDiv=wc(),Kc&&(Z._coverDiv.style.background=Jk),zg(G,Z._coverDiv)),Z._togglable?I.parentNode||(zg(G,I),zg(G,e)):(ig(I),ig(e));var h=Z._coverDiv,g=Z._leftView,t=Z._rightView;if(ql(Z)){if(E>m&&(E=m),A===bo)if(1===j)var u=a(x,m),B=q(0,m-E-u);else-1===j?(B=a(-x,m),u=q(0,m-E-B)):(u=y((m-E)*x),B=q(0,m-E-u));else"cl"===A?(u=0,B=q(0,m-E)):"cr"===A&&(B=0,u=q(0,m-E));g&&Km(g,0,0,u,N),t&&Km(t,u+E,0,B,N),Km(G,u,0,E,N),Z._22o=u,h&&(Km(h,E/2-O/2,0,O,N),h.style.cursor=w?ns:""),G.style.cursor=w?ns:"";var o=G.clientHeight/2,n=G.clientWidth;ik(I,n,n),Km(I,0,o-n-_,n,n),R=ck(I),ko(R,0,0,1),K.rotation=-T,qc(R,U,0,0,n,n),R.restore(),ik(e,n,n),Km(e,0,o+_,n,n),R=ck(e),ko(R,0,0,1),K.rotation=T,qc(R,U,0,0,n,n),R.restore()}else{if(E>N&&(E=N),A===bo)if(1===j)var r=a(x,N),F=q(0,N-E-r);else-1===j?(F=a(-x,N),r=q(0,N-E-F)):(r=y((N-E)*x),F=q(0,N-E-r));else"cl"===A?(r=0,F=q(0,N-E)):"cr"===A&&(F=0,r=q(0,N-E));g&&Km(g,0,0,m,r),t&&Km(t,0,r+E,m,F),Km(G,0,r,m,E),Z._22o=r,h&&(Km(h,0,E/2-O/2,m,O),h.style.cursor=w?zn:""),P.cursor=w?zn:"";var $=G.clientWidth/2,n=G.clientHeight;ik(I,n,n),Km(I,$-n-_,0,n,n),R=ck(I),ko(R,0,0,1),K.rotation=0,qc(R,U,0,0,n,n),R.restore(),ik(e,n,n),Km(e,$+_,0,n,n),R=ck(e),ko(R,0,0,1),K.rotation=S,qc(R,U,0,0,n,n),R.restore()}P.background=p}});var Mp=function(b){this.sv=b,this.addListeners()};Tr(Mp,u,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(P){var o=this,$=o.sv,l=$._dividerDiv,U=$._60O,H=$._61O,p=$._status,i=P.target;if(i===U)p===bo?$.setStatus("cl"):"cr"===p&&$.setStatus(bo);else if(i===H)p===bo?$.setStatus("cr"):"cl"===p&&$.setStatus(bo);else if(rp(P)&&(i===l||i===$._coverDiv)&&(Hc(P),$.isDraggable())){$.getLeftView(),$.getRightView();var D=o.maskDiv=wc();if(D.style.left=0,D.style.top=0,D.style.width=$.getWidth()+"px",D.style.height=$.getHeight()+"px",$.getView().appendChild(D),!$.isContinuousLayout()){var f=o.resizeDiv=wc();f.style.left=l.style.left,f.style.top=l.style.top,f.style.width=l.style.width,f.style.height=l.style.height,f.style.opacity=$.getDragOpacity(),f.style.background=$.getDividerBackground(),zg(o.getView(),f)}o._lastAbsPosition=$._22o,o._86o=ql($)?ad(P).x:ad(P).y,Rr(o,P)}},handleWindowTouchMove:function(b){rp(b)&&this.update(b,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(u){var U=this;U.update(u,!0),U.sv.setStatus(bo),U.maskDiv&&ig(U.maskDiv),U.resizeDiv&&ig(U.resizeDiv),U.maskDiv=U.resizeDiv=t},handle_mousedown:function(Q){Ir(Q)&&this.handle_touchstart(Q)},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},update:function(g,_){var v=this,N=v.sv,n=ql(N)?N.getWidth():N.getHeight(),l=N._dividerSize,L=v._lastAbsPosition-v._86o;ql(N)?(L+=ad(g).x,L>n-l&&(L=n-l),0>L&&(L=0),v.resizeDiv&&(v.resizeDiv.style.left=L+yr)):(L+=ad(g).y,L>n-l&&(L=n-l),0>L&&(L=0),v.resizeDiv&&(v.resizeDiv.style.top=L+yr)),_&&n!==l&&(1===N._82O?N.setPosition(L,1):-1===N._82O?N.setPosition(L-n+l,1):N.setPosition(L/(n-l),1))}}),kk.TabView=function(){var N=this,T=N._view=yo(1,N),y=N._91O=wc(1),M=N._tabModel=new Jg,O=M.sm(),w=N.invalidate;N._7o=new ls,N._canvas=Yh(y),zg(T,y),zg(T,N._92O=wc(1)),O.setSelectionMode(Kh),O.ms(N.handleSelectionChange,N),M.mm(w,N),M.mh(w,N),M.md(w,N),N._interactor=new $g(N),N.iv()},Vm("TabView",u,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",zb,Nm,"tabHPadding","tabBackground","selectWidth",Fr,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:_j,_tabHeight:ch,_tabGap:Q.tabViewTabGap,_labelColor:Q.tabViewLabelColor,_labelFont:Q.tabViewLabelFont,_tabBackground:Q.tabViewTabBackground,_selectWidth:Q.tabViewSelectWidth,_selectBackground:Q.tabViewSelectBackground,_moveBackground:Q.tabViewMoveBackground,_insertColor:Q.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(v,R,N){var q,M=this._tabModel;return v instanceof Ek?(q=v,R&&q.setView(R)):(q=new Ek,q.setName(v),q.setView(R)),M.add(q),N&&M.sm().ss(q),q},getLabel:function(R){return R.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(y){this._23o=y,this.iv()},get:function(r){var l=this,z=l._tabModel;if(Td(r))return z._roots.get(r);if(vh(r)){var y;return z.each(function(Q){r===l.getLabel(Q)&&(y=Q)}),y}return r instanceof Ek?r:t},select:function(F){this._tabModel.sm().ss(this.get(F))},remove:function(z){var h=this;if(z=h.get(z)){var D=h._tabModel,M=D._roots.indexOf(z);h._tabModel.remove(z),h.selectByIndex(--M)}},getCurrentTab:function(){return this._8o},hideTabView:function(W,H){H.parentNode===this._92O&&(Tp(H)?(H.style.display=Ym,H._tab_=W):ig(H),sj())},showTabView:function(E,C){Tp(C)&&(C.style.display="block",C._tab_=E),C.parentNode!==this._92O&&(zg(this._92O,C),sj())},_24o:function(){var t,b=this,m=b._8o,$=b._9o,S=b._tabModel.sm().ld();S&&(t=Le(S.getView())),t!==$&&($&&(m.getView()&&m.getView().endEditing&&m.getView().endEditing(),b.hideTabView(m,$)),t&&b.showTabView(S,t)),b._8o=S,b._9o=t,m!==S&&b.onTabChanged(m,S)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(J,q){this.selectByIndex(--q)},selectByIndex:function(u){var P=this,$=P._tabModel,T=$.size();if(T&&!$.sm().ld()){u==t&&(u=0),u>=T&&(u=T-1),0>u&&(u=0);for(var g=u;g>=0;g--){var L=P.get(g);if(!L.isDisabled())return P.select(L),L}for(g=u+1;T>g;g++)if(L=P.get(g),!L.isDisabled())return P.select(L),L}},getTabWidth:function(K){var O=this.getTabHPadding(),j=4+2*O,A=ir(K.getIcon());A&&(j+=To(A,K)+4);var C=this.getLabel(K);return C&&(j+=Rj(this.getLabelFont(K),C).width+4),K.isClosable()&&(j+=10),j},drawTab:function(X,D,O,q,x,P,V){var c,n=this,$=n._tabPosition,I=this.getTabHPadding(),E=O+4+I,M=n._selectWidth,o=ir(D.getIcon()),b=D.isDisabled(),m=n.getLabelColor(D),B=n.getLabelFont(D),k=n.getLabel(D),w=n._selectBackground,A=$===Ug+"-vertical",U=$===af+"-vertical";(A||U)&&(E=q+4+I),b&&(X.globalAlpha=Wj),Qf(X,O,q,x,P,V),D===n._8o&&M&&($===_j?Qf(X,O,q+P-M,x,M,w):$===Ug?Qf(X,O+x-M,q,M,P,w):$===af?Qf(X,O,q,M,P,w):A?Qf(X,O+x-M,q,M,P,w):U?Qf(X,O,q,M,P,w):Qf(X,O,q,x,M,w));var p=x/2;if(A&&(_h(X,p,q+P/2),Pp(X,S),_h(X,-p,-q-P/2)),o){var v=wb(o,D),l=To(o,D);if(A||U){var L=O+x/2,s=E+v/2;_h(X,L,s),Pp(X,T),_h(X,-L,-s),ld(X,o,O+x/2,E+v/2,D,n),_h(X,L,s),Pp(X,-T),_h(X,-L,-s),E+=v+4}else ld(X,o,E+l/2,q+P/2,D,n),E+=l+4}return A||U?(_h(X,x/2,E+x/2),Pp(X,T),_h(X,-x/2,-E-x/2),rd(X,k,B,m,O,E,P,x),_h(X,x/2,E+x/2),Pp(X,-T),_h(X,-x/2,-E-x/2)):rd(X,k,B,m,E,q,x,P),A&&(_h(X,p,q+P/2),Pp(X,-S),_h(X,-p,-q-P/2)),D.isClosable()&&(c=U?{x:O+x-12,y:q+P-12,width:12,height:12}:{x:O+x-12,y:q+2,width:12,height:12},this.drawCloseIcon(D,X,m,c)),b&&(X.globalAlpha=1),c},drawCloseIcon:function($,C,G,S){var o=S.x,d=S.y;
C.strokeStyle=G,C.lineWidth=1,C.beginPath(),C.moveTo(o+2,d+8),C.lineTo(o+8,d+2),C.moveTo(o+8,d+8),C.lineTo(o+2,d+2),C.stroke()},getTabAt:function(J){var r=this._interactor._8Q(J);return r?r.tab:null},validateImpl:function(){var n=this;n._24o();var l,S=n._canvas,b=n._tabPosition,i=n._91O,B=n._92O,M=n._tabModel,v=n.getWidth(),O=n.getHeight(),_=n._tabHeight,X=n._7o,k=n._tabGap,Y=b===_j,f=b===Ug,p=b===af,g=b===Ug+"-vertical",I=b===af+"-vertical",N=n._23o,T=0;if((f||p)&&M._roots.each(function(s){T=q(n.getTabWidth(s),T)}),Y?(Km(i,0,0,v,_),l={x:0,y:_,width:v,height:q(0,O-_)}):f?(Km(i,0,0,T,O),l={x:T,y:0,width:q(0,v-T),height:O}):p?(Km(i,v-T,0,T,O),l={x:0,y:0,width:q(0,v-T),height:O}):g?(Km(i,0,0,_,O),l={x:_,y:0,width:q(0,v-_),height:O}):I?(Km(i,v-_,0,_,O),l={x:0,y:0,width:q(0,v-_),height:O}):(Km(i,0,O-_,v,_),l={x:0,y:0,width:v,height:q(0,O-_)}),Km(B,l),g||I){n._9o&&(l.x=0,Km(n._8o.getView(),l)),ik(S,_,O);var J=ck(S),Z=0;if(ko(J,0,n.ty(),1),J.clearRect(0,0,_,O),X.clear(),M._roots.each(function(F){if(F.isVisible()){var V,I=n.getTabWidth(F);N&&N.tab===F||(V=n.drawTab(J,F,0,Z,_,I,n._tabBackground)),X.add({_75o:V,tab:F,startY:Z,endY:Z+I,height:I}),Z+=I+k}}),n._23Q=q(0,Z-k),N){var y=N.position;n.drawTab(J,N.tab,0,N.startY,_,N.height,n._moveBackground),Qf(J,0,y,_,1,n._insertColor)}if(J.restore(),n._selectionChanged){n._selectionChanged=!1;for(var a=n.ty(),u=0;u<X.size();u++){var h=X.get(u);if(h.tab===n._8o){if(h.endY+a<0){n.ty(-h.startY);break}if(h.startY+a>O){n.ty(O-h.endY);break}}}}n.ty(n.ty())}else if(f||p){n._9o&&(l.x=0,Km(n._8o.getView(),l)),ik(S,T,O);var J=ck(S),Z=0;if(ko(J,0,n.ty(),1),J.clearRect(0,0,T,O),X.clear(),M._roots.each(function(g){if(g.isVisible()){var C;N&&N.tab===g||(C=n.drawTab(J,g,0,Z,T,_,n._tabBackground)),X.add({_75o:C,tab:g,startY:Z,endY:Z+_,height:_}),Z+=_+k}}),n._23Q=q(0,Z-k),N){var y=N.position;n.drawTab(J,N.tab,0,N.startY,T,N.height,n._moveBackground),Qf(J,0,y,T,1,n._insertColor)}if(J.restore(),n._selectionChanged){n._selectionChanged=!1;for(var a=n.ty(),u=0;u<X.size();u++){var h=X.get(u);if(h.tab===n._8o){if(h.endY+a<0){n.ty(-h.startY);break}if(h.startY+a>O){n.ty(O-h.endY);break}}}}n.ty(n.ty())}else{n._9o&&(l.y=0,Km(n._8o.getView(),l)),ik(S,v,_);var J=ck(S),r=0;if(ko(J,n.tx(),0,1),J.clearRect(0,0,v,_),X.clear(),M._roots.each(function(M){if(M.isVisible()){var v,d=n.getTabWidth(M);N&&N.tab===M||(v=n.drawTab(J,M,r,0,d,_,n._tabBackground)),X.add({_75o:v,tab:M,startX:r,endX:r+d,width:d}),r+=d+k}}),n._64I=q(0,r-k),N){var y=N.position;n.drawTab(J,N.tab,N.startX,0,N.width,_,n._moveBackground),im(J,n._insertColor,y,0,_)}if(J.restore(),n._selectionChanged){n._selectionChanged=!1;for(var E=n.tx(),u=0;u<X.size();u++){var h=X.get(u);if(h.tab===n._8o){if(h.endX+E<0){n.tx(-h.startX);break}if(h.startX+E>v){n.tx(v-h.endX);break}}}}n.tx(n.tx())}for(var x=[],d=B.children,u=0;u<d.length;u++){var G=d[u],H=G._tab_;H&&!M.contains(H)&&x.push(G)}x.forEach(function(r){B.removeChild(r)})}});var $g=function(R){this.tv=R,this.addListeners()};Tr($g,u,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(s){this.handleScroll(s,10*(s.wheelDelta/40))},handle_DOMMouseScroll:function(F){this.handleScroll(F,10*-F.detail)},handleScroll:function(Z,e){Hc(Z);var g=this.tv,I=g._tabPosition;!g._40o()||I!==_j&&I!==mn||g.tx(this.tv.tx()+e),!g._41o()||I!==Ug&&I!==af&&I!==Ug+"-vertical"&&I!==af+"-vertical"||g.ty(this.tv.ty()+e)},_8Q:function(c){var $,N,F=this.tv,J=F._tabPosition,u=F._7o;if(J===_j||J===mn){var Z=F.lp(c).x;for($=0;$<u.size();$++)if(N=u.get($),N.startX<=Z&&Z<=N.endX)return N}else if(J===Ug||J===af||J===Ug+"-vertical"||J===af+"-vertical"){var z=F.lp(c).y;for($=0;$<u.size();$++)if(N=u.get($),N.startY<=z&&z<=N.endY)return N}return t},isClickable:function(j){var w=this.tv,P=w._tabPosition,D=this._73o=this._8Q(j);return!w._40o()||P!==_j&&P!==mn?!w._41o()||P!==Ug&&P!==af&&P!==Ug+"-vertical"&&P!==af+"-vertical"?D&&(!D.tab.isDisabled()||w.isMovable()):!0:!0},handle_mousemove:function(L){var M=this;lg?M._74o=M._8Q(L):M.getView().style.cursor=M.isClickable(L)?ok:""},handle_mousedown:function(f){this.handle_mousemove(f),this.handle_touchstart(f)},handle_touchstart:function(Y){var L=this,g=L.tv,s=g._tabPosition;Hc(Y),Ir(Y)&&L.isClickable(Y)&&(s===_j||s===mn?(L.x=ad(Y).x,L.lp=g.lp(Y),L.tx=g.tx()):(L.y=ad(Y).y,L.lp=g.lp(Y),L.ty=g.ty()),Rr(L,Y))},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(Y){var Q,e=this,P=e.tv,j=P._tabPosition,K=e._73o;if(j===_j||j===mn){if(Q=ad(Y).x-e.x,!e._25o&&!e.moving&&c(Q)>2&&(P._40o()&&!Sf(Y)?e._25o=1:K&&P.isMovable()&&(e.moving=1)),e._25o)P.tx(e.tx+Q);else if(e.moving){var C=e.lp.x+Q,U=P._tabGap/2;P._7o.each(function(p){var F=p.endX,l=C-p.startX<F-C;C>=p.startX&&F>=C&&P._7Q({tab:K.tab,startX:K.startX+Q,width:K.width,front:l,insertTab:p.tab,position:l?q(0,p.startX-U):a(P._64I,F+U)})})}}else if(Q=ad(Y).y-e.y,!e._25o&&!e.moving&&c(Q)>2&&(P._41o()&&!Sf(Y)?e._25o=1:K&&P.isMovable()&&(e.moving=1)),e._25o)P.ty(e.ty+Q);else if(e.moving){var O=e.lp.y+Q,U=P._tabGap/2;P._7o.each(function(i){var v=i.endY,j=O-i.startY<v-O;O>=i.startY&&v>=O&&P._7Q({tab:K.tab,startY:K.startY+Q,height:K.height,front:j,insertTab:i.tab,position:j?q(0,i.startY-U):a(P._23Q,v+U)})})}},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(){var $=this,o=$.tv,r=o._tabPosition,T=o.getTabModel(),p=T._roots,L=$._73o;if($.moving){var B=o._23o;if(B&&B.insertTab!==B.tab){var E=B.tab,j=p.remove(E),u=p.indexOf(B.insertTab);u>=0&&(B.front||u++,u<=p.size()&&(p.add(E,u),T._38I(E,j,u)))}o._7Q(t),delete $.moving}else if(!$._25o&&L){E=L.tab;var s=$._74o;if(!s||s.tab===E)if(!E.isDisabled()&&Mf(L._75o,$.lp)){var b=function(){var _=p.indexOf(E);T.remove(E),o.onTabClosed(E,_)};o.onTabClosing(E,b)&&b()}else E.isDisabled()||o._8o===E||T.sm().ss(E)}$._25o=$._73o=$._74o=r===_j||r===mn?$.x=$.lp=$.tx=t:$.y=$.lp=$.ty=t}}),kk.PropertyView=function(J){var v=this;v._view=yo(1,v),v._canvas=Yh(v._view),zg(v._view,v._79O=wc()),v._rows=new ls,v._28o=new ls,v._26o={},v._26Q={};var D=v._propertyModel=new Jg,e=v.ivm;D.mm(e,v),D.md(e,v),D.mh(e,v),v.dm(J?J:new Jg),new gc(v)},Vm("PropertyView",u,{ms_ac:[zb,jn,Nm,Ep,fd,"categorizable",gn,hh,Vr,Oc,As,sc,us,Ml,"selectRowIndex",Fr,"background",qn,bh,xi,Ho,fj],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:xq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:co,_background:Q.propertyViewBackground,_expandIcon:Q.propertyViewExpandIcon,_collapseIcon:Q.propertyViewCollapseIcon,_scrollBarColor:ih,_scrollBarSize:Wi,_autoHideScrollBar:Qe,_selectBackground:Q.propertyViewSelectBackground,_rowHeight:Nf,_rowLineVisible:Q.propertyViewRowLineVisible,_rowLineColor:Q.propertyViewRowLineColor,_10I:.5,_columnLineVisible:Q.propertyViewColumnLineVisible,_columnLineColor:Q.propertyViewColumnLineColor,_labelColor:Q.propertyViewLabelColor,_labelSelectColor:Q.propertyViewLabelSelectColor,_labelFont:Q.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(h){0>h&&(h=0),h>1&&(h=1);var Z=this,C=Z._10I;Z._10I=h,Z.fp("columnPosition",C,h)},getPropertyName:function(m){return m.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(H,k,l){return l===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(X,e){return e===this._selectRowIndex?this._labelSelectColor:X.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(F){var v=this.getHeight()-this._59I;return v>F&&(F=v),F>0?0:y(F)},isExpanded:function(n){if(!n)return!0;var o=this._26o[n];return o?o.isExpanded:!(this._26Q[n]===!1)},toggle:function(o){var B=this;B.isExpanded(o)?B.collapse(o):B.expand(o)},expandAll:function(){this.validate();for(var s in this._26o)this.expand(s)},expand:function(T){if(T&&T!==Ym){var Y=this,D=Y._26o[T];D&&!D.isExpanded&&(D.isExpanded=!0,Y.onExpanded(T),Y.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var l in this._26o)this.collapse(l)},collapse:function(w){if(w&&w!==Ym){var z=this,l=z._26o[w];l&&l.isExpanded&&(l.isExpanded=!1,z.onCollapsed(w),z.ivm())}},onCollapsed:function(){},getCategoryName:function(U){if(!this.isCategorizable())return Ym;var m=U.getCategoryName();return m?m:Ym},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(r){var E=this,m=E._dataModel;m!==r&&(m&&(m.umd(E.handlePropertyChange,E),E._selectionModel||m.sm().ums(E.handleSelectionChange,E)),E._dataModel=r,r.md(E.handlePropertyChange,E),E._selectionModel?E._selectionModel._21I(r):r.sm().ms(E.handleSelectionChange,E),E.fp($q,m,r))},isVisible:function(a){return this._visibleFunc?this._visibleFunc(a):!0},onPropertyChanged:function(g){var Z=this,U=g.property;Ze[U]?Z.ivm():Z.iv(),U===Go&&Z._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:wn},handlePropertyChange:function(z){this._27o===z.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var A=this;A._96I||(A.setSelectRowIndex(-1),A._96I=1,A.iv())},redraw:function(){this.iv()},validateModel:function(){var K=this,c=K._rows,z=K._28o,R={},D=new ls,X=K._27o;K.updateCurrentData(),X!==K._27o&&K.endEditing(),c.clear(),z.clear(),K.getRawProperties().each(function(l){if(K.isVisible(l)){D.add(l);var Q=K.getCategoryName(l);R[Q]||(z.add(Q,Q===Ym?0:w),R[Q]={isExpanded:K.isExpanded(Q),properties:new ls})}}),K._sortFunc&&D.sort(K._sortFunc);for(var S in K._26o)K._26Q[S]=K.isExpanded(S);K._26o=R,z.each(function(w){w!==Ym&&c.add(w);var q=R[w];q.isExpanded&&D.each(function(U){K.getCategoryName(U)===w&&(q.properties.add(U),c.add({property:U,data:K._27o}))},K)})},validateImpl:function(){var F=this;F._76o(),F._96I&&(F.validateModel(),delete F._96I);var l=F._canvas,b=F.getWidth(),I=F.getHeight(),V=-F.ty(),Y=F._rowHeight,s=F._indent,w=b-s,B=F._rows,k=B.size(),y=F._9I=s+w*F._10I,o=F._59I=k*Y;ik(l,b,I),F._29I={x:0,y:V,width:b,height:I},F._31I=E(V/Y),F._14I=m((V+I)/Y),F._31I<0&&(F._31I=0),F._14I>k&&(F._14I=k);var g,h=ck(l),Z=F._background;ko(h,0,-V,1),h.beginPath(),h.rect(0,V,b,I),h.clip(),h.clearRect(0,V,b,I),F._93db(h),Z&&Qf(h,0,0,s,o,Z);for(var H=F._31I;H<F._14I;H++){var r=B.get(H),V=Y*H;if(vh(r))Z&&Qf(h,s,V,w,Y,Z),g=ir(F.isExpanded(r)?F._expandIcon:F._collapseIcon),g&&Mi(h,g,pp,0,V,s,Y),h.save(),h.beginPath(),h.rect(s,V,w,Y),h.clip(),F.drawCategoryName(h,r,H,s,V,w,Y),h.restore();else{var i=r.property,U=r.data,g=ir(i.getIcon()),p=F._selectRowIndex===H?F.getSelectBackground():t;if(g&&Mi(h,g,pp,0,V,s,Y),p&&Qf(h,s,V,w,Y,p),h.save(),h.beginPath(),h.rect(s,V,y-s,Y),h.clip(),F.drawPropertyName(h,i,H,s,V,y-s,Y),h.restore(),!F.isEditing(U,i)){var S=y+1,u=b-y-1;h.save(),h.beginPath(),h.rect(S,V,u,Y),h.clip(),F._87o(F.drawPropertyValue(h,i,F.getValue(U,i),H,S,V,u,Y,U),H,S,V,u,Y),h.restore()}}F._rowLineVisible&&Qf(h,s,V+Y-1,w,1,F._rowLineColor)}F._columnLineVisible&&(Qf(h,y,0,1,o,F._columnLineColor),Qf(h,b-1,0,1,o)),F._92db(h),F._93I(),h.restore(),F.ty(F.ty())},drawCategoryName:function(M,u,Z,S,g,C,e){rd(M,u,this.getCategoryFont(u),this.getCategoryColor(u),S,g,C,e)},drawPropertyName:function(l,I,Y,k,M,p,i){return I.drawPropertyName?(I.drawPropertyName(l,I,Y,k,M,p,i,this),void 0):(rd(l,this.getPropertyName(I),this.getPropertyFont(I,Y),this.getPropertyColor(I,Y),k,M,p,i),void 0)},drawPropertyValue:function(R,F,E,v,d,s,I,O,e){return F.drawPropertyValue?F.drawPropertyValue(R,F,E,v,d,s,I,O,e,this):(zo(R,E,F,this.getLabelFont(F,E,v),this.getLabelColor(F,E,v),d,s,I,O,e,this),void 0)},isPropertyEditable:function(c){return c.isEditable()&&this.isEditable()},setProperties:function(i){this._propertyModel.clear(),this.addProperties(i)},addProperties:function(Q){if(Q){var V=this._propertyModel;Q.forEach(function(M){if(!(M instanceof Ne)){var b=Nb(M.className);M=dq(b?b:Ne,M)}V.add(M)})}},getRowIndexAt:function(C){var L=this,I=E(L.lp(C).y/L._rowHeight);return I>=0&&I<L._rows.size()?I:-1},getPropertyAt:function(Y){var d=this,w=d.getRowIndexAt(Y);return w>=0?d._rows.get(w).property:t},getToolTip:function(N){var O=this,P=O.getPropertyAt(N),s=O._27o;return P&&s?P.getToolTip(s,O._9I<O.lp(N).x,O):t}});var gc=function(L){this.pv=L,this.addListeners()};Tr(gc,u,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(y){this.getView().style.cursor=y},clear:function(){var v=this;v._62O=v.cp=v.ty=v.p=t,v.setCursor(Xp)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(c){var R=this,P=R.pv;Hc(c),P.setFocus(c)&&(Ir(c)?(R.cp=ad(c),R.ty=P.ty(),R.p=P.getColumnPosition(),R.handle_touchmove(c)):P.setSelectRowIndex(P.getRowIndexAt(c)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(Y){this.handle_touchend(Y)},handle_touchend:function(r){var x=this;if(x.cp&&!x._62O){var F=x.pv,h=F.lp(r),X=h.x,y=h.y,K=F._indent,z=F.getRowIndexAt(r),b=F._9I;if(z>=0){var m=F._rowHeight,w=m*z,O=F._rows.get(z),q=O.property;if(vh(O))ir(F.isExpanded(O)?F._expandIcon:F._collapseIcon)&&X>=0&&K>=X&&y>=w&&w+m>=y?F.toggle(O):fo(r)&&F.toggle(O);else if(X>b&&F.isPropertyEditable(q,r)){var v={x:b+1,y:w,width:F.getWidth()-b-1,height:m},L={x:v.x+F.tx(),y:v.y+F.ty(),width:v.width,height:v.height},B=0,P=F._29I;v.y<P.y?B=v.y-P.y:v.y+m>P.y+P.height&&(B=v.y+m-P.y-P.height),B&&(F.ty(F.ty()-B),L.y-=B),F.beginEditing({data:O.data,property:q,value:F.getValue(O.data,q),event:r,rect:v,editorRect:L,view:F})}}F.setSelectRowIndex(z)}x.clear()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(F){var A=this,_=A.pv,D=A.ty,v=A.cp,E=ad(F),n=A._62O;if("p"===n)_.setTranslateY(D+E.y-v.y);else if("c"===n){var C=_.getWidth()-_._indent;if(C>16){var f=A.p-(v.x-E.x)/C,Q=16/C;Q>f&&(f=Q),f>1-Q&&(f=1-Q),_.setColumnPosition(f)}}else"s"===n&&_.setTranslateY(D+(v.y-E.y)*_._59I/_._29I.height)},handle_mousemove:function(n){this.handle_touchmove(n)},handle_touchmove:function(K){if(!lg&&Ir(K)){var V=this,U=V.pv,J=c(U.lp(K).x-U._9I)<=(mc?8:3);V.cp?V._62O||(J?(V._62O="c",Rr(V)):c(ad(K).y-V.cp.y)>=2&&(V._62O=V.isV(K)?"s":"p",Rr(V))):(J?V.setCursor(ns):V.setCursor(Xp),V.isV(K)&&U._43o())}},isV:function(A){var y=this.pv,m=y._29I;return y._41o()&&m.x+m.width-y.lp(A).x<Ce},handle_mousewheel:function(t){this.handleScroll(t,t.wheelDelta/40)},handle_DOMMouseScroll:function(g){2===g.axis&&this.handleScroll(g,-g.detail)},handleScroll:function(E,B){var v=this.pv;Hc(E),v.endEditing(),v.translate(0,B*v.getRowHeight())},handle_keydown:function(X){var D=this.pv,t=D._rows.size(),x=D._selectRowIndex+(ah(X)?-1:1);(ah(X)||Fq(X))&&(0>x&&(x=0),x>=t&&(x=t-1),D.setSelectRowIndex(x))}}),kk.ListView=function(J){this._5o(J),new cg(this)},Vm("ListView",u,{ms_ac:[zb,jn,Nm,qn,gn,bh,xi,hh,Vr,sc,us,Ml,Qg,Fr],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:co,_rowHeight:Nf,_rowLineVisible:Q.listViewRowLineVisible,_rowLineColor:Q.listViewRowLineColor,_scrollBarColor:ih,_scrollBarSize:Wi,_autoMakeVisible:Pq,_autoHideScrollBar:Qe,_selectBackground:Q.listViewSelectBackground,_labelColor:Q.listViewLabelColor,_labelSelectColor:Q.listViewLabelSelectColor,_labelFont:Q.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(K){var F=this,g=F._checkMode;F._checkMode=K,F.fp(kf,g,K)},drawRow:function(B,n,C,O,h,e,j){var o=this,c=0,g=o._indent,z=o.getIconWidth(n);o.drawRowBackground(B,n,C,O,h,e,j),o._checkMode&&(ld(B,ir(o.getCheckIcon(n)),c+g/2,h+j/2,n,o),c+=g),o.drawIcon(B,n,c,h,z,j),o.drawLabel(B,n,c+z,h,j)}});var cg=function(J){this.list=J,this._lastSelectDataTime=Lq(),this.addListeners()};Tr(cg,u,{ms_listener:1,getView:function(){return this.list._view},clear:function(n){var m=this,s=m.list;n&&"d"===m._62O&&!m.dragCancel&&s.handleDragAndDrop(n,"end"),s.draggingData&&(s.draggingData=null,s.redraw()),m.dragCancel=m._62O=m._isV=m._isH=m.cp=m.tx=m.ty=t},handle_mousedown:function(I){this.handle_touchstart(I)},handle_touchstart:function(X){var d=this,W=d.list;if(Hc(X),W.setFocus(X)){var c=W.getDataAt(X);d.cp=ad(X),d.tx=W.tx(),d.ty=W.ty(),Ir(X)?c&&W.handleDragAndDrop&&!d.isV(X)&&!d.isH(X)&&(W.draggingData=c,W.redraw(),W.handleDragAndDrop(X,"prepare")):(c&&d._33o(X,c),d.clear(X))}},handleWindowMouseUp:function(w){this.clear(w)},handleWindowTouchEnd:function(t){this.clear(t)},handle_mouseup:function(X){this.handle_touchend(X)},handle_touchend:function(n){var I=this,M=I.list;if(!I._isV&&!I._isH&&I.cp&&!I._62O){var W=M.getDataAt(n);W?(M.isCheckMode()?I._34o(n,W):I._33o(n,W),fo(n)?M.onDataDoubleClicked(W,n):M.onDataClicked(W,n)):M.handleBackgroundClick(n)}I.clear(n)},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(t){var v=this,l=v.list,O=v._62O,p=v.tx,D=v.ty,R=v.cp,f=ad(t),K=l._29I;"p"===O?l.setTranslate(p+f.x-R.x,D+f.y-R.y):"v"===O?l.ty(D+(R.y-f.y)*l._59I/K.height):"h"===O?l.tx(p+(R.x-f.x)*l._91I/K.width):"d"===O&&(v.dragCancel||l.handleDragAndDrop(t,"between"))},handle_mousemove:function(f){this.handle_touchmove(f)},handle_touchmove:function(w){if(!lg&&Ir(w)){var v=this,Q=v.list;if(v._isV=v.isV(w),v._isH=v.isH(w),v.cp){if(!v._62O){if(ro(ad(w),v.cp)<2)return;v._isV?v._62O="v":v._isH?v._62O="h":Q.draggingData&&!this.dragCancel?(v._62O="d",Q.handleDragAndDrop(w,"begin")):v._62O="p",v._62O&&"d"!==v._62O&&Q.draggingData&&(Q.draggingData=null,Q.redraw()),Rr(v)}}else v._isV&&Q._43o(),v._isH&&Q._42o()}},isV:function(p){var E=this.list,Q=E._29I;return E._41o()&&Q.x+Q.width-E.lp(p).x<Ce},isH:function(W){var N=this.list,L=N._29I;return N._40o()&&L.y+L.height-N.lp(W).y<Ce},handle_mousewheel:function(F){this.handleScroll(F,F.wheelDelta/40,F.wheelDelta!==F.wheelDeltaX)},handle_DOMMouseScroll:function(r){this.handleScroll(r,-r.detail,1)},handleScroll:function(j,a,Q){var L=this.list;Hc(j),L.endEditing&&L.endEditing(),Q&&L._41o()?L.translate(0,a*L.getRowHeight()):L._40o()&&L.translate(10*a,0)},handle_keydown:function(F){if(!Q.isInput(F.target)){var L,s=this.list,M=s.sm(),U=s._rows,k=U.size();if(xr(F))s.selectAll();else if(Eg(F))s.handleDelete&&s.handleDelete(F);else if(Fd(F))"d"!==this._62O||this.dragCancel||(s.handleDragAndDrop(F,"cancel"),this.dragCancel=!0);else if(Kb(F))s.isCheckMode()&&(L=s.getFocusData(),L&&s.checkData(L));else if(ah(F)||Fq(F)){var N=s.isCheckMode();if(L=N?s.getFocusData():M.ld()){var W=s.getRowIndex(L);W>=0&&(ah(F)?0!==W&&(L=U.get(W-1),N?s.setFocusData(L):M.ss(L)):W!==k-1&&(L=U.get(W+1),N?s.setFocusData(L):M.ss(L)))}else k>0&&(L=U.get(0),N?s.setFocusData(L):M.ss(L))}}},_34o:function(Y,o){var F=this.list,I=F.lp(Y).x;return I>=0&&I<=F._indent?(F.checkData(o),void 0):(F.setFocusData(o),void 0)},_33o:function(F,S){var l=this.list,Z=l.sm(),K=Z.ld();if(Sf(F))l.isSelected(S)?Z.rs(S):Z.as(S);else if(Dc(F))if(K)for(var e=l.getRowIndex(K),G=l.getRowIndex(S);e!==G;)e+=G>e?1:-1,Z.as(l._rows.get(e));else Z.ss(S);else if(Ir(F)){var X=Lq();if(Z.contains(S)){var j=X-this._lastSelectDataTime;l.handleDataDoubleSelect&&j>500&&1500>j&&l.handleDataDoubleSelect(F,S)}Z.ss(S),this._lastSelectDataTime=X}else Z.contains(S)||Z.ss(S)}}),kk.TreeView=function(N){var e=this;e._35o(),e._5o(N),new Nc(e)},Vm("TreeView",u,{ms_ac:[zb,jn,Nm,"rootVisible",kf,"rootData",hh,Vr,sc,us,Ml,gn,qn,bh,xi,Oc,As,Qg,Fr,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:t,_indent:co,_rowHeight:Nf,_rowLineVisible:Q.treeViewRowLineVisible,_rowLineColor:Q.treeViewRowLineColor,_scrollBarColor:ih,_scrollBarSize:Wi,_autoHideScrollBar:Qe,_expandIcon:Q.treeViewExpandIcon,_collapseIcon:Q.treeViewCollapseIcon,_autoMakeVisible:Pq,_selectBackground:Q.treeViewSelectBackground,_labelColor:Q.treeViewLabelColor,_labelSelectColor:Q.treeViewLabelSelectColor,_labelFont:Q.treeViewLabelFont,_doubleClickToToggle:Q.treeViewDoubleClickToToggle,drawRow:function(o,U,D,O,h,G,_){var k=this;k.drawRowBackground(o,U,D,O,h,G,_),k._97I(o,U,D,0,h,G,_)},isOnToggleIcon:function(i){var Q=this.getDataAt(i);if(Q){var H=this.getIndent(),e=this.lp(i).x;if(ir(this.getToggleIcon(Q))){var p=H*this.getLevel(Q);if(e>=p&&p+H>=e)return!0}}return!1}});var Nc=function(M){ml(Nc,this,[M])};Tr(Nc,cg,{toggle:function(k,R,a,Z){var W=this.list,$=W.lp(k).x;if(ir(W.getToggleIcon(R))){var N=a*Z;if($>=N&&N+a>=$)return W.toggle(R),!0}return W.isDoubleClickToToggle()&&fo(k)?(W.toggle(R),!0):!1},_34o:function(t,l){var I=this.list,N=I.lp(t).x,f=I._levelMap[l._id],d=I._indent,Y=d*(f+1);return N>=Y&&Y+d>=N?(I.checkData(l),void 0):(this.toggle(t,l,d,f)||I.setFocusData(l),void 0)},_33o:function(f,P){var h=this,c=h.list;if(!h.toggle(f,P,c._indent,c.getLevel(P)))if(Dc(f)){var W=c.sm();if(W.size()>0){for(var Z=c._rows,k=null,C=0,X=Z.size();X>C;C++)if(c.isSelected(Z.get(C))){k=C;break}for(var U=null,C=Z.size()-1;C>=0;C--)if(c.isSelected(Z.get(C))){U=C;break}var m,l,M=c.getRowIndex(P);for(k>M?(m=M-1,l=k):M>U?(m=U,l=M):(m=k,l=U);m!==l;)m++,W.as(c._rows.get(m))}else W.ss(P)}else Nc.superClass._33o.call(h,f,P)},handle_keydown:function(k){if(_g(k)||El(k)){var b=this.list,p=b._rows,n=b.isCheckMode(),t=b.sm(),a=n?b.getFocusData():t.ld();a?a.hasChildren()&&(_g(k)?b.collapse(a):b.expand(a)):p.size()>0&&(a=p.get(0),n?b.setFocusData(a):t.ss(a))}else Nc.superClass.handle_keydown.call(this,k)}});var Bi=kk.TableView=function(D){this._98I(),this._5o(D),new Ud(this)};Vm("TableView",u,{ms_ac:[zb,jn,Nm,"sortMode",Ep,fd,qn,bh,xi,Ho,fj,"sortColumn",hh,Vr,sc,us,Ml,Qg,Fr],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Ln,_editable:!0,_batchEditable:!1,_rowHeight:Nf,_rowLineVisible:Q.tableViewRowLineVisible,_rowLineColor:Q.tableViewRowLineColor,_columnLineVisible:Q.tableViewColumnLineVisible,_columnLineColor:Q.tableViewColumnLineColor,_scrollBarColor:ih,_scrollBarSize:Wi,_autoHideScrollBar:Qe,_autoMakeVisible:Pq,_selectBackground:Q.tableViewSelectBackground,_labelColor:Q.tableViewLabelColor,_labelSelectColor:Q.tableViewLabelSelectColor,_labelFont:Q.tableViewLabelFont,getCheckColumn:function(){var j=this;if(!j._31o){var Q=j._31o=new vj;Q.setEditable(!0),Q.setWidth(40),Q.getValue=j.getCheckColumValue,Q.drawCell=j.drawCheckColumnCell}return j._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(q){var e=this,i=e._39o,Z=e.getCheckColumn();q!==e.isCheckMode()&&(q?i.add(Z,0):i.remove(Z),e.fp(kf,!q,q))},getCheckColumValue:function(P,L,g){return g.isSelected(P)},drawCheckColumnCell:function(p,x,Y,m,P,z,q,o,e){ld(p,e.getCheckIcon(x),P+q/2,z+o/2,x,e)}});var Ud=function(v){ml(Ud,this,[v])};Tr(Ud,cg,{_34o:function(L,C){var c=this.list,F=c._31o;if(c.isCellEditable(C,F,L)){var K=c._3Q(F),d=c.lp(L).x;if(K&&d>=K.startX&&d<K.startX+F.getWidth())return c.checkData(C),void 0}c._37O(C,L),c.setFocusData(C)},_33o:function(A,Y){this.list._37O(Y,A),Ud.superClass._33o.apply(this,arguments)}});var vo=kk.TreeTableView=function(I){var Q=this,w=Q._4o=new vj;Q._35o(),Q._98I(),Q._5o(I),w.setDisplayName("Name"),w.setEditable(!0),w.setWidth(180),w.drawCell=Tj,w.getValue=id,Q._39o.add(w),new Ap(Q)},Tj=function(w,n,_,h,N,o,g,B,u){u._97I(w,n,_,N,o,g,B)},id=function($,Q,S){return S.getLabel($)};Vm("TreeTableView",u,{ms_ac:[zb,jn,Nm,"sortMode",Ep,fd,gn,kf,"rootData","rootVisible",hh,Vr,"sortColumn",Oc,As,sc,us,Ml,Qg,xi,qn,bh,Ho,fj,Fr,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Ln,_checkMode:t,_editable:!0,_batchEditable:!1,_indent:co,_rowHeight:Nf,_rowLineVisible:Q.treeTableViewRowLineVisible,_rowLineColor:Q.treeTableViewRowLineColor,_columnLineVisible:Q.treeTableViewColumnLineVisible,_columnLineColor:Q.treeTableViewColumnLineColor,_expandIcon:Q.treeTableViewExpandIcon,_collapseIcon:Q.treeTableViewCollapseIcon,_scrollBarColor:ih,_scrollBarSize:Wi,_autoHideScrollBar:Qe,_autoMakeVisible:Pq,_selectBackground:Q.treeTableViewSelectBackground,_labelColor:Q.treeTableViewLabelColor,_labelSelectColor:Q.treeTableViewLabelSelectColor,_labelFont:Q.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ap=function(a){ml(Ap,this,[a])};Tr(Ap,cg,{_34o:function(f,q){var T=this.list,O=T._4o,D=T._3Q(O),a=T.lp(f).x;if(D){var U=T._indent,Q=D.startX+U*T.getLevel(q);if(ir(T.getToggleIcon(q))&&a>=Q&&Q+U>=a)return T.toggle(q),void 0;if(T.isCellEditable(q,O)&&(Q+=U,a>=Q&&Q+U>=a))return T.checkData(q),void 0}T._37O(q,f),T.setFocusData(q)},_33o:function(L,B){var J=this.list,j=J.lp(L).x;if(ir(J.getToggleIcon(B))){var x=J._3Q(J._4o);if(x){var i=J._indent,F=x.startX+i*J.getLevel(B);if(j>=F&&F+i>=j)return J.toggle(B),void 0}}J._37O(B,L),Ap.superClass._33o.apply(this,arguments)}});var Gk=kk.TableHeader=function(X){var p=this,x=p._view=yo(1,p),W=p._39o=X.getColumnModel(),s=p.iv;p.tv=p._tableView=X,p._60I=new ls,p._canvas=Yh(x),x.style.background=Q.tableHeaderBackground||"",x.style.height=pq+yr,W.mm(s,p),W.md(s,p),W.mh(s,p),X.mp(function(u){Xj[u.property]&&p.iv()},p),new Tg(p),p.iv()};Vm("TableHeader",u,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",zb,Nm,gn,"moveBackground","insertColor",Ho,fj,"resizable","movable"],_checkIcon:ys,_movable:!0,_resizable:!0,_labelColor:Q.tableHeaderLabelColor,_labelFont:Q.tableHeaderLabelFont,_columnLineColor:Q.tableHeaderColumnLineColor,_columnLineVisible:Q.tableHeaderColumnLineVisible,_sortDescIcon:Q.tableHeaderSortDescIcon,_sortAscIcon:Q.tableHeaderSortAscIcon,_moveBackground:Q.tableHeaderMoveBackground,_insertColor:Q.tableHeaderInsertColor,_indent:co,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Q){return Q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(g){return g.getColor()||this._labelColor},getLabelAlign:function(E){return E._align},onPropertyChanged:function(){this.iv()},_5Q:function(l){this._61I=l,this.iv()},getLogicalPoint:function(T){return fg(T,this._canvas,this.tv.tx())},validateImpl:function(){var I=this,G=I._canvas,B=I.getWidth(),N=I.getHeight(),M=I.tv,Y=I._60I,c=I._61I,K=-M.tx(),L=0;(B!==G.clientWidth||N!==G.clientHeight)&&ik(G,B,N),Y.clear(),I._39o._roots.each(function(Q){if(Q.isVisible()){var l=L+Q.getWidth();K+B>=L&&l>=K&&Y.add({column:Q,startX:L}),L=l}});var T=ck(G);if(ko(T,-K,0,1),T.beginPath(),T.rect(K,0,B,N),T.clip(),T.clearRect(K,0,B,N),Y.each(function(j){var K=j.column,v=j.startX,H=K.getWidth();H>0&&(T.save(),T.beginPath(),T.rect(v,0,H,N),T.clip(),c&&c.column===K||I.drawColumn(T,K,v,0,H,N),I._columnLineVisible&&Qf(T,v+H-1,0,1,N,I._columnLineColor),T.restore())}),c){var w=c.column,L=c.startX,u=c.position,m=w.getWidth();T.save(),T.beginPath(),T.rect(L,0,m,N),T.clip(),T.fillStyle=I._moveBackground,T.fill(),I.drawColumn(T,w,L,0,m,N),T.restore(),im(T,I._insertColor,u,0,N)}T.restore()},_6Q:function(t){var l=this.tv;return l._31o===t&&l.sm().getSelectionMode()===Fo},drawColumn:function(k,b,l,h,c,F){var q=this,x=q.tv,G=ir(b.getIcon()),v=q.getLabelAlign(b);if(q._6Q(b)){var R=ir(q._checkIcon);ld(k,R,l+c/2,h+F/2,b,q)}else{var C=q.getLabel(b),n=q.getLabelFont(b),T=q.getLabelColor(b),B=Rj(n,C).width,p=G?q._indent:0;v===Ug?(G&&Mi(k,G,pp,l,h,p,F),rd(k,C,n,T,l+p,h,c,F,Ug)):v===af?(G&&Mi(k,G,pp,l+c-B-p,h,p,F),rd(k,C,n,T,l,h,c,F,af)):(G&&Mi(k,G,pp,l+(c-B-p)/2,h,p,F),rd(k,C,n,T,l+(c-B+p)/2,h,0,F,Ug))}if(b.isSortable()&&x.getSortColumn()===b&&(G=ir(b.getSortOrder()===Mb?q._sortAscIcon:q._sortDescIcon))){var z=To(G,b)/2+2;ld(k,G,v===af?l+z:l+c-z,h+F/2,b,x)}}});var Tg=function(h){var _=this;_.th=h,_.tv=h._tableView,_.addListeners()};Tr(Tg,u,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(j){this.getView().style.cursor=j},handle_mousemove:function(i){if(!lg){var Y=this;delete Y._29o,Y.setCursor(Xp);for(var W=Y.th,x=W._60I,z=W.lp(i).x,l=x.size()-1;l>=0;l--){var p=x.get(l),M=p.column,N=p.startX+M.getWidth();if(W.isResizable()&&c(N-z)<=(mc?10:3))return Y._29o=p,Y.setCursor(ns),void 0;z>p.startX&&N>z&&(Y._29o=p),(M.isClickable()||M.isSortable()||W.isMovable()||Y.tv.getCheckColumn&&M===Y.tv.getCheckColumn())&&z>p.startX&&N>z&&Y.setCursor(ok)}}},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(h){var c=this;Hc(h),c.tv.endEditing(),c.handle_mousemove(h),c._29o&&(c.x=ad(h).x,c.lx=c.th.lp(h).x,c.w=c._29o.column.getWidth(),Rr(c,h))},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(t){var i=this,h=i.th,A=i.getView().style.cursor,N=i._29o,X=ad(t).x-i.x;if(i.resizing||i.moving||(A===ns?i.resizing=1:h.isMovable()&&A===ok&&c(X)>2&&(i.moving=1)),i.resizing)N.column.setWidth(i.w+X);else if(i.moving){var s=i.lx+X;h._60I.each(function(z){var T=z.startX,f=T+z.column.getWidth();if(s>=T&&f>=s){var $={column:N.column,startX:N.startX+X,front:f-s>s-T,insertColumn:z.column};$.position=$.front?T:f,h._5Q($)}})}},_16Q:function(Y,p){var R=this,s=R.tv,I=R.th,r=I._checkIcon;if(I._6Q(Y)){var V=ir(r),$=R.lx,W=Y.getWidth(),f=To(V,Y);if($>=p+W/2-f&&p+W/2+f>=$){I.setCheckIcon(r===Kr?ys:Kr);var J=s.sm(),c=s._rows;return r===Kr?J.rs(c):J.ss(c),s.onCheckColumnClicked(Y),!0}}return!1},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(y){var D=this,O=D.tv,b=D.th,o=D._29o;if(D.moving){var s=b._61I;if(s&&s.insertColumn!==s.column){var Z=s.column,f=O.getColumnModel()._roots,Y=f.remove(Z),h=f.indexOf(s.insertColumn);h>=0&&(s.front||h++,h<=f.size()&&(f.add(Z,h),O.getColumnModel()._38I(Z,Y,h)))}b._5Q(t),delete D.moving}else if(!D.resizing&&o){Z=o.column;var R=b.lp(y).x,_=o.startX,q=!0;if(b.onColumnClicked){var d=b.onColumnClicked(Z,y,_);d===!1&&(q=!1)}if(q&&R>=_&&R<=_+Z.getWidth()&&!D._16Q(Z,_)){if(Z.isSortable()){var p=O.getSortMode(),v=Z.getSortOrder();p===Ln?O.getSortColumn()===Z?(v===_l&&O.setSortColumn(t),Z.setSortOrder(v===Mb?_l:Mb)):O.setSortColumn(Z):"bistate"===p&&(O.getSortColumn()===Z?Z.setSortOrder(v===Mb?_l:Mb):O.setSortColumn(Z))}O.onColumnClicked(Z,y,_)}}D._29o=D.resizing=D.x=D.lx=D.w=t}}),kk.TablePane=function(t){this.init(new Bi(t))},Vm("TablePane",u,{ms_v:1,_44o:1}),kk.TreeTablePane=function(e){this.init(new vo(e))},Vm("TreeTablePane",u,{ms_v:1,_44o:1}),kk.Toolbar=function(k){var J=this,d=J._view=yo(1,J),f=d.style;f.background=Q.toolbarBackground||"",f.height=ch+yr,J._canvas=Yh(d),J._30o=new ls,J._90I=new ls,J.setItems(k||[]),d.handleGroupSelectedChanged=function(_){if(_.isSelected()){var s=_.getGroupId();null!=s&&J._items.forEach(function(U){var $=U.element;$&&$!==_&&$.setSelected&&$.getGroupId&&$.getGroupId()===s&&$.setSelected(!1)})}},new no(J)},Vm("Toolbar",u,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Rp,zb,Nm,jn,Fr,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:Q.toolbarLabelColor,_labelSelectColor:Q.toolbarLabelSelectColor,_labelFont:Q.toolbarLabelFont,_selectBackground:Q.toolbarSelectBackground,_itemGap:Q.toolbarItemGap,_separatorColor:Q.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(q){var M=this.getItemInfoAt(q);return M?M.item.toolTip:t},getLabelColor:function(I){return I&&I.selected&&I.type!==Kr&&I.type!==kq?this._labelSelectColor:this._labelColor},onPropertyChanged:function(F){this.iv(),F.property===Rp&&this._items.forEach(function(Q){oq(Q)})},redraw:function(){this.iv()},addItem:function(K,a){var Q=this._items;a==t?Q.push(K):Q.splice(a,0,K),this.fp(Rp,t,Q)},removeItem:function(q){if(q)for(var h=this._items,R=0;R<h.length;R++)q===h[R]&&(h.splice(R,1),this.fp(Rp,t,h))},removeItemById:function(i){if(i!=t)for(var a=this._items,C=0;C<a.length;C++)if(i===a[C].id){var V=a.splice(C,1)[0];return this.fp(Rp,t,a),V}},getItemById:function(i){if(i!=t)for(var C=this._items,J=0;J<C.length;J++){var r=C[J];
if(i===r.id)return r}},setItemVisible:function(c,H){var d=this.getItemById(c);d&&(d.visible=H)},getItemInfos:function(){return this._30o},getItemInfoAt:function(Z){var j=this,h=0,W=j._30o,z=j.lp(Z),b=z.x,g=z.y;if(g>=0&&g<=j.getHeight())for(;h<W.size();h++){var p=W.get(h);if(p.startX<=b&&b<=p.endX)return p}return t},drawItem:function(T,X,l,C,w){if(X.visible===!1)return 0;if(Jm(X.visible)&&!X.visible())return 0;var E=this,h=X.disabled;h&&(T.globalAlpha=Wj);var y=E.drawItemImpl(T,X,l,C,w),z=E._itemGap;return h&&(T.globalAlpha=1),this._currentItem!==X||"separator"===X||X.separator===!0||X.unfocusable||Lh(T,E._separatorColor,l-z/2,0,y+z,C),y},drawItemImpl:function(m,T,R,I,Q){var e=this,o=e._view,v=e._itemGap,z=I/2,r=T.type,p=T.element,$=T.label;vh(p)&&($=p,p=t);var J,P=e.getLabelFont(T),a=e.getLabelColor(T),C=T.selected,x=ir(T.icon),B=To(x,T),N=0,G=B+($?Rj(P,$).width:0);if("separator"===T||T.separator===!0)return im(m,e._separatorColor,R,I/4,z),1;if(p){x&&ld(m,x,R+B/2,z,T,e),rd(m,$,P,a,R+B,0,0,I);var K=Le(p);Q||e._90I.add(K),K.parentNode!==o&&zg(o,K),p.iv&&p.iv(),p.validate&&p.validate();var b=K.getBoundingClientRect(),n=b.width,j=K.style;return uo(K),j.left=e.tx()+R+G+yr,j.top=(I-b.height)/2+yr,G+n}return r===kq?J=ir(C?Jf:Eb):r===Kr&&(J=ir(C?Kr:ys)),J?(N=To(J,T),ld(m,J,R+N/2,z,T,e),R+=N,G+=N):C&&Qf(m,R-v/2,0,G+v,I,e.getSelectBackground(T)),x&&ld(m,x,R+B/2,z,T,e),rd(m,$,P,a,R+B,0,0,I),G},validateImpl:function(){var B=this,U=B._canvas,k=B.getWidth(),n=B.getHeight(),V=B._30o,f=B._items;ik(U,k,n);var p=ck(U),c=B._itemGap,Z=c/2;ko(p,B.tx(),0,1),p.clearRect(0,0,k,n);var m=B._90I;B._90I=new ls,V.clear(),f.forEach(function(t){var E=B.drawItem(p,t,Z,n);V.add({item:t,startX:Z,endX:Z+E,width:E}),E&&(Z+=E+c)}),m.each(function(c){B._90I.contains(c)||ig(c)});var O=B._64I;B._64I=q(0,Z),p.restore(),B._stickToRight?(B._65O=0,p=ck(U),Z=k-B._64I+c,ko(p,0,0,1),p.clearRect(0,0,k,n),V.clear(),f.forEach(function(j){var k=B.drawItem(p,j,Z,n,!0);V.add({item:j,startX:Z,endX:Z+k,width:k}),k&&(Z+=k+c)}),p.restore()):B.tx(B.tx()),O!==B._64I&&B.onSumWidthChanged(O,B._64I)},onSumWidthChanged:function(){},handleClick:function(i,e){var K=this,Z=i.type,O=i.action,y=i.groupId,L=i.selected;i.disabled||(y!=t?L||(i.selected=!0,this._items.forEach(function(L){L.groupId===y&&i!==L&&(L.selected=!1)}),O&&i.action(i,K,e)):Z===Kr||"toggle"===Z?(i.selected=!L,O&&i.action(i,K,e)):O&&i.action(i,K,e)),sj(),K.iv()}});var no=function(A){this.tb=A,this.addListeners()};Tr(no,u,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(H){this.handleScroll(H,10*(H.wheelDelta/40))},handle_DOMMouseScroll:function(P){this.handleScroll(P,10*-P.detail)},handleScroll:function(b,y){Hc(b);var k=this.tb;k.isScrollable()&&!k._stickToRight&&(k.tx(k.tx()+y),em())},handle_mousemove:function(o){var y=this;lg||y.setItem(o)},handle_mouseout:function(U){var N=this;U.target===N.getView()?N.tb.setCurrentItem(t):N.handle_mousemove(U)},handle_mousedown:function(n){this.handle_mousemove(n),this.handle_touchstart(n)},handle_touchstart:function(w){var A=this,q=A.tb,O=w.target;Ir(w)&&(O===A.getView()||O===q._canvas)&&(Hc(w),q.setFocus(w)&&(this.setItem(w,!0),(q.isScrollable()||A.info&&!A.info.item.disabled)&&(A.x=ad(w).x,A.tx=q.tx(),Rr(A,w))))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(u){var x=this,b=x.tb;if(!b._stickToRight){var M=ad(u).x-x.x;!x._25o&&c(M)>2&&b.isScrollable()&&(x._25o=1),x._25o&&b.tx(x.tx+M)}},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(O){var A=this,D=A.tb,C=A.info,N=A.tb.getItemInfoAt(O);if(!A._25o&&C){var b=C.item;N&&N.item===b&&D.handleClick(b,O)}A._25o=A.x=A.tx=t,A.setItem()},setItem:function(U,z){var S=this,H=S.tb,V=S.info=U?H.getItemInfoAt(U):t,O=V?V.item:t;H.setCurrentItem(O),z&&O&&Jm(O.onDown)&&O.onDown(U)}}),kk.BorderPane=function(){this._view=yo(1,this),this.iv()},Vm("BorderPane",u,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(V,M){this._12o("leftView",V),M!=t&&this.setLeftWidth(M)},getRightView:function(){return this._rightView},setRightView:function(m,v){this._12o("rightView",m),v!=t&&this.setRightWidth(v)},getTopView:function(){return this._topView},setTopView:function(Z,N){this._12o("topView",Z),N!=t&&this.setTopHeight(N)},getBottomView:function(){return this._bottomView},setBottomView:function(M,s){this._12o("bottomView",M),s!=t&&this.setBottomHeight(s)},getCenterView:function(){return this._centerView},setCenterView:function(m){this._12o("centerView",m)},_12o:function(l,s){var F=this,Z="_"+l,X=F._view,K=F[Z];K!==s&&(K&&(K.getView?ig(K.getView()):ig(K)),F[Z]=s,s&&(s.getView?zg(X,s.getView(),1):zg(X,s,1)),F.fp(l,K,s))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var b=this,J=b._topView,$=b._bottomView,v=b._leftView,l=b._rightView,P=b._centerView,E=b.getWidth(),x=b.getHeight(),m=0,y=0,S=E,n=x,A=0,_=0,L=0,c=0;J&&(A=b._topHeight==t?zd(J):b._topHeight,y=A),$&&(_=b._bottomHeight==t?zd($):b._bottomHeight,n=x-_),v&&(L=b._leftWidth==t?zh(v):b._leftWidth,m=L),l&&(c=b._rightWidth==t?zh(l):b._rightWidth,S=E-c);var a=q(0,S-m),h=q(0,n-y);J&&Km(J,0,0,E,A),$&&Km($,0,n,E,_),v&&Km(v,0,y,L,h),l&&Km(l,S,y,c,h),P&&Km(P,m,y,a,h)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);